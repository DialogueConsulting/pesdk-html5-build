!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("photoeditorsdk")):"function"==typeof define&&define.amd?define(["photoeditorsdk"],t):"object"==typeof exports?exports._unexposedPESDK=t(require("photoeditorsdk")):e._unexposedPESDK=t(e.PhotoEditorSDK)}("undefined"!=typeof self?self:this,function(e){return function(e){function t(r){if(i[r])return i[r].exports;var o=i[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,r){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=84)}({0:function(t,i){t.exports=e},84:function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),a=i.n(n),p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=n.Math.Vector2,h=void 0;h=window.Image;var d=function(e){function t(){r(this,t);for(var i=arguments.length,s=Array(i),a=0;a<i;a++)s[a]=arguments[a];var p=o(this,e.call.apply(e,[this].concat(s)));return p._colorOverlayFilter=new n.Engine.Filters.ColorOverlayFilter({color:p.getTintColor()}),p._frameContainer=new n.Engine.Container,p._resetSprites(),p._options.frame&&p._createSpritesForFrame(p._options.frame),p}return s(t,e),t.prototype._resetSprites=function(){this._spriteGroups={top:{},left:{},right:{},bottom:{}},this._sprites=[],this._repeatSprites={top:[],left:[],right:[],bottom:[]}},t.prototype._createSpritesForFrame=function(e){var t=this;if(!e)return this._disposeSprites();var i=e.imageGroups,r=e.layoutMode;this._layoutMode=r||"horizontal-inside",this._disposeSprites(),["top","left","right","bottom"].forEach(function(e){void 0!==i[e]&&["start","mid","end"].forEach(function(r){if(void 0!==i[e][r]){var o=i[e][r];"image"in o&&(o=o.image);var s=n.Engine.Texture.fromImage(o),a=new n.Engine.Sprite(s);t._spriteGroups[e][r]=a,t._sprites.push(a),t._frameContainer.addChild(a)}})})},t.prototype._render=function(e){var t=this._renderTexture.getDimensions();return this._options.frame&&(this._colorOverlayFilter.setColor(this.getTintColor()),this._updateSprites(e)),this._frameRenderTexture?this._frameRenderTexture.resizeTo(t):(this._frameRenderTexture=new n.Engine.RenderTexture(this._sdk.getRenderer(),t.x,t.y),this._frameSprite=new n.Engine.Sprite(this._frameRenderTexture),this._container.addChild(this._frameSprite)),this._frameSprite.setAlpha(this._options.alpha),this._options.frame&&this._options.frame.tintable?this._frameSprite.setFilters([this._colorOverlayFilter]):this._frameSprite.setFilters([]),this._frameRenderTexture.clear(),this._frameRenderTexture.render(this._frameContainer),this._renderTexture.render(this._container),n.Promise.resolve(this._renderTexture)},t.prototype._updateSprites=function(e){var t=e.getDimensions();this._frameWidth=Math.ceil(e.getDimensions().min()*this._options.scale),this._updateHorizontalSpriteGroup(e,"top",0),this._updateHorizontalSpriteGroup(e,"bottom",t.y-this._frameWidth),this._updateVerticalSpriteGroup(e,"left",0),this._updateVerticalSpriteGroup(e,"right",t.x-this._frameWidth)},t.prototype._updateHorizontalSpriteGroup=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.getDimensions(),o="vertical-inside"===this._layoutMode,s=this._spriteGroups[t].start,n=this._spriteGroups[t].mid,a=this._spriteGroups[t].end,p=0,h=0,d=void 0,u=void 0;if(s){d=s.getTexture().getDimensions(),u=d.y/d.x,p=Math.floor(this._frameWidth/u);var l=new f(0,i);l.x=o?this._frameWidth:0,s.setPosition(l),s.setHeight(this._frameWidth),s.setWidth(p)}if(a){d=a.getTexture().getDimensions(),u=d.y/d.x,h=Math.floor(this._frameWidth*u);var m=new f(r.x-h,i);m.x-=o?this._frameWidth:0,a.setPosition(m),a.setHeight(this._frameWidth),a.setWidth(h)}if(n){d=n.getTexture().getDimensions(),u=d.y/d.x;var _=new f(p,i),c=r.x-p-h;if(o&&(_.x+=this._frameWidth,c-=2*this._frameWidth),n.setPosition(_),n.setWidth(c),n.setHeight(this._frameWidth),"repeat"===this._options.frame.imageGroups[t].mid.mode){var y=this._frameWidth/u,g=Math.ceil(c/y),v=0;if(-1!==g){var x=Math.round(c/g);n.setWidth(x),v+=x,this._ensureRepeatSpritesExist(g-1,t,n);for(var b=0;b<g-1;b++){x=Math.round((c-v)/(g-b-1));var S=this._repeatSprites[t][b],w=_.clone().add(v,0).floor();S.setPosition(w),S.setWidth(x),S.setHeight(this._frameWidth),v+=x}}}}},t.prototype._ensureRepeatSpritesExist=function(e,t,i){var r=this;i.getTexture().setMaxListeners(e+1);var o=this._repeatSprites[t].length;if(e>o)for(var s=e-o,a=0;a<s;a++){var p=new n.Engine.Sprite(i.getTexture());this._repeatSprites[t].push(p),this._frameContainer.addChild(p),this._sprites.push(p)}else if(e<o){var f=this._repeatSprites[t].splice(e);f.forEach(function(e){var t=r._sprites.indexOf(e);-1!==t&&(r._sprites.splice(t,1),r._frameContainer.removeChild(e),e.dispose())})}},t.prototype._updateVerticalSpriteGroup=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.getDimensions(),o="horizontal-inside"===this._layoutMode,s=this._spriteGroups[t].start,n=this._spriteGroups[t].mid,a=this._spriteGroups[t].end,p=0,h=0,d=void 0,u=void 0;if(s){d=s.getTexture().getDimensions(),u=d.y/d.x,p=Math.floor(this._frameWidth*u);var l=new f(i,0);l.y=o?this._frameWidth:0,s.setPosition(l),s.setWidth(this._frameWidth),s.setHeight(p)}if(a){d=a.getTexture().getDimensions(),u=d.y/d.x,h=Math.floor(this._frameWidth*u);var m=new f(i,r.y-h);m.y-=o?this._frameWidth:0,a.setPosition(m),a.setWidth(this._frameWidth),a.setHeight(h)}if(n){d=n.getTexture().getDimensions(),u=d.y/d.x;var _=new f(i,p),c=r.y-p-h;if(o&&(_.y+=this._frameWidth,c-=2*this._frameWidth),n.setPosition(_),n.setHeight(c),n.setWidth(this._frameWidth),"repeat"===this._options.frame.imageGroups[t].mid.mode){var y=this._frameWidth*u,g=Math.ceil(c/y),v=0;if(-1!==g){var x=Math.round(c/g);n.setHeight(x),v+=x,this._ensureRepeatSpritesExist(g-1,t,n);for(var b=0;b<g-1;b++){x=Math.round((c-v)/(g-b-1));var S=this._repeatSprites[t][b],w=_.clone().add(0,v).floor();S.setPosition(w),S.setHeight(x),S.setWidth(this._frameWidth),v+=x}}}}},t.prototype._disposeSprites=function(){var e=this;this._sprites.forEach(function(t){e._frameContainer.removeChild(t),t.getTexture().getBaseTexture().dispose(),t.dispose()}),this._resetSprites()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeSprites()},t.validateFrame=function(e){if(e){var t=e.imageGroups,i=e.layoutMode;if("string"!=typeof e.identifier)throw new Error("Frame needs a property `identifier` of type String.");if("object"!==p(e.imageGroups))throw new Error("Frame needs a property `imageGroups` of type Object.");var r=function(e){var i=t[e],r=i.start,o=i.end,s=i.mid;if(void 0!==t[e]){if("object"!==p(t[e]))throw new Error("Frame: `imageGroups."+e+"` needs to be of type Object.");if(void 0!==r&&!(r instanceof h||"undefined"!=typeof HTMLImageElement&&r instanceof HTMLImageElement))throw new Error("Frame: `imageGroups."+e+".start` needs to be of type Image.");if(void 0!==s&&!(r instanceof h||"undefined"!=typeof HTMLImageElement&&r instanceof HTMLImageElement)&&"object"!==(void 0===s?"undefined":p(s)))throw new Error("Frame: `imageGroups."+e+".mid` needs to be of type Image or Object.");if(void 0!==o&&!(o instanceof h||"undefined"!=typeof HTMLImageElement&&o instanceof HTMLImageElement))throw new Error("Frame: `imageGroups."+e+".end` needs to be of type Image.")}};if(void 0!==i&&-1===["vertical-inside","horizontal-inside"].indexOf(i))throw new Error("Frame: `layoutMode` must be one of vertical-inside, horizontal-inside");if("undefined"!=typeof tintable&&"boolean"!=typeof tintable)throw new Error("Frame: `tintable` needs to be of type Boolean.");r("top"),r("left"),r("right"),r("bottom")}},t}(n.Operation);d.identifier="frame",d.prototype.availableOptions={frame:{type:n.OptionType.OBJECT,validation:d.validateFrame,setter:function(e,t){return t||this._createSpritesForFrame(e),e}},alpha:{type:n.OptionType.NUMBER,default:1},tintColor:{type:n.OptionType.COLOR,default:new n.Color(1,1,1,0)},scale:{type:n.OptionType.NUMBER,default:.1}},a.a.Operations.FrameOperation=d,t.default=d}}).default});