!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("photoeditorsdk")):"function"==typeof define&&define.amd?define(["photoeditorsdk"],t):"object"==typeof exports?exports._unexposedPESDK=t(require("photoeditorsdk")):e._unexposedPESDK=t(e.PhotoEditorSDK)}("undefined"!=typeof self?self:this,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=92)}({0:function(t,r){t.exports=e},92:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=r(0),a=r.n(s),l=s.Engine.Filters.OverlayFilter,p=s.Math.Vector2,u=function(e){function t(){n(this,t);for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var l=o(this,e.call.apply(e,[this].concat(i)));return l._overlayTexture=s.Engine.Texture.fromImage(l._options.image),l._overlayContainer=new s.Engine.Container,l._overlaySprite=new s.Engine.Sprite,l._overlaySprite.setTexture(l._overlayTexture),l._overlaySprite.setAnchor(0,0),l._overlayContainer.addChild(l._overlaySprite),l._overlayFilter=new s.Engine.Filters.OverlayFilter({overlayImage:l._overlayTexture.getBaseTexture().getGLUnit(),overlayTexture:l._overlayTexture}),l._sprite.setFilters([l._overlayFilter]),l._renderedOverlaySprite=new s.Engine.Sprite,l._renderedOverlayContainer=new s.Engine.Container,l._renderedOverlayContainer.addChild(l._renderedOverlaySprite),l._overlayRendered=!1,l._lastInputDimensions=new p(0,0),l}return i(t,e),t.prototype.setOption=function(t,r){if(e.prototype.setOption.call(this,t,r),"image"===t&&r&&this._sdk){var n=this._sdk.getRenderer(),o=this._overlayTexture.getBaseTexture();o.setSource(r),n.isOfType(s.RendererType.WEBGL)&&n.updateTexture(o),this._overlayRendered=!1}},t.prototype._render=function(e){var t=e.getDimensions(),r=this._options,n=r.image,o=r.alpha,i=r.blendMode;return n?(this._overlayRendered&&this._lastInputDimensions.equals(t)||(this._renderOverlayToRenderTexture(e),this._overlayRendered=!0,this._lastInputDimensions.copy(t)),this._overlayFilter.set({blendMode:i,overlayImage:this._overlayRenderTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayRenderTexture,alpha:o}),this._sprite.setFilters([this._overlayFilter]),this._renderTexture.render(this._container),s.Promise.resolve(this._renderTexture)):(this._sprite.setFilters([]),this._renderTexture.render(this._container),s.Promise.resolve())},t.prototype._renderOverlayToRenderTexture=function(e){var t=this._sdk.getRenderer(),r=e.getDimensions();this._overlayRenderTexture||(this._overlayRenderTexture=new s.Engine.RenderTexture(t,r.x,r.y),this._renderedOverlaySprite.setTexture(this._overlayRenderTexture));var n=this._options.image,o=n.width,i=n.height,a=s.Utils.resizeVectorToFill(new p(o,i),r);this._overlaySprite.setWidth(a.x),this._overlaySprite.setHeight(a.y);var l=this._overlayRenderTexture.getBaseTexture();t.isOfType(s.RendererType.WEBGL)&&(l.setGLUnit(4),t.updateTexture(l,!1)),this._overlayRenderTexture.resizeTo(r),this._overlayRenderTexture.render(this._overlayContainer)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._overlaySprite.dispose()},t}(s.Operation);u.identifier="overlay",u.BLEND_MODES=l.BLEND_MODES,u.prototype.availableOptions={identifier:{type:s.OptionType.STRING},image:{type:s.OptionType.IMAGE},blendMode:{type:s.OptionType.NUMBER,default:l.BLEND_MODES.MULTIPLY,available:Object.keys(l.BLEND_MODES).map(function(e){return l.BLEND_MODES[e]})},alpha:{type:s.OptionType.NUMBER,default:1}},a.a.Operations.OverlayOperation=u,t.default=u}}).default});