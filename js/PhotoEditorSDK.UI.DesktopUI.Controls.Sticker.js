!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("photoeditorsdk/PhotoEditorSDK.UI.DesktopUI.Core"),require("photoeditorsdk")):"function"==typeof define&&define.amd?define([["PhotoEditorSDK","UI","DesktopUI"],"photoeditorsdk"],e):"object"==typeof exports?exports._unexposedPESDK=e(require("photoeditorsdk/PhotoEditorSDK.UI.DesktopUI.Core"),require("photoeditorsdk")):t._unexposedPESDK=e(t.PhotoEditorSDK.UI.DesktopUI,t.PhotoEditorSDK)}("undefined"!=typeof self?self:this,function(t,e){return function(t){function e(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=48)}([function(e,o){e.exports=t},function(t,o){t.exports=e},,function(t,e,o){"use strict";function n(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=o(1),c=(o.n(s),o(0)),p=(o.n(c),Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}),l=s.Math.Vector2,u=void 0;s.Operations.SpriteOperation&&(u=s.Operations.SpriteOperation.TextSprite);var h=function(t){function e(){r(this,e);for(var o=arguments.length,n=Array(o),a=0;a<o;a++)n[a]=arguments[a];var s=i(this,t.call.apply(t,[this].concat(n)));return s._bindAll("_onDragStart","_onDrag","_onDragStop","_onRotateDragStart","_onRotateDrag","_onRotateDragStop","_onCornerDrag","_onCornerDragStop","_onSpriteUpdate","_onTakeToFront","_onFlipHorizontally","_onDuplicate","_onDelete"),s}return a(e,t),e.prototype.componentDidMount=function(){this.props.sprite.on("update",this._onSpriteUpdate)},e.prototype.componentWillUnmount=function(){this.props.sprite.off("update",this._onSpriteUpdate)},e.prototype.componentWillReceiveProps=function(t){this.props.sprite.off("update",this._onSpriteUpdate),t.sprite.on("update",this._onSpriteUpdate)},e.prototype._onSpriteUpdate=function(){this.forceUpdate()},e.prototype._onTakeToFront=function(t){t.stopPropagation(),this.props.onTakeToFront&&this.props.onTakeToFront(t)},e.prototype._onFlipHorizontally=function(t){t.stopPropagation(),this.props.onFlipHorizontally&&this.props.onFlipHorizontally(t)},e.prototype._onDelete=function(t){t.stopPropagation(),this.props.onDelete&&this.props.onDelete(t)},e.prototype._onDuplicate=function(t){t.stopPropagation(),this.props.onDuplicate&&this.props.onDuplicate(t)},e.prototype._onBeforeScale=function(){},e.prototype._onScale=function(t){},e.prototype._onRotateDragStart=function(){this._imageBoundingBox=this.props.canvasControls.getImageBoundingRect(),this._containerOffset=this.props.canvasControls.getContainerOffset(),this.props.onBeforeChange&&this.props.onBeforeChange(),this.props.onCanvasClickDisabled&&this.props.onCanvasClickDisabled()},e.prototype._onRotateDrag=function(t,e){var o=this.context.editor,n=this.props.sprite,r=this._getAbsoluteSpritePosition().add(this._imageBoundingBox.x,this._imageBoundingBox.y),i=r.clone(),a=e.clone().subtract(this._containerOffset).subtract(i),s=Math.atan2(a.y,a.x)-Math.PI/2,c=this.props,p=c.snapRotation,l=c.snapRotationTolerance,u=Math.round(180*s/Math.PI),h=Math.round(u/p)*p,f=u-h;Math.abs(f)<l&&(s=h*Math.PI/180),n.setRotation(s),o.render(),this.forceUpdate()},e.prototype._onRotateDragStop=function(){this.props.onAfterChange&&this.props.onAfterChange(),this.props.onCanvasClickEnabled&&this.props.onCanvasClickEnabled()},e.prototype._onCornerDragStart=function(t,e,o,n){var r=this.context.editor,i=this.props.sprite,a=i.getDimensions(r.getSDK(),r.getOutputDimensions()),s=a.x;this._imageBoundingBox=this.props.canvasControls.getImageBoundingRect(),this._containerOffset=this.props.canvasControls.getContainerOffset();var c=i.getPivot(),p=i.getAnchor(),u=this._getAbsoluteSpritePosition().add(this._imageBoundingBox.x,this._imageBoundingBox.y),h=i.getDimensions(r.getSDK(),r.getOutputDimensions()),f=new l(h.width,h.height),d=u.clone().subtract(f.clone().multiply(p)).add(f.clone().multiply(c)).round(),g=n.clone().subtract(this._containerOffset).subtract(d);this._initialScaleSettings={width:s,mouseDistanceFromPivot:g},this._onBeforeScale(),this.props.onBeforeChange&&this.props.onBeforeChange(),this.props.onCanvasClickDisabled&&this.props.onCanvasClickDisabled()},e.prototype._onCornerDrag=function(t){var e=this.context.editor,o=this.props.sprite,n=o.getRotation(),r=this._initialScaleSettings,i=r.width,a=r.mouseDistanceFromPivot,s=a.clone().add(t),c=Math.cos(n),p=Math.sin(n),l=Math.max(Math.abs(2*(s.x*c+s.y*p)),this.constructor.MIN_WIDTH),u=l/i;e.render(),this._onScale(u)},e.prototype._onCornerDragStop=function(){this.props.onAfterChange&&this.props.onAfterChange(),this.props.onCanvasClickEnabled&&this.props.onCanvasClickEnabled()},e.prototype._isDraggingDisabled=function(){return!this.props.selected},e.prototype._onDragStart=function(){var t=this.props.sprite;this._initialPosition=t.getPosition(),this.props.onBeforeChange&&this.props.onBeforeChange()},e.prototype._onDrag=function(t){var e=this.props.sprite,o=this.context.editor,n=o.getOutputDimensions(),r=this._initialPosition.clone().add(t.divide(n));e.setPosition(r),o.render(),this.forceUpdate()},e.prototype._onDragStop=function(){this.props.onAfterChange&&this.props.onAfterChange()},e.prototype._getAbsoluteSpritePosition=function(){var t=this.context.editor,e=t.getOutputDimensions();return this.props.sprite.getPosition().clone().multiply(e)},e.prototype._getContainerStyle=function(){return{}},e.prototype._renderKnobs=function(){var t=this,e=[];return["top","bottom"].forEach(function(o){["left","right"].forEach(function(r){var i=o+"-"+r,a=n({},i,!0);e.push(c.React.createElement(c.DraggableComponent,{key:i,onStart:t._onCornerDragStart.bind(t,o,r),onDrag:t._onCornerDrag,onStop:t._onCornerDragStop},c.React.createElement(v,a)))})}),e},e.prototype._getSpriteDimensions=function(){var t=this.context.editor,e=this.props.sprite,o=t.getOutputDimensions();return e.getDimensions(t.getSDK(),o)},e.prototype._getOverlayPosition=function(){var t=this.context.editor,e=this.props.sprite,o=t.getOutputDimensions(),n=this._getSpriteDimensions(),r=e.getPosition().clone().multiply(o),i=e.getRotation(),a=Math.sin(i),s=Math.cos(i),c=new l(Math.abs(n.x*s)+Math.abs(n.y*a),Math.abs(n.x*a)+Math.abs(n.y*s));return new l(r.x,r.y-c.y/2-70).clamp(new l(80,20),o.clone().subtract(80,70))},e.prototype._renderOverlayControls=function(){if(this.props.selected)return c.React.createElement(c.CanvasOverlayControlsComponent,{takeToFront:!0,flipHorizontally:!(this.props.sprite instanceof u),duplicate:!0,delete:!0,position:this._getOverlayPosition(),onTakeToFront:this._onTakeToFront,onFlipHorizontally:this._onFlipHorizontally,onDuplicate:this._onDuplicate,onDelete:this._onDelete})},e.prototype._getItemControlsProps=function(){return{}},e.prototype.render=function(){var t=this,e=this.props,o=e.selected,n=e.sprite,r=this.state.editing,i=!r,a=[this._renderKnobs(),c.React.createElement(m,{key:"rotateControls"},c.React.createElement(c.DraggableComponent,{onStart:this._onRotateDragStart,onDrag:this._onRotateDrag,onStop:this._onRotateDragStop},c.React.createElement(S,null)))],s=this._getItemControlsProps(),l=c.React.createElement(g,p({style:this._getContainerStyle()},s),a);return c.React.createElement(c.DraggableComponent,{onStart:this._onDragStart,onStop:this._onDragStop,onDrag:this._onDrag,disabled:this._isDraggingDisabled()},c.React.createElement(f,{onClick:this.props.onClick,"data-type":n.constructor.type,"data-selected":o,className:void 0},this._renderOverlayControls(),c.React.createElement(d,{style:this._getContainerStyle(),editing:o&&r,innerRef:function(e){t._container=e},className:void 0},c.React.createElement(y,null,this._renderContent()),o&&!i&&a),o&&i&&l))},e}(c.BaseComponent);h.contextTypes=c.BaseComponent.contextTypes,h.MIN_WIDTH=1,h.defaultProps={snapRotation:90,snapRotationTolerance:5},e.a=h;var f=c.adonis.div("120drhm","OuterContainer"),d=c.adonis.div("bkf7u8",{editing:"64zghi"},"Container"),g=c.adonis.div("36haff","ItemControls"),y=c.adonis.div("120drhm","Content"),m=c.adonis.div("77tiy3","RotateControl"),_=c.adonis.div("mznefm","Knob"),S=Object(c.adonis)(_)("1en5760","RotateKnob"),v=Object(c.adonis)(_)("bdmepn",{"top-left":"1dtvxe8","top-right":"1tu191k","bottom-left":"1we5ut6","bottom-right":"f2wva1"},"CornerKnob")},,function(t,e,o){"use strict";var n=function(){function t(t,e){var o=[],n=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(o.push(a.value),!e||o.length!==e);n=!0);}catch(t){r=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}return o}return function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.a={load:function(t){var e=this;return function(){if(t.substr(0,5),!0)return Promise.resolve([t,t])}().then(function(t){var o=n(t,2),r=o[0],i=o[1];return e._createAndLoadImage(r,i)})},_createAndLoadImage:function(t,e){return new Promise(function(t,o){var n=new window.Image;n.addEventListener("load",function(){t(n)}),n.addEventListener("error",function(){o(new Error("Failed to load image at "+e))}),n.crossOrigin="Anonymous",n.src=e})},loadXHR:function(t,e){return new Promise(function(o,n){var r=void 0;window.XDomainRequest?(r=new window.XDomainRequest,e&&r.overrideMimeType(e),r.onload=function(){o(r)},r.onerror=function(t){n(t)}):window.XMLHttpRequest&&(r=new window.XMLHttpRequest,e&&r.overrideMimeType(e),r.onreadystatechange=function(t){4===r.readyState&&(200===r.status?o(r):n(new Error("HTTP Status "+r.status)))}),r.open("GET",t,!0),r.send()})}}},function(t,e,o){"use strict";function n(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=o(1),c=(o.n(s),o(0)),p=(o.n(c),o(7)),l=o(8),u=o(9),h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},f=s.Math.Vector2,d=function(t){function e(){var o;r(this,e);for(var a=arguments.length,p=Array(a),l=0;l<a;l++)p[l]=arguments[l];var u=i(this,t.call.apply(t,[this].concat(p)));return u._bindAll("_onZoomDone","_onWindowResize","_onHistoryChange","_onAfterTransform"),u._events=(o={},n(o,c.Constants.EVENTS.ZOOM_DONE,u._onZoomDone),n(o,c.Constants.EVENTS.WINDOW_RESIZE,u._onWindowResize),n(o,c.Constants.EVENTS.HISTORY_UNDO,u._onHistoryChange),n(o,c.Constants.EVENTS.HISTORY_REDO,u._onHistoryChange),o),u.state=s.Utils.extend(u.state,{visible:!1,canvasClickDisabled:!1}),u}return a(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.forceUpdate()},e.prototype._onAfterTransform=function(t){var e="sprite-transform-"+t.getId();this.props.controls.addLocalHistorySnapshot(e,!0)},e.prototype._onHistoryChange=function(){var t=this.getSharedState("operation");if(t){var e=this.getSharedState("selectedSprite");-1===t.getSprites().indexOf(e)&&this._selectNextSprite()}},e.prototype._onWindowResize=function(){var t=this;this.context.editor.once("rendered",function(){t.forceUpdate()})},e.prototype._onZoomDone=function(){this.context.editor.render(),this.setState({visible:!0})},e.prototype._onItemBlur=function(){},e.prototype._onCanvasClick=function(t){if(!this.state.canvasClickDisabled){this._performHitTest(c.Utils.getEventPosition(t))||(this.getSharedState("selectedSprite")&&this._onItemBlur(),this.context.screen.switchToControls("default"))}},e.prototype._onSpriteDelete=function(t){this.getSharedState("operation").removeSprite(t),t.dispose(),this._selectNextSprite(),this.props.controls.addLocalHistorySnapshot("sprite-deletion",!1),this.context.editor.render()},e.prototype._onSpriteTakeToFront=function(t){this.getSharedState("operation").takeSpriteToFront(t),this.props.controls.addLocalHistorySnapshot("sprite-order",!1),this.forceUpdate(),this.context.editor.render()},e.prototype._onSpriteFlipHorizontally=function(t,e){e.stopPropagation(),t.setFlipHorizontally(!t.getFlipHorizontally()),this.props.controls.addLocalHistorySnapshot("sprite-flip-horizontally",!1),this.forceUpdate(),this.context.editor.render()},e.prototype._onSpriteDuplicate=function(t,e){e.stopPropagation();var o=this.getSharedState("operation"),n=t.serializeOptions();delete n.id,delete n.type,t.hasOption("image")&&(n.image=t.getImage());var r=o.getInputDimensions();n.position.add(new f(10,10).divide(r));var i=this._createSprite(n);o.addSprite(i),this.setSharedState({selectedSprite:i}),this.props.controls.addLocalHistorySnapshot("sprite-creation",!1),this.context.editor.render()},e.prototype._selectNextSprite=function(){var t=this.getSharedState("operation"),e=t.getSprites(),o=e[e.length-1];o?this.setSharedState({selectedSprite:o}):(this.props.controls.skipHistory=!0,this.context.screen.switchToControls("default"))},e.prototype._getComponentTypeForSprite=function(t){var e=s.Operations.SpriteOperation;switch(t.constructor){case e.StickerSprite:return p.a;case e.TextSprite:return l.a;case e.BrushSprite:return u.a}},e.prototype._getPropsForSprite=function(t){var e={};return e.hideContent=!0,e},e.prototype._renderSpriteItems=function(t){var e=this,o=this.getSharedState("selectedSprite");return t.map(function(t){var n=e._getComponentTypeForSprite(t),r=e._getPropsForSprite(t),i=o===t;return c.React.createElement(n,h({sprite:t,selected:i,onClick:e._onCanvasClick,onAfterChange:e._onAfterTransform.bind(e,t),onCanvasClickDisabled:e._onCanvasClickDisabled,onCanvasClickEnabled:e._onCanvasClickEnabled,onDelete:e._onSpriteDelete.bind(e,t),onTakeToFront:e._onSpriteTakeToFront.bind(e,t),onFlipHorizontally:e._onSpriteFlipHorizontally.bind(e,t),onDuplicate:e._onSpriteDuplicate.bind(e,t),snapRotation:e.props.options.snapRotation,snapRotationTolerance:e.props.options.snapRotationTolerance,canvasControls:e,key:t.getId()},r))})},e.prototype._renderOverlayControls=function(){return null},e.prototype._renderControls=function(){var t=this;if(this.state.visible){var e=this.getSharedState("operation"),o=e.getSprites(),n=this._container&&this._getContainerStyle();return c.React.createElement(g,{className:void 0},c.React.createElement(y,{innerRef:function(e){t._innerContainer=e},style:n,className:void 0},!this.state.canvasClickDisabled&&c.React.createElement(m,{onClick:this._onCanvasClick}),c.React.createElement("div",null,this._renderSpriteItems(o),this._renderOverlayControls())))}},e}(c.CanvasControlsComponent);d.contextTypes=c.CanvasControlsComponent.contextTypes,e.a=d;var g=c.adonis.div("120drhm","CanvasControls"),y=c.adonis.div("1anj0of","Container"),m=c.adonis.div("o35414","ClickHandlerForInternetExplorer")},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=o(0),s=(o.n(a),o(3)),c=o(5),p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},l=function(t){function e(){n(this,e);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r(this,t.call.apply(t,[this].concat(i)));return s.state={renderAsSVG:!1,svgAttributes:{}},s}return i(e,t),e.prototype.componentDidMount=function(){var e=this;if(t.prototype.componentDidMount.call(this),this.props.hideContent)return null;var o=this.props.sprite;o.getImage().src.match(/\w+\.svg(?=\?|$)/i)&&"none"!==o.getTintMode()&&c.a.loadXHR(o.getImage().src,"image/svg+xml").then(function(t){for(var o=t.responseXML.documentElement.attributes,n={},r=0;r<o.length;r++){var i=o[r],a=i.name,s=i.value;"xmlns:xlink"===a&&(a="xmlnsXlink"),n[a]=s}var c=t.responseText.match(/<svg\b[^>]*>([\s\S]*?)<\/svg>/im)[1];c=c.replace(/\s+?fill=["'].*?["']/gi,""),e.setState({renderAsSVG:!0,svgContent:c,svgAttributes:n})})},e.prototype._onBeforeScale=function(){var t=this.props.sprite;this._initialOptions={dimensions:t.getDimensions().clone()}},e.prototype._onScale=function(t){var e=this.context.editor,o=this._initialOptions.dimensions;this.props.sprite.set({dimensions:o.clone().multiply(t/e.zoom.level)}),this.forceUpdate(),e.render()},e.prototype._getSpriteDimensions=function(){var t=this.context.editor;return this.props.sprite.getDimensions().clone().multiply(t.zoom.level)},e.prototype._getContainerStyle=function(){var t=this.context.editor,e=t.getOutputDimensions(),o=this.props.sprite,n=o.getPosition().clone().multiply(e),r=180*o.getRotation()/Math.PI,i="rotateZ("+r.toFixed(2)+"deg)",a=o.getDimensions().clone().multiply(t.zoom.level);return{width:a.x,height:a.y,left:n.x,top:n.y,marginLeft:-.5*a.x,marginTop:-.5*a.y,transform:i,MozTransform:i,msTransform:i,WebkitTransform:i,transformOrigin:"50% 50%",MozTransformOrigin:"50% 50%",msTransformOrigin:"50% 50%",WebkitTransformOrigin:"50% 50%"}},e.prototype._getContentStyle=function(){var t=this.props.sprite,e="rotateY("+(t.getFlipHorizontally()?180:0)+"deg) rotateX("+(t.getFlipVertically()?180:0)+"deg)",o={opacity:t.getAlpha(),transform:e,MozTransform:e,msTransform:e,WebkitTransform:e};return this.state.renderAsSVG&&(o.fill=t.getTintColor().toRGBA()),o},e.prototype._renderContent=function(){if(this.props.hideContent)return null;var t=this.props.sprite,e=this.state.svgAttributes;return this.state.renderAsSVG?React.createElement(h,p({style:this._getContentStyle(),dangerouslySetInnerHTML:{__html:this.state.svgContent}},e)):React.createElement(u,{src:t.getImage().src,style:this._getContentStyle()})},e}(s.a);l.contextTypes=s.a.contextTypes,l.MIN_WIDTH=s.a.MIN_WIDTH,e.a=l;var u=a.adonis.img("1ssoezr","Image"),h=a.adonis.svg("1ssoezr","SVGImage")},function(t,e,o){"use strict";function n(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=o(1),c=(o.n(s),o(0)),p=(o.n(c),o(3)),l=s.Math.Vector2,u=function(t){function e(){r(this,e);for(var o=arguments.length,n=Array(o),a=0;a<o;a++)n[a]=arguments[a];var s=i(this,t.call.apply(t,[this].concat(n)));return s._bindAll("_onTextChange","_onBlur","_onItemDoubleClick","_onWidthDrag","_onWidthDragStop"),s.state={editing:!1,updateBecauseIESucks:!1},s}return a(e,t),e.prototype._isDraggingDisabled=function(){return t.prototype._isDraggingDisabled.call(this)||this.state.editing},e.prototype.enterEditMode=function(){var t=this,e=this.context.editor,o=this.props.sprite;o.setVisible(!1),e.render(),this.setState({editing:!0},function(){o._edited||(o.setText(""),t._textField.value="",o._edited=!0,t.forceUpdate()),t._textField.focus(),t._textField.select()})},e.prototype.leaveEditMode=function(){var t=this.context.editor;this.props.sprite.setVisible(!0),t.render(),this.setState({editing:!1})},e.prototype.shouldComponentUpdate=function(){return!0},e.prototype._onTakeToFront=function(){var e;this.leaveEditMode();for(var o=arguments.length,n=Array(o),r=0;r<o;r++)n[r]=arguments[r];(e=t.prototype._onTakeToFront).call.apply(e,[this].concat(n))},e.prototype._onFlipHorizontally=function(){var e;this.leaveEditMode();for(var o=arguments.length,n=Array(o),r=0;r<o;r++)n[r]=arguments[r];(e=t.prototype._onFlipHorizontally).call.apply(e,[this].concat(n))},e.prototype._onDuplicate=function(){var e;this.leaveEditMode();for(var o=arguments.length,n=Array(o),r=0;r<o;r++)n[r]=arguments[r];(e=t.prototype._onDuplicate).call.apply(e,[this].concat(n))},e.prototype._onSpriteUpdate=function(e,o){var n=this;c.Utils.Browser.isIElte(10)&&o.alignment&&e.getAlignment()!==o.alignment&&this.setState({updateBecauseIESucks:!0},function(){Object(c.requestAnimationFrame)(function(){n.setState({updateBecauseIESucks:!1})})}),t.prototype._onSpriteUpdate.call(this)},e.prototype._onWidthDragStart=function(t,e,o){var n=this.context.editor,r=this.props.sprite,i=r.getAnchor();this._imageBoundingBox=this.props.canvasControls.getImageBoundingRect(),this._containerOffset=this.props.canvasControls.getContainerOffset();var a=this._getAbsoluteSpritePosition().add(this._imageBoundingBox.x,this._imageBoundingBox.y),s=r.getDimensions(n.getSDK(),n.getOutputDimensions()),c=new l(s.width,s.height),p=a.clone().subtract(c.clone().multiply(i)).add(c.clone().multiply(.5)).round(),u=o.clone().subtract(this._containerOffset).subtract(p);this._initialScaleSettings={maxWidth:r.getMaxWidth(),mouseDistanceFromCenter:u},this.props.onBeforeChange&&this.props.onBeforeChange(),this.props.onCanvasClickDisabled&&this.props.onCanvasClickDisabled()},e.prototype._onWidthDrag=function(t){var e=this.props.sprite,o=e.getRotation(),n=this._initialScaleSettings.mouseDistanceFromCenter,r=n.clone().add(t),i=Math.cos(o),a=Math.sin(o),s=Math.max(Math.abs(2*(r.x*i+r.y*a)),50)/this._imageBoundingBox.width;e.setMaxWidth(s),this.context.editor.render()},e.prototype._onWidthDragStop=function(){this.props.onAfterChange&&this.props.onAfterChange(),this.props.onCanvasClickEnabled&&this.props.onCanvasClickEnabled()},e.prototype._onBlur=function(){this.leaveEditMode();var t=this.props.sprite;t&&""===t.getText()&&(t.setText(this._t("editor.controls.text.defaultText")),t._edited=!1)},e.prototype._onTextChange=function(t){this.props.sprite.setText(t.target.value),this.forceUpdate()},e.prototype._onItemDoubleClick=function(){this.props.selected&&this.enterEditMode()},e.prototype._onBeforeScale=function(){var t=this.props.sprite;this._initialOptions={maxWidth:t.getMaxWidth(),fontSize:t.getFontSize()}},e.prototype._onScale=function(t){var e=this._initialOptions,o=e.maxWidth,n=e.fontSize,r=this.props.sprite;r.set({maxWidth:o*t,fontSize:n*t}),this.context.mediator.emit(c.Constants.EVENTS.TEXT_SCALED,r),this.forceUpdate()},e.prototype._getContainerStyle=function(){var t=this.context.editor,e=t.getOutputDimensions(),o=this.props.sprite,n=o.getPosition().clone().multiply(e),r=180*o.getRotation()/Math.PI,i="rotateZ("+r.toFixed(2)+"deg)",a=o.getMaxWidth()*e.x,s=o.getDimensions(t.getSDK(),e).y;return{width:a,height:s,left:n.x,top:n.y,marginLeft:-.5*a,marginTop:-.5*s,transform:i,MozTransform:i,msTransform:i,WebkitTransform:i,transformOrigin:"50% 50%",MozTransformOrigin:"50% 50%",msTransformOrigin:"50% 50%",WebkitTransformOrigin:"50% 50%"}},e.prototype._getTextStyle=function(){var t=this.context.editor,e=this.props.sprite,o=t.getSDK(),n=t.getOutputDimensions(),r=e.getDOMStyle(o,n),i=this._getAbsoluteSpritePosition(),a=e.getDimensions(o,n);return r.height=Math.min(a.y,n.y-i.y+a.y/2),r},e.prototype._renderKnobs=function(){var e=this,o=t.prototype._renderKnobs.call(this);return["left","right"].forEach(function(t){var r="width-"+t,i=n({},t,!0);o.push(c.React.createElement(c.DraggableComponent,{key:r,onStart:e._onWidthDragStart.bind(e,t),onDrag:e._onWidthDrag,onStop:e._onWidthDragStop},c.React.createElement(d,i)))}),o},e.prototype._getItemControlsProps=function(){return{onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd}},e.prototype._renderContent=function(){var t=this,e=this.props,o=e.sprite,n=e.selected,r=this.state,i=r.editing,a=r.updateBecauseIESucks,s=[];return this.props.hideContent&&!this.state.editing||s.push(c.React.createElement(h,{key:"text-field",editing:i,innerRef:function(e){t._textField=e},style:this._getTextStyle(),defaultValue:o.getText(),onBlur:this._onBlur,onChange:this._onTextChange,updateBecauseIESucks:a})),this.state.editing||s.push(c.React.createElement(f,{key:"disabled-overlay",className:void 0,selected:n})),s},e}(p.a);u.contextTypes=p.a.contextTypes,u.MIN_WIDTH=100,e.a=u;var h=c.adonis.textarea("12u5t8c",{updateBecauseIESucks:"ckktkq",editing:"15kzu1c"},"TextField"),f=c.adonis.div("8gacw5","DisabledOverlay"),d=c.adonis.div("jqmmm4",{left:"tr97e1",right:"1llojum"},"WidthControl")},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=o(0),s=(o.n(a),o(3)),c=function(t){function e(){return n(this,e),r(this,t.apply(this,arguments))}return i(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this);var e=this.props.sprite.getCanvas();this._brush&&this._appendCanvas(e)},e.prototype.componentWillReceiveProps=function(t){if(t.sprite!==this.props.sprite){var e=this.props.sprite.getCanvas();if(e.parentNode.removeChild(e),this._brush){var o=t.sprite.getCanvas();this._appendCanvas(o)}}},e.prototype._appendCanvas=function(t){t.style.width="100%",t.style.height="100%",this._brush.appendChild(t)},e.prototype._renderOverlayControls=function(){return null},e.prototype.render=function(){var t=this;return this.props.hideContent?null:a.React.createElement(p,{innerRef:function(e){t._brush=e}})},e}(s.a);e.a=c;var p=a.adonis.div("8gacw5","BrushItem")},,,function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=o(0),s=(o.n(a),a.ControlsStyles.PlainControlItem),c=function(t){function e(){return n(this,e),r(this,t.apply(this,arguments))}return i(e,t),e.prototype._onStickerClick=function(t){this.props.onStickerClick&&this.props.onStickerClick(t)},e.prototype._renderListItems=function(){var t=this,e=this.props.stickers,o=void 0,n=this.getSharedState("selectedSprite");return n&&(o=n.getIdentifier()),e.map(function(e){var n=a.StickerManager.getURLForSticker(e,"thumb"),r=t._getAssetPath(n),i={background:"url('"+r+"') no-repeat center center",backgroundSize:"contain"};return a.React.createElement(l,{selected:e.identifier===o,key:e.identifier,onClick:t._onStickerClick.bind(t,e),className:void 0,threeColumns:!0},a.React.createElement(u,{style:i}))})},e.prototype.render=function(){return a.React.createElement(p,null,this._renderListItems())},e}(a.SharedStateComponent);c.contextTypes=a.SharedStateComponent.contextTypes,e.a=c;var p=a.adonis.ul("18qztam","StickerList"),l=Object(a.adonis)(s).li("m4lnou","StickerListItem"),u=a.adonis.div("7r0ke8","StickerImage")},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=o(1),s=(o.n(a),o(0)),c=o.n(s),p=o(49),l=o(54),u=void 0,h=void 0;a.Operations.SpriteOperation&&(u=a.Operations.SpriteOperation.StickerSprite,h=a.Operations.SpriteOperation.BrushSprite);var f=function(t){function e(){return n(this,e),r(this,t.apply(this,arguments))}return i(e,t),e.prototype._onEnter=function(){var t=this.context.editor,e=t.operations.getOrCreate("sprite");t.zoom.auto(),t.features.disable("zoom","drag"),this.sharedState.set({operation:e})},e.prototype._onLeave=function(){var t=this.context.editor;t.features.enable("zoom","drag"),t.render()},e.clickAtPosition=function(t,e){if(!e.operations.exists("sprite"))return!1;var o=e.operations.getOrCreate("sprite"),n=o.getSpritesAtPosition(t,e.getOutputTextureDimensions()).filter(function(t){return!(t instanceof h)});return!!(n.length&&n[0]instanceof u)&&{selectedSprite:n[0]}},e.getPreloadAssets=function(t){return["editor/controls/shared/canvas-overlay-controls/to-front.png","editor/controls/shared/canvas-overlay-controls/duplicate.png","editor/controls/shared/canvas-overlay-controls/delete.png"]},e.isEnabled=function(t){return t.isToolAllowed("sticker")&&t.isToolEnabled("sticker")},e}(s.BaseControls);f.identifier="sticker",f.controlsComponent=p.a,f.canvasControlsComponent=l.a,f.iconPath="editor/controls/sticker/icon.png",f.activeIconPath="editor/controls/sticker/icon-active.png",f.requiredOperations=["sprite"],f.defaultOptions={categories:[],replaceCategories:!1,availableStickers:null,snapRotation:90,snapRotationTolerance:5},e.default=f,c.a.Controls.StickerControls=f},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=o(1),s=(o.n(a),o(0)),c=(o.n(s),o(50)),p=o(52),l=o(53),u=a.Math.Vector2,h={ROOT:1,CATEGORY:2,OPTIONS:3},f=function(t){function e(){n(this,e);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r(this,t.call.apply(t,[this].concat(i)));s._bindAll("_onCategoryClick","_onStickerClick","_onBackClick","_onNewStickerClick","_onReplaceClick"),s._initStickerManager(),s._needsStyleFixes=!0;var c=h.ROOT;return s.getSharedState("selectedSprite")&&(c=h.OPTIONS),s.state.currentPanel=c,s}return i(e,t),e.prototype.fixStyles=function(){var e=this;return this._list.style.height="100%",t.prototype.fixStyles.call(this).then(function(){if(s.Utils.Browser.isIElte(10)){var t=e._container.offsetHeight;e._list.style.height=t+"px"}return e.refs.panel.fixStyles()})},e.prototype.sharedStateDidChange=function(t,e){t.selectedSprite!==e.selectedSprite&&e.selectedSprite&&this.setState({currentPanel:h.OPTIONS})},e.prototype.componentDidUpdate=function(t,e){this.state.currentPanel!==e.currentPanel&&this.fixStyles()},e.prototype._initStickerManager=function(){var t=this.props.options,e=t.categories,o=t.replaceCategories,n=t.availableStickers;this._stickerManager=new s.StickerManager(this.context.ui,{categories:e,replaceCategories:o,availableStickers:n})},e.prototype._loadStickerImage=function(t){var e=this;return new Promise(function(o,n){var r=t.images.mediaBase,i=s.StickerManager.getURLForSticker(t,"base"),a=e._getAssetPath(i),c=new window.Image,p=void 0,l=setTimeout(function(){p=s.ModalManager.instance.displayLoading(e._t("loading.loading"))},100);c.addEventListener("load",function(){p&&p.close(),l&&(clearTimeout(l),l=null),void 0!==r.width&&void 0!==r.height&&(c.width=r.width,c.height=r.height),o(c)}),c.addEventListener("error",function(){p&&p.close(),l&&(clearTimeout(l),l=null),s.ModalManager.instance.displayError(e._t("errors.title"),e._t("errors.stickerLoadingError.text",{path:c.src})),n(new Error("Loading sticker failed"))}),c.crossOrigin="Anonymous",c.src=a})},e.prototype._createSticker=function(t){var e=this;return this._loadStickerImage(t).then(function(o){var n=e.context.editor,r=e.getSharedState("operation"),i=r.getInputDimensions(!1),s=new u(o.width,o.height),c=new u(.5*i.min(),.5*i.min()),p=r.createSticker({identifier:t.identifier,image:o,position:new u(.5,.5),dimensions:a.Utils.resizeVectorToFit(s,c),rotation:0,smoothDownscaling:e.props.options.smoothDownscaling});return r.addSprite(p),e.props.controls.addLocalHistorySnapshot("sticker-creation",!0),n.render(function(){e.setSharedState({selectedSprite:p})}),p})},e.prototype._onReplaceClick=function(){this.setState({currentPanel:h.ROOT})},e.prototype._onNewStickerClick=function(){this.state.currentPanel=h.ROOT,this.setSharedState({selectedSprite:null})},e.prototype._onCategoryClick=function(t){this.setState({currentPanel:h.CATEGORY,category:t})},e.prototype._onBackClick=function(){this.setState({currentPanel:h.ROOT})},e.prototype._onStickerClick=function(t){var e=this,o=this.getSharedState("selectedSprite"),n=function(){e.setState({currentPanel:h.OPTIONS})},r=this.context.editor;o?this._loadStickerImage(t).then(function(i){var s=o.getDimensions().clone(),c=s.max(),p=new u(c,c),l=new u(i.width,i.height),h={image:i,identifier:t.identifier,dimensions:a.Utils.resizeVectorToFit(l,p)};"none"!==o.getTintMode()&&o.setTintMode(t.tintMode||"none"),o.set(h),o.setImage(i),e.props.controls.addLocalHistorySnapshot("sticker-image",!0),r.render(),n()}):this._createSticker(t).then(function(t){e.setSharedState({selectedSprite:t}),n()})},e.prototype._renderCurrentPanel=function(){var t=this,e=this.props.controls;switch(this.state.currentPanel){case h.ROOT:return s.React.createElement(c.a,{innerRef:function(e){t._list=e},stickerManager:this._stickerManager,onCategoryClick:this._onCategoryClick,onStickerClick:this._onStickerClick,controls:e,ref:"panel"});case h.CATEGORY:return s.React.createElement(p.a,{innerRef:function(e){t._list=e},category:this.state.category,stickerManager:this._stickerManager,onBackClick:this._onBackClick,onStickerClick:this._onStickerClick,controls:e,ref:"panel"});case h.OPTIONS:return s.React.createElement(l.a,{innerRef:function(e){t._list=e},stickerManager:this._stickerManager,onReplaceClick:this._onReplaceClick,onNewStickerClick:this._onNewStickerClick,controls:e,ref:"panel"})}},e.prototype._getRootProps=function(){return{className:void 0,withBorderTop:!0}},e.prototype._renderContent=function(){return this._renderCurrentPanel()},e}(s.ControlsComponent);f.contextTypes=s.ControlsComponent.contextTypes,f.RootElement=s.ControlsComponent.RootElement,e.a=f},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=o(0),s=(o.n(a),o(51)),c=o(12),p=function(t){function e(){n(this,e);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r(this,t.call.apply(t,[this].concat(i)));return s.state={category:"all"},s}return i(e,t),e.prototype._onCategoryClick=function(t,e){this.props.onCategoryClick&&this.props.onCategoryClick(t)},e.prototype.fixStyles=function(){var t=this;return Promise.resolve().then(function(){a.Utils.Browser.isIElte(10)?Object(a.requestAnimationFrame)(function(){t._scrollbar.update()}):t._scrollbar.update()})},e.prototype._renderListItems=function(){var t=this;return this.props.stickerManager.getCategories().map(function(e){return a.React.createElement(s.a,{key:e.identifier,category:e,onClick:t._onCategoryClick.bind(t,e)})})},e.prototype.render=function(){var t=this,e=this.props,o=e.stickerManager,n=e.innerRef;return a.React.createElement(l,{innerRef:function(e){n&&n(e),t._wrapper=e},className:void 0},a.React.createElement(a.ScrollableListComponent,{direction:"vertical",innerRef:function(e){t._scrollbar=e}},a.React.createElement(u,null,this._renderListItems()),a.React.createElement(c.a,{stickers:o.getStickersForCategory("all"),onStickerClick:this.props.onStickerClick})))},e}(a.BaseComponent);p.contextTypes=a.BaseComponent.contextTypes,e.a=p;var l=a.adonis.div("rfecls","Wrapper"),u=a.adonis.ul("5jg0ou","CategoryList")},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=o(0),s=(o.n(a),a.ControlsStyles.ControlItem),c=a.ControlsStyles.ControlItemTitle,p=function(t){function e(){return n(this,e),r(this,t.apply(this,arguments))}return i(e,t),e.prototype.render=function(){var t=this.props.category,e=this._getAssetPath(t.metaData.backgroundImage),o={backgroundImage:"url('"+e+"')"};return a.React.createElement(l,{onClick:this.props.onClick,style:o,className:void 0},a.React.createElement(h,null,this._t("editor.controls.sticker.stickerCategories."+t.identifier)||t.defaultName),a.React.createElement(u,null))},e}(a.BaseComponent);p.contextTypes=a.BaseComponent.contextTypes,e.a=p;var l=Object(a.adonis)(s).li("1dc04zg","StickerCategoryItem"),u=a.adonis.div("1fxaw8w","Gradient"),h=Object(a.adonis)(c).div("120drhm","Title")},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=o(0),s=(o.n(a),o(12)),c=a.ControlsStyles.ControlItemTextStyles,p=function(t){function e(){return n(this,e),r(this,t.apply(this,arguments))}return i(e,t),e.prototype.fixStyles=function(){var t=this;return Promise.resolve().then(function(){a.Utils.Browser.isIElte(10)?Object(a.requestAnimationFrame)(function(){t._scrollbar.update()}):t._scrollbar.update()})},e.prototype.render=function(){var t=this,e=this.props,o=e.stickerManager,n=e.category,r=e.onBackClick,i=e.onStickerClick,c=e.innerRef,p=this._getAssetPath(n.metaData.backgroundImage),m={backgroundImage:"url('"+p+"')",backgroundSize:"cover"},_={backgroundImage:"url('"+this._getAssetPath("editor/controls/shared/back.png",!0)+"')"},S=o.getStickersForCategory(n.identifier);return a.React.createElement(l,{innerRef:function(t){return c&&c(t)},className:void 0},a.React.createElement(u,{style:m},a.React.createElement(h,null,a.React.createElement(d,null,this._t("editor.controls.sticker.stickerCategories."+n.identifier)||n.defaultName),n.metaData.author&&a.React.createElement(g,null,a.React.createElement("span",null,"by "),n.metaData.author),a.React.createElement(y,{style:_,onClick:r.bind(this),className:void 0}))),a.React.createElement(f,{innerRef:function(e){t._wrapper=e}},a.React.createElement(a.ScrollableListComponent,{direction:"vertical",innerRef:function(e){t._scrollbar=e}},a.React.createElement(s.a,{stickers:S,onStickerClick:i}))))},e}(a.BaseComponent);p.contextTypes=a.BaseComponent.contextTypes,e.a=p;var l=a.adonis.div("iauaz2","StickerCategoryPanel"),u=a.adonis.div("2j8ygm","Header"),h=a.adonis.div("3wd3qf","HeaderContent"),f=a.adonis.div("zb78lb","Content"),d=Object(a.adonis)(c).div("kswtk0","Title"),g=Object(a.adonis)(c).div("1qn5s6u","Subtitle"),y=a.adonis.button("1t2nim8","BackButton")},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=o(0),s=(o.n(a),a.ControlsStyles.PlainControlItemBackground),c=function(t){function e(){n(this,e);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r(this,t.call.apply(t,[this].concat(i)));return s._bindAll("_onTintToggle","_onTintColorChange","_onOpacityChange"),s}return i(e,t),e.prototype._getStickerObject=function(){var t=this.props.stickerManager,e=this.getSharedState("selectedSprite"),o=e.getIdentifier();return t.getStickerByIdentifier(o)},e.prototype._onOpacityChange=function(t){this.getSharedState("selectedSprite").setAlpha(t/100),this.props.controls.addLocalHistorySnapshot("sticker-opacity",!0),this.context.editor.render(),this.forceUpdate()},e.prototype._onTintToggle=function(t){var e=this.getSharedState("selectedSprite"),o=this._getStickerObject();e.setTintMode(t?o.tintMode:"none"),this.props.controls.addLocalHistorySnapshot("sticker-tint-toggle",!0),this.context.editor.render(),this.forceUpdate()},e.prototype._onTintColorChange=function(t){this.getSharedState("selectedSprite").setTintColor(t.clone()),this.props.controls.addLocalHistorySnapshot("sticker-tint",!0),this.context.editor.render(),this.forceUpdate()},e.prototype.fixStyles=function(){var t=this;return Promise.resolve().then(function(){a.Utils.Browser.isIElte(10)?Object(a.requestAnimationFrame)(function(){t._scrollbar.update()}):t._scrollbar.update()})},e.prototype.render=function(){var t=this,e=this.props,o=e.innerRef,n=e.onNewStickerClick,r=e.onReplaceClick,i=this.getSharedState("selectedSprite");if(!i)return null;var s=this._getStickerObject(),c={background:"url('"+i.getImage().src+"') center center / contain no-repeat"},_=!!s.tintMode&&"none"!==s.tintMode;return a.React.createElement(p,{innerRef:function(e){o&&o(e),t._wrapper=e},className:void 0},a.React.createElement(a.ScrollableListComponent,{direction:"vertical",innerRef:function(e){t._scrollbar=e}},a.React.createElement("div",null,a.React.createElement(l,null,a.React.createElement(a.ButtonComponent,{title:this._t("editor.controls.sticker.new"),className:void 0,onClick:n}),a.React.createElement(u,null,a.React.createElement(h,null,a.React.createElement(f,{onClick:r,style:c})),a.React.createElement(d,null,a.React.createElement(g,null,this._t("editor.controls.sticker.stickers."+s.identifier)||s.defaultName),a.React.createElement(y,{onClick:r,className:void 0},this._t("editor.controls.sticker.replace")))),a.React.createElement(a.SliderControlComponent,{minValue:0,value:Math.round(100*i.getAlpha()),maxValue:100,label:this._t("editor.controls.sticker.opacity"),onSliderValueChange:this._onOpacityChange,onValueChange:this._onOpacityChange,middleDot:!1,className:void 0})),_&&a.React.createElement(a.CollapseSectionComponent,{toggleable:!0,title:this._t("editor.controls.sticker.fill"),expanded:"none"!==i.getTintMode(),className:void 0,onToggle:this._onTintToggle},a.React.createElement(m,{value:i.getTintColor(),onColorPickerToggle:this.fixStyles,onChange:this._onTintColorChange})))))},e}(a.SharedStateComponent);c.contextTypes=a.SharedStateComponent.contextTypes,e.a=c;var p=a.adonis.div("rfecls","Wrapper"),l=a.adonis.div("1vnvjau","TopSection"),u=a.adonis.div("aqfteq","Details"),h=Object(a.adonis)(s).div("6u8g0p","Thumbnail"),f=a.adonis.div("7r0ke8","ThumbnailImage"),d=a.adonis.div("1trlo6v","DetailsContainer"),g=a.adonis.div("w9mc0y","Title"),y=a.adonis.div("1rhky7p","ReplaceButton"),m=Object(a.adonis)(a.ColorSelectionComponent)("1ouwzwk","ColorSelection")},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=o(1),s=(o.n(a),o(6)),c=a.Operations.SpriteOperation,p=void 0;c&&(p=a.Operations.SpriteOperation.StickerSprite);var l=function(t){function e(){return n(this,e),r(this,t.apply(this,arguments))}return i(e,t),e.prototype._renderSpriteItems=function(e){return t.prototype._renderSpriteItems.call(this,e.filter(function(t){return t instanceof p}))},e.prototype._selectNextSprite=function(){for(var t=this.getSharedState("operation"),e=t.getSprites().slice(0).reverse(),o=void 0,n=void 0,r=0;r<e.length;r++)if((o=e[r])instanceof p){n=o;break}n||(this.props.controls.skipHistory=!0,this.context.screen.switchToControls("default")),this.setSharedState({selectedSprite:n})},e.prototype._createSprite=function(t){return this.getSharedState("operation").createSticker(t)},e}(s.a);l.contextTypes=s.a.contextTypes,e.a=l}]).default});