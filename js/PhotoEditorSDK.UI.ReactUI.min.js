!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("photoeditorsdk/js/PhotoEditorSDK"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["photoeditorsdk","react","react-dom"],t):"object"==typeof exports?exports.PhotoEditorReactUI=t(require("photoeditorsdk/js/PhotoEditorSDK"),require("react"),require("react-dom")):e.PhotoEditorReactUI=t(e.PhotoEditorSDK,e.React,e.ReactDOM)}("undefined"!=typeof self?self:this,function(e,t,n){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=56)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SharedConstants=t.PropTypes=t.ImageLoader=t.ImageFormat=t.ColorMatrix=t.now=t.Log=t.cancelAnimationFrame=t.requestAnimationFrame=t.SDK=t.EXIF=t.ReactDOM=t.UniformType=t.OptionType=t.RenderType=t.Base64=t.Color=t.SharedState=t.Constants=t.EventEmitter=t.SDKUtils=t.Vector2=t.ReactBEM=t.BaseComponent=t.Classnames=t.BEM=t.React=t.Utils=t.Promise=void 0;var r=n(7),o=i(r),a=n(15),s=i(a),l=n(59),c=i(l),u=n(32),f=i(u),p=n(34),h=i(p),d=n(35),_=i(d),m=n(36),y=i(m),g=n(64),v=i(g),b=n(65),k=i(b),w=n(77),O=i(w),E=n(78),S=i(E),P=n(79),C=n(19),M=i(C),j=n(22),R=i(j),x=n(37),B=i(x),T=o.default.Base64,D=o.default.Color,F=o.default.Math.ColorMatrix,I=o.default.EventEmitter,A=o.default.EXIF,z=o.default.OptionType,N=o.default.Promise,L=o.default.Utils,V=o.default.RenderType,U=o.default.ImageFormat,W=o.default,K=o.default.UniformType,H=o.default.Math.Vector2,$="undefined"!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):n(38);t.Promise=N,t.Utils=k.default,t.React=s.default,t.BEM=_.default,t.Classnames=h.default,t.BaseComponent=v.default,t.ReactBEM=y.default,t.Vector2=H,t.SDKUtils=L,t.EventEmitter=I,t.Constants=O.default,t.SharedState=S.default,t.Color=D,t.Base64=T,t.RenderType=V,t.OptionType=z,t.UniformType=K,t.ReactDOM=c.default,t.EXIF=A,t.SDK=W,t.requestAnimationFrame=P.requestAnimationFrame,t.cancelAnimationFrame=P.cancelAnimationFrame,t.Log=M.default,t.now=$,t.ColorMatrix=F,t.ImageFormat=U,t.ImageLoader=R.default,t.PropTypes=f.default,t.SharedConstants=B.default},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(e,n,o){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i(this,t);var s=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s.type=e,s.title=n,s.text=o,s.overlay=a,s.data=null,s}return o(t,e),a(t,[{key:"setData",value:function(e){this.data=e,this.emit("update")}},{key:"close",value:function(){this.emit("close")}}]),t}(s.EventEmitter),c=function(e){function t(){i(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._modals=[],e}return o(t,e),a(t,[{key:"displayLoading",value:function(e){var t=new l("loading",null,e);return this.addModal(t),t}},{key:"displayProgress",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new l("progress",null,e);return n.setData({progress:t}),this.addModal(n),n}},{key:"displayWarning",value:function(e,t){var n=new l("warning",e,t);return this.addModal(n),n}},{key:"displayError",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=new l("error",e,t,n);return this.addModal(i),i}},{key:"addModal",value:function(e){var t=this;this._modals.push(e),e.on("close",function(){t.removeModal(e)}),e.on("update",function(){t.emit("update")}),this.emit("update")}},{key:"removeModal",value:function(e){var t=this._modals.indexOf(e);this._modals.splice(t,1),this.emit("update")}},{key:"getModals",value:function(){return this._modals}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}(s.EventEmitter);t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=n(5),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){i(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.constructor.NATIVE_SCROLLBAR_WIDTH||(e.constructor.NATIVE_SCROLLBAR_WIDTH=l.Utils.getScrollbarWidth()),e._needsStyleFixes=!0,e._isDragging=!1,e._bindAll("_onButtonDragStart","_onButtonDrag","_onButtonDragStop","_onBarDragStart","_onBarDrag","_onBarDragStop","_onListScroll"),e.state={buttonSize:0,buttonPosition:0,buttonVisible:!1},e}return o(t,e),a(t,[{key:"componentDidMount",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this.update()}},{key:"fixStyles",value:function(){l.Utils.isMobile()||this._updateListSize()}},{key:"_onListScroll",value:function(){if(!this._isDragging){var e=this._getDirection(),n=void 0,i=void 0,r=void 0;e===t.HORIZONTAL?(n=this._list.scrollWidth-this._list.offsetWidth,i=this._list.scrollLeft,r=this._node.offsetWidth-this.state.buttonSize):e===t.VERTICAL&&(n=this._list.scrollHeight-this._list.offsetHeight,i=this._list.scrollTop,r=this._node.offsetHeight-this.state.buttonSize);var o=i/n;this.setState({buttonPosition:r*o})}}},{key:"_onButtonDragStart",value:function(e){this._isDragging=!0,this._initialButtonPosition=this.state.buttonPosition||0}},{key:"_onButtonDrag",value:function(e){var n=this._getDirection(),i=void 0;n===t.HORIZONTAL?i=this._initialButtonPosition+e.x:n===t.VERTICAL&&(i=this._initialButtonPosition+e.y),this._setButtonPosition(i)}},{key:"_onButtonDragStop",value:function(){this._isDragging=!1}},{key:"_onBarDragStart",value:function(e){var n=l.Utils.getEventPosition(e);this._initialPosition=n.clone();var i=this._node.getBoundingClientRect(),r=new l.Vector2(i.left,i.top),o=n.clone().subtract(r),a=this._getDirection();a===t.HORIZONTAL?this._setButtonPosition(o.x-this.state.buttonSize/2):a===t.VERTICAL&&this._setButtonPosition(o.y-this.state.buttonSize/2),document.addEventListener("mousemove",this._onBarDrag),document.addEventListener("touchmove",this._onBarDrag),document.addEventListener("mouseup",this._onBarDragStop),document.addEventListener("touchend",this._onBarDragStop)}},{key:"_onBarDrag",value:function(e){var n=l.Utils.getEventPosition(e),i=this._node.getBoundingClientRect(),r=new l.Vector2(i.left,i.top),o=n.clone().subtract(r),a=this._getDirection();a===t.HORIZONTAL?this._setButtonPosition(o.x-this.state.buttonSize/2):a===t.VERTICAL&&this._setButtonPosition(o.y-this.state.buttonSize/2)}},{key:"_onBarDragStop",value:function(){document.removeEventListener("mousemove",this._onBarDrag),document.removeEventListener("touchmove",this._onBarDrag),document.removeEventListener("mouseup",this._onBarDragStop),document.removeEventListener("touchend",this._onBarDragStop)}},{key:"_setButtonPosition",value:function(e){var n=this._getDirection(),i=void 0,r=void 0;n===t.HORIZONTAL?(i=this._node.offsetWidth-this.state.buttonSize,r=this._list.scrollWidth-this._list.offsetWidth):n===t.VERTICAL&&(i=this._node.offsetHeight-this.state.buttonSize,r=this._list.scrollHeight-this._list.offsetHeight),e=Math.max(0,e),e=Math.min(e,i),this.setState({buttonPosition:e});var o=e/i,a=r*o;n===t.HORIZONTAL?this._list.scrollLeft=a:n===t.VERTICAL&&(this._list.scrollTop=a)}},{key:"_updateButtonSize",value:function(e){var n=0,i=!1,r=void 0,o=void 0,a=this._getDirection();a===t.HORIZONTAL?(r=this._list.clientWidth,o=this._list.scrollWidth):a===t.VERTICAL&&(r=this._list.offsetHeight,o=this._list.scrollHeight),n=r/o*r,i=o>r,this.setState({buttonSize:n,buttonVisible:i},e)}},{key:"_updateListSize",value:function(){if(this._list){var e=this._getDirection();if(e===t.HORIZONTAL){this._list.style.height="";var n=this._getFullListDimensions();this._listSize=n.y,this._listContentSize=this._list.offsetHeight}else if(e===t.VERTICAL){this._list.style.width="";var i=this._getFullListDimensions();this._listSize=i.x,this._listContentSize=this._list.offsetWidth}}}},{key:"_getFullListDimensions",value:function(){var e=this._list.getBoundingClientRect();return new l.Vector2(e.width,e.height)}},{key:"update",value:function(){var e=this;if(!l.Utils.isMobile()){var n=this.refs,i=n.root,r=n.list;this._node=i,this._list=r;var o=this._getDirection();this._updateButtonSize(function(){e._listSize||e._updateListSize();var n=e._listSize;e.state.buttonVisible&&(n+=e.constructor.NATIVE_SCROLLBAR_WIDTH),o===t.HORIZONTAL?(e._list.style.height=n+"px",e._node.style.top=e._listContentSize-12+"px",e._node.style.width=e._list.offsetWidth+"px"):o===t.VERTICAL&&(e._list.style.width=n+"px",e._node.style.left=e._listContentSize-12+"px",e._node.style.height=e._list.offsetHeight+"px")}),this._list.addEventListener("scroll",this._onListScroll)}}},{key:"_getDirection",value:function(){return this.props.direction||"horizontal"}},{key:"_getButtonStyle",value:function(){return"horizontal"===this._getDirection()?{left:this.state.buttonPosition,width:this.state.buttonSize}:{top:this.state.buttonPosition,height:this.state.buttonSize}}},{key:"getList",value:function(){return this.refs.list}},{key:"getRoot",value:function(){return this.refs.root}},{key:"renderWithBEM",value:function(){if(l.Utils.isMobile())return this.props.children;var e=this._getButtonStyle(),t={display:this.state.buttonVisible?"block":"none"},n=l.React.cloneElement(this.props.children,{ref:"list"});return l.ReactBEM.createElement("div",null,n,l.ReactBEM.createElement("div",{bem:"$b:scrollbar m:"+(this.props.direction||"horizontal")+" m:"+(this.state.buttonVisible?"visible":"invisible"),ref:"root",style:t,onMouseDown:this._onBarDragStart,onTouchStart:this._onBarDragStart},l.ReactBEM.createElement(u.default,{onStart:this._onButtonDragStart,onDrag:this._onButtonDrag,onStop:this._onButtonDragStop},l.ReactBEM.createElement("div",{bem:"e:bar",style:e,onMouseDown:this._onButtonDown}))))}}]),t}(l.BaseComponent);t.default=f,f.HORIZONTAL="horizontal",f.VERTICAL="vertical",f.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(104),u=i(c),f=n(105),p=i(f),h=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._hasBackButton=!0,s._hasDoneButton=!1,s._backButtonClicked=!1,s._bindAll("_onBackClick","_onDoneClick"),s}return a(t,e),s(t,[{key:"_onBackClick",value:function(e){this._backButtonClicked=!0,this.props.onSwitchControls("back")}},{key:"_onDoneClick",value:function(e){this._onBackClick()}},{key:"renderControls",value:function(){return null}},{key:"renderOverlayControls",value:function(){return null}},{key:"renderWithBEM",value:function(){var e=this.props.options&&this.props.options.forcedControl,t=this._hasBackButton&&!e?l.ReactBEM.createElement(u.default,{onClick:this._onBackClick}):null,n=this._hasDoneButton||e?l.ReactBEM.createElement(p.default,{onClick:this._onDoneClick}):null;return l.ReactBEM.createElement("div",{bem:"$b:controls",ref:"root"},this.renderOverlayControls(),l.ReactBEM.createElement("div",{bem:"e:table"},t,this.renderControls(),n))}}]),t}(l.BaseComponent);t.default=h,h.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){i(this,e)}return r(e,[{key:"getInitialSharedState",value:function(){return{}}},{key:"isAvailable",value:function(e){return!1}}],[{key:"getPreloadAssets",value:function(){return[]}}]),e}();o.topBarControlsComponent=null,o.controlsComponent=null,o.canvasControlsComponent=null,o.identifier=null,o.iconPath=null,o.languageKey=null,o.defaultOptions={},t.default=o},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onDragStart","_onDragMove","_onDragEnd"),s}return o(t,e),a(t,[{key:"_onDragStart",value:function(e){if(!this.props.disabled){e.preventDefault(),e.stopPropagation(),this._initialMousePosition=s.Utils.getEventPosition(e),document.addEventListener("mousemove",this._onDragMove),document.addEventListener("touchmove",this._onDragMove),document.addEventListener("mouseup",this._onDragEnd),document.addEventListener("touchend",this._onDragEnd);var t=this.refs.element,n=t.getBoundingClientRect(),i=new s.Vector2(n.left,n.top),r=this._initialMousePosition.clone().subtract(i);this.props.onStart&&this.props.onStart(r,e)}}},{key:"_onDragMove",value:function(e){e.preventDefault(),e.stopPropagation();var t=s.Utils.getEventPosition(e);if(t){var n=t.clone().subtract(this._initialMousePosition);this.props.onDrag&&this.props.onDrag(n,e)}}},{key:"_onDragEnd",value:function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this._onDragMove(e),document.removeEventListener("mousemove",this._onDragMove),document.removeEventListener("touchmove",this._onDragMove),document.removeEventListener("mouseup",this._onDragEnd),document.removeEventListener("touchend",this._onDragEnd),this.props.onStop&&this.props.onStop(e)}},{key:"render",value:function(){if(!this.props.children||this.props.children instanceof Array)throw new Error("DraggableComponent expects exactly one child.");return s.React.cloneElement(this.props.children,{onMouseDown:this._onDragStart,onTouchStart:this._onDragStart,ref:"element"})}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(13),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onSliderValueChange"),s.state={value:s.props.value},s}return o(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){e.value!==this.state.value&&(this.state.value=e.value)}},{key:"_onSliderValueChange",value:function(e){this.props.onChange&&this.props.onChange(e),this.setState({value:e})}},{key:"_renderSlider",value:function(){var e=s.SDKUtils.defaults(this.props,{style:"",middleDot:!1,minValue:1,maxValue:100,label:"Label",onChange:this._onSliderValueChange,value:this.state.value});return s.ReactBEM.createElement(c.default,e)}},{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("div",{bem:"$b:controls e:overlay m:slider m:dark"},this._renderSlider())}}]),t}(s.BaseComponent);t.default=u,u.contextTypes=s.BaseComponent.contextTypes},function(t,n){t.exports=e},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(82),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"_renderHeader",value:function(){return this.context.options.showHeader?s.ReactBEM.createElement(c.default,null):null}},{key:"_renderScreen",value:function(){return s.ReactBEM.createElement("div",null)}},{key:"renderWithBEM",value:function(){var e="b:screen";return this.context.options.showHeader||(e+=" m:noHeader"),s.ReactBEM.createElement("div",{bem:e,className:this.props.visible?null:"is-hidden"},this._renderHeader(),this._renderScreen())}}]),t}(s.BaseComponent);t.default=u,u.propTypes={editor:s.PropTypes.any},u.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onCanvasZoomDone"),s}return o(t,e),a(t,[{key:"_performHitTest",value:function(e){var t=this.refs.container,n=t.getBoundingClientRect(),i=new l.Vector2(n.left,n.top),r=e.subtract(i),o=this.context.editor,a=o.controls.getAvailable();for(var s in a){var c=a[s],u=c.clickAtPosition&&c.clickAtPosition(r,o);if(u)return u.selectedSprite===this.getSharedState("selectedSprite")||(this.props.onSwitchControls(c,u),!0)}return!1}},{key:"_onCanvasZoomDone",value:function(){this.forceUpdate()}},{key:"_bindEvents",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_bindEvents",this).call(this),this.context.mediator.on(l.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone)}},{key:"_unbindEvents",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_unbindEvents",this).call(this),this.context.mediator.off(l.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone)}}]),t}(l.BaseComponent);t.default=c,c.contextTypes=l.BaseComponent.contextTypes},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(0),s=n(37),l=i(s),c=n(21),u=i(c),f=function(){function e(t,n){r(this,e),this._ui=t,this._options=n,this._categoriesById={},this._categories=[],this._stickersById={},this._addCategories(l.default.DEFAULTS.STICKER_CATEGORIES);var i=this._options,o=i.categories,a=i.replaceCategories;this._options.categories?this._addCategories(o,a):(this._updateCategoriesMap(),this._updateAllCategory())}return o(e,[{key:"loadExternal",value:function(e){var t=this;return new u.default(e).load().then(function(e){t._addCategories(e.categories,t._options.replaceCategories)})}},{key:"_addCategories",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._categories=t?e.slice(0):a.Utils.mergeCategories(this._categories,e,"stickers"),this._updateCategoriesMap(),this._updateAllCategory()}},{key:"_updateCategoriesMap",value:function(){var e=this;this._categoriesById={},this._categories.forEach(function(t){e._categoriesById[t.identifier]=t}),this._categories.forEach(function(t){t.stickers.forEach(function(t){e._stickersById[t.identifier]=t})}),void 0!==this._options.availableStickers&&null!==this._options.availableStickers&&(this._categories.forEach(function(t){t.stickers=t.stickers.filter(function(t){return-1!==e._options.availableStickers.indexOf(t.identifier)})}),this._categories=this._categories.filter(function(e){return e.stickers.length>0})),this._updateAllCategory()}},{key:"_updateAllCategory",value:function(){this._allCategory={identifier:"all",defaultName:"All",stickers:this._categories.map(function(e){return e.stickers}).reduce(function(e,t){return e.concat(t)},[])},this._categoriesById.all=this._allCategory}},{key:"getStickersForCategory",value:function(e){if(!this._categoriesById[e])throw new Error("Unknown sticker category '"+e+"'");return this._categoriesById[e].stickers}},{key:"getStickerByIdentifier",value:function(e){return this._stickersById[e]}},{key:"getCategories",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?[this._allCategory].concat(this._categories):this._categories}},{key:"getCategory",value:function(e){return this._categoriesById[e]}}],[{key:"getURLForSticker",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"base",n=e.images,i="base"===t?n.mediaBase||n.mediaThumb:n.mediaThumb,r=i.uris||[i.uri];if(void 0===a.Utils.Browser||a.Utils.Browser.getIEVersion()){var o=r.filter(function(e){return!/\.svg$/i.test(e)});return o.length?o[0]:r[0]}var s=r.filter(function(e){return/\.svg$/i.test(e)});return s.length?s[0]:r[0]}}]),e}();t.default=f},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"renderContent",value:function(){return this.props.children}},{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("div",{bem:"$b:topBar e:row"},s.ReactBEM.createElement("div",{bem:"e:cell"},this.renderContent()))}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(5),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onKnobDragStart","_onKnobDrag","_onKnobDragStop","_onBarDragStart","_onBarDrag","_onBarDragStop","_onMiddleDotClick"),s.state={value:s.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0},s}return o(t,e),s(t,[{key:"componentDidMount",value:function(){this._setValue(this.state.value,!1)}},{key:"componentWillReceiveProps",value:function(e){e.value!==this.state.value&&this._setValue(e.value,!1)}},{key:"_onMiddleDotClick",value:function(){this._previousValue=this.state.value;var e=this.props.minValue+(this.props.maxValue-this.props.minValue)/2;this._setValue(e,!0,!0)}},{key:"_onKnobDragStart",value:function(e){this._previousValue=this.state.value,this._initialSliderPosition=this.state.sliderPosition,this._initialPosition=e}},{key:"_onKnobDrag",value:function(e){var t=this.refs.bar,n=t.offsetWidth,i=this._initialSliderPosition+e.x;i=Math.max(0,Math.min(i,n));var r=i/n,o=this.props.minValue+(this.props.maxValue-this.props.minValue)*r;this._setValue(o)}},{key:"_onKnobDragStop",value:function(){this._setValue(this.state.value,!0,!0)}},{key:"_onBarDragStart",value:function(e){this._previousValue=this.state.value,this._initialPosition=e.clone();var t=this.refs.bar,n=t.offsetWidth,i=e.x/n,r=this.props.minValue+(this.props.maxValue-this.props.minValue)*i;this._setValue(r)}},{key:"_onBarDrag",value:function(e){var t=this._initialPosition.clone().add(e),n=this.refs.bar,i=n.offsetWidth,r=t.x/i,o=this.props.minValue+(this.props.maxValue-this.props.minValue)*r;o=Math.max(this.props.minValue,Math.min(this.props.maxValue,o)),this._setValue(o)}},{key:"_onBarDragStop",value:function(){this._setValue(this.state.value,!0,!0)}},{key:"_getKnobStyle",value:function(){return{left:this.state.sliderPosition}}},{key:"_getForegroundStyle",value:function(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth}}},{key:"_displayMiddleDot",value:function(){return!1!==this.props.middleDot}},{key:"_setValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=Math.round(e);var i=this.props,r=i.minValue,o=i.maxValue,a=(e-r)/(o-r),s=this.refs.bar,l=s.offsetWidth,c=l*a,u=a*l,f=0;this._displayMiddleDot()&&(u=Math.abs(a-.5)*l,f=a<.5?.5*l-u:"50%"),this.setState({value:e,sliderPosition:c,foregroundWidth:u,foregroundLeft:f}),t&&this.props.onChange&&this.props.onChange(e,this._previousValue,n)}},{key:"_buildValue",value:function(e){return e%1!=0&&(e=e.toFixed(2)),this.props.positiveValuePrefix&&e>=0&&(e=""+this.props.positiveValuePrefix+e),this.props.valueUnit&&(e+=this.props.valueUnit),e}},{key:"renderWithBEM",value:function(){var e=null;this._displayMiddleDot()&&(e=l.ReactBEM.createElement("div",{bem:"e:middleDot",onClick:this._onMiddleDotClick}));var t={style:this._getForegroundStyle()},n="$b:slider"+(this.props.style?" m:"+this.props.style:"");return l.ReactBEM.createElement("div",{bem:n},l.ReactBEM.createElement("div",{bem:"$e:bar",ref:"bar"},l.ReactBEM.createElement(u.default,{onStart:this._onBarDragStart,onDrag:this._onBarDrag,onStop:this._onBarDragStop},l.ReactBEM.createElement("div",null,l.ReactBEM.createElement("div",{bem:"$e:background"}),l.ReactBEM.createElement("div",a({bem:"$e:foreground"},t)),l.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag,onStop:this._onKnobDragStop},l.ReactBEM.createElement("div",{bem:"e:knob b:knob m:slider",style:this._getKnobStyle()})))),e),l.ReactBEM.createElement("div",{bem:"$e:labels"},l.ReactBEM.createElement("div",{bem:"e:label m:lowerBoundary"},this._buildValue(this.props.minValue)),l.ReactBEM.createElement("div",{bem:"e:label m:value"},this.props.label," ",this._buildValue(this.state.value)),l.ReactBEM.createElement("div",{bem:"e:label m:upperBoundary"},this._buildValue(this.props.maxValue))))}}]),t}(l.BaseComponent);t.default=f,f.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(0),f=n(138),p=i(f),h=n(139),d=i(h),_=n(140),m=i(_),y=n(9),g=i(y),v=u.SDK.Operations.SpriteOperation,b=v.StickerSprite,k=v.TextSprite,w=v.BrushSprite,O=function(e){function t(){var e,n;o(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];var c=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s)));return c._bindAll("_onCanvasClick","_onSpriteDragStart","_onSpriteDragStop","_onOperationUpdated","_onOperationRemoved","_onSpriteFlip","_onSpriteTakeToFront","_onSpriteRemove"),c._canvasClickDisabled=!1,c._events=(n={},r(n,u.Constants.EVENTS.OPERATION_UPDATED,c._onOperationUpdated),r(n,u.Constants.EVENTS.OPERATION_REMOVED,c._onOperationRemoved),n),c}return s(t,e),c(t,[{key:"_onOperationRemoved",value:function(e){var t=this.getSharedState("selectedSprite");if(e===this.getSharedState("operation")&&t){var n=this.context.editor,i=n.operations.getOrCreate("sprite",{sprites:[t],enabled:!1});this.setSharedState({operation:i,operationExistedBefore:!1,initialOptions:{}})}}},{key:"_onOperationUpdated",value:function(e){var t=this.getSharedState("selectedSprite");if(e===this.getSharedState("operation")&&t){var n=e.getSprites();-1===n.indexOf(t)&&n.push(t),this.forceUpdate()}}},{key:"_onItemBlur",value:function(){}},{key:"_onCanvasClick",value:function(e){if(!this._canvasClickDisabled){this._performHitTest(u.Utils.getEventPosition(e))||(this.getSharedState("selectedSprite")&&this._onItemBlur(),this.props.onSwitchControls("home"))}}},{key:"_onSpriteFlip",value:function(e){var t=this.getSharedState("selectedSprite");switch(e){case"h":t.setFlipHorizontally(!t.getFlipHorizontally());break;case"v":t.setFlipVertically(!t.getFlipVertically())}this.context.editor.render()}},{key:"_onSpriteTakeToFront",value:function(e){this.getSharedState("operation").takeSpriteToFront(this.getSharedState("selectedSprite")),this.forceSharedUpdate(),this.context.editor.render()}},{key:"_onSpriteRemove",value:function(){var e=this.getSharedState("operation"),t=this.getSharedState("selectedSprite");e.removeSprite(t),t.dispose(),this.setSharedState({selectedSprite:null}),this.context.editor.render()}},{key:"_onSpriteDragStart",value:function(){this._canvasClickDisabled=!0}},{key:"_onSpriteDragStop",value:function(){var e=this;setTimeout(function(){e._canvasClickDisabled=!1},100)}},{key:"_getContainerStyle",value:function(){var e=this.context.editor,t=e.getCanvasDimensions(),n=e.getOutputDimensions(),i=t.clone().divide(2).subtract(n.clone().divide(2));return{left:i.x,top:i.y,width:n.x,height:n.y}}},{key:"_getContainerProps",value:function(){return{}}},{key:"_getInnerContainerProps",value:function(){return{style:this._getContainerStyle(),onClick:this._onCanvasClick}}},{key:"_getPropsForSprite",value:function(e){return{hideContent:!0}}},{key:"_getComponentTypeForSprite",value:function(e){return e instanceof k?p.default:e instanceof b?d.default:e instanceof w?m.default:void 0}},{key:"_renderSpriteItems",value:function(){var e=this,t=this.getSharedState("operation"),n=t.getSprites(),i=this.getSharedState("selectedSprite");return n.map(function(n){var r=n===i,o=e._getComponentTypeForSprite(n),a=e._getPropsForSprite(n);return u.ReactBEM.createElement(o,l({operation:t,sharedState:e.props.sharedState,sprite:n,selected:r,onDragStart:e._onSpriteDragStart,onDragStop:e._onSpriteDragStop,onRemove:e._onSpriteRemove.bind(e,n),options:e.props.options,ref:"sprite-"+n.getId()},a))})}},{key:"_renderOverlayControls",value:function(){return null}},{key:"renderWithBEM",value:function(){return u.ReactBEM.createElement("div",l({bem:"$b:canvasControls e:container m:full",ref:"container"},this._getContainerProps()),u.ReactBEM.createElement("div",l({bem:"b:canvasControls e:innerContainer",ref:"innerContainer"},this._getInnerContainerProps()),u.ReactBEM.createElement("div",{bem:"$b:spritesCanvasControls",ref:"container"},this._renderSpriteItems(),this._renderOverlayControls())))}}]),t}(g.default);t.default=O,O.contextTypes=g.default.contextTypes},function(e,n){e.exports=t},function(e,t,n){"use strict";function i(e){return function(){return e}}var r=function(){};r.thatReturns=i,r.thatReturnsFalse=i(!1),r.thatReturnsTrue=i(!0),r.thatReturnsNull=i(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(e){return e},e.exports=r},function(e,t,n){"use strict";function i(e,t,n,i,o,a,s,l){if(r(t),!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,i,o,a,s,l],f=0;c=new Error(t.replace(/%s/g,function(){return u[f++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}}var r=function(e){};"production"!=={ENV:'"production"'}.NODE_ENV&&(r=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")}),e.exports=i},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n="warn",i=[{type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{type:"info",background:"#BDE5F8",color:"#00529B"},{type:"warn",background:"#FEEFB3",color:"#9F6000"},{type:"error",background:"#FFBABA",color:"#D8000C"},{type:"log",background:"#EEEEEE",color:"#1f4f6b"}],r=i.map(function(e){return e.type}),o={};o.setLevel=function(e){n=e},o.canLog=function(e){return null!==n&&!(r.indexOf(e)<r.indexOf(n))},o.hasColorfulOutput=function(){return(!e||e&&e.browser)&&"undefined"!=typeof navigator&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/)},o.printError=function(e){e.stack.split("\n").forEach(function(e){o.error("Error",e)})},i.forEach(function(e){var t=e.type,n=e.background,i=e.color;o[t]=function(e){if("undefined"!=typeof console&&o.canLog(t)){for(var r=arguments.length,a=Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];var l=a.map(function(e){return"string"==typeof e?e:e.toString()}).join(" ");if(!o.hasColorfulOutput())return console.log("PhotoEditorSDK | "+e+" | "+l);console.log("%c  %c PhotoEditorSDK %c  %c "+e+" %c  "+l+"  %c  ","background: #2D7BFF; line-height: 20px; padding: 4px 0","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0","background: "+n+"; color: "+i+"; line-height: 20px; padding: 4px 0; font-weight: bold","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0")}}}),t.default=o}).call(t,n(20))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function r(e){if(u===setTimeout)return setTimeout(e,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===i||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){_&&h&&(_=!1,h.length?d=h.concat(d):m=-1,d.length&&s())}function s(){if(!_){var e=r(a);_=!0;for(var t=d.length;t;){for(h=d,d=[];++m<t;)h&&h[m].run();m=-1,t=d.length}h=null,_=!1,o(e)}}function l(e,t){this.fun=e,this.array=t}function c(){}var u,f,p=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(e){u=n}try{f="function"==typeof clearTimeout?clearTimeout:i}catch(e){f=i}}();var h,d=[],_=!1,m=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new l(e,t)),1!==d.length||_||r(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(67),s=i(a),l=n(70),c=i(l),u="undefined"!=typeof window?window:e,f=function(){function e(t){r(this,e),this._url=t,this._parsedUrl=c.default.parse(this._url,!0)}return o(e,[{key:"_isJSONPRequest",value:function(){var e=this._parsedUrl.query;for(var t in e){if("?"===e[t])return!0}return!1}},{key:"load",value:function(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON()}},{key:"_loadJSON",value:function(){var e=this;return new s.default(function(t,n){var i=void 0;u.XDomainRequest?(i=new u.XDomainRequest,i.onload=function(){var e=JSON.parse(i.responseText);t(e)},i.onerror=function(e){n(e)},i.open("GET",e._url,!0),i.send()):u.XMLHttpRequest&&(i=new XMLHttpRequest,i.onreadystatechange=function(e){if(4===i.readyState)if(200===i.status){var r=JSON.parse(i.responseText);t(r)}else n(new Error("HTTP Status "+i.status))},i.open("GET",e._url,!0),i.send())})}},{key:"_loadJSONP",value:function(){var e=this,t=!1,n=!1,i="pesdk"+Math.round(99999999999999*Math.random());return new s.default(function(r,o){var a=e._createJSONPNode(i);u[i]=function(i){e._removeJSONPNode(a),t||(n=!0,r(i))},u.setTimeout(function(){n||(e._removeJSONPNode(a),t=!0,o(new Error("Timeout of 5 seconds exceeded.")))},5e3)})}},{key:"_createJSONPNode",value:function(e){var t=this._buildJSONPUrl(e),n=document.querySelector("head"),i=document.createElement("script");return i.src=t,n.appendChild(i),i}},{key:"_removeJSONPNode",value:function(e){e.parentNode.removeChild(e)}},{key:"_buildJSONPUrl",value:function(e){var t=this._parsedUrl.query,n=null;for(var i in t)if("?"===t[i]){n=i;break}return delete this._parsedUrl.search,t[n]=e,c.default.format(this._parsedUrl)}}]),e}();t.default=f}).call(t,n(10))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default={load:function(e){var t=this;return function(){if(e.substr(0,5),!0)return Promise.resolve([e,e])}().then(function(e){var n=i(e,2),r=n[0],o=n[1];return t._createAndLoadImage(r,o)})},_createAndLoadImage:function(e,t){return new Promise(function(e,n){var i=new window.Image;i.addEventListener("load",function(){e(i)}),i.addEventListener("error",function(){n(new Error("Failed to load image at "+t))}),i.crossOrigin="Anonymous",i.src=t})},loadXHR:function(e,t){return new Promise(function(n,i){var r=void 0;window.XDomainRequest?(r=new window.XDomainRequest,t&&r.overrideMimeType(t),r.onload=function(){n(r)},r.onerror=function(e){i(e)}):window.XMLHttpRequest&&(r=new window.XMLHttpRequest,t&&r.overrideMimeType(t),r.onreadystatechange=function(e){4===r.readyState&&(200===r.status?n(r):i(new Error("HTTP Status "+r.status)))}),r.open("GET",e,!0),r.send()})}}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onClick"),s}return o(t,e),a(t,[{key:"_onClick",value:function(e){this.props.onClick&&this.props.onClick()}},{key:"_renderContent",value:function(){return null}},{key:"renderWithBEM",value:function(){var e="$e:row m:"+this._modifier;return this.props.totalRows&&(e+=" m:row-"+this.props.totalRows),s.ReactBEM.createElement("bem",{specifier:"b:splashScreen"},s.ReactBEM.createElement("div",{bem:e},this._renderContent()))}}]),t}(s.BaseComponent);t.default=l,l.propTypes={onClick:s.PropTypes.func},l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(86),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onNewFile"),s}return o(t,e),a(t,[{key:"componentDidMount",value:function(){this._fileLoader=new c.default(this.refs.fileInput),this._fileLoader.on("file",this._onNewFile)}},{key:"componentWillUnmount",value:function(){this._fileLoader.off("file",this._onNewFile),this._fileLoader.dispose(),this._fileLoader=null}},{key:"_onNewFile",value:function(e){this.props.onNewFile&&this.props.onNewFile(e)}},{key:"open",value:function(){this._fileLoader.open()}},{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("input",{type:"file",accept:"image/*",bem:"b:hiddenFileInput",ref:"fileInput"})}}]),t}(s.BaseComponent);t.default=u,u.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"renderWithBEM",value:function(){var e="$e:button";this.props.style&&(e+=" m:"+this.props.style),this.props.icon&&(e+=" m:withIcon");var t=null;return this.props.icon&&(t=s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath(this.props.icon,!0)})),s.ReactBEM.createElement("bem",{specifier:"$b:topBar"},s.ReactBEM.createElement("div",{bem:e,onClick:this.props.onClick},t,s.ReactBEM.createElement("div",{bem:"e:label"},this.props.label||"Button")))}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),a=function(){function e(t,n){i(this,e),this._ui=t,this._options=n,this._categoriesById={},this._filtersByIdentifier={identity:o.SDK.Operations.FilterOperation.Filters.IdentityFilter},this._categories=o.SharedConstants.DEFAULTS.FILTERS.slice(0),this._initCategories()}return r(e,[{key:"instantiateFilterWithIdentifier",value:function(e){var t=this,n=this.getFilterByIdentifier(e);if(!n)return Promise.reject(new Error("Unknown filter with identifier `"+e+"`!"));if(n.prototype instanceof o.SDK.Operations.FilterOperation.Filter)return Promise.resolve(new n);var i=n.lutImage,r=n.resolution,a=n.horizontalTileCount,s=n.verticalTileCount,l=void 0;this._ui.getPreloader&&(l=this._ui.getPreloader().getAsset(i));var c=void 0;return c=l?Promise.resolve(l):o.ImageLoader.load(this._ui.getAssetPath(i)),c.then(function(e){return o.ImageLoader.load(t._ui.getAssetPath(i)).then(function(e){return new o.SDK.Operations.FilterOperation.Filters.ThreeDLUTFilter({image:e,resolution:r,horizontalTileCount:a,verticalTileCount:s})})})}},{key:"_initCategories",value:function(){var e=this;if(this._options.categories&&(this._options.replaceCategories?this._categories=this._options.categories:this._categories=o.Utils.mergeCategories(this._categories,this._options.categories,"filters")),this._options.availableFilters){var t=[];this._categories.forEach(function(n){var i=n.filters.filter(function(t){return-1!==e._options.availableFilters.indexOf(t.identifier)});i.length>0&&t.push({identifier:n.identifier,defaultName:n.defaultName,filters:i})}),this._categories=t}var n={identifier:"all",defaultName:"All",filters:this._categories.length<=0?[]:this._categories.map(function(e){return e.filters}).reduce(function(e,t){return e.concat(t)})};this._categories.unshift(n),this._categoriesById.all=n,this._categories.forEach(function(t){e._categoriesById[t.identifier]=t}),n.filters.forEach(function(t){e._filtersByIdentifier[t.identifier]=t})}},{key:"getFiltersForCategory",value:function(e){if(!this._categoriesById[e])throw new Error("Unknown filter category '"+e+"'");return this._categoriesById[e].filters}},{key:"getFilterByIdentifier",value:function(e){return this._filtersByIdentifier[e]}},{key:"getCategories",value:function(){return this._categories}},{key:"getCategoryByIdentifier",value:function(e){return this._categoriesById[e]}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onItemDragStart","_onItemDragStop","_onItemDrag","_onSpriteUpdate"),s}return o(t,e),a(t,[{key:"_getAbsoluteSpritePosition",value:function(){var e=this.context.editor,t=e.getOutputDimensions();return this.props.sprite.getPosition().clone().multiply(t)}},{key:"componentDidMount",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this.props.sprite.on("update",this._onSpriteUpdate)}},{key:"componentWillUnmount",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this),this.props.sprite.off("update",this._onSpriteUpdate)}},{key:"componentWillReceiveProps",value:function(e){this.props.sprite.off("update",this._onSpriteUpdate),e.sprite.on("update",this._onSpriteUpdate)}},{key:"_onSpriteUpdate",value:function(){this.forceUpdate()}},{key:"_onItemDragStart",value:function(){var e=this.props.sprite;this._initialPosition=e.getPosition(),this.props.onDragStart&&this.props.onDragStart()}},{key:"_onItemDrag",value:function(e){var t=this.props.sprite,n=this.context.editor,i=n.getOutputDimensions(),r=this._initialPosition.clone().add(e.divide(i));t.setPosition(r),n.render()}},{key:"_onItemDragStop",value:function(){this.props.onDragStop&&this.props.onDragStop()}}]),t}(l.BaseComponent);t.default=c,c.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(146),f=function(e){return e&&e.__esModule?e:{default:e}}(u),p=function(e){function t(){var e;r(this,t);for(var n=arguments.length,a=Array(n),s=0;s<n;s++)a[s]=arguments[s];var l=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return l._value=l.props.initialValue.clone(),l._bindAll("_onButtonClick","_onValueChange","_onColorPickerOpen","_onColorPickerClose"),l._events=i({},c.Constants.EVENTS.COLORPICKER_OPEN,l._onColorPickerOpen),l.state={overlayVisible:!1},l._transparentPatternCanvas=c.Utils.createTransparentPatternCanvas(),l}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){e.initialValue!==this.props.initialValue&&(this._value=e.initialValue.clone(),this._renderColor())}},{key:"componentDidMount",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._renderColor()}},{key:"componentDidUpdate",value:function(){this._renderColor()}},{key:"_onColorPickerOpen",value:function(e){e!==this&&this.setState({overlayVisible:!1})}},{key:"_onColorPickerClose",value:function(){this.setState({overlayVisible:!1})}},{key:"_onButtonClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.state.overlayVisible||this._emitEvent(c.Constants.EVENTS.COLORPICKER_OPEN,this),this.setState({overlayVisible:!this.state.overlayVisible})}},{key:"_onValueChange",value:function(e){this._value=e,this._renderColor(),this.forceUpdate(),this.props.onChange&&this.props.onChange(e)}},{key:"_renderColor",value:function(){var e=this.refs.canvas,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight;var n=t.createPattern(this._transparentPatternCanvas,"repeat");t.fillStyle=n,t.fillRect(0,0,e.width,e.height),t.fillStyle=this._value.toRGBA(),t.fillRect(0,0,e.width,e.height)}},{key:"renderWithBEM",value:function(){var e=null;this.state.overlayVisible&&(e=c.ReactBEM.createElement(f.default,{initialValue:this._value,onChange:this._onValueChange,onClose:this._onColorPickerClose,alpha:this.props.alpha}));var t=this.state.overlayVisible?"is-active":null;return c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$b:colorPicker",className:t,onClick:this._onButtonClick},c.ReactBEM.createElement("canvas",{bem:"e:preview",ref:"canvas"}),c.ReactBEM.createElement("div",{bem:"e:label"},this.props.label||this._t("generic.color")),e))}}]),t}(c.BaseComponent);t.default=p,p.contextTypes=c.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(170),l=i(s),c=n(173),u=i(c),f=function(){function e(t,n){r(this,e),this._ui=t,this._fonts=n,this._loadedFonts=[]}return a(e,[{key:"setFonts",value:function(e){this._fonts=e}},{key:"needsToLoad",value:function(){for(var e=this,t=0;t<this._fonts.length;t++){var n=function(t){var n=void 0;return e._fonts[t].getVariations().forEach(function(e){n=n||e.getProvider()}),n?{v:!0}:"continue"}(t);switch(n){case"continue":continue;default:if("object"===(void 0===n?"undefined":o(n)))return n.v}}}},{key:"fontLoaded",value:function(e){var t=e.getFontFamily();return-1!==this._loadedFonts.indexOf(t)}},{key:"setFontLoaded",value:function(e){if(!this.fontLoaded(e)){var t=e.getFontFamily();this._loadedFonts.push(t)}}},{key:"load",value:function(){var e=this,t=this._fonts,n={google:new l.default(this._ui),file:new u.default(this._ui)},i=function(){for(var e in n){n[e].dispose()}};t.filter(function(t){return!e.fontLoaded(t)}).forEach(function(e){e.getVariations().forEach(function(e){var t=e.getProvider();if(t){n[t].add(e)}})});var r=[];for(var o in n)r.push(n[o].load());return Promise.all(r).then(function(){i(),t.forEach(function(t){e.setFontLoaded(t)})}).catch(function(e){throw i(),e})}}]),e}();t.default=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(53),u=i(c),f=n(55),p=i(f),h=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_serializeSticker",value:function(e,n){var i=e.getInputDimensions(!1),r=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeSticker",this).call(this,e,n);return"none"!==n.getTintMode()&&(r.options.tintColor=n.serializeOption("tintColor",!0)),r.options.dimensions=n.getDimensions().clone().divide(i.min()).toObject(),r.options.identifier=r.options.name,delete r.options.name,r}},{key:"_serializePath",value:function(e){var n=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializePath",this).call(this,e),i=e.getBrush();return i.hasOption("hardness")&&(n.hardness=i.getOption("hardness")),n}},{key:"_serializeOperation",value:function(e,n){return"frame"===e.constructor.identifier?(this._serializeFrameOperation(e,n),null):"overlay"===e.constructor.identifier?(this._serializeOverlayOperation(e,n),null):l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeOperation",this).call(this,e,n)}},{key:"_serializeFrameOperation",value:function(e,t){var n=t.filter(function(e){return"sprite"===e.type}),i=void 0;n.length?i=n.pop():(i={type:"sprite",options:{sprites:[]}},t.push(i)),i.options.sprites.push({type:"frame",options:this._getFrameOptions(e)})}},{key:"_serializeOverlayOperation",value:function(e,t){if(e.getIdentifier()){var n=t.filter(function(e){return"sprite"===e.type}),i=void 0;n.length?i=n.pop():(i={type:"sprite",options:{sprites:[]}},t.push(i)),i.options.sprites.push({type:"overlay",options:{identifier:e.getIdentifier(),intensity:e.getAlpha(),blendMode:p.default[e.getBlendMode()]}})}}},{key:"_getFrameOptions",value:function(e){return{identifier:e.getFrame().identifier}}},{key:"_serializeOrientationOperation",value:function(e){var n=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeOrientationOperation",this).call(this,e);return 90!==n.options.rotation&&270!==n.options.rotation||(n.options.flipHorizontally=!n.options.flipHorizontally,n.options.flipVertically=!n.options.flipVertically),n}},{key:"_serializeTransformOperation",value:function(e){var n=this._editor.operations;if(n.exists("orientation")){e=e.clone();var i=n.get("orientation");e.rotate(-i.getRotation()),i.getFlipVertically()&&(e.flip("vertical"),e.setRotation(-1*e.getRotation())),i.getFlipHorizontally()&&(e.flip("horizontal"),e.setRotation(-1*e.getRotation()))}var r=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeTransformOperation",this).call(this,e);return r.type="transform",r}},{key:"_serializeText",value:function(e,n){var i=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeText",this).call(this,e,n),r=e.getInputDimensions(!1);return i.options.fontIdentifier=n.getFontIdentifier(),i.options.maxWidth=i.options.maxWidth*r.x/r.min(),delete i.options.fontFamily,i}},{key:"_serializeFilterOperation",value:function(e){var n=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeFilterOperation",this).call(this,e);return n?(n.options.identifier=n.options.name,delete n.options.name,n):null}},{key:"_serializeRadialFocusOperation",value:function(e){var n=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeRadialFocusOperation",this).call(this,e),i=n.options.options;return i.start=i.position,delete i.position,i.end={x:i.start.x+i.radius,y:i.start.y},delete i.radius,n}}]),t}(u.default);t.default=h,h.version="2.0.0"},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(54),f=i(u),p=n(48),h=i(p),d=n(176),_=i(d),m=n(11),y=i(m),g=n(49),v=i(g),b=n(29),k=i(b),w=n(22),O=i(w),E=n(55),S=i(E),P=c.SDKUtils.flipObject(S.default),C=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));s._frameManager=new h.default(s._ui,s._getOptions("frame"));var l=s._getOptions("overlay");return l&&(s._overlayManager=new _.default(s._ui,l)),s}return a(t,e),s(t,[{key:"_deserializeSprite",value:function(e,n){return"frame"===n.type?this._deserializeFrame(e,n):"overlay"===n.type?this._deserializeOverlay(e,n):l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeSprite",this).call(this,e,n)}},{key:"_deserializeOperation",value:function(e){return"transform"===e.type?this._deserializeTransformOperation(e):l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeOperation",this).call(this,e)}},{key:"_deserializeOrientationOperation",value:function(e){return 90!==e.options.rotation&&270!==e.options.rotation||(e.options.flipHorizontally=!e.options.flipHorizontally,e.options.flipVertically=!e.options.flipVertically),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeOrientationOperation",this).call(this,e)}},{key:"_deserializeTransformOperation",value:function(e){var n=this;return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeCropOperation",this).call(this,e).then(function(e){if(e){var t=n._data.operations.find(function(e){return"orientation"===e.type});if(t){var i=t.options,r=i.rotation,o=i.flipHorizontally,a=i.flipVertically;90!==r&&270!==r||(!o&&a||o&&!a)&&(o=!o,a=!a),e.rotate(i.rotation),o&&(e.flip("horizontal"),e.setRotation(-1*e.getRotation())),a&&(e.flip("vertical"),e.setRotation(-1*e.getRotation()))}return e}})}},{key:"_deserializeFrame",value:function(e,t){var n=this,i=t.options.identifier,r=this._frameManager.getFrameByIdentifier(i);if(!r)return c.Log.warn("Deserializer","Unknown frame `"+i+"`. Skipping frame."),Promise.resolve();var o=new v.default(this._ui,r);return o.load().then(function(){n._editor.operations.getOrCreate("frame",{frame:o.getFrame()})})}},{key:"_deserializeOverlay",value:function(e,t){var n=this,i=t.options,r=i.blendMode,o=i.intensity,a=i.identifier,s=this._overlayManager.getOverlayByIdentifier(a);if(!s)return c.Log.warn("Deserializer","Unknown overlay `"+a+"`. Skipping overlay."),Promise.resolve();var l=this._editor.getUI().getAssetPath(s.image);return O.default.load(l).then(function(e){n._editor.operations.getOrCreate("overlay",{alpha:o,identifier:a,blendMode:parseInt(P[r||s.blendMode],10),image:e})})}},{key:"_createBrushForPath",value:function(e){var n=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_createBrushForPath",this).call(this,e);return void 0!==e.hardness&&n.hasOption("hardness")&&n.setHardness(e.hardness),n}},{key:"_deserializeSticker",value:function(e,t){var n=this,i=c.SDK.Operations.SpriteOperation,r=t.options,o=this._stickerManager.getStickerByIdentifier(r.identifier),a=y.default.getURLForSticker(o,"base");if(!o)return c.Log.warn("Deserializer","Unknown sticker `"+r.identifier+"`. Skipping sprite."),Promise.resolve();var s=e.getInputDimensions(!1);return new Promise(function(t,l){var u=new window.Image;u.addEventListener("load",function(){var n=i.StickerSprite.prototype.availableOptions.adjustments.structure,a=r.rotation,l=r.flipHorizontally,f=r.flipVertically,p={identifier:r.identifier,image:u,position:c.Vector2.fromObject(r.position),dimensions:c.Vector2.fromObject(r.dimensions).multiply(s.min()),rotation:a,flipHorizontally:l,flipVertically:f,adjustments:{}};void 0!==r.adjustments&&["brightness","contrast","saturation"].forEach(function(e){void 0!==r.adjustments[e]&&(p.adjustments[e]=r.adjustments[e]+n[e].default)}),void 0!==r.tintColor&&void 0!==o.tintMode&&(p.tintColor=c.Color.fromArray(r.tintColor),p.tintMode=o.tintMode),t(e.createSticker(p))}),u.crossOrigin="Anonymous",u.src=n._editor.getUI().getAssetPath(a)})}},{key:"_deserializeFilterOperation",value:function(e){var t=this,n=e.options;return this._filterManager.getFilterByIdentifier(n.identifier)?this._filterManager.instantiateFilterWithIdentifier(n.identifier).then(function(e){var i=t._editor.operations.getOrCreate("filter");if(i)return i.set({identifier:n.identifier,filter:e,intensity:n.intensity}),i}):(c.Log.warn("Deserializer","Unknown filter `"+n.identifier+"`"),Promise.resolve())}},{key:"_deserializeFocusOperation",value:function(e){var n=e.options,i=n.options;if("radial"!==n.type)return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeFocusOperation",this).call(this,e);var r=i.start,o=i.end,a=i.gradientRadius,s=i.blurRadius,u=c.Vector2.fromObject(o).subtract(c.Vector2.fromObject(r)).len();return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:c.Vector2.fromObject(r),radius:u,gradientRadius:a,blurRadius:s}))}},{key:"_deserializeText",value:function(e,t){var n=t.options,i=n.fontSize,r=n.lineHeight,o=n.fontIdentifier,a=n.alignment,s=n.rotation,l=n.maxWidth,u=n.color,f=n.backgroundColor,p=new k.default(this._ui),h=this._fontManager.getVariationByIdentifier(o);return h?p.setFonts([h.getFont()]):h=this._fontManager.getDefaultFont(),p.load().then(function(){var t=e.getInputDimensions(!1),o=l*t.min()/t.x;return e.createText({fontSize:i,lineHeight:r,fontFamily:h.getFontFamily(),fontWeight:h.getFontWeight(),fontIdentifier:h.getIdentifier(),alignment:a,rotation:s,maxWidth:o,text:n.text,color:c.Color.fromArray(u),backgroundColor:c.Color.fromArray(f),position:c.Vector2.fromObject(n.position)})})}}]),t}(f.default);t.default=C,C.version="2.0.0"},function(e,t,n){if("production"!=={ENV:'"production"'}.NODE_ENV){var i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,r=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===i};e.exports=n(60)(r,!0)}else e.exports=n(63)()},function(e,t,n){"use strict";var i=n(16),r=i;if("production"!=={ENV:'"production"'}.NODE_ENV){var o=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=0,o="Warning: "+e.replace(/%s/g,function(){return n[r++]});"undefined"!=typeof console&&console.error(o);try{throw new Error(o)}catch(e){}};r=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var n=arguments.length,i=Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];o.apply(void 0,[t].concat(i))}}}e.exports=r},function(e,t,n){var i,r;/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++){var i=arguments[t];if(i){var r=typeof i;if("string"===r||"number"===r)e.push(i);else if(Array.isArray(i))e.push(n.apply(null,i));else if("object"===r)for(var a in i)o.call(i,a)&&i[a]&&e.push(a)}}return e.join(" ")}var o={}.hasOwnProperty;void 0!==e&&e.exports?e.exports=n:(i=[],void 0!==(r=function(){return n}.apply(t,i))&&(e.exports=r))}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,n,r){i(this,e),this._parent=t,this._type=n,this._name=r}return r(e,[{key:"element",value:function(t){return new e(this,"element",t)}},{key:"modifier",value:function(t){return new e(this,"modifier",t)}},{key:"str",get:function(){var e=this._parent?this._parent.str:"";switch(this._type){case"block":e+="pesdk-react-"+this._name;break;case"element":e+="__"+this._name;break;case"modifier":e+="--"+this._name}return e}}]),e}();t.default={block:function(e){return new o(null,"block",e)}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e){for(var t=[],n=0;n<e.length;n++)e[n]instanceof Array?t=t.concat(o(e[n])):t.push(e[n]);return t}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(15),l=i(s),c=n(34),u=i(c),f=n(35),p=i(f),h={b:"block",e:"element",m:"modifier"},d={_parseBemSpecifier:function(e){return e?e.split(" ").map(function(e){var t=e.match(/^(\$)?([bem]):(.*)$/i);if(!t)throw new Error("Invalid BEM specifier: "+e);var n=void 0!==t[1];return{type:h[t[2]],name:t[3],pass:n}}):[]},_getBemInfoForNode:function(e){var t="bem"===e.type,n=t?e.props.specifier:e.props.bem;if(t&&!n)throw new Error("<bem> elements should always have a `specifier` property");var i=this._parseBemSpecifier(n);return t&&i.forEach(function(e){e.pass=!0}),{data:i,isBemNode:t}},createElement:function(e,t){for(var n=arguments.length,i=Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return t=t||{},i=i.filter(function(e){return null!==e&&void 0!==e}),{type:e,props:t,children:i}},_isNodeBEMable:function(e){return null!==e&&"object"===(void 0===e?"undefined":a(e))&&!l.default.isValidElement(e)},_applyBEMClasses:function(e){var t=this;if(!this._isNodeBEMable(e))return e;var n=e.props.className?[e.props.className]:[],i=this._getBemInfoForNode(e),r=e.props.__bemObject,a=e.props.__bemObject;i.data.forEach(function(e){if("block"===e.type)r=p.default.block(e.name),e.pass&&(a=p.default.block(e.name)),n.push(r.str);else if("element"===e.type){if(!r)throw new Error("Tried to create an element, but no parent block has been found.");r=r.element(e.name),e.pass&&(a=a.element(e.name)),n.push(r.str)}else if("modifier"===e.type){if(!r)throw new Error("Tried to create a modifier, but no parent block has been found.");e.pass&&(a=a.modifier(e.name)),n.push(r.modifier(e.name).str)}});var s=(0,u.default)(n);return s&&(e.props.className=s),e.children=o(e.children),e.children.forEach(function(e){t._isNodeBEMable(e)&&(e.props.__bemObject=a)}),e.children=e.children.map(function(e){return t._applyBEMClasses(e)}),e.children=o(e.children),delete e.props.__bemObject,delete e.props.bem,i.isBemNode&&(e=e.children instanceof Array&&1===e.children.length?e.children[0]:e.children),e},_transformToReact:function(e){var t=this;return this._isNodeBEMable(e)?(e.children=e.children.map(function(e){return t._transformToReact(e)}),l.default.createElement.apply(l.default,[e.type,e.props].concat(r(e.children)))):e},transform:function(e){return(e=this._applyBEMClasses(e))instanceof Array?e:e=this._transformToReact(e)}};t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={DEFAULTS:{FILTERS:[{identifier:"imgly_filters_analog",defaultName:"Analog",filters:[{identifier:"imgly_lut_cool",defaultName:"Cool",lutImage:"filters/imgly_lut_cool_5_5_128.png"},{identifier:"imgly_lut_blues",defaultName:"Blues",lutImage:"filters/imgly_lut_blues_5_5_128.png"},{identifier:"imgly_lut_blueshadows",defaultName:"Blue Shadows",lutImage:"filters/imgly_lut_blueshadows_5_5_128.png"},{identifier:"imgly_lut_k6",defaultName:"K6",lutImage:"filters/imgly_lut_k6_5_5_128.png"},{identifier:"imgly_lut_kdynamic",defaultName:"KDynamic",lutImage:"filters/imgly_lut_kdynamic_5_5_128.png"},{identifier:"imgly_lut_lucid",defaultName:"Lucid",lutImage:"filters/imgly_lut_lucid_5_5_128.png"},{identifier:"imgly_lut_pale",defaultName:"Pale",lutImage:"filters/imgly_lut_pale_5_5_128.png"}]},{identifier:"imgly_filters_bw",defaultName:"Black & White",filters:[{identifier:"imgly_lut_sin",defaultName:"Sin",lutImage:"filters/imgly_lut_sin_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_ad1920",defaultName:"1920 A.D.",lutImage:"filters/imgly_lut_ad1920_5_5_128.png"},{identifier:"imgly_lut_bw",defaultName:"B & W",lutImage:"filters/imgly_lut_bw_5_5_128.png"},{identifier:"imgly_lut_litho",defaultName:"Litho",lutImage:"filters/imgly_lut_litho_5_5_128.png"},{identifier:"imgly_lut_plate",defaultName:"Plate",lutImage:"filters/imgly_lut_plate_5_5_128.png"},{identifier:"imgly_lut_x400",defaultName:"X400",lutImage:"filters/imgly_lut_x400_5_5_128.png"}]},{identifier:"imgly_filters_retro",defaultName:"Retro",filters:[{identifier:"imgly_lut_celsius",defaultName:"Celsius",lutImage:"filters/imgly_lut_celsius_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_k2",defaultName:"K2",lutImage:"filters/imgly_lut_k2_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_sepiahigh",defaultName:"Sepia High",lutImage:"filters/imgly_lut_sepiahigh_5_5_128.png"},{identifier:"imgly_lut_ancient",defaultName:"Ancient",lutImage:"filters/imgly_lut_ancient_5_5_128.png"},{identifier:"imgly_lut_classic",defaultName:"Classic",lutImage:"filters/imgly_lut_classic_5_5_128.png"},{identifier:"imgly_lut_eighties",defaultName:"Eighties",lutImage:"filters/imgly_lut_eighties_5_5_128.png"},{identifier:"imgly_lut_elder",defaultName:"Elder",lutImage:"filters/imgly_lut_elder_5_5_128.png"},{identifier:"imgly_lut_glam",defaultName:"Glam",lutImage:"filters/imgly_lut_glam_5_5_128.png"},{identifier:"imgly_lut_gobblin",defaultName:"Gobblin",lutImage:"filters/imgly_lut_gobblin_5_5_128.png"},{identifier:"imgly_lut_orchid",defaultName:"Orchid",lutImage:"filters/imgly_lut_orchid_5_5_128.png"},{identifier:"imgly_lut_seventies",defaultName:"Seventies",lutImage:"filters/imgly_lut_seventies_5_5_128.png"}]},{identifier:"imgly_filters_special",defaultName:"Special",filters:[{identifier:"imgly_lut_fixie",defaultName:"Fixie",lutImage:"filters/imgly_lut_fixie_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_colorful",defaultName:"Colorful",lutImage:"filters/imgly_lut_colorful_5_5_128.png"},{identifier:"imgly_lut_cottoncandy",defaultName:"Cotton Candy",lutImage:"filters/imgly_lut_cottoncandy_5_5_128.png"},{identifier:"imgly_lut_food",defaultName:"Food",lutImage:"filters/imgly_lut_food_5_5_128.png"},{identifier:"imgly_lut_highcontrast",defaultName:"High Contrast",lutImage:"filters/imgly_lut_highcontrast_5_5_128.png"},{identifier:"imgly_lut_k1",defaultName:"K1",lutImage:"filters/imgly_lut_k1_5_5_128.png"},{identifier:"imgly_lut_lomo100",defaultName:"Lomo 100",lutImage:"filters/imgly_lut_lomo100_5_5_128.png"},{identifier:"imgly_lut_neat",defaultName:"Neat",lutImage:"filters/imgly_lut_neat_5_5_128.png"},{identifier:"imgly_lut_nogreen",defaultName:"No Green",lutImage:"filters/imgly_lut_nogreen_5_5_128.png"},{identifier:"imgly_lut_pola669",defaultName:"Pola 669",lutImage:"filters/imgly_lut_pola669_5_5_128.png"},{identifier:"imgly_lut_polasx",defaultName:"Pola SX",lutImage:"filters/imgly_lut_polasx_5_5_128.png"},{identifier:"imgly_lut_pro400",defaultName:"Pro 400",lutImage:"filters/imgly_lut_pro400_5_5_128.png"},{identifier:"imgly_lut_twilight",defaultName:"Twilight",lutImage:"filters/imgly_lut_twilight_5_5_128.png"},{identifier:"imgly_lut_settled",defaultName:"Settled",lutImage:"filters/imgly_lut_settled_5_5_128.png"},{identifier:"imgly_lut_steel",defaultName:"Steel",lutImage:"filters/imgly_lut_steel_5_5_128.png"}]},{identifier:"imgly_filters_summer",defaultName:"Summer",filters:[{identifier:"imgly_lut_texas",defaultName:"Texas",lutImage:"filters/imgly_lut_texas_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_mellow",defaultName:"Mellow",lutImage:"filters/imgly_lut_mellow_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_chest",defaultName:"Chest",lutImage:"filters/imgly_lut_chest_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_creamy",defaultName:"Creamy",lutImage:"filters/imgly_lut_creamy_5_5_128.png"},{identifier:"imgly_lut_evening",defaultName:"Evening",lutImage:"filters/imgly_lut_evening_5_5_128.png"},{identifier:"imgly_lut_fall",defaultName:"Fall",lutImage:"filters/imgly_lut_fall_5_5_128.png"},{identifier:"imgly_lut_front",defaultName:"Front",lutImage:"filters/imgly_lut_front_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_highcarb",defaultName:"High Carb",lutImage:"filters/imgly_lut_highcarb_5_5_128.png"},{identifier:"imgly_lut_keen",defaultName:"Keen",lutImage:"filters/imgly_lut_keen_5_5_128.png"},{identifier:"imgly_lut_pitched",defaultName:"Pitched",lutImage:"filters/imgly_lut_pitched_5_5_128.png"},{identifier:"imgly_lut_soft",defaultName:"Soft",lutImage:"filters/imgly_lut_soft_5_5_128.png"},{identifier:"imgly_lut_summer",defaultName:"Summer",lutImage:"filters/imgly_lut_summer_5_5_128.png"},{identifier:"imgly_lut_sunset",defaultName:"Sunset",lutImage:"filters/imgly_lut_sunset_5_5_128.png"},{identifier:"imgly_lut_tender",defaultName:"Tender",lutImage:"filters/imgly_lut_tender_5_5_128.png"}]},{identifier:"imgly_filters_winter",defaultName:"Winter",filters:[{identifier:"imgly_lut_fridge",defaultName:"Fridge",lutImage:"filters/imgly_lut_fridge_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_bleached",defaultName:"Bleached",lutImage:"filters/imgly_lut_bleached_5_5_128.png"},{identifier:"imgly_lut_bleachedblue",defaultName:"Bleached Blue",lutImage:"filters/imgly_lut_bleachedblue_5_5_128.png"},{identifier:"imgly_lut_breeze",defaultName:"Breeze",lutImage:"filters/imgly_lut_breeze_5_5_128.png"},{identifier:"imgly_lut_lenin",defaultName:"Lenin",lutImage:"filters/imgly_lut_lenin_5_5_128.png"},{identifier:"imgly_lut_quozi",defaultName:"Quozi",lutImage:"filters/imgly_lut_quozi_5_5_128.png"},{identifier:"imgly_lut_winter",defaultName:"Winter",lutImage:"filters/imgly_lut_winter_5_5_128.png"}]}],OVERLAYS:[{identifier:"imgly_overlay_golden",defaultName:"Golden",image:"overlays/imgly_overlay_golden.jpg",thumbnail:"overlays/imgly_overlay_golden_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_bokeh",defaultName:"Bokeh",image:"overlays/imgly_overlay_bokeh.jpg",thumbnail:"overlays/imgly_overlay_bokeh_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_hearts",defaultName:"Hearts",image:"overlays/imgly_overlay_hearts.jpg",thumbnail:"overlays/imgly_overlay_hearts_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak1",defaultName:"Light Leak",image:"overlays/imgly_overlay_lightleak1.jpg",thumbnail:"overlays/imgly_overlay_lightleak1_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak2",defaultName:"Light Leak 2",image:"overlays/imgly_overlay_lightleak2.jpg",thumbnail:"overlays/imgly_overlay_lightleak2_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_rain",defaultName:"Rain",image:"overlays/imgly_overlay_rain.jpg",thumbnail:"overlays/imgly_overlay_rain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_wood",defaultName:"Wood",image:"overlays/imgly_overlay_wood.jpg",thumbnail:"overlays/imgly_overlay_wood_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_mosaic",defaultName:"Mosaic",image:"overlays/imgly_overlay_mosaic.jpg",thumbnail:"overlays/imgly_overlay_mosaic_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_chop",defaultName:"Chop",image:"overlays/imgly_overlay_chop.jpg",thumbnail:"overlays/imgly_overlay_chop_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_vintage",defaultName:"Vintage",image:"overlays/imgly_overlay_vintage.jpg",thumbnail:"overlays/imgly_overlay_vintage_thumb.jpg",blendMode:"darken"},{identifier:"imgly_overlay_metal",defaultName:"Metal",image:"overlays/imgly_overlay_metal.jpg",thumbnail:"overlays/imgly_overlay_metal_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_paper",defaultName:"Paper",image:"overlays/imgly_overlay_paper.jpg",thumbnail:"overlays/imgly_overlay_paper_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_painting",defaultName:"Painting",image:"overlays/imgly_overlay_painting.jpg",thumbnail:"overlays/imgly_overlay_painting_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_grain",defaultName:"Grain",image:"overlays/imgly_overlay_grain.jpg",thumbnail:"overlays/imgly_overlay_grain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_clouds",defaultName:"Clouds",image:"overlays/imgly_overlay_clouds.jpg",thumbnail:"overlays/imgly_overlay_clouds_thumb.jpg",blendMode:"softLight"},{identifier:"imgly_overlay_wall1",defaultName:"Wall",image:"overlays/imgly_overlay_wall1.jpg",thumbnail:"overlays/imgly_overlay_wall1_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_wall2",defaultName:"Wall 2",image:"overlays/imgly_overlay_wall2.jpg",thumbnail:"overlays/imgly_overlay_wall2_thumb.jpg",blendMode:"overlay"}],FRAME_CATEGORIES:[{identifier:"imgly_frame_generic",defaultName:"Generic",metaData:{backgroundImage:"frames/generic.png"},frames:[{identifier:"imgly_frame_dia",defaultName:"Dia",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_left.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_right.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",defaultName:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",defaultName:"Black Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",defaultName:"Low Poly",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",defaultName:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}}]}],STICKER_CATEGORIES:[{identifier:"imgly_sticker_emoticons",defaultName:"Emoticons",metaData:{backgroundImage:"stickers/emoticons/background.png"},stickers:[{identifier:"imgly_sticker_emoticons_alien",defaultName:"Alien",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png"],width:1e3,height:935}}},{identifier:"imgly_sticker_emoticons_angel",defaultName:"Angel",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png"]}}},{identifier:"imgly_sticker_emoticons_angry",defaultName:"Angry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png"]}}},{identifier:"imgly_sticker_emoticons_anxious",defaultName:"Anxious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png"]}}},{identifier:"imgly_sticker_emoticons_asleep",defaultName:"Asleep",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png"]}}},{identifier:"imgly_sticker_emoticons_attention",defaultName:"Attention",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png"]}}},{identifier:"imgly_sticker_emoticons_baby_chicken",defaultName:"Baby Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png"],width:61,height:42},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_batman",defaultName:"Batman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png"]}}},{identifier:"imgly_sticker_emoticons_beer",defaultName:"Beer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png"]}}},{identifier:"imgly_sticker_emoticons_blush",defaultName:"Blush",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png"]}}},{identifier:"imgly_sticker_emoticons_boxer",defaultName:"Boxer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png"]}}},{identifier:"imgly_sticker_emoticons_business",defaultName:"Business",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png"],width:60,height:63},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png"]}}},{identifier:"imgly_sticker_emoticons_chicken",defaultName:"Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png"],width:63,height:55},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_cool",defaultName:"Cool",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png"]}}},{identifier:"imgly_sticker_emoticons_cry",defaultName:"Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png"]}}},{identifier:"imgly_sticker_emoticons_deceased",defaultName:"Deceased",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png"]}}},{identifier:"imgly_sticker_emoticons_devil",defaultName:"Devil",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png"]}}},{identifier:"imgly_sticker_emoticons_duckface",defaultName:"Duckface",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png"]}}},{identifier:"imgly_sticker_emoticons_furious",defaultName:"Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png"],width:62,height:61},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png"]}}},{identifier:"imgly_sticker_emoticons_grin",defaultName:"Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png"]}}},{identifier:"imgly_sticker_emoticons_guitar",defaultName:"Guitar",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png"]}}},{identifier:"imgly_sticker_emoticons_harry_potter",defaultName:"Harry Potter",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png"]}}},{identifier:"imgly_sticker_emoticons_hippie",defaultName:"Hippie",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png"]}}},{identifier:"imgly_sticker_emoticons_hitman",defaultName:"Hitman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png"]}}},{identifier:"imgly_sticker_emoticons_humourous",defaultName:"Humourous",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png"]}}},{identifier:"imgly_sticker_emoticons_idea",defaultName:"Idea",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png"]}}},{identifier:"imgly_sticker_emoticons_impatient",defaultName:"Impatient",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png"]}}},{identifier:"imgly_sticker_emoticons_kiss",defaultName:"Kiss",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png"]}}},{identifier:"imgly_sticker_emoticons_kisses",defaultName:"Kisses",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png"]}}},{identifier:"imgly_sticker_emoticons_laugh",defaultName:"Laugh",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png"]}}},{identifier:"imgly_sticker_emoticons_loud_cry",defaultName:"Loud Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png"],width:64,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png"]}}},{identifier:"imgly_sticker_emoticons_loving",defaultName:"Loving",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png"]}}},{identifier:"imgly_sticker_emoticons_masked",defaultName:"Masked",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png"]}}},{identifier:"imgly_sticker_emoticons_music",defaultName:"Music",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png"],width:62,height:54},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png"]}}},{identifier:"imgly_sticker_emoticons_nerd",defaultName:"Nerd",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png"]}}},{identifier:"imgly_sticker_emoticons_ninja",defaultName:"Ninja",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png"]}}},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",defaultName:"Not Speaking To You",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png"]}}},{identifier:"imgly_sticker_emoticons_pig",defaultName:"Pig",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png"],width:63,height:41},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png"]}}},{identifier:"imgly_sticker_emoticons_pumpkin",defaultName:"Pumpkin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png"]}}},{identifier:"imgly_sticker_emoticons_question",defaultName:"Question",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png"]}}},{identifier:"imgly_sticker_emoticons_rabbit",defaultName:"Rabbit",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png"],width:65,height:47},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png"]}}},{identifier:"imgly_sticker_emoticons_sad",defaultName:"Sad",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png"]}}},{identifier:"imgly_sticker_emoticons_sick",defaultName:"Sick",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png"]}}},{identifier:"imgly_sticker_emoticons_skateboard",defaultName:"Skateboard",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png"]}}},{identifier:"imgly_sticker_emoticons_skull",defaultName:"Skull",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png"]}}},{identifier:"imgly_sticker_emoticons_sleepy",defaultName:"Sleepy",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png"]}}},{identifier:"imgly_sticker_emoticons_smile",defaultName:"Smile",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png"]}}},{identifier:"imgly_sticker_emoticons_smoking",defaultName:"Smoking",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png"]}}},{identifier:"imgly_sticker_emoticons_sobbing",defaultName:"Sobbing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png"]}}},{identifier:"imgly_sticker_emoticons_star",defaultName:"Star",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png"]}}},{identifier:"imgly_sticker_emoticons_steaming_furious",defaultName:"Steaming Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png"]}}},{identifier:"imgly_sticker_emoticons_sunbathing",defaultName:"Sunbathing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png"]}}},{identifier:"imgly_sticker_emoticons_tired",defaultName:"Tired",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png"]}}},{identifier:"imgly_sticker_emoticons_tongue_out_wink",defaultName:"Tongue Out Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wave",defaultName:"Wave",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png"]}}},{identifier:"imgly_sticker_emoticons_wide_grin",defaultName:"Wide Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png"]}}},{identifier:"imgly_sticker_emoticons_wink",defaultName:"Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wrestler",defaultName:"Wrestler",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png"]}}}]},{identifier:"imgly_sticker_shapes",defaultName:"Shapes",metaData:{backgroundImage:"stickers/shapes/background.png"},stickers:[{identifier:"imgly_sticker_shapes_arrow_02",defaultName:"Arrow 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236}}},{identifier:"imgly_sticker_shapes_arrow_03",defaultName:"Arrow 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_01",defaultName:"Badge 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_04",defaultName:"Badge 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589}}},{identifier:"imgly_sticker_shapes_badge_06",defaultName:"Badge 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733}}},{identifier:"imgly_sticker_shapes_badge_08",defaultName:"Badge 4",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_11",defaultName:"Badge 5",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_12",defaultName:"Badge 6",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903}}},{identifier:"imgly_sticker_shapes_badge_13",defaultName:"Badge 7",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718}}},{identifier:"imgly_sticker_shapes_badge_15",defaultName:"Badge 8",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_18",defaultName:"Badge 9",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_19",defaultName:"Badge 10",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png"],width:2127,height:481},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png"],width:2127,height:481}}},{identifier:"imgly_sticker_shapes_badge_20",defaultName:"Badge 11",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404}}},{identifier:"imgly_sticker_shapes_badge_28",defaultName:"Badge 12",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_32",defaultName:"Badge 13",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_35",defaultName:"Badge 14",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002}}},{identifier:"imgly_sticker_shapes_badge_36",defaultName:"Badge 15",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668}}},{identifier:"imgly_sticker_shapes_spray_01",defaultName:"Spray 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039}}},{identifier:"imgly_sticker_shapes_spray_03",defaultName:"Spray 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779}}},{identifier:"imgly_sticker_shapes_spray_04",defaultName:"Spray 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248}}}]}]}}},function(e,t,n){(function(t){(function(){var n,i,r;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:void 0!==t&&null!==t&&t.hrtime?(e.exports=function(){return(n()-r)/1e6},i=t.hrtime,n=function(){var e;return e=i(),1e9*e[0]+e[1]},r=n()):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)}).call(t,n(20))},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onClick"),s}return o(t,e),a(t,[{key:"_onClick",value:function(){this.props.onClick&&this.props.onClick(this.props.searchSuggestion)}},{key:"renderWithBEM",value:function(){var e=this.props.searchSuggestion,t={backgroundImage:"url("+e.coverImage+")"};return s.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:libraryList"},s.ReactBEM.createElement("li",{bem:"e:item",style:t,onClick:this._onClick},s.ReactBEM.createElement("div",{bem:"e:overlay"}),s.ReactBEM.createElement("div",{bem:"e:name"},e.query)))}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(1),f=i(u),p=n(97),h=i(p),d=n(2),_=i(d),m=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._needsStyleFixes=!0,s._totalPhotosHeight=0,s.state={loading:!1,photos:[]},s}return a(t,e),s(t,[{key:"componentDidMount",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._loadPhotos()}},{key:"componentDidUpdate",value:function(){this.refs.scrollbar&&this.refs.scrollbar.update()}},{key:"_onPhotoClicked",value:function(e){this.props.onPhotoClicked&&this.props.onPhotoClicked(e)}},{key:"_getHeadline",value:function(){return this.props.library.name}},{key:"fixStyles",value:function(){if(c.Utils.Browser.isIElte(11)){var e=this.refs.cell,t=this.refs.scrollbar.getList();if(!e||!t)return;var n=e.offsetHeight;t.style.height=n+"px"}this.refs.scrollbar&&this.refs.scrollbar.update()}},{key:"_renderColumns",value:function(){for(var e=this,t=this.state.photos,n=[],i=[],r=0;r<3;r++)i.push([]),n.push(0);return t.forEach(function(t){for(var r=t.dimensions,o=null,a=1/0,s=0;s<3;s++)n[s]<a&&(o=s,a=n[s]);i[o].push(c.ReactBEM.createElement(h.default,{photo:t.obj,onClick:e._onPhotoClicked.bind(e,t.obj)})),n[o]+=r.y}),i}},{key:"_renderPhotos",value:function(){var e=this._renderColumns();return c.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},c.ReactBEM.createElement("div",{bem:"e:cell",ref:"cell"},c.ReactBEM.createElement(_.default,{direction:"vertical",ref:"scrollbar"},c.ReactBEM.createElement("div",{bem:"e:container",ref:"container"},c.ReactBEM.createElement("div",{bem:"e:innerContainer"},c.ReactBEM.createElement("div",{bem:"e:headline"},this._getHeadline()),c.ReactBEM.createElement("bem",{specifier:"e:photoList"},e.map(function(e){return c.ReactBEM.createElement("ul",{bem:"$e:list"},e)})))))))}},{key:"_loadPhotos",value:function(){var e=this;this._totalPhotosHeight=0;var t=f.default.instance.displayProgress(this._t("loading.loading"));(new(0,this.context.options.photoRoll.provider)).getPhotosForLibrary(this.props.library).then(function(n){return e._preloadPhotos(n,t)}).then(function(n){e.setState({photos:n,loading:!1}),t.close()}).catch(function(n){t.close(),f.default.instance.displayError(e._t("errors.photoRollLoadFail.title"),e._t("errors.photoRollLoadFail.text",{error:n.message}))})}},{key:"_preloadPhotos",value:function(e,t){var n=this,i=e.length,r=0;return Promise.all(e.map(function(e){return n._preloadPhoto(e).then(function(o){var a=new c.Vector2(o.width,o.height);return a.multiply(240/o.width),n._totalPhotosHeight+=a.y,r++,t.setData({progress:r/i}),{obj:e,dimensions:a}})}))}},{key:"_preloadPhoto",value:function(e){return new Promise(function(t,n){var i=new window.Image;i.addEventListener("load",function(){t(i)}),i.addEventListener("error",function(){t(i)}),i.crossOrigin="Anonymous",i.src=e.urls.thumb})}},{key:"renderWithBEM",value:function(){return this.state.loading?c.ReactBEM.createElement("div",null):this._renderPhotos()}}]),t}(c.BaseComponent);t.default=m,m.contextTypes=c.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(3),u=i(c),f=n(2),p=i(f),h=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._hasBackButton=!1,s}return a(t,e),s(t,[{key:"_onItemClick",value:function(e){this.props.onSwitchControls(e)}},{key:"_renderListItems",value:function(){var e=this,t=this.context.editor,n=[],i=function(n){var i=t.controls.get(n);return l.ReactBEM.createElement("li",{bem:"e:item",key:i.identifier,"data-identifier":i.identifier,onClick:e._onItemClick.bind(e,i)},l.ReactBEM.createElement("bem",{specifier:"$b:controls"},l.ReactBEM.createElement("div",{bem:"$e:button m:withLabel"},l.ReactBEM.createElement("img",{bem:"e:icon",src:e._getAssetPath(i.iconPath,!0)}),l.ReactBEM.createElement("div",{bem:"e:label"},e._t(i.languageKey)))))};this.context.options.editor.controlsOrder.forEach(function(e){if(Array.isArray(e)){var r=e,o=[];r.forEach(function(e){t.controls.isEnabled(e)&&o.push(i(e))}),o.length&&n.push(o)}else{var a=e;if(!t.controls.isEnabled(a))return;n.push(i(a))}});var r=[];return n.forEach(function(e){r=r.concat(e),e!==n[n.length-1]&&r.push(l.ReactBEM.createElement("li",{bem:"e:separator"}))}),r}},{key:"renderControls",value:function(){var e=this._renderListItems();return l.ReactBEM.createElement("div",{bem:"e:cell m:list"},l.ReactBEM.createElement(p.default,null,l.ReactBEM.createElement("ul",{bem:"$e:list"},e)))}}]),t}(u.default);t.default=h,h.contextTypes=u.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(114),u=i(c),f=n(116),p=i(f),h=n(117),d=i(h),_=n(118),m=i(_),y=n(162),g=i(y),v=n(163),b=i(v),k=n(164),w=i(k),O=function(e){function t(e,n,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s._ui=e,s._options=n,s._mediator=i,s._ready=!1,s._padding=[0,0,0,0],s._shallow=a,a||(s._initSDK(),s._onZoom=s._onZoom.bind(s),s._onUndo=s._onUndo.bind(s),s.history=new w.default(s,s._sdk,s._mediator),s.history.on("undo",s._onUndo),s.zoom=new b.default(s,s._sdk,s._mediator),s.zoom.on("set",s._onZoom),s._initSerializers()),s.operations=new d.default(s,s._sdk,s._mediator),s.controls=new m.default(s,s._sdk,s._mediator),s.features=new g.default(s,s._sdk,s._mediator),s._running=!1,s._renderRequested=!0,s._renderCallbacks=[],s._animationFrameRequest=null,s.render=s.render.bind(s),s._tick=s._tick.bind(s),s}return a(t,e),s(t,[{key:"setImage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._options.editor.image,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._sdk.getRenderer(),r=new l.Vector2(t.naturalWidth,t.naturalHeight),o=1e6*this.getMaxMegapixels(),a=i.getMaxDimensions();n&&this.reset();var s=new p.default(t,o,a),c=null,u=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;arguments.length>2&&void 0!==arguments[2]&&arguments[2];e._setImage(t,c,n),e._initWatermark(),e._ready=!0,e.emit("ready")};s.needsResize()?(this.emit("resize"),c=this._sdk.parseExif(t),s.resize().then(function(t){var n=t.canvas,i=t.dimensions,r=t.reason;n.src="data:image/jpeg;base64,",e.emit("resized",{dimensions:i,reason:r}),u(n,i,r)})):u(t)}},{key:"_initWatermark",value:function(){this._options.editor.watermarkImage&&(this._watermarkOperation=this.operations.getOrCreate("watermark",{image:this._options.editor.watermarkImage}))}},{key:"_initSDK",value:function(){var e=this._options,t=e.logLevel,n=e.displayWelcomeMessage,i=e.debug,r=e.license,o=this._options.editor,a=o.smoothDownscaling,s=o.smoothUpscaling,c=o.preferredRenderer,u=o.pixelRatio,f={logLevel:t,debug:i,displayWelcomeMessage:n,pixelRatio:u,smoothDownscaling:a,smoothUpscaling:s,transparent:!0,license:r};this._sdk=new l.SDK(c,f)}},{key:"_onZoom",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.fixOffset(),this.render(function(){t._mediator.emit(l.Constants.EVENTS.ZOOM_DONE),n&&n()})}},{key:"_onUndo",value:function(){this.render()}},{key:"getRotation",value:function(){return this._sdk.getRotation()}},{key:"setRotation",value:function(e){this._sdk.setRotation(e)}},{key:"getSpriteScale",value:function(){return this._sdk.getSpriteScale()}},{key:"setSpriteScale",value:function(e){this._sdk.setSpriteScale(e)}},{key:"isToolAllowed",value:function(e){return!!this._shallow||this._sdk._l.isToolAllowed(e)}},{key:"isToolEnabled",value:function(e){return-1!==this._options.editor.tools.indexOf(e)}},{key:"getMaxMegapixels",value:function(){var e=this._options.editor.maxMegaPixels;return l.Utils.isMobile()?e.mobile:e.desktop}},{key:"getOutputDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sdk.getOutputDimensions(e)}},{key:"getOutputTextureDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sdk.getOutputTextureDimensions(e)}},{key:"getFinalDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sdk.getFinalDimensions(e)}},{key:"getCanvasDimensions",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this._sdk.getCanvas(),n=new l.Vector2(t.offsetWidth,t.offsetHeight);return e&&n.subtract(this._padding[1]+this._padding[3],this._padding[0]+this._padding[2]),n}},{key:"_setImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._options.editor.image,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._sdk.setAllOperationsToDirty(),this._options.editor.image=e,this._sdk.setImage(e,t,n),this.zoom.set("auto"),this.emit("new-image")}},{key:"export",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._watermarkOperation&&this._watermarkOperation.setEnabled(!1),this._sdk.setAllOperationsToDirty();var n=this._options.editor.export;return new u.default(this._sdk,n,t).export().then(function(t){return e.emit("export",t),e._mediator.emit(l.Constants.EVENTS.EXPORT,t,e),e._watermarkOperation&&(e._watermarkOperation.setEnabled(!0),e._sdk.render()),e._sdk.setAllOperationsToDirty(),t})}},{key:"_initSerializers",value:function(){this._serializers={"1.0.0":n(165).default,"1.0.1":n(174).default,"2.0.0":n(175).default,"2.0.1":n(177).default,"3.0.0":n(180).default}}},{key:"serialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"3.0.0",n=this._serializers[t];return n?new n(this).serialize(e):l.Promise.reject(new Error("No serializer for version "+t+" found."))}},{key:"deserialize",value:function(e){var t=this,n=this._serializers[e.version];return n?new n(this).deserialize(e).then(function(){t.zoom.set("auto")}):l.Promise.reject(new Error("No serializer for version "+e.version+" found."))}},{key:"_applyOffset",value:function(){var e=this._offset.clone();e.x-=this._padding[1]/2,e.x+=this._padding[3]/2,e.y-=this._padding[2]/2,e.y+=this._padding[0]/2,this._sdk.setOffset(e)}},{key:"start",value:function(){this.zoom.set("auto"),this._animationFrameRequest=(0,l.requestAnimationFrame)(this._tick)}},{key:"stop",value:function(){this._running=!1,this._animationFrameRequest&&((0,l.cancelAnimationFrame)(this._animationFrameRequest),this._renderCallbacks=[])}},{key:"render",value:function(e){this._renderRequested=!0,e&&this._renderCallbacks.push(e)}},{key:"setOffset",value:function(e){this._offset=this._clampOffset(e)}},{key:"getOffset",value:function(){return this._offset}},{key:"fixOffset",value:function(){this.setOffset(this._sdk.getOffset())}},{key:"_clampOffset",value:function(e){var t=this._sdk.getRenderer(),n=new l.Vector2(t.getWidth(),t.getHeight()),i=this._sdk.getOutputDimensions(!1),r=n.clone().subtract(i).divide(2).clamp(null,new l.Vector2(0,0)),o=i.clone().subtract(n).divide(2).clamp(new l.Vector2(0,0),null);return e.clone().clamp(r,o).round()}},{key:"_tick",value:function(){var e=this;if(this._renderRequested){var t=this._renderCallbacks.slice(0);this._renderCallbacks=[],this._render().then(function(){t.forEach(function(e){return e()}),e._animationFrameRequest=(0,l.requestAnimationFrame)(e._tick)}).catch(function(e){l.Log.printError(e)}),this._renderRequested=!1}else this._animationFrameRequest=(0,l.requestAnimationFrame)(this._tick)}},{key:"_render",value:function(){var e=this;return this._ready?(this._applyOffset(),this._sdk.render().then(function(){e._lastOutputBounds=e._sdk.getSprite().getBounds()}).catch(function(t){e.emit("render-error",t)})):l.Promise.resolve()}},{key:"reset",value:function(){this._sdk.reset(),this.history.reset(),this.operations.reset()}},{key:"dispose",value:function(){this.stop(),this._sdk.dispose()}},{key:"isReady",value:function(){return this._ready}},{key:"getRenderer",value:function(){return this._sdk.getRenderer()}},{key:"getSDK",value:function(){return this._sdk}},{key:"getInputDimensions",value:function(){return this._sdk.getInputDimensions(!1)}},{key:"getPadding",value:function(){return this._padding}},{key:"setPadding",value:function(e){this._padding=e||[0,0,0,0]}},{key:"getImage",value:function(){return this._options.editor.image}},{key:"getOptions",value:function(){return this._options}},{key:"getUI",value:function(){return this._ui}},{key:"getMediator",value:function(){return this._mediator}},{key:"broadcastTransform",value:function(e,t){var n=this,i=new l.SDK.Operations.TransformOperation.TransformChange(e,t);["sprite","selective-blur","radial-focus","mirrored-focus","linear-focus","blur"].forEach(function(e){var t=n.operations.get(e);t&&t.transform(i)})}},{key:"broadcastFlip",value:function(e){var t=this;["mirrored-focus","radial-focus","sprite","selective-blur"].forEach(function(n){var i=t.operations.get(n);i&&i.flip(e)})}},{key:"broadcastRotate",value:function(e){var t=this;["transform","mirrored-focus","radial-focus","sprite","selective-blur"].forEach(function(n){var i=t.operations.get(n);i&&i.rotate(e)})}}]),t}(l.EventEmitter);t.default=O},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(119);Object.defineProperty(t,"adjustments",{enumerable:!0,get:function(){return i(r).default}});var o=n(122);Object.defineProperty(t,"transform",{enumerable:!0,get:function(){return i(o).default}});var a=n(126);Object.defineProperty(t,"filter",{enumerable:!0,get:function(){return i(a).default}});var s=n(129);Object.defineProperty(t,"focus",{enumerable:!0,get:function(){return i(s).default}});var l=n(134);Object.defineProperty(t,"sticker",{enumerable:!0,get:function(){return i(l).default}});var c=n(142);Object.defineProperty(t,"text",{enumerable:!0,get:function(){return i(c).default}});var u=n(152);Object.defineProperty(t,"brush",{enumerable:!0,get:function(){return i(u).default}});var f=n(156);Object.defineProperty(t,"selectiveBlur",{enumerable:!0,get:function(){return i(f).default}});var p=n(159);Object.defineProperty(t,"frame",{enumerable:!0,get:function(){return i(p).default}})},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(128),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(){i(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._bindAll("_onButtonClick"),e.state={overlayVisible:!1},e}return o(t,e),a(t,[{key:"_onButtonClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.setState({overlayVisible:!this.state.overlayVisible})}},{key:"renderWithBEM",value:function(){var e=null;this.state.overlayVisible&&(e=s.ReactBEM.createElement(c.default,{items:this.props.items,selectedItem:this.props.selectedItem,onChange:this.props.onChange}));var t=this.state.overlayVisible?"is-active":null;return s.ReactBEM.createElement("bem",{specifier:"$b:controls"},s.ReactBEM.createElement("div",{bem:"$e:categoryDropdown",className:t,onClick:this._onButtonClick},s.ReactBEM.createElement("img",{bem:"e:icon",src:this.props.selectedItem.icon}),s.ReactBEM.createElement("div",{bem:"e:label"},this.props.selectedItem.label),e))}}]),t}(s.BaseComponent);t.default=u,u.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"componentDidMount",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._renderCanvas()}},{key:"componentDidUpdate",value:function(){this._renderCanvas()}},{key:"_renderCanvas",value:function(){var e=this.refs.canvas,t=this.context.editor,n=t.getSDK(),i=n.getPixelRatio();e.width=e.offsetWidth*i,e.height=e.offsetHeight*i,e.style.width=e.offsetWidth+"px",e.style.height=e.offsetHeight+"px";var r=e.getContext("2d");r.fillStyle="red",r.clearRect(0,0,e.width,e.height),r.font=(this.props.fontStyle||"")+" "+(this.props.fontWeight||"")+" "+24*i+"px "+this.props.fontFamily,r.textBaseline="middle",r.textAlign="center",r.fillStyle="white",r.fillText("Abc",e.width/2,e.height/2)}},{key:"renderWithBEM",value:function(){return l.ReactBEM.createElement("canvas",{bem:"b:fontFamily e:canvas",ref:"canvas"})}}]),t}(l.BaseComponent);t.default=c,c.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(0),s=n(151),l=i(s),c=n(19),u=i(c),f=n(47),p=i(f),h=function(){function e(t,n){r(this,e),this._ui=t,this._options=n,this._fonts=[],this._variationsByIdentifier={},this._fontsByFontFamily={},this._initFonts()}return o(e,[{key:"_initFonts",value:function(){var e=this,t=this._options,n=t.fonts,i=t.replaceFonts,r=t.availableVariations,o=a.Constants.DEFAULTS.FONTS;o=i?n:o.concat(n||[]);var s=void 0;o=o.map(function(t){var n=t.fontFamily,i=t.variations;if(r&&(i=i.filter(function(e){return-1!==r.indexOf(e.identifier)})),0===i.length)return null;var o=new l.default({fontFamily:n});return i=i.map(function(t){var i=new p.default(t);return i.setFontFamily(n),i.setFont(o),t.default&&!s&&(s=i),null==i.getTextMetrics()&&u.default.warn("Missing font metrics for "+i.getIdentifier()+". The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details."),e._variationsByIdentifier[i.getIdentifier()]=i,i}),o.setVariations(i),e._fontsByFontFamily[n]=o,o}).filter(function(e){return e}),s||(s=o[0].getVariations()[0]),this._defaultVariation=s,this._fonts=o}},{key:"getFonts",value:function(){return this._fonts}},{key:"getFontByFontFamily",value:function(e){return this._fontsByFontFamily[e]}},{key:"getVariationByIdentifier",value:function(e){return this._variationsByIdentifier[e]}},{key:"getDefaultVariation",value:function(){return this._defaultVariation}}]),e}();t.default=h},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(7),l={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"Semibold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular"},c=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"getLabel",value:function(){var e=l[this._options.fontWeight];switch(this._options.fontStyle){case"italic":e+=" Italic"}return e}}]),t}(s.Configurable);t.default=c,c.prototype.availableOptions={identifier:{type:s.OptionType.STRING,required:!0},fontFamily:{type:s.OptionType.STRING,required:!0},fontWeight:{type:s.OptionType.ALL,default:400},fontStyle:{type:s.OptionType.STRING,default:"normal"},textMetrics:{type:s.OptionType.OBJECT,default:null},provider:{type:s.OptionType.STRING,available:["google","file"]},filePath:{type:s.OptionType.STRING},default:{type:s.OptionType.BOOLEAN,default:!1},font:{type:s.OptionType.OBJECT}}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),a=function(){function e(t,n){i(this,e),this._ui=t,this._options=n,this._categoriesById={},this._categories=[],this._framesById={},this._addCategories(o.SharedConstants.DEFAULTS.FRAME_CATEGORIES);var r=this._options,a=r.categories,s=r.replaceCategories;this._options.categories?this._addCategories(a,s):this._updateAllCategory()}return r(e,[{key:"_addCategories",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._categories=n?e.slice(0):o.Utils.mergeCategories(this._categories,e,"frames"),this._categoriesById={},this._categories.forEach(function(e){t._categoriesById[e.identifier]=e});var i=this._options.availableFrames;i&&this._categories.forEach(function(e){e.frames=e.frames.filter(function(e){return-1!==i.indexOf(e.identifier)})}),this._categories.forEach(function(e){e.frames.forEach(function(e){t._framesById[e.identifier]=e})}),this._updateAllCategory()}},{key:"_updateAllCategory",value:function(){this._allCategory={identifier:"all",defaultName:"All",frames:this._categories.map(function(e){return e.frames}).reduce(function(e,t){return e.concat(t)},[])},this._categoriesById.all=this._allCategory}},{key:"getFramesForCategory",value:function(e){if(!this._categoriesById[e])throw new Error("Unknown frame category '"+e+"'");return this._categoriesById[e].frames}},{key:"getFrameByIdentifier",value:function(e){return this._framesById[e]}},{key:"getCategories",value:function(){return this._categories}},{key:"getCategory",value:function(e){return this._categoriesById[e]}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=s.SDK.OptionType,c=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return o._loaded=!1,o._loading=!1,o._ui=e,o._frame=s.SDK.Utils.deepClone(o._options),o}return o(t,e),a(t,[{key:"load",value:function(){var e=this;if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this._loading=!0;var t=this._frame.imageGroups,n=[];return["top","left","right","bottom"].forEach(function(i){if(i in t){var r=t[i];["start","mid","end"].forEach(function(t){t in r&&n.push(e._loadPart(i,t))})}}),Promise.all(n).then(function(){e._loaded=!0,e._loading=!1}).catch(function(t){e._loaded=!1,e._loading=!1})}},{key:"_loadPart",value:function(e,t){var n=this;return new Promise(function(i,r){var o=n._frame.imageGroups,a=o[e][t],s=a;"string"!=typeof a&&"image"in a&&(s=a.image);var l=new window.Image;l.addEventListener("load",function(){"string"!=typeof a?n._frame.imageGroups[e][t].image=l:n._frame.imageGroups[e][t]=l,i(l)}),l.addEventListener("error",function(){r(new Error("Failed to load image at "+s))}),l.crossOrigin="Anonymous",l.src=n._ui.getAssetPath(s)})}},{key:"getFrame",value:function(){return this._frame}}]),t}(s.SDK.Configurable);t.default=c,c.prototype.availableOptions={identifier:{type:l.STRING,required:!0},defaultName:{type:l.STRING},thumbnail:{type:l.STRING},tintable:{type:l.BOOLEAN,default:!1},layoutMode:{type:l.STRING,default:"horizontal-inside",available:["horizontal-inside","vertical-inside"]},imageGroups:{type:l.OBJECT,required:!0}}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),a=2*Math.PI,s=function(){function e(t){i(this,e),this._editor=t,this._serializeOperations=this._serializeOperations.bind(this)}return r(e,[{key:"serialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._options=o.SDKUtils.defaults(e,{image:!0});var t={version:this.constructor.version};return this._serializeInputImage(t).then(this._serializeOperations)}},{key:"_serializeInputImage",value:function(e){var t=this._editor.getImage(),n=t.width,i=t.height;if(!this._options.image)return e.inputImage={width:n,height:i},Promise.resolve(e);var r=o.SDKUtils.createCanvas();r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0);var a=r.toDataURL(o.ImageFormat.PNG);return e.inputImage={type:o.ImageFormat.PNG,data:a.replace(/^data:image\/(.*?);base64,/,""),width:n,height:i},Promise.resolve(e)}},{key:"_serializeOperations",value:function(e){var t=this,n=[];return this._editor.operations.getStack().forEach(function(e){var i=t._serializeOperation(e,n);i&&n.push(i)}),e.operations=n.filter(function(e){return e}),Promise.resolve(e)}},{key:"_serializeOperation",value:function(e,t){switch(e.constructor.identifier){case"transform":return this._serializeTransformOperation(e);case"orientation":return this._serializeOrientationOperation(e);case"filter":return this._serializeFilterOperation(e);case"adjustments":return this._serializeAdjustmentsOperation(e);case"sprite":return this._serializeSpriteOperation(e,t);case"radial-focus":return this._serializeRadialFocusOperation(e);case"mirrored-focus":return this._serializeLinearFocusOperation(e);default:o.Log.warn("Unable to serialize operation of type "+e.constructor.identifier)}}},{key:"_serializeTransformOperation",value:function(e){var t=e.serializeOptions(["start","end","rotation"],!0);return t.rotation=(t.rotation+a)%a,{type:"crop",options:t}}},{key:"_serializeOrientationOperation",value:function(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}},{key:"_serializeFilterOperation",value:function(e){return"identity"===e.getIdentifier()?null:{type:"filter",options:{intensity:e.getIntensity(),name:e.getIdentifier()}}}},{key:"_serializeAdjustmentsOperation",value:function(e){var t=e.availableOptions,n=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],i={};return n.forEach(function(n){var r=t[n],o=e.getOption(n),a=r.minValue,s=r.midValue,l=r.maxValue;i[n]=o<=s?(o-a)/(s-a)-1:(o-s)/(l-s)}),{type:"adjustments",options:i}}},{key:"_serializeSpriteOperation",value:function(e,t){var n=this,i=t.filter(function(e){return"sprite"===e.type}),r=void 0,o=!0;if(i.length?(r=i.pop(),o=!1):r={type:"sprite",options:{sprites:[]}},e.getSprites().forEach(function(t){var i=null;t instanceof e.constructor.StickerSprite?i=n._serializeSticker(e,t):t instanceof e.constructor.TextSprite?i=n._serializeText(e,t):t instanceof e.constructor.BrushSprite&&(i=n._serializeBrush(e,t)),i&&r.options.sprites.push(i)}),o)return r}},{key:"_serializeSticker",value:function(e,t){var n=t.getAdjustments(),i=t.serializeOptions(["identifier","position","dimensions","flipVertically","flipHorizontally","rotation"],!0);i.name=i.identifier,delete i.identifier,i.rotation=(i.rotation+a)%a;var r=n.availableOptions;return i.adjustments={brightness:n.getBrightness()-r.brightness.default,saturation:n.getSaturation()-r.saturation.default,contrast:n.getContrast()-r.contrast.default},{type:"sticker",options:i}}},{key:"_serializeText",value:function(e,t){var n=t.serializeOptions(["fontSize","lineHeight","fontFamily","fontWeight","alignment","color","backgroundColor","position","rotation","text","maxWidth"],!0);return n.rotation=(n.rotation+a)%a,{type:"text",options:n}}},{key:"_serializeBrush",value:function(e,t){var n=this;return{type:"brush",options:{paths:t.getPaths().map(function(e){return n._serializePath(e)})}}}},{key:"_serializePath",value:function(e){var t=e.getBrush().serializeOptions(["color","size"],!0);return t.points=e.getControlPoints().map(function(e){return e.getPosition().toObject()}),t}},{key:"_serializeRadialFocusOperation",value:function(e){return{type:"focus",options:{type:"radial",options:e.serializeOptions(["position","radius","gradientRadius","blurRadius"],!0)}}}},{key:"_serializeLinearFocusOperation",value:function(e){return{type:"focus",options:{type:"linear",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}},{key:"_getInputDimensionsForOperation",value:function(e){var t=!1,n=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(function(i){i===e&&(t=!0),t||(n=i.getNewDimensions(n))}),n}}]),e}();t.default=s,s.version="1.0.0"},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,o){try{var a=t[r](o),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)});e(s)}return i("next")})}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var l=n(166),c=i(l),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f=n(0),p=n(26),h=i(p),d=n(11),_=i(d),m=n(169),y=i(m),g=n(46),v=i(g),b=n(29),k=i(b),w=void 0;void 0!==f.SDK.Operations.SpriteOperation&&(w=f.SDK.Operations.SpriteOperation.BrushSprite);var O=function(){function e(t,n){s(this,e),this._editor=t,this._ui=this._editor.getUI(),this._data=n,this._filterManager=new h.default(this._ui,this._getOptions("filter")),this._stickerManager=new _.default(this._ui,this._getOptions("sticker")),this._brushManager=new y.default(this._ui,this._getOptions("brush")),this._fontManager=new v.default(this._ui,this._getOptions("text"))}return u(e,[{key:"_getOptions",value:function(e){var t=this._editor.controls,n={};t&&t.get(e)&&(n=t.get(e).defaultOptions);var i=this._editor.getOptions();return f.SDKUtils.deepDefaults({},i.editor.controlsOptions[e]||{},n)}},{key:"deserialize",value:function(){var e=this;return this._validateVersion().then(function(){return e._deserializeInputImage()}).then(function(){return e._deserializeOperations()})}},{key:"_validateVersion",value:function(){return this._data.version!==this.constructor.version?Promise.reject(new Error("Invalid version "+this._data.version+", expected "+this.constructor.version)):Promise.resolve()}},{key:"_deserializeInputImage",value:function(){var e=this;return new Promise(function(t,n){var i=e._data.inputImage,r=i.data,o=i.type;if(r&&o){var a=new window.Image;a.addEventListener("load",function(){e._editor.setImage(a),t()}),a.src="data:"+o+";base64,"+r}else t()})}},{key:"_deserializeOperations",value:function(){function e(){return t.apply(this,arguments)}var t=a(c.default.mark(function e(){var t,n,i,r,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this._data.operations,n=[],i=0;case 3:if(!(i<t.length)){e.next=12;break}return r=t[i],e.next=7,this._deserializeOperation(r);case 7:o=e.sent,n.push(o);case 9:i++,e.next=3;break;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"_deserializeOperation",value:function(e){switch(e.type){case"crop":return this._deserializeCropOperation(e);case"orientation":return this._deserializeOrientationOperation(e);case"filter":return this._deserializeFilterOperation(e);case"adjustments":return this._deserializeAdjustmentsOperation(e);case"sprite":return this._deserializeSpriteOperation(e);case"focus":return this._deserializeFocusOperation(e)}}},{key:"_deserializeCropOperation",value:function(e){var t=e.options,n=t.rotation,i=f.Vector2.fromObject(t.start),r=f.Vector2.fromObject(t.end);n>Math.PI&&(n-=2*Math.PI);var o={start:i,end:r};void 0!==n&&(o.rotation=n);var a=this._editor.operations.getOrCreate("transform");return this._editor.broadcastTransform(a,o),a.set(o),Promise.resolve(a)}},{key:"_deserializeOrientationOperation",value:function(e){var t=e.options,n=this._editor.operations.getOrCreate("orientation");return n?(n.set(t),Promise.resolve(n)):Promise.resolve()}},{key:"_deserializeFilterOperation",value:function(e){var t=this,n=e.options;return this._filterManager.getFilterByIdentifier(n.name)?this._filterManager.instantiateFilterWithIdentifier(n.name).then(function(e){var i=t._editor.operations.getOrCreate("filter");return i.set({identifier:n.name,filter:e,intensity:n.intensity}),i}):(f.Log.warn("Deserializer","Unknown filter `"+n.name+"`"),Promise.resolve())}},{key:"_deserializeAdjustmentsOperation",value:function(e){var t=f.SDK.Operations.AdjustmentsOperation,n=e.options,i=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],r={};return i.forEach(function(e){if(void 0!==n[e]){var i=t.prototype.availableOptions[e],o=i.minValue,a=i.midValue,s=i.maxValue,l=n[e];l=l<0?a+(a-o)*l:a+(s-a)*l,r[e]=l}}),Promise.resolve(this._editor.operations.getOrCreate("adjustments",r))}},{key:"_deserializeSpriteOperation",value:function(e){var t=this,n=e.options,i=this._editor.operations.getOrCreate("sprite");if(!i)return Promise.resolve();var r=n.sprites.map(function(e){return t._deserializeSprite(i,e)}).filter(function(e){return e});return Promise.all(r).then(function(e){return i.setSprites(e.filter(function(e){return e})),i})}},{key:"_deserializeSprite",value:function(e,t){switch(t.type){case"sticker":return this._deserializeSticker(e,t);case"text":return this._deserializeText(e,t);case"brush":return this._deserializeBrush(e,t)}}},{key:"_deserializeSticker",value:function(e,t){var n=this,i=f.SDK.Operations.SpriteOperation,r=t.options,o=this._stickerManager.getStickerByIdentifier(r.name),a=this._stickerManager.getURLForSticker(o);return o?new Promise(function(t,o){var s=new window.Image;s.addEventListener("load",function(){var n=i.StickerSprite.prototype.availableOptions.adjustments.structure,o=r.rotation,a=r.flipHorizontally,l=r.flipVertically,c={identifier:r.name,image:s,position:f.Vector2.fromObject(r.position),dimensions:f.Vector2.fromObject(r.dimensions),rotation:o,flipHorizontally:a,flipVertically:l,adjustments:{}};void 0!==r.adjustments&&["brightness","contrast","saturation"].forEach(function(e){void 0!==r.adjustments[e]&&(c.adjustments[e]=r.adjustments[e]+n[e].default)}),t(e.createSticker(c))}),s.crossOrigin="Anonymous",s.src=n._editor.getUI().getAssetPath(a)}):(f.Log.warn("Deserializer","Unknown sticker '"+r.name+"'. Skipping sprite."),Promise.resolve())}},{key:"_deserializeText",value:function(e,t){var n=t.options,i=n.fontSize,r=n.lineHeight,o=n.fontFamily,a=n.fontWeight,s=n.alignment,l=n.rotation,c=n.maxWidth,u=n.color,p=n.backgroundColor,h=new k.default(this._ui),d=this._fontManager.getFontByFontFamily(o);return d||(d=this._fontManager.getDefaultFont()),h.setFonts([d]),h.load().then(function(){return e.createText({fontSize:i,lineHeight:r,fontFamily:o,fontWeight:a,alignment:s,rotation:l,maxWidth:c,text:n.text,color:f.Color.fromArray(u),backgroundColor:f.Color.fromArray(p),position:f.Vector2.fromObject(n.position)})})}},{key:"_deserializeBrush",value:function(e,t){var n=this,i=t.options,r=i.paths,o=e.createBrush();return r.forEach(function(e){n._deserializeBrushPath(o,e)}),Promise.resolve(o)}},{key:"_deserializeBrushPath",value:function(e,t){var n=t.points,i=this._createBrushForPath(t),r=e.createPath(i);r.setClosed(!0),n.forEach(function(e){r.addControlPoint(f.Vector2.fromObject(e))})}},{key:"_createBrushForPath",value:function(e){var t=e.color,n=e.size,i=f.Color.fromArray(t),a={color:i,size:n},l=this._brushManager.getFirstBrush();if(l.prototype&&l.prototype instanceof w){return new l(a)}var c=f.SDKUtils.extend({},l);delete c.image;var u=function(e){function t(){return s(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),t}(w);return u.identifier=l.identifier,new u(f.SDKUtils.extend({},c,a))}},{key:"_deserializeFocusOperation",value:function(e){var t=e.options.options;switch(e.options.type){case"radial":var n=t.position,i=t.radius,r=t.gradientRadius,o=t.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:f.Vector2.fromObject(n),radius:i,gradientRadius:r,blurRadius:o}));case"linear":var a=t.start,s=t.end,l=t.size,c=t.gradientSize,u=t.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:f.Vector2.fromObject(a),end:f.Vector2.fromObject(s),size:l,gradientSize:c,blurRadius:u}))}}},{key:"_getInputDimensionsForOperation",value:function(e){var t=!1,n=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(function(i){i===e&&(t=!0),t||(n=i.getNewDimensions(n))}),n}}]),e}();t.default=O,O.version="1.0.0"},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(171),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){i(this,e),this._ui=t,this._fonts=[],this._observers=[]}return r(e,[{key:"add",value:function(e){this._fonts.push(e)}},{key:"load",value:function(){var e=this;return 0===this._fonts.length?Promise.resolve():(this._observers=[],this._fonts.forEach(function(t){e._observers.push(new a.default(t))}),Promise.all(this._observers.map(function(e){return e.observe()})))}},{key:"dispose",value:function(){this._observers.forEach(function(e){return e.dispose()})}}]),e}();t.default=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(50),l=function(e){return e&&e.__esModule?e:{default:e}}(s),c=2*Math.PI,u=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"_serializeTransformOperation",value:function(e){var t=e.serializeOptions(["start","end","rotation","textureScale"],!0);return t.rotation=(t.rotation+c)%c,1!==t.textureScale&&(t.dimensions=e.getNewDimensions(e.getInputDimensions(!1))),delete t.textureScale,{type:"crop",options:t}}}]),t}(l.default);t.default=u,u.version="1.0.1"},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=n(51),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"_deserializeOperation",value:function(e){return"selective-blur"===e.type?this._deserializeSelectiveBlurOperation(e):s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeOperation",this).call(this,e)}},{key:"_deserializeCropOperation",value:function(e){var t=e.options,n=t.rotation,i=l.Vector2.fromObject(t.start),r=l.Vector2.fromObject(t.end),o=t.dimensions?l.Vector2.fromObject(t.dimensions):null;n>Math.PI&&(n-=2*Math.PI);var a={start:i,end:r};void 0!==n&&(a.rotation=n);var s=this._editor.operations.getOrCreate("transform");if(!s)return Promise.resolve();if(this._editor.broadcastTransform(s,a),s.set(a),o){var c=r.clone().subtract(i),u=s.getInputDimensions(!1).multiply(c);s.setTextureScale(o.x/u.x)}return Promise.resolve(s)}}]),t}(u.default);t.default=f,f.version="1.0.1"},function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),a=o.SDK.Engine.Filters.OverlayFilter;t.default=(r={},i(r,a.BLEND_MODES.NORMAL,"normal"),i(r,a.BLEND_MODES.OVERLAY,"overlay"),i(r,a.BLEND_MODES.HARD_LIGHT,"hard light"),i(r,a.BLEND_MODES.SOFT_LIGHT,"soft light"),i(r,a.BLEND_MODES.MULTIPLY,"multiply"),i(r,a.BLEND_MODES.DARKEN,"darken"),i(r,a.BLEND_MODES.LIGHTEN,"lighten"),i(r,a.BLEND_MODES.SCREEN,"screen"),i(r,a.BLEND_MODES.COLOR_BURN,"color burn"),r)},function(e,t,n){"use strict";/*!
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */
n(57),e.exports=n(58).default},function(e,t){},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(0),u=n(80),f=r(u),p=n(2),h=r(p),d=n(3),_=r(d),m=n(1),y=r(m),g=n(21),v=r(g),b=n(188),k=r(b),w=n(189),O=i(w),E=n(4),S=r(E),P=n(43),C=i(P),M=n(13),j=r(M),R=n(6),x=r(R),B=n(29),T=r(B),D=function(e){return c.SDKUtils.byteArrayToString(c.Base64.decode(e))},F=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._mediator=new c.EventEmitter,n._fontLoader=new T.default(n),n._options=e,n._initOptions(),n._initLanguage(),n._initEvents(),n._disposed=!1,n._preloader=new k.default(n,n._options,n._mediator),c.Log.setLevel(n._options.logLevel),n._v()&&n.run(),n}return s(t,e),l(t,[{key:"run",value:function(){this._registerWebFonts(),this._options.container.style.position="relative",this._render()}},{key:"_render",value:function(){var e=this,t=c.React.createElement(f.default,{ui:this,mediator:this._mediator,ref:function(t){e._component=t},options:this._options});if(this._options.renderReturnsComponent)return t;c.ReactDOM.render(t,this._options.container)}},{key:"export",value:function(){var e;return(e=this._component).export.apply(e,arguments)}},{key:"serialize",value:function(){var e;return(e=this._component).serialize.apply(e,arguments)}},{key:"deserialize",value:function(e){return this._component.deserialize(e)}},{key:"getEditor",value:function(){return this._component.getEditor()}},{key:"_initOptions",value:function(){this._options=c.SDKUtils.defaults(this._options,{language:"en",title:"PhotoEditor SDK",logLevel:"warn",preloader:!0,editor:{},assets:{},photoRoll:{},enableUpload:!0,enableWebcam:!0,showCloseButton:!1,showHeader:!0,showTopBar:!0,responsive:!1}),this._options.editor=c.SDKUtils.defaults(this._options.editor||{},{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1,preferredRenderer:"webgl",enableZoom:!0,enableDrag:!0,smoothDownscaling:!1,smoothUpscaling:!1,displayResizeMessage:!0,maxMegaPixels:{},forceControls:[],watermarkImage:null,tools:["transform","filter","brightness","saturation","contrast","clarity","exposure","shadows","highlights","gamma","text","sticker","brush","radial-focus","mirrored-focus","frame"],controlsOrder:["transform",["filter","adjustments"],["text","sticker","brush"],["selectiveBlur","focus","frame"]],operationsOrder:["exif-orientation","orientation","transform","filter","adjustments","radial-focus","mirrored-focus","selective-blur","sprite","frame","watermark"],controlsOptions:{}}),this._options.editor.maxMegaPixels=c.SDKUtils.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10}),this._options.editor.export=c.SDKUtils.defaults(this._options.editor.export||{},{showButton:!0,format:"image/png",type:c.RenderType.IMAGE,download:!0,fileBasename:"photoeditorsdk-export",quality:.8}),this._options.photoRoll=c.SDKUtils.defaults(this._options.photoRoll||{},{provider:null}),this._options.extensions=c.SDKUtils.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]}),this._options.assets=c.SDKUtils.defaults(this._options.assets||{},{baseUrl:"assets",resolver:null})}},{key:"_v",value:function(){return!!this[D("X29wdGlvbnM=")][D("bGljZW5zZQ==")]||(c.Log.error(D("TGljZW5zaW5n"),D("Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbi4=")),c.Log.error(D("TGljZW5zaW5n"),D("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),!1)}},{key:"_registerWebFonts",value:function(){var e=this.getAssetPath("fonts/montserrat-regular.woff",!0,!0),t=this.getAssetPath("fonts/montserrat-light.woff",!0,!0),n='\n      // Injected by PhotoEditorSDK\n      @font-face {\n        font-family: "__pesdk_Montserrat";\n        src: url(\''+e+"') format('woff');\n        font-weight: normal;\n        font-style: normal;\n      }\n\n      @font-face {\n        font-family: \"__pesdk_Montserrat\";\n        src: url('"+t+"') format('woff');\n        font-weight: 100;\n        font-style: normal;\n      }\n    ";this._webFontsStyle=document.createElement("style"),this._webFontsStyle.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(this._webFontsStyle)}},{key:"_initEvents",value:function(){this._mediator.pipeEvents(this)}},{key:"_disposeEvents",value:function(){this._mediator.unpipeEvents(this)}},{key:"_initLanguage",value:function(){this._languages=c.SDKUtils.deepDefaults(this._options.extensions.languages,{de:n(194),en:n(195)}),this._language=this._languages[this._options.language],this._language||c.Log.error(this.constructor.name,"Language `"+this._options.language+"` not found!")}},{key:"translate",value:function(e,t){return c.Utils.translate(this._language,e,t)}},{key:"setImage",value:function(e){this._component&&this._component.setImage(e)}},{key:"getAssetPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this._options.assets,r=i.baseUrl,o=i.resolver,a=r+"/"+e;if(e.match(/(ftp|http|https):\/\//)&&(a=e),t){if(!n){if(("undefined"!=typeof window&&window.devicePixelRatio||1)>1){var s=/\.[\w?=]+$/;e=e.replace(s,function(e){return"@2x"+e})}}a=r+"/ui/react/"+e}return void 0!==o&&null!==o&&(a=o(a)),a}},{key:"getFontLoader",value:function(){return this._fontLoader}},{key:"getPreloader",value:function(){return this._preloader}},{key:"dispose",value:function(){if(this._disposed)throw new Error("This instance of PhotoEditorSDK is already disposed.");this._disposed=!0,this._webFontsStyle.parentNode.removeChild(this._webFontsStyle),c.ReactDOM.unmountComponentAtNode(this._options.container),this._disposeEvents()}}]),t}(c.EventEmitter);F.prototype.identifier="react",F.BaseComponent=c.BaseComponent,F.BaseControls=S.default,F.ControlsComponent=_.default,F.React=c.React,F.ReactBEM=c.ReactBEM,F.SharedState=c.SharedState,F.Constants=c.Constants,F.Utils=c.Utils,F.ScrollbarComponent=h.default,F.ModalManager=y.default,F.JSONLoader=v.default,F.PhotoRoll=O,F.Controls=C,F.SliderComponent=j.default,F.SliderOverlayComponent=x.default;var I=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"componentDidMount",value:function(){this._ui=new F(c.SDKUtils.extend({},this.props,{container:this.refs.container}))}},{key:"render",value:function(){var e=c.SDKUtils.extend({},this.props.style||{});return c.React.createElement("div",{style:e,ref:"container"})}},{key:"ui",get:function(){return this._ui}}]),t}(c.React.Component);F.ReactComponent=I,c.SDK.UI=c.SDK.UI||{},c.SDK.UI.ReactUI=F,t.default=F},function(e,t){e.exports=n},function(e,t,n){"use strict";var i=n(16),r=n(17),o=n(33),a=n(61),s=n(18),l=n(62);e.exports=function(e,t){function n(e){var t=e&&(P&&e[P]||e[C]);if("function"==typeof t)return t}function c(e,t){return e===t?0!==e||1/e==1/t:e!==e&&t!==t}function u(e){this.message=e,this.stack=""}function f(e){function n(n,l,c,f,p,h,d){if(f=f||M,h=h||c,d!==s)if(t)r(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("production"!=={ENV:'"production"'}.NODE_ENV&&"undefined"!=typeof console){var _=f+":"+c;!i[_]&&a<3&&(o(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",h,f),i[_]=!0,a++)}return null==l[c]?n?new u(null===l[c]?"The "+p+" `"+h+"` is marked as required in `"+f+"`, but its value is `null`.":"The "+p+" `"+h+"` is marked as required in `"+f+"`, but its value is `undefined`."):null:e(l,c,f,p,h)}if("production"!=={ENV:'"production"'}.NODE_ENV)var i={},a=0;var l=n.bind(null,!1);return l.isRequired=n.bind(null,!0),l}function p(e){function t(t,n,i,r,o,a){var s=t[n];if(w(s)!==e)return new u("Invalid "+r+" `"+o+"` of type `"+O(s)+"` supplied to `"+i+"`, expected `"+e+"`.");return null}return f(t)}function h(e){function t(t,n,i,r,o){if("function"!=typeof e)return new u("Property `"+o+"` of component `"+i+"` has invalid PropType notation inside arrayOf.");var a=t[n];if(!Array.isArray(a)){return new u("Invalid "+r+" `"+o+"` of type `"+w(a)+"` supplied to `"+i+"`, expected an array.")}for(var l=0;l<a.length;l++){var c=e(a,l,i,r,o+"["+l+"]",s);if(c instanceof Error)return c}return null}return f(t)}function d(e){function t(t,n,i,r,o){if(!(t[n]instanceof e)){var a=e.name||M;return new u("Invalid "+r+" `"+o+"` of type `"+S(t[n])+"` supplied to `"+i+"`, expected instance of `"+a+"`.")}return null}return f(t)}function _(e){function t(t,n,i,r,o){for(var a=t[n],s=0;s<e.length;s++)if(c(a,e[s]))return null;return new u("Invalid "+r+" `"+o+"` of value `"+a+"` supplied to `"+i+"`, expected one of "+JSON.stringify(e)+".")}return Array.isArray(e)?f(t):("production"!=={ENV:'"production"'}.NODE_ENV&&o(!1,"Invalid argument supplied to oneOf, expected an instance of array."),i.thatReturnsNull)}function m(e){function t(t,n,i,r,o){if("function"!=typeof e)return new u("Property `"+o+"` of component `"+i+"` has invalid PropType notation inside objectOf.");var a=t[n],l=w(a);if("object"!==l)return new u("Invalid "+r+" `"+o+"` of type `"+l+"` supplied to `"+i+"`, expected an object.");for(var c in a)if(a.hasOwnProperty(c)){var f=e(a,c,i,r,o+"."+c,s);if(f instanceof Error)return f}return null}return f(t)}function y(e){function t(t,n,i,r,o){for(var a=0;a<e.length;a++){if(null==(0,e[a])(t,n,i,r,o,s))return null}return new u("Invalid "+r+" `"+o+"` supplied to `"+i+"`.")}if(!Array.isArray(e))return"production"!=={ENV:'"production"'}.NODE_ENV&&o(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),i.thatReturnsNull;for(var n=0;n<e.length;n++){var r=e[n];if("function"!=typeof r)return o(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",E(r),n),i.thatReturnsNull}return f(t)}function g(e){function t(t,n,i,r,o){var a=t[n],l=w(a);if("object"!==l)return new u("Invalid "+r+" `"+o+"` of type `"+l+"` supplied to `"+i+"`, expected `object`.");for(var c in e){var f=e[c];if(f){var p=f(a,c,i,r,o+"."+c,s);if(p)return p}}return null}return f(t)}function v(e){function t(t,n,i,r,o){var l=t[n],c=w(l);if("object"!==c)return new u("Invalid "+r+" `"+o+"` of type `"+c+"` supplied to `"+i+"`, expected `object`.");var f=a({},t[n],e);for(var p in f){var h=e[p];if(!h)return new u("Invalid "+r+" `"+o+"` key `"+p+"` supplied to `"+i+"`.\nBad object: "+JSON.stringify(t[n],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var d=h(l,p,i,r,o+"."+p,s);if(d)return d}return null}return f(t)}function b(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(b);if(null===t||e(t))return!0;var i=n(t);if(!i)return!1;var r,o=i.call(t);if(i!==t.entries){for(;!(r=o.next()).done;)if(!b(r.value))return!1}else for(;!(r=o.next()).done;){var a=r.value;if(a&&!b(a[1]))return!1}return!0;default:return!1}}function k(e,t){return"symbol"===e||("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}function w(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":k(t,e)?"symbol":t}function O(e){if(void 0===e||null===e)return""+e;var t=w(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function E(e){var t=O(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}function S(e){return e.constructor&&e.constructor.name?e.constructor.name:M}var P="function"==typeof Symbol&&Symbol.iterator,C="@@iterator",M="<<anonymous>>",j={array:p("array"),bool:p("boolean"),func:p("function"),number:p("number"),object:p("object"),string:p("string"),symbol:p("symbol"),any:function(){return f(i.thatReturnsNull)}(),arrayOf:h,element:function(){function t(t,n,i,r,o){var a=t[n];if(!e(a)){return new u("Invalid "+r+" `"+o+"` of type `"+w(a)+"` supplied to `"+i+"`, expected a single ReactElement.")}return null}return f(t)}(),instanceOf:d,node:function(){function e(e,t,n,i,r){return b(e[t])?null:new u("Invalid "+i+" `"+r+"` supplied to `"+n+"`, expected a ReactNode.")}return f(e)}(),objectOf:m,oneOf:_,oneOfType:y,shape:g,exact:v};return u.prototype=Error.prototype,j.checkPropTypes=l,j.PropTypes=j,j}},function(e,t,n){"use strict";function i(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(e){i[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,l=i(e),c=1;c<arguments.length;c++){n=Object(arguments[c]);for(var u in n)o.call(n,u)&&(l[u]=n[u]);if(r){s=r(n);for(var f=0;f<s.length;f++)a.call(n,s[f])&&(l[s[f]]=n[s[f]])}}return l}},function(e,t,n){"use strict";function i(e,t,n,i,l){if("production"!=={ENV:'"production"'}.NODE_ENV)for(var c in e)if(e.hasOwnProperty(c)){var u;try{r("function"==typeof e[c],"%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",i||"React class",n,c,typeof e[c]),u=e[c](t,c,i,n,null,a)}catch(e){u=e}if(o(!u||u instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",i||"React class",n,c,typeof u),u instanceof Error&&!(u.message in s)){s[u.message]=!0;var f=l?l():"";o(!1,"Failed %s type: %s%s",n,u.message,null!=f?f:"")}}}if("production"!=={ENV:'"production"'}.NODE_ENV)var r=n(17),o=n(33),a=n(18),s={};e.exports=i},function(e,t,n){"use strict";var i=n(16),r=n(17),o=n(18);e.exports=function(){function e(e,t,n,i,a,s){s!==o&&r(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=i,n.PropTypes=n,n}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(15),c=i(l),u=n(32),f=i(u),p=n(36),h=i(p),d=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._events={},s._needsStyleFixes=!1,s._bindAll("_onSharedStateUpdate","fixStyles"),s}return a(t,e),s(t,[{key:"fixStyles",value:function(){}},{key:"componentDidMount",value:function(){this._bindEvents(),this.props.sharedState&&this.props.sharedState.on("update",this._onSharedStateUpdate),this._needsStyleFixes&&(this.fixStyles(),this.context.options.responsive&&window.addEventListener("resize",this.fixStyles))}},{key:"componentWillUnmount",value:function(){this._unbindEvents(),this.props.sharedState&&this.props.sharedState.off("update",this._onSharedStateUpdate),this.context.options.responsive&&this._needsStyleFixes&&window.removeEventListener("resize",this.fixStyles)}},{key:"componentWillReceiveProps",value:function(e){e.sharedState&&(this.props.sharedState&&this.props.sharedState.off("update",this._onSharedStateUpdate),e.sharedState.on("update",this._onSharedStateUpdate))}},{key:"_bindAll",value:function(){for(var e=this,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach(function(t){if("function"!=typeof e[t])throw new Error("_bindAll: "+e.constructor.name+"."+t+" is not a function.");e[t]=e[t].bind(e)})}},{key:"_t",value:function(e,t){return this.context.ui.translate(e,t)}},{key:"_getAssetPath",value:function(){var e;return(e=this.context.ui).getAssetPath.apply(e,arguments)}},{key:"_onSharedStateUpdate",value:function(e,t){this.sharedStateDidChange(t),this.shouldSharedComponentUpdate(e,t)&&this.forceUpdate()}},{key:"shouldSharedComponentUpdate",value:function(e,t){return!0}},{key:"sharedStateDidChange",value:function(e){}},{key:"setSharedState",value:function(e,t){this.props.sharedState.set(e,t)}},{key:"getSharedState",value:function(e){return this.props.sharedState.get(e)}},{key:"forceSharedUpdate",value:function(){this.props.sharedState.broadcastUpdate()}},{key:"_bindEvents",value:function(){for(var e in this._events){var t=this._events[e];this.context.mediator.on(e,t)}}},{key:"_unbindEvents",value:function(){for(var e in this._events){var t=this._events[e];this.context.mediator.off(e,t)}}},{key:"_emitEvent",value:function(e){for(var t,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=this.context.mediator).emit.apply(t,[e].concat(i))}},{key:"renderWithBEM",value:function(){return h.default.createElement("div")}},{key:"render",value:function(){return h.default.transform(this.renderWithBEM())}}]),t}(c.default.Component);t.default=d,d.contextTypes={editor:f.default.object,ui:f.default.object,options:f.default.object,mediator:f.default.object,editorScreen:f.default.object},d.propTypes={sharedState:f.default.any}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=i(r),a=n(19),s=i(a),l=n(66),c=i(l),u=n(21),f=i(u),p=o.default.Utils,h=o.default.Math.Vector2,d={getInnerDimensionsForElement:function(e){var t=new h(e.offsetWidth,e.offsetHeight),n=window.getComputedStyle(e,null);return t.x-=parseInt(n.getPropertyValue("padding-left"),10),t.x-=parseInt(n.getPropertyValue("padding-right"),10),t.y-=parseInt(n.getPropertyValue("padding-top"),10),t.y-=parseInt(n.getPropertyValue("padding-bottom"),10),t},getEventPosition:function(e){var t=e.clientX,n=e.clientY;if(-1!==e.type.indexOf("touch")){if(!e.touches.length)return;t=e.touches[0].clientX,n=e.touches[0].clientY}return new h(t,n)},createTransparentPatternCanvas:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return e.width=10,e.height=10,t.fillStyle="white",t.fillRect(0,0,e.width,e.height),t.fillStyle="#cccccc",t.fillRect(0,0,e.width/2,e.height/2),t.fillRect(e.width/2,e.height/2,e.width,e.height),e},supportsMSBlob:function(){return void 0!==document.createElement("canvas").msToBlob},translate:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.fetch(e,t);if(!i)return s.default.info("Utils#translate","Unable to translate `"+t+"`"),null;for(var r in n)i=i.replace("${"+r+"}",n[r]);return i},fetch:function(e,t,n){t=t.replace(/\[(\w+)]/g,".$1"),t=t.replace(/^\./,"");for(var i=t.split("."),r=0;r<i.length;r++){if(!(e=e[i[r]]))break}return void 0!==e&&e},isMobile:function(){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))},isTouchDevice:function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)},select:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n||(n=function(e){return e});var i=[];return t.forEach(function(t){e.forEach(function(e){n(e)===t&&i.push(e)})}),i},getJSONP:function(e){return new f.default(e).load()},cloneCategories:function(e,t){return e.map(function(e){return e=p.clone(e),e[t]=e[t].slice(0),e})},mergeCategories:function(e,t,n){e=this.cloneCategories(e,n);var i=null;return t.forEach(function(t){e.forEach(function(e){t.identifier===e.identifier&&(i=e)}),i?i[n]=i[n].concat(t[n]):e.push(t)}),e},getStyleObject:function(e){var t=window.getComputedStyle(e),n={};for(var i in t){var r=t.getPropertyValue(i),o=i.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()});""!==r&&(n[o]=r)}return n},debounce:function(e,t,n){var i;return function(){var r=this,o=arguments,a=function(){i=null,n||e.apply(r,o)},s=n&&!i;clearTimeout(i),i=setTimeout(a,t),s&&e.apply(this,o)}},getScrollbarWidth:function(){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var n=document.createElement("div");n.style.width="100%",e.appendChild(n);var i=n.offsetWidth;return e.parentNode.removeChild(e),t-i},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Browser:c.default};t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={getIEVersion:function(){var e=navigator,t=e.userAgent,n=e.appVersion;return-1!==n.indexOf("MSIE")?n.match(/MSIE\s+?([0-9]+)/i)[1]:-1!==t.indexOf("Trident")&&t.match(/rv:([0-9]+)/i)[1]},isIE10:function(){var e=this.getIEVersion();return!1!==e&&10===e},isIE11:function(){var e=this.getIEVersion();return!1!==e&&11===e},isIElte:function(e){var t=this.getIEVersion();return!1!==t&&t<=e}}},function(e,t,n){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=void 0===n?window:n,o="undefined"!=typeof Promise?Promise:function(){function t(e,t){d.add(e,t),h||(h=m(d.drain))}function n(e){var t,n=void 0===e?"undefined":i(e);return null==e||"object"!=n&&"function"!=n||(t=e.then),"function"==typeof t&&t}function r(){for(var e=0;e<this.chain.length;e++)o(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function o(e,t,i){var r,o;try{!1===t?i.reject(e.msg):(r=!0===t?e.msg:t.call(void 0,e.msg),r===i.promise?i.reject(TypeError("Promise-chain cycle")):(o=n(r))?o.call(r,i.resolve,i.reject):i.resolve(r))}catch(e){i.reject(e)}}function a(e){var i,o=this;if(!o.triggered){o.triggered=!0,o.def&&(o=o.def);try{(i=n(e))?t(function(){var t=new c(o);try{i.call(e,function(){a.apply(t,arguments)},function(){s.apply(t,arguments)})}catch(e){s.call(t,e)}}):(o.msg=e,o.state=1,o.chain.length>0&&t(r,o))}catch(e){s.call(new c(o),e)}}}function s(e){var n=this;n.triggered||(n.triggered=!0,n.def&&(n=n.def),n.msg=e,n.state=2,n.chain.length>0&&t(r,n))}function l(e,t,n,i){for(var r=0;r<t.length;r++)!function(r){e.resolve(t[r]).then(function(e){n(r,e)},i)}(r)}function c(e){this.def=e,this.triggered=!1}function u(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function f(e){if("function"!=typeof e)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var n=new u(this);this.then=function(e,i){var o={success:"function"!=typeof e||e,failure:"function"==typeof i&&i};return o.promise=new this.constructor(function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");o.resolve=e,o.reject=t}),n.chain.push(o),0!==n.state&&t(r,n),o.promise},this.catch=function(e){return this.then(void 0,e)};try{e.call(void 0,function(e){a.call(n,e)},function(e){s.call(n,e)})}catch(e){s.call(n,e)}}var p,h,d,_=Object.prototype.toString,m=void 0!==e?function(t){return e(t)}:setTimeout;try{Object.defineProperty({},"x",{}),p=function(e,t,n,i){return Object.defineProperty(e,t,{value:n,writable:!0,configurable:!1!==i})}}catch(e){p=function(e,t,n){return e[t]=n,e}}d=function(){function e(e,t){this.fn=e,this.self=t,this.next=void 0}var t,n,i;return{add:function(r,o){i=new e(r,o),n?n.next=i:t=i,n=i,i=void 0},drain:function(){var e=t;for(t=n=h=void 0;e;)e.fn.call(e.self),e=e.next}}}();var y=p({},"constructor",f,!1);return f.prototype=y,p(y,"__NPO__",0,!1),p(f,"resolve",function(e){var t=this;return e&&"object"==(void 0===e?"undefined":i(e))&&1===e.__NPO__?e:new t(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");t(e)})}),p(f,"reject",function(e){return new this(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");n(e)})}),p(f,"all",function(e){var t=this;return"[object Array]"!=_.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t(function(n,i){if("function"!=typeof n||"function"!=typeof i)throw TypeError("Not a function");var r=e.length,o=Array(r),a=0;l(t,e,function(e,t){o[e]=t,++a===r&&n(o)},i)})}),p(f,"race",function(e){var t=this;return"[object Array]"!=_.call(e)?t.reject(TypeError("Not an array")):new t(function(n,i){if("function"!=typeof n||"function"!=typeof i)throw TypeError("Not a function");l(t,e,function(e,t){n(t)},i)})}),f}();r.Promise=r.Promise||o,t.default=o}).call(t,n(68).setImmediate,n(10))},function(e,t,n){function i(e,t){this._id=e,this._clearFn=t}var r=Function.prototype.apply;t.setTimeout=function(){return new i(r.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(r.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(69),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,n){(function(e,t){!function(e,n){"use strict";function i(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return c[l]=i,s(l),l++}function r(e){delete c[e]}function o(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(n,i)}}function a(e){if(u)setTimeout(a,0,e);else{var t=c[e];if(t){u=!0;try{o(t)}finally{r(e),u=!1}}}}if(!e.setImmediate){var s,l=1,c={},u=!1,f=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?function(){s=function(e){t.nextTick(function(){a(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),s=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){a(e.data)},s=function(t){e.port2.postMessage(t)}}():f&&"onreadystatechange"in f.createElement("script")?function(){var e=f.documentElement;s=function(t){var n=f.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():function(){s=function(e){setTimeout(a,0,e)}}(),p.setImmediate=i,p.clearImmediate=r}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,n(10),n(20))},function(e,t,n){"use strict";function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function r(e,t,n){if(e&&c.isObject(e)&&e instanceof i)return e;var r=new i;return r.parse(e,t,n),r}function o(e){return c.isString(e)&&(e=r(e)),e instanceof i?e.format():i.prototype.format.call(e)}function a(e,t){return r(e,!1,!0).resolve(t)}function s(e,t){return e?r(e,!1,!0).resolveObject(t):t}var l=n(71),c=n(73);t.parse=r,t.resolve=a,t.resolveObject=s,t.format=o,t.Url=i;var u=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,p=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["<",">",'"',"`"," ","\r","\n","\t"],d=["{","}","|","\\","^","`"].concat(h),_=["'"].concat(d),m=["%","/","?",";","#"].concat(_),y=["/","?","#"],g=/^[+a-z0-9A-Z_-]{0,63}$/,v=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,b={javascript:!0,"javascript:":!0},k={javascript:!0,"javascript:":!0},w={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},O=n(74);i.prototype.parse=function(e,t,n){if(!c.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),r=-1!==i&&i<e.indexOf("#")?"?":"#",o=e.split(r),a=/\\/g;o[0]=o[0].replace(a,"/"),e=o.join(r);var s=e;if(s=s.trim(),!n&&1===e.split("#").length){var f=p.exec(s);if(f)return this.path=s,this.href=s,this.pathname=f[1],f[2]?(this.search=f[2],this.query=t?O.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=u.exec(s);if(h){h=h[0];var d=h.toLowerCase();this.protocol=d,s=s.substr(h.length)}if(n||h||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===s.substr(0,2);!E||h&&k[h]||(s=s.substr(2),this.slashes=!0)}if(!k[h]&&(E||h&&!w[h])){for(var S=-1,P=0;P<y.length;P++){var C=s.indexOf(y[P]);-1!==C&&(-1===S||C<S)&&(S=C)}var M,j;j=-1===S?s.lastIndexOf("@"):s.lastIndexOf("@",S),-1!==j&&(M=s.slice(0,j),s=s.slice(j+1),this.auth=decodeURIComponent(M)),S=-1;for(var P=0;P<m.length;P++){var C=s.indexOf(m[P]);-1!==C&&(-1===S||C<S)&&(S=C)}-1===S&&(S=s.length),this.host=s.slice(0,S),s=s.slice(S),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var x=this.hostname.split(/\./),P=0,B=x.length;P<B;P++){var T=x[P];if(T&&!T.match(g)){for(var D="",F=0,I=T.length;F<I;F++)T.charCodeAt(F)>127?D+="x":D+=T[F];if(!D.match(g)){var A=x.slice(0,P),z=x.slice(P+1),N=T.match(v);N&&(A.push(N[1]),z.unshift(N[2])),z.length&&(s="/"+z.join(".")+s),this.hostname=A.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=l.toASCII(this.hostname));var L=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+L,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!b[d])for(var P=0,B=_.length;P<B;P++){var U=_[P];if(-1!==s.indexOf(U)){var W=encodeURIComponent(U);W===U&&(W=escape(U)),s=s.split(U).join(W)}}var K=s.indexOf("#");-1!==K&&(this.hash=s.substr(K),s=s.slice(0,K));var H=s.indexOf("?");if(-1!==H?(this.search=s.substr(H),this.query=s.substr(H+1),t&&(this.query=O.parse(this.query)),s=s.slice(0,H)):t&&(this.search="",this.query={}),s&&(this.pathname=s),w[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",$=this.search||"";this.path=L+$}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",i=this.hash||"",r=!1,o="";this.host?r=e+this.host:this.hostname&&(r=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&c.isObject(this.query)&&Object.keys(this.query).length&&(o=O.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||w[t])&&!1!==r?(r="//"+(r||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):r||(r=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),a=a.replace("#","%23"),t+r+n+a+i},i.prototype.resolve=function(e){return this.resolveObject(r(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(c.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var n=new i,r=Object.keys(this),o=0;o<r.length;o++){var a=r[o];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),l=0;l<s.length;l++){var u=s[l];"protocol"!==u&&(n[u]=e[u])}return w[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!w[e.protocol]){for(var f=Object.keys(e),p=0;p<f.length;p++){var h=f[p];n[h]=e[h]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||k[e.protocol])n.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var _=n.pathname||"",m=n.search||"";n.path=_+m}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var y=n.pathname&&"/"===n.pathname.charAt(0),g=e.host||e.pathname&&"/"===e.pathname.charAt(0),v=g||y||n.host&&e.pathname,b=v,O=n.pathname&&n.pathname.split("/")||[],d=e.pathname&&e.pathname.split("/")||[],E=n.protocol&&!w[n.protocol];if(E&&(n.hostname="",n.port=null,n.host&&(""===O[0]?O[0]=n.host:O.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),v=v&&(""===d[0]||""===O[0])),g)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,O=d;else if(d.length)O||(O=[]),O.pop(),O=O.concat(d),n.search=e.search,n.query=e.query;else if(!c.isNullOrUndefined(e.search)){if(E){n.hostname=n.host=O.shift();var S=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");S&&(n.auth=S.shift(),n.host=n.hostname=S.shift())}return n.search=e.search,n.query=e.query,c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!O.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var P=O.slice(-1)[0],C=(n.host||e.host||O.length>1)&&("."===P||".."===P)||""===P,M=0,j=O.length;j>=0;j--)P=O[j],"."===P?O.splice(j,1):".."===P?(O.splice(j,1),M++):M&&(O.splice(j,1),M--);if(!v&&!b)for(;M--;M)O.unshift("..");!v||""===O[0]||O[0]&&"/"===O[0].charAt(0)||O.unshift(""),C&&"/"!==O.join("/").substr(-1)&&O.push("");var R=""===O[0]||O[0]&&"/"===O[0].charAt(0);if(E){n.hostname=n.host=R?"":O.length?O.shift():"";var S=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");S&&(n.auth=S.shift(),n.host=n.hostname=S.shift())}return v=v||n.host&&O.length,v&&!R&&O.unshift(""),O.length?n.pathname=O.join("/"):(n.pathname=null,n.path=null),c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){(function(e,i){var r;!function(o){function a(e){throw new RangeError(B[e])}function s(e,t){for(var n=e.length,i=[];n--;)i[n]=t(e[n]);return i}function l(e,t){var n=e.split("@"),i="";return n.length>1&&(i=n[0]+"@",e=n[1]),e=e.replace(x,"."),i+s(e.split("."),t).join(".")}function c(e){for(var t,n,i=[],r=0,o=e.length;r<o;)t=e.charCodeAt(r++),t>=55296&&t<=56319&&r<o?(n=e.charCodeAt(r++),56320==(64512&n)?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--)):i.push(t);return i}function u(e){return s(e,function(e){var t="";return e>65535&&(e-=65536,t+=F(e>>>10&1023|55296),e=56320|1023&e),t+=F(e)}).join("")}function f(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:k}function p(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function h(e,t,n){var i=0;for(e=n?D(e/S):e>>1,e+=D(e/t);e>T*O>>1;i+=k)e=D(e/T);return D(i+(T+1)*e/(e+E))}function d(e){var t,n,i,r,o,s,l,c,p,d,_=[],m=e.length,y=0,g=C,v=P;for(n=e.lastIndexOf(M),n<0&&(n=0),i=0;i<n;++i)e.charCodeAt(i)>=128&&a("not-basic"),_.push(e.charCodeAt(i));for(r=n>0?n+1:0;r<m;){for(o=y,s=1,l=k;r>=m&&a("invalid-input"),c=f(e.charCodeAt(r++)),(c>=k||c>D((b-y)/s))&&a("overflow"),y+=c*s,p=l<=v?w:l>=v+O?O:l-v,!(c<p);l+=k)d=k-p,s>D(b/d)&&a("overflow"),s*=d;t=_.length+1,v=h(y-o,t,0==o),D(y/t)>b-g&&a("overflow"),g+=D(y/t),y%=t,_.splice(y++,0,g)}return u(_)}function _(e){var t,n,i,r,o,s,l,u,f,d,_,m,y,g,v,E=[];for(e=c(e),m=e.length,t=C,n=0,o=P,s=0;s<m;++s)(_=e[s])<128&&E.push(F(_));for(i=r=E.length,r&&E.push(M);i<m;){for(l=b,s=0;s<m;++s)(_=e[s])>=t&&_<l&&(l=_);for(y=i+1,l-t>D((b-n)/y)&&a("overflow"),n+=(l-t)*y,t=l,s=0;s<m;++s)if(_=e[s],_<t&&++n>b&&a("overflow"),_==t){for(u=n,f=k;d=f<=o?w:f>=o+O?O:f-o,!(u<d);f+=k)v=u-d,g=k-d,E.push(F(p(d+v%g,0))),u=D(v/g);E.push(F(p(u,0))),o=h(n,y,i==r),n=0,++i}++n,++t}return E.join("")}function m(e){return l(e,function(e){return j.test(e)?d(e.slice(4).toLowerCase()):e})}function y(e){return l(e,function(e){return R.test(e)?"xn--"+_(e):e})}var g=("object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType,"object"==typeof i&&i);var v,b=2147483647,k=36,w=1,O=26,E=38,S=700,P=72,C=128,M="-",j=/^xn--/,R=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,B={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},T=k-w,D=Math.floor,F=String.fromCharCode;v={version:"1.4.1",ucs2:{decode:c,encode:u},decode:d,encode:_,toASCII:y,toUnicode:m},void 0!==(r=function(){return v}.call(t,n,t,e))&&(e.exports=r)}()}).call(t,n(72)(e),n(10))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(75),t.encode=t.stringify=n(76)},function(e,t,n){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var l=1e3;o&&"number"==typeof o.maxKeys&&(l=o.maxKeys);var c=e.length;l>0&&c>l&&(c=l);for(var u=0;u<c;++u){var f,p,h,d,_=e[u].replace(s,"%20"),m=_.indexOf(n);m>=0?(f=_.substr(0,m),p=_.substr(m+1)):(f=_,p=""),h=decodeURIComponent(f),d=decodeURIComponent(p),i(a,h)?r(a[h])?a[h].push(d):a[h]=[a[h],d]:a[h]=d}return a};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function i(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(a(e),function(a){var s=encodeURIComponent(r(a))+n;return o(e[a])?i(e[a],function(e){return s+encodeURIComponent(r(e))}).join(t):s+encodeURIComponent(r(e[a]))}).join(t):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default={EVENTS:{RENDER:"render",EXPORT:"export",CLOSE:"close",ZOOM_DONE:"zoom:done",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed",FEATURES_DISABLED:"editor:features:disabled",FEATURES_ENABLED:"editor:features:enabled",FEATURES_UPDATED:"editor:features:updated",COLORPICKER_OPEN:"colorpicker:open",HISTORY_UPDATED:"history:update",HISTORY_BEFORE_UNDO:"history:before_undo",HISTORY_UNDO:"history:undo",WINDOW_RESIZE:"window:resize",CONTROLS_SWITCHED:"controls:switched",TRANSFORM_REAPPLY_RATIO:"transform:reapply_ratio"},DEFAULTS:{TRANSFORM_RATIOS:[[{identifier:"imgly_transform_common_custom",defaultName:"Custom",ratio:"*",selected:!0},{identifier:"imgly_transform_common_square",defaultName:"Square",ratio:1},{identifier:"imgly_transform_common_4-3",defaultName:"4:3",ratio:1.33},{identifier:"imgly_transform_common_16-9",defaultName:"16:9",ratio:1.77}],[{identifier:"imgly_transform_facebook_profile",defaultName:"FB Profile",ratio:1},{identifier:"imgly_transform_facebook_ad",defaultName:"FB Ad",dimensions:new r.default.Math.Vector2(1200,627)},{identifier:"imgly_transform_facebook_post",defaultName:"FB Post",dimensions:new r.default.Math.Vector2(940,788)},{identifier:"imgly_transform_facebook_cover",defaultName:"FB Cover",dimensions:new r.default.Math.Vector2(851,315)}]],BRUSHES:[r.default.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush],FONTS:[{fontFamily:"Aleo",variations:[{identifier:"imgly_font_aleo_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_aleo_bold.woff"}]},{fontFamily:"Amatic SC",variations:[{identifier:"imgly_font_amaticsc",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_amaticsc.woff"}]},{fontFamily:"Bernier",variations:[{identifier:"imgly_font_bernier_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_bernier_regular.woff"}]},{fontFamily:"Cheque",variations:[{identifier:"imgly_font_cheque_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_cheque_regular.woff"}]},{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0}]},{fontFamily:"Gagalin",variations:[{identifier:"imgly_font_gagalin_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_gagalin_regular.woff"}]},{fontFamily:"Hagin",variations:[{identifier:"imgly_font_hagin_caps_thin",fontWeight:200,provider:"file",filePath:"fonts/imgly_font_hagin_caps_thin.woff"}]},{fontFamily:"Intro",variations:[{identifier:"imgly_font_intro_inline",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_intro_inline.woff"}]},{fontFamily:"Lobster",variations:[{identifier:"imgly_font_lobster",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_lobster.woff"}]},{fontFamily:"Nexa",variations:[{identifier:"imgly_font_nexa_script",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_nexa_script.woff"}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff"},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff"}]},{fontFamily:"Panton",variations:[{identifier:"imgly_font_panton_blackitalic_caps",fontWeight:800,fontStyle:"italic",provider:"file",filePath:"fonts/imgly_font_panton_blackitalic_caps.woff"},{identifier:"imgly_font_panton_lightitalic_caps",fontWeight:200,fontStyle:"italic",provider:"file",filePath:"fonts/imgly_font_panton_lightitalic_caps.woff"}]},{fontFamily:"Perfograma",variations:[{identifier:"imgly_font_perfograma",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_perfograma.woff"}]},{fontFamily:"Trashhand",variations:[{identifier:"imgly_font_trash_hand",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_trash_hand.woff"}]}]}}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(7),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=c.default.EventEmitter,f=c.default.Utils,p=c.default.Log,h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._state=e,n}return o(t,e),s(t,[{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"object"!==(void 0===e?"undefined":a(e))&&p.warn("SharedState#set expects an object as first parameter");var n=f.extend({},this._state);this._state=f.extend(this._state,e),t&&this.broadcastUpdate(n,this._state)}},{key:"get",value:function(e){return this._state[e]}},{key:"broadcastUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.emit("update",e,t)}},{key:"clear",value:function(){this._state={}}}]),t}(u);t.default=h},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});for(var n="undefined"==typeof window?e:window,i=n.requestAnimationFrame,r=n.cancelAnimationFrame,o=0,a=["ms","moz","webkit","o"],s=0;s<a.length&&!i;++s)t.requestAnimationFrame=i=n[a[s]+"RequestAnimationFrame"],t.cancelAnimationFrame=r=n[a[s]+"CancelAnimationFrame"]||n[a[s]+"CancelRequestAnimationFrame"];i&&(t.requestAnimationFrame=i=i.bind(n)),r&&(t.cancelAnimationFrame=r=r.bind(n)),i||(t.requestAnimationFrame=i=function(e,t){var n=(new Date).getTime(),i=Math.max(0,16-(n-o)),r=setTimeout(function(){e(n+i)},i);return o=n+i,r}),r||(t.cancelAnimationFrame=r=function(e){clearTimeout(e)}),t.requestAnimationFrame=i,t.cancelAnimationFrame=r}).call(t,n(10))},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(0),u=n(81),f=i(u),p=n(83),h=i(p),d=n(90),_=i(d),m=n(100),y=i(m),g=n(103),v=i(g),b=n(8),k=i(b),w=n(183),O=i(w),E=n(1),S=i(E),P=function(e){function t(){var e;o(this,t);for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];var l=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));l._screens={loading:f.default,splash:h.default,photoRoll:_.default,webcam:y.default,editor:v.default,empty:k.default};var c=void 0;return l.props.options.preloader&&(c="loading"),l._screenAfterLoading="splash",l.props.options.editor.image&&(l._screenAfterLoading="editor"),c||(c=l._screenAfterLoading),l._previousScreensStack=[],l.state={activeScreen:l._screens[c],activeScreenName:c,screens:r({},c,l._screens[c])},l}return s(t,e),l(t,[{key:"hasPreviousScreen",value:function(){return!!this._previousScreensStack.length}},{key:"getPreviousScreen",value:function(){var e=this._previousScreensStack;return e[e.length-1]}},{key:"switchToScreen",value:function(e){var t=this,n=null;if("back"===e){if(!(n=this._previousScreensStack.pop()))throw new Error("Unable to switch to previous screen - no previous screen found.")}else{if("post-loading"===e&&(e=this._screenAfterLoading),!(n=this._screens[e]))throw new Error("Unknown screen `"+e+"`");this._previousScreensStack.push(this.state.activeScreen)}return this.state.screens[e]||(this.state.screens[e]=n),"editor"!==this.state.activeScreenName&&delete this.state.screens[this.state.activeScreenName],new c.Promise(function(i){t.setState({activeScreen:n,activeScreenName:e},function(){i()})})}},{key:"setImage",value:function(e,t){var n=this;this.props.options.editor.image=e;var i=!this.refs.editorScreen;this.switchToScreen("editor").then(function(){i||n.refs.editorScreen.setImage(e,t)})}},{key:"export",value:function(){if(this.state.activeScreen!==this._screens.editor)return c.Promise.reject(new Error("Unable to export: Active screen is not the editor screen."));if(this.state.screens.editor){var e;return(e=this.refs.editorScreen).export.apply(e,arguments)}}},{key:"getEditor",value:function(){return this.state.activeScreen!==this._screens.editor?c.Promise.reject(new Error("Unable to get editor: Active screen is not the editor screen.")):this.state.screens.editor?this.refs.editorScreen.getEditor():void 0}},{key:"serialize",value:function(){var e;return this.state.screens.editor?(e=this.refs.editorScreen).serialize.apply(e,arguments):c.Promise.reject(new Error("Editor screen unavailable"))}},{key:"deserialize",value:function(e){return this.state.screens.editor?this.refs.editorScreen.deserialize(e):c.Promise.reject(new Error("Editor screen unavailable"))}},{key:"getChildContext",value:function(){return{ui:this.props.ui,options:this.props.options,mediator:this.props.mediator}}},{key:"_renderScreens",value:function(){var e=[];for(var t in this.state.screens){var n=this.state.screens[t],i=this.state.activeScreen===n;e.push(c.ReactBEM.createElement(n,{ref:t+"Screen",app:this,visible:i}))}return e}},{key:"render",value:function(){return c.ReactBEM.transform(c.ReactBEM.createElement("div",{bem:"b:editor"},c.ReactBEM.createElement(O.default,{modalManager:S.default.instance}),this._renderScreens()))}}]),t}(c.React.Component);t.default=P,P.childContextTypes={ui:c.PropTypes.object.isRequired,mediator:c.PropTypes.object.isRequired,options:c.PropTypes.object.isRequired},P.propTypes={ui:c.PropTypes.object.isRequired,mediator:c.PropTypes.object.isRequired,options:c.PropTypes.object.isRequired}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=n(8),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s.state={progress:0},s._preloader=s.context.ui.getPreloader(),s._preloader.on("progress",function(e){s.state.progress=e}),s._preloader.on("done",function(){s.props.app.switchToScreen("post-loading")}),s}return o(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var n=window,i=n.devicePixelRatio;this._canvas=this.refs.canvas,this._canvas.width=this._canvas.offsetWidth*i,this._canvas.height=this._canvas.offsetHeight*i,this._context=this._canvas.getContext("2d"),this._preloaderImage=new window.Image,this._preloaderImage.addEventListener("load",function(){e._preloader.load(),(0,l.requestAnimationFrame)(e._tick)}),this._preloaderImage.crossOrigin="Anonymous",this._preloaderImage.src=this.context.ui.getAssetPath("preloader.png",!0),this._running=!0,this._tick=this._tick.bind(this)}},{key:"componentWillUnmount",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this),this._running=!1}},{key:"_tick",value:function(){this._renderLoadingIndicator(),this._running&&(0,l.requestAnimationFrame)(this._tick)}},{key:"_renderLoadingIndicator",value:function(){var e=this._canvas,t=e.width,n=e.height,i=this._context;i.clearRect(0,0,t,n),i.save(),i.beginPath(),i.moveTo(t/2,n/2),i.arc(t/2,n/2,t/2,.5*-Math.PI,2*Math.PI*this.state.progress-.5*Math.PI,!1),i.lineTo(t/2,n/2),i.clip(),i.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,t,n),i.restore(),i.save(),i.globalAlpha=.05,i.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,t,n),i.restore()}},{key:"_renderScreen",value:function(){return l.ReactBEM.createElement("div",{bem:"$b:loadingScreen"},l.ReactBEM.createElement("div",{bem:"e:container"},l.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"})))}}]),t}(u.default);t.default=f,f.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onCloseClick"),s}return o(t,e),a(t,[{key:"_onCloseClick",value:function(){this.context.mediator.emit(s.Constants.EVENTS.CLOSE)}},{key:"renderWithBEM",value:function(){var e=void 0;return this.context.options.showCloseButton&&(e=s.ReactBEM.createElement("div",{bem:"$e:close",onClick:this._onCloseClick},s.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("close.png",!0)}))),s.ReactBEM.createElement("div",{bem:"$b:header"},s.ReactBEM.createElement("div",{bem:"e:label"},this.context.options.title),e)}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(8),u=i(c),f=n(84),p=i(f),h=n(88),d=i(h),_=n(89),m=i(_),y=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._bindAll("_onWebcamClick","_onPhotoRollClick","_onImage"),e}return a(t,e),s(t,[{key:"_onPhotoRollClick",value:function(){this.props.app.switchToScreen("photoRoll")}},{key:"_onWebcamClick",value:function(){this.props.app.switchToScreen("webcam")}},{key:"_onImage",value:function(e){this.props.app.setImage(e)}},{key:"_isWebcamAvailable",value:function(){return!l.Utils.isMobile()&&!1!==this.context.options.enableWebcam}},{key:"_isPhotoRollAvailable",value:function(){return!!this.context.options.photoRoll.provider}},{key:"_renderScreen",value:function(){var e=[],t=0,n=this.context.options.enableUpload;n&&t++;var i=this._isWebcamAvailable();i&&t++;var r=this._isPhotoRollAvailable();return r&&t++,n&&e.push(l.ReactBEM.createElement(p.default,{onImage:this._onImage,totalRows:t})),i&&e.push(l.ReactBEM.createElement(d.default,{onClick:this._onWebcamClick,totalRows:t})),r&&e.push(l.ReactBEM.createElement(m.default,{onClick:this._onPhotoRollClick,totalRows:t})),l.ReactBEM.createElement("div",{bem:"$b:splashScreen"},l.ReactBEM.createElement("div",{bem:"e:container"},e))}}]),t}(u.default);t.default=y,y.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(0),u=n(1),f=i(u),p=n(23),h=i(p),d=n(85),_=i(d),m=n(24),y=i(m),g=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._modifier="upload",e._bindAll("_onImage","_onDragEnter","_onDragOver","_onDragLeave","_onDrop"),e._dragCounter=0,e.state={dragAreaHovered:!1},e}return a(t,e),l(t,[{key:"_onDragEnter",value:function(e){e.preventDefault(),this._dragCounter++,this.setState({dragAreaHovered:!0})}},{key:"_onDragOver",value:function(e){e.preventDefault()}},{key:"_onDragLeave",value:function(e){e.preventDefault(),0===--this._dragCounter&&this.setState({dragAreaHovered:!1})}},{key:"_onDrop",value:function(e){var t=this;e.stopPropagation(),e.preventDefault(),e=e.nativeEvent,e.returnValue=!1,this.setState({dragAreaHovered:!1},function(){if(e.dataTransfer)return e.dataTransfer.files[0].type.match(/^image\//i)?void t._handleFile(e.dataTransfer.files[0]):f.default.instance.displayError(t._t("errors.title"),t._t("errors.invalidFileType.text",{fileType:e.dataTransfer.files[0].type}))})}},{key:"_onClick",value:function(e){this.refs.upload.open()}},{key:"_handleFile",value:function(e){var t=this,n=new window.FileReader;n.onload=function(){return function(e){var n=e.target.result,i=new window.Image;i.addEventListener("load",function(){t._onImage(i)}),i.src=n}}(),n.readAsDataURL(e)}},{key:"_onImage",value:function(e){this.props.onImage&&this.props.onImage(e)}},{key:"_renderContent",value:function(){var e={onDragEnter:this._onDragEnter,onDragOver:this._onDragOver,onDragLeave:this._onDragLeave,onDrop:this._onDrop};this.state.dragAreaHovered&&(e.className="is-hovered");var t="e:contentCell";return!1===this.context.options.enableWebcam&&null===this.context.options.photoRoll.provider||(t+=" m:withBorder"),c.ReactBEM.createElement("div",{bem:"e:contentWrapper"},c.ReactBEM.createElement("div",{bem:"e:contentRow"},c.ReactBEM.createElement("div",s({bem:t,onClick:this._onClick},e),c.ReactBEM.createElement(y.default,{ref:"upload",onNewFile:this._onImage}),c.ReactBEM.createElement(_.default,{bem:"e:button",uppercase:!0},this._t("splash.upload.button")),c.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.upload.description")))))}}]),t}(h.default);t.default=g,g.propTypes={onImage:c.PropTypes.func.isRequired},g.contextTypes=h.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"renderWithBEM",value:function(){var e="b:button";return this.props.uppercase&&(e+=" m:uppercase"),s.ReactBEM.createElement("button",{bem:e,className:this.props.className,onClick:this.props.onClick},this.props.children)}}]),t}(s.BaseComponent);t.default=l,l.propTypes={onClick:s.PropTypes.func,children:s.PropTypes.any.isRequired,className:s.PropTypes.string},l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(87),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._input=e,n._onFileChange=n._onFileChange.bind(n),n._input.addEventListener("change",n._onFileChange),n}return o(t,e),a(t,[{key:"open",value:function(){this._input.value=null,this._input.click()}},{key:"_handleFile",value:function(e){var t=this,n=new window.FileReader;n.onload=function(){return function(e){var n=e.target.result,i=new window.Image;i.addEventListener("load",function(){t.emit("file",i)}),i.addEventListener("error",function(e){return c.default.instance.displayError(t._t("errors.title"),t._t("errors.imageLoadingError.text"))}),i.src=n}}(),n.readAsDataURL(e)}},{key:"_onFileChange",value:function(){var e=this._input.files;e.length&&this._handleFile(e[0])}},{key:"dispose",value:function(){this._input.removeEventListener("change",this._onFileChange)}}]),t}(s.EventEmitter);t.default=u},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(e,n,o){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i(this,t);var l=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return l.id=s.SDKUtils.getUUID(),l.type=e,l.title=n,l.text=o,l.overlay=a,l.visible=!0,l.data=null,l}return o(t,e),a(t,[{key:"setData",value:function(e){this.data=e,this.emit("update")}},{key:"close",value:function(){this.visible=!1,this.emit("close")}},{key:"remove",value:function(){this.emit("remove")}}]),t}(s.EventEmitter),c=function(e){function t(){i(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._modals=[],e}return o(t,e),a(t,[{key:"displayLoading",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new l("loading",e,null,t);return this.addModal(n),n}},{key:"displayProgress",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new l("progress",null,e);return n.setData({progress:t}),this.addModal(n),n}},{key:"displayWarning",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["OK"],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=new l("warning",e,t,i);return r.setData({buttons:n}),this.addModal(r),r}},{key:"displayError",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=new l("error",e,t,n);return this.addModal(i),i}},{key:"addModal",value:function(e){var t=this;this._modals.push(e),e.on("close",function(){t.emit("update")}),e.on("remove",function(){t.removeModal(e)}),e.on("update",function(){t.emit("update")}),this.emit("update")}},{key:"removeModal",value:function(e){var t=this._modals.indexOf(e);this._modals.splice(t,1),this.emit("update")}},{key:"getModals",value:function(){return this._modals}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}(s.EventEmitter);t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(23),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._needsStyleFixes=!0,s._modifier="webcam",s}return o(t,e),a(t,[{key:"fixStyles",value:function(){if(s.Utils.Browser.isIElte(11)){var e=this.refs,t=e.cell,n=e.overlay,i=t.offsetHeight;n.style.height=i+"px"}}},{key:"_renderContent",value:function(){var e={backgroundImage:"url("+this._getAssetPath("splash/webcam.png",!0,!0)+")"};return s.ReactBEM.createElement("div",{bem:"e:contentWrapper"},s.ReactBEM.createElement("div",{bem:"e:contentRow"},s.ReactBEM.createElement("div",{bem:"e:contentCell",onClick:this._onClick,style:e,ref:"cell"},s.ReactBEM.createElement("div",{bem:"e:overlay",ref:"overlay"}),s.ReactBEM.createElement("div",{bem:"e:headline"},this._t("splash.webcam.headline")),s.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.webcam.description")))))}}]),t}(c.default);t.default=u,u.contextTypes=c.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(23),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._needsStyleFixes=!0,s._modifier="photoRoll",s}return o(t,e),a(t,[{key:"fixStyles",value:function(){if(s.Utils.Browser.isIElte(11)){var e=this.refs,t=e.cell,n=e.overlay,i=t.offsetHeight;n.style.height=i+"px"}}},{key:"_renderContent",value:function(){var e={backgroundImage:"url("+this._getAssetPath("splash/photo-roll.png",!0,!0)+")"};return s.ReactBEM.createElement("div",{bem:"e:contentWrapper"},s.ReactBEM.createElement("div",{bem:"e:contentRow"},s.ReactBEM.createElement("div",{bem:"e:contentCell",onClick:this._onClick,style:e,ref:"cell"},s.ReactBEM.createElement("div",{bem:"e:overlay",ref:"overlay"}),s.ReactBEM.createElement("div",{bem:"e:headline"},this._t("splash.photoRoll.headline")),s.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.photoRoll.description")))))}}]),t}(c.default);t.default=u,u.contextTypes=c.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(8),u=i(c),f=n(91),p=i(f),h=n(95),d=i(h),_=n(40),m=i(_),y=n(98),g=i(y),v=n(1),b=i(v),k=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s.state={section:"overview",sectionsHistory:[]},s._bindAll("_onLibraryClicked","_onSearchSuggestionClicked","_onPhotoClicked","_onFileUpload","_onWebcamClick","_onBackClicked","_onSearch"),s}return a(t,e),s(t,[{key:"hasPreviousSection",value:function(){return!!this.state.sectionsHistory.length}},{key:"switchToSection",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("back"===e){if(!this.hasPreviousSection())return t?this.props.app.switchToScreen("back"):this.switchToSection("overview");e=this.state.sectionsHistory.pop()}else this.state.section!==e&&n&&this.state.sectionsHistory.push(this.state.section);this.setState({section:e})}},{key:"_onLibraryClicked",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.state.library=e,this.switchToSection("library",!0,!t)}},{key:"_onSearchSuggestionClicked",value:function(e){this.state.searchQuery=e.query,this.switchToSection("search")}},{key:"_onPhotoClicked",value:function(e){var t=this,n=b.default.instance.displayLoading(this._t("loading.loading")),i=new window.Image;i.addEventListener("load",function(){n.close(),t.props.app.setImage(i,!0)}),i.addEventListener("error",function(){n.close(),b.default.instance.displayError(t._t("errors.imageLoadFail.title"),t._t("errors.imageLoadFail.text",{path:i.src}))}),i.crossOrigin="Anonymous",i.src=e.urls.raw}},{key:"_onBackClicked",value:function(){this.switchToSection("back")}},{key:"_onSearch",value:function(e){if(!e.trim().length)return this.state.searchQuery=null,this.switchToSection("back",!1);this.state.searchQuery=e,this.switchToSection("search")}},{key:"_onWebcamClick",value:function(){this.props.app.switchToScreen("webcam")}},{key:"_onFileUpload",value:function(e){this.props.app.setImage(e)}},{key:"_isBackButtonVisible",value:function(){return 0!==this.state.sectionsHistory.length||this.props.app.hasPreviousScreen()}},{key:"_renderContent",value:function(){switch(this.state.section){case"search":return l.ReactBEM.createElement(g.default,{query:this.state.searchQuery,onPhotoClicked:this._onPhotoClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked});case"library":return l.ReactBEM.createElement(m.default,{library:this.state.library,onPhotoClicked:this._onPhotoClicked});case"overview":return l.ReactBEM.createElement(d.default,{onLibraryClicked:this._onLibraryClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked})}}},{key:"_renderScreen",value:function(){var e=this._renderContent();return l.ReactBEM.createElement("div",{bem:"$b:photoRollScreen"},l.ReactBEM.createElement(p.default,{onBackClicked:this._onBackClicked,onSearch:this._onSearch,searchQuery:this.state.searchQuery,onFileUpload:this._onFileUpload,onWebcamClick:this._onWebcamClick,backButton:this._isBackButtonVisible(),backButtonLabel:this._t("generic.back"),ref:"topBarControls"}),e)}}]),t}(u.default);t.default=k,k.childContextTypes={ui:l.PropTypes.object.isRequired,editor:l.PropTypes.object.isRequired,mediator:l.PropTypes.object.isRequired,options:l.PropTypes.object.isRequired,editorScreen:l.PropTypes.object.isRequired},k.contextTypes=u.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(12),u=i(c),f=n(92),p=i(f),h=n(24),d=i(h),_=n(93),m=i(_),y=n(94),g=i(y),v=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._bindAll("_onUploadButtonClicked","_onWebcamButtonClicked","_onBackClicked","_onSearchValueChange","_onNewFile"),s._onSearchValueChange=l.Utils.debounce(s._onSearchValueChange,250),s}return a(t,e),s(t,[{key:"_onBackClicked",value:function(){this.props.onBackClicked&&this.props.onBackClicked()}},{key:"_onSearchValueChange",value:function(e){this.props.onSearch&&this.props.onSearch(e)}},{key:"_onUploadButtonClicked",value:function(){this.refs.upload.open()}},{key:"_onWebcamButtonClicked",value:function(){this.props.onWebcamClick&&this.props.onWebcamClick()}},{key:"_onNewFile",value:function(e){this.props.onFileUpload&&this.props.onFileUpload(e)}},{key:"_isWebcamAvailable",value:function(){return!l.Utils.isMobile()&&!1!==this.context.options.enableWebcam}},{key:"_renderRightButtons",value:function(){var e=this.context.options,t=[];return e.enableUpload&&t.push(l.ReactBEM.createElement(p.default,{icon:this._getAssetPath("photo-roll/upload.png",!0),onClick:this._onUploadButtonClicked})),this._isWebcamAvailable()&&t.push(l.ReactBEM.createElement(p.default,{icon:this._getAssetPath("photo-roll/webcam.png",!0),onClick:this._onWebcamButtonClicked})),t}},{key:"renderWithBEM",value:function(){var e=void 0;return this.props.backButton&&(e=l.ReactBEM.createElement(g.default,{label:this.props.backButtonLabel,onClick:this._onBackClicked})),l.ReactBEM.createElement("div",{bem:"$b:topBar e:row"},l.ReactBEM.createElement("div",{bem:"e:cell"},l.ReactBEM.createElement("div",{bem:"e:table"},l.ReactBEM.createElement("div",{bem:"e:cell m:left"},e),l.ReactBEM.createElement("div",{bem:"e:cell m:fullWidth"},l.ReactBEM.createElement(m.default,{searchQuery:this.props.searchQuery,onChange:this._onSearchValueChange}),l.ReactBEM.createElement(d.default,{onNewFile:this._onNewFile,ref:"upload"})),l.ReactBEM.createElement("div",{bem:"e:cell m:right"},this._renderRightButtons()))))}}]),t}(u.default);t.default=v,v.contextTypes=u.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("bem",{specifier:"$b:topBar"},s.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this.props.onClick},s.ReactBEM.createElement("img",{bem:"e:icon",src:this.props.icon})))}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onFocus","_onBlur","_onChange","_onBarClick"),s.state={active:!1,placeholder:s._t("photoRoll.search.placeholder"),value:s.props.searchQuery||""},s}return o(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){e.searchQuery||this.state.value?this.state.active=!0:this.state.active=!1,this.setState({value:e.searchQuery||""})}},{key:"componentDidUpdate",value:function(){this.refs.input.value=this.state.value}},{key:"componentDidMount",value:function(){var e=this;s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._hiddenInputDummy=document.createElement("div");var n=l.Utils.getStyleObject(this.refs.input);["font","lineHeight","textAlign","textIndent","textTransform","textDecoration","textRendering","textShadow","textOverflow","wordSpacing","letterSpacing","whiteSpace"].forEach(function(t){e._hiddenInputDummy.style[t]=n[t]}),this._hiddenInputDummy.style.position="absolute",this._hiddenInputDummy.style.top="-9999px",this._hiddenInputDummy.style.left="-9999px",this.refs.root.appendChild(this._hiddenInputDummy),this._updateInputWidth()}},{key:"_updateInputWidth",value:function(){var e=this;this._hiddenInputDummy.innerHTML=this.state.value||this.state.placeholder,setTimeout(function(){e.setState({inputWidth:e._hiddenInputDummy.offsetWidth+5})},0)}},{key:"_onBarClick",value:function(){this.refs.input.focus()}},{key:"_onFocus",value:function(){this.setState({active:!0})}},{key:"_onBlur",value:function(){""!==this.state.value||this.props.searchQuery||this.setState({active:!1})}},{key:"_onChange",value:function(e){this.state.value=e.target.value,this.forceUpdate(),this.props.onChange&&this.props.onChange(this.state.value)}},{key:"renderWithBEM",value:function(){var e="$e:searchBar",t="photo-roll/search-light.png";this.state.active&&(e+=" m:active",t="photo-roll/search-dark.png"),t=this._getAssetPath(t,!0);var n={width:this.state.inputWidth+"px"};return l.ReactBEM.createElement("bem",{specifier:"$b:photoRollScreen"},l.ReactBEM.createElement("div",{bem:e,ref:"root",onClick:this._onBarClick},l.ReactBEM.createElement("div",{bem:"e:content"},l.ReactBEM.createElement("div",{bem:"$e:icon"},l.ReactBEM.createElement("img",{src:t,bem:"e:image"})),l.ReactBEM.createElement("div",{bem:"e:inputContainer"},l.ReactBEM.createElement("input",{bem:"e:input",ref:"input",placeholder:this.state.placeholder,onBlur:this._onBlur,onFocus:this._onFocus,onChange:this._onChange,defaultValue:this.state.value,style:n})))))}}]),t}(l.BaseComponent);t.default=c,c.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("bem",{specifier:"$b:topBar"},s.ReactBEM.createElement("div",{bem:"$e:backButton",onClick:this.props.onClick},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("top-bar/back.png",!0)}),s.ReactBEM.createElement("div",{bem:"e:label"},this.props.label)))}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},u=n(0),f=n(1),p=i(f),h=n(96),d=i(h),_=n(39),m=i(_),y=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));s._needsStyleFixes=!0,s.state={loading:!0,libraries:[],searchSuggestions:[]},s._bindAll("_onLibraryClick","_onSearchSuggestionClick");var l=s.context.options.photoRoll.provider;return s._provider=new l,s}return a(t,e),l(t,[{key:"fixStyles",value:function(){if(u.Utils.Browser.isIElte(11)){var e=this.refs,t=e.cell,n=e.container;if(!t||!n)return;var i=t.offsetHeight;n.style.height=i+"px"}}},{key:"componentDidMount",value:function(){var e=this;c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var n=p.default.instance.displayLoading(this._t("loading.loading"));this._load().then(function(t){var i=s(t,2),r=i[0],o=i[1];n.close(),1===r.length?e._onLibraryClick(r[0],!0):e.setState({loading:!1,libraries:r,searchSuggestions:o})})}},{key:"_onLibraryClick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.props.onLibraryClicked&&this.props.onLibraryClicked(e,t)}},{key:"_onSearchSuggestionClick",value:function(e){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(e)}},{key:"_load",value:function(){var e=[this._provider.getLibraries(),this._provider.getSearchSuggestions()];return u.Promise.all(e)}},{key:"_renderLibraries",value:function(){var e=this,t=this.state.libraries.map(function(t){return u.ReactBEM.createElement(d.default,{onClick:e._onLibraryClick,library:t})});return u.ReactBEM.createElement("li",{bem:"e:item"},u.ReactBEM.createElement("bem",{specifier:"b:photoRoll"},u.ReactBEM.createElement("div",{bem:"e:headline"},"Browse libraries"),u.ReactBEM.createElement("ul",{bem:"$e:libraryList"},t)))}},{key:"_renderSearchSuggestions",value:function(){var e=this;if(!this.state.searchSuggestions.length)return null;var t=this.state.searchSuggestions.map(function(t){return u.ReactBEM.createElement(m.default,{onClick:e._onSearchSuggestionClick,searchSuggestion:t})});return u.ReactBEM.createElement("li",{bem:"e:item"},u.ReactBEM.createElement("bem",{specifier:"b:photoRoll"},u.ReactBEM.createElement("div",{bem:"e:headline"},"Search suggestions"),u.ReactBEM.createElement("ul",{bem:"$e:libraryList"},t)))}},{key:"_renderContent",value:function(){return u.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},u.ReactBEM.createElement("div",{bem:"e:cell",ref:"cell"},u.ReactBEM.createElement("div",{bem:"e:container",ref:"container"},u.ReactBEM.createElement("div",{bem:"e:innerContainer"},u.ReactBEM.createElement("ul",{bem:"$e:groupList"},this._renderLibraries(),this._renderSearchSuggestions())))))}},{key:"renderWithBEM",value:function(){return this.state.loading?u.ReactBEM.createElement("div",null):this._renderContent()}}]),t}(u.BaseComponent);t.default=y,y.contextTypes=u.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onClick"),s}return o(t,e),a(t,[{key:"_onClick",value:function(){this.props.onClick&&this.props.onClick(this.props.library)}},{key:"renderWithBEM",value:function(){var e=this.props.library,t={backgroundImage:"url("+e.coverImage+")"};return s.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:libraryList"},s.ReactBEM.createElement("li",{bem:"e:item",style:t,onClick:this._onClick},s.ReactBEM.createElement("div",{bem:"e:overlay"}),s.ReactBEM.createElement("div",{bem:"e:name"},e.name)))}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"renderWithBEM",value:function(){var e=this.props.photo;return s.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:photoList"},s.ReactBEM.createElement("li",{bem:"$e:item",onClick:this.props.onClick},s.ReactBEM.createElement("div",{bem:"e:overlay"}),s.ReactBEM.createElement("div",{bem:"e:title"},e.title),s.ReactBEM.createElement("img",{bem:"e:image",src:e.urls.thumb})))}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(40),u=i(c),f=n(99),p=i(f),h=n(1),d=i(h),_=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){e.query!==this.props.query&&this._loadPhotos(e.query)}},{key:"_getHeadline",value:function(){return this._t("photoRoll.search.results.headline",{query:this.props.query})}},{key:"_loadPhotos",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.query;this._totalPhotosHeight=0;var n=d.default.instance.displayProgress(this._t("loading.loading"));(new(0,this.context.options.photoRoll.provider)).searchPhotos(t).then(function(t){return e._preloadPhotos(t,n)}).then(function(t){e.setState({photos:t,loading:!1}),n.close()})}},{key:"_renderNotFound",value:function(){return l.ReactBEM.createElement(p.default,{query:this.props.query,onSearchSuggestionClicked:this.props.onSearchSuggestionClicked})}},{key:"renderWithBEM",value:function(){return this.state.loading?l.ReactBEM.createElement("div",null):0===this.state.photos.length?this._renderNotFound():this._renderPhotos()}}]),t}(u.default);t.default=_,_.contextTypes=u.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=n(39),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));s._bindAll("_onSearchSuggestionClick");var l=s.context.options.photoRoll.provider;return s._provider=new l,s.state={searchSuggestions:[]},s}return o(t,e),a(t,[{key:"_onSearchSuggestionClick",value:function(e){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(e)}},{key:"componentDidMount",value:function(){var e=this;s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._provider.getSearchSuggestions().then(function(t){e.setState({searchSuggestions:t})})}},{key:"_renderMessage",value:function(){return{__html:this._t("photoRoll.search.noSearchResults",{query:this.props.query})}}},{key:"_renderSearchSuggestions",value:function(){var e=this;if(!this.state.searchSuggestions.length)return null;var t=this.state.searchSuggestions.map(function(t){return l.ReactBEM.createElement(u.default,{onClick:e._onSearchSuggestionClick,searchSuggestion:t})});return l.ReactBEM.createElement("div",null,l.ReactBEM.createElement("div",{bem:"e:headline"},"Search suggestions"),l.ReactBEM.createElement("ul",{bem:"$e:libraryList"},t))}},{key:"renderWithBEM",value:function(){return l.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},l.ReactBEM.createElement("div",{bem:"e:cell"},l.ReactBEM.createElement("div",{bem:"e:container"},l.ReactBEM.createElement("div",{bem:"e:innerContainer"},l.ReactBEM.createElement("div",{bem:"e:noSearchResults",dangerouslySetInnerHTML:this._renderMessage()}),this._renderSearchSuggestions()))))}}]),t}(l.BaseComponent);t.default=f,f.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(8),u=i(c),f=n(12),p=i(f),h=n(101),d=i(h),_=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._bindAll("_onCancel","_onWebcamReady","_onShutterClicked"),e.state={webcamReady:!1},e}return a(t,e),s(t,[{key:"_onWebcamReady",value:function(){this.setState({webcamReady:!0})}},{key:"_onCancel",value:function(){this.props.app.switchToScreen("back")}},{key:"_onShutterClicked",value:function(){var e=this;this.refs.webcam.makePhoto().then(function(t){e.props.app.setImage(t)}).catch(function(e){l.Log.error(e)})}},{key:"_renderScreen",value:function(){return l.ReactBEM.createElement("div",{bem:"$b:webcamScreen"},l.ReactBEM.createElement(p.default,{label:this._t("webcam.headline")},l.ReactBEM.createElement("bem",{specifier:"$b:topBar"},l.ReactBEM.createElement("div",{bem:"e:cancelButton",onClick:this._onCancel},this._t("generic.cancel")),l.ReactBEM.createElement("div",{bem:"e:label"},this._t("webcam.headline")))),l.ReactBEM.createElement("div",{bem:"$b:canvas e:container e:row"},l.ReactBEM.createElement("div",{bem:"e:container e:cell"},l.ReactBEM.createElement(d.default,{ref:"webcam",onReady:this._onWebcamReady,onBack:this._onCancel}))),l.ReactBEM.createElement("div",{bem:"$b:controls $e:container e:row"},l.ReactBEM.createElement("div",{bem:"e:cell"},l.ReactBEM.createElement("bem",{specifier:"b:webcamScreen"},l.ReactBEM.createElement("div",{bem:"$e:shutterButton",onClick:this._onShutterClicked,className:!!this.state.webcamReady&&"is-active"},l.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/webcam/shutter.png",!0)}))))))}}]),t}(u.default);t.default=_,_.contextTypes=u.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(1),u=i(c),f=n(102),p=i(f),h=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._bindAll("_onWebcamReady","_onWebcamError"),e.state={webcamReady:!1},e}return a(t,e),s(t,[{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"_onWebcamReady",value:function(){this.props.onReady&&this.props.onReady(),this.setState({webcamReady:!0})}},{key:"_onWebcamError",value:function(e){var t=this;u.default.instance.displayError(this._t("errors.title"),this._t("errors.webcamUnavailable.text",{error:e})).on("close",function(){return t.props.onBack()})}},{key:"makePhoto",value:function(){if(this.state.webcamReady)return this._webcam.capture()}},{key:"renderWithBEM",value:function(){var e=this;return l.ReactBEM.createElement("div",{bem:"$b:webcam",ref:"container"},l.ReactBEM.createElement(p.default,{flashURL:this._getAssetPath("fallback/webcam.swf"),ref:function(t){e._webcam=t},onWebcamError:this._onWebcamError,onWebcamAvailable:this._onWebcamReady}))}}]),t}(l.BaseComponent);t.default=h,h.propTypes={onReady:l.PropTypes.func},h.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._bindAll("_onLoadedMetadata"),n.state={webcamAvailable:!1,useFlashFallback:!1,containerWidth:null,containerHeight:null},n._getUserMedia=null,n._webcamStream=null,n}return o(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;if(this._initGetUserMedia(),this._calculateFlashDimensions(),this._getUserMedia)this._getUserMedia({video:{optional:[{minWidth:320},{minWidth:640},{minWidth:1024},{minWidth:1280},{minWidth:1920},{minWidth:2560}]},audio:!1}).then(function(t){e._webcamStream=t;var n=e._videoElement;"srcObject"in n?n.srcObject=t:n.src=window.URL.createObjectURL(t)}).catch(function(t){e.props.onWebcamError&&e.props.onWebcamError(t)});else{var t=!1;window.Webcam||(window.Webcam={},t=!0),window.Webcam.flashNotify=function(n,i){switch(n){case"cameraLive":e.setState({webcamAvailable:!0},function(){e.props.onWebcamAvailable&&e.props.onWebcamAvailable()}),delete window.Webcam.flashNotify,t&&delete window.Webcam;break;case"error":e.props.onWebcamError&&e.props.onWebcamError(i),delete window.Webcam.flashNotify,t&&delete window.Webcam}}}}},{key:"componentWillUnmount",value:function(){this._disposeWebcam()}},{key:"_initGetUserMedia",value:function(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&(this._getUserMedia=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices)),!this._getUserMedia){var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;e&&(this._getUserMedia=function(t){return new Promise(function(n,i){return e.call(navigator,t,n,i)})})}this._getUserMedia||this.setState({useFlashFallback:!0})}},{key:"_disposeWebcam",value:function(){if(this._webcamStream){var e=this._webcamStream,t=e.getTracks()[0];t?t.stop():e.stop&&e.stop()}else this._flashWebcam&&this._flashWebcam._releaseCamera()}},{key:"capture",value:function(){var e=this;return this.state.webcamAvailable?this._videoElement&&!this._flashWebcam?new Promise(function(t,n){var i=e._videoElement;if(0===i.readyState)n(new Error("Webcam video not available"));else{var r=document.createElement("canvas");r.width=i.videoWidth,r.height=i.videoHeight;r.getContext("2d").drawImage(i,0,0);var o=new window.Image;o.addEventListener("load",function(){t(o)}),o.src=r.toDataURL("image/jpeg")}}):this._flashWebcam?new Promise(function(t,n){var i=e._flashWebcam._snap(),r=new Image;r.onload=function(){t(r)},r.src="data:image/jpeg;base64,"+i}):Promise.reject(new Error("Webcam video not available")):Promise.reject(new Error("Webcam video not available"))}},{key:"_getIEHeight",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=this._container,n=0;n<1e3&&!(t.clientHeight>e)&&t.parentNode;n++)t=t.parentNode;return t.clientHeight>e?t.clientHeight:null}},{key:"_calculateFlashDimensions",value:function(){var e=.9*(this._getIEHeight()||window.innerHeight),t=4/3*e||640,n=e||480;this.setState({containerWidth:t,containerHeight:n})}},{key:"_getFlashFallbackComponent",value:function(){var e=this,t=this.state.containerWidth||640,n=this.state.containerHeight||480,i="width="+t+"&height="+n+"&dest_width=1024&dest_height=768&jpeg_quality=100&fps=24";return React.createElement("object",{classID:"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000",type:"application/x-shockwave-flash",width:t,height:n,ref:function(t){e._flashWebcam=t},align:"middle"},React.createElement("param",{name:"wmode",value:"transparent"}),React.createElement("param",{name:"allowScriptAccess",value:"always"}),React.createElement("param",{name:"allowFullScreen",value:"false"}),React.createElement("param",{name:"movie",value:this.props.flashURL}),React.createElement("param",{name:"loop",value:"false"}),React.createElement("param",{name:"menu",value:"false"}),React.createElement("param",{name:"quality",value:"best"}),React.createElement("param",{name:"bgcolor",value:"#ffffff"}),React.createElement("param",{name:"flashvars",value:i}))}},{key:"_onLoadedMetadata",value:function(){var e=this;this.setState({webcamAvailable:!0},function(){e.props.onWebcamAvailable&&e.props.onWebcamAvailable()})}},{key:"render",value:function(){var e=this,t=this.state.useFlashFallback?this._getFlashFallbackComponent():React.createElement("video",{style:{width:"100%"},autoPlay:!0,ref:function(t){e._videoElement=t},onLoadedMetadata:this._onLoadedMetadata});return React.createElement("div",{style:{width:this.state.useFlashFallback?this.state.containerWidth:"100%",height:this.state.useFlashFallback?this.state.containerHeight:"100%",display:"block",margin:"auto",overflow:"hidden"},ref:function(t){e._container=t}},t)}}]),t}(s.BaseComponent);t.default=l,l.propTypes={flashURL:s.PropTypes.string,onWebcamAvailable:s.PropTypes.func,onWebcamError:s.PropTypes.func}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(41),f=i(u),p=n(8),h=i(p),d=n(106),_=i(d),m=n(1),y=i(m),g=n(107),v=i(g),b=n(42),k=i(b),w=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._overviewControls=f.default,s._bindAll("switchToControls","_startEditor","_onWindowResize","_onWindowResizeDone","_onImageResize","_onNewImage","_onRenderError"),s._previousControlsStack=[],s.state={zoom:null,controls:v.default,dragEnabled:!0,sharedState:new c.SharedState},s._editor=new k.default(s.context.ui,s.context.options,s.context.mediator),s._editor.on("new-image",s._onNewImage),s._editor.on("ready",s._startEditor),s._editor.on("resize",s._onImageResize),s._editor.on("render-error",s._onRenderError),s._forceControls=s.context.options.editor.forceControls,s._forceControlIndex=0,s}return a(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var n=this.context.options.editor.image;this.setImage(n),this._editor.render(),this._editor.on("ready",function(){e._switchToNextForceControl()}),this.context.options.responsive&&window.addEventListener("resize",this._onWindowResize)}},{key:"componentWillUnmount",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this),this._editor.dispose(),this.context.options.responsive&&window.removeEventListener("resize",this._onWindowResize)}},{key:"_startEditor",value:function(){this._editor.start()}},{key:"_switchToNextForceControl",value:function(){if(this._forceControlIndex<this._forceControls.length){var e=this._forceControls[this._forceControlIndex],t=e.control,n=e.options,i=this._editor.controls.getAvailable(),r=i[t],o=c.SDKUtils.defaults({forcedControl:!0},n);if(!r)throw new Error("Force controls: Could not find control with identifier `"+t+"`");this.switchToControls(r,{},null,o),this._forceControlIndex++}}},{key:"_onRenderError",value:function(e){y.default.instance.displayError(this._t("errors.renderingError.title"),this._t("errors.renderingError.text"),!0),c.Log.error(this.constructor.name,"An error occurred while rendering: "+e.message),c.Log.printError(e)}},{key:"_onNewImage",value:function(){this.switchToControls(v.default)}},{key:"_onImageResize",value:function(){var e=this,t=y.default.instance.displayLoading(this._t("loading.resizing"));this._editor.once("resized",function(n){var i=n.dimensions,r=n.reason;t.close(),e.context.options.editor.displayResizeMessage&&y.default.instance.displayWarning(e._t("warnings.imageResized_"+r+".title"),e._t("warnings.imageResized_"+r+".text",{maxMegaPixels:e._editor.getMaxMegapixels(),width:i.x,height:i.y}))})}},{key:"_onWindowResize",value:function(){this._resizeTimeout&&(window.clearTimeout(this._resizeTimeout),this._resizeTimeout=null),this._resizeTimeout=window.setTimeout(this._onWindowResizeDone,500)}},{key:"_onWindowResizeDone",value:function(){this._emitEvent(c.Constants.EVENTS.WINDOW_RESIZE)}},{key:"switchToControls",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=null;if("back"===e)r=this._previousControlsStack.pop();else if("home"===e||e===v.default){if(this._forceControlIndex<this._forceControls.length)return this._switchToNextForceControl();r=v.default,this._previousControlsStack=[]}else r=e,this._previousControlsStack.push(this.state.controls);var o=this.state.controls!==r;this.state.controls.onExit&&this.state.controls.onExit.call(this.refs.controls),this.state.sharedState.clear(),this.state.sharedState.set(t,!1);var a=c.SDKUtils.defaults(c.SDKUtils.defaults(i,this.context.options.editor.controlsOptions[r.identifier]),r.defaultOptions);if(r.onEnter&&r.onEnter.call(this.refs.controls,this.state.sharedState,a),!o)return n&&n();this.setState({controls:r,controlsOptions:a},n)}},{key:"getZoom",value:function(){return this.state.zoom}},{key:"export",value:function(){for(var e=this,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return new Promise(function(t,i){e.switchToControls("home",{},function(){var r;(r=e._editor).export.apply(r,n).then(t).catch(i)})})}},{key:"getEditor",value:function(){return this._editor}},{key:"serialize",value:function(){var e;return(e=this._editor).serialize.apply(e,arguments)}},{key:"deserialize",value:function(e){return this._editor.deserialize(e)}},{key:"_showUndoButton",value:function(){return this._editor.history.isAvailable()}},{key:"getChildContext",value:function(){return{editor:this._editor,ui:this.context.ui,options:this.context.options,editorScreen:this,mediator:this.context.mediator}}},{key:"setImage",value:function(e,t){this._forceControlIndex=0,this._editor.setImage(e,t)}},{key:"_renderScreen",value:function(){var e=this.state.controls.controlsComponent,t=this.state.controls.canvasControlsComponent;t||(t=v.default.canvasControlsComponent);var n=this.state.controls.topBarControlsComponent;n||(n=v.default.topBarControlsComponent);var i=void 0,r=void 0,o=void 0;n&&this.context.options.showTopBar&&(o=c.ReactBEM.createElement(n,{sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,ref:"topBarControls"})),e&&(i=c.ReactBEM.createElement(e,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+"-controls",ref:"controls"})),t&&(r=c.ReactBEM.createElement(t,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+"-canvasControls",ref:"canvasControls"}));var a="$b:editorScreen";return this.context.options.showHeader||(a+=" m:noHeader"),c.ReactBEM.createElement("div",{bem:a},o,c.ReactBEM.createElement(_.default,{ref:"canvas",largeControls:this.state.controls.largeCanvasControls},r),c.ReactBEM.createElement("div",{bem:"$b:controls $e:container e:row"},c.ReactBEM.createElement("div",{bem:"e:cell"},i)))}}]),t}(h.default);t.default=w,w.childContextTypes={ui:c.PropTypes.object.isRequired,editor:c.PropTypes.object.isRequired,mediator:c.PropTypes.object.isRequired,options:c.PropTypes.object.isRequired,editorScreen:c.PropTypes.object.isRequired},w.contextTypes=h.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("bem",{specifier:"$b:controls"},s.ReactBEM.createElement("div",{bem:"e:cell m:largeButton"},s.ReactBEM.createElement("div",{bem:"$e:largeButton",onClick:this.props.onClick},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/back.png",!0)}))))}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("bem",{specifier:"$b:controls"},s.ReactBEM.createElement("div",{bem:"e:cell m:largeButton"},s.ReactBEM.createElement("div",{bem:"$e:largeButton",onClick:this.props.onClick},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/tick.png",!0)}))))}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=function(e){function t(){var e,n;r(this,t);for(var a=arguments.length,s=Array(a),l=0;l<a;l++)s[l]=arguments[l];var u=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s)));return u._bindAll("_onDragStart","_onDragMove","_onDragEnd","_onWindowResize","_onFeaturesUpdated","_onZoomChange"),u._events=(n={},i(n,c.Constants.EVENTS.WINDOW_RESIZE,u._onWindowResize),i(n,c.Constants.EVENTS.FEATURES_UPDATED,u._onFeaturesUpdated),n),u._initialRenderDone=!1,u.state={canvasPosition:new c.Vector2,canvasOffset:new c.Vector2},u}return a(t,e),s(t,[{key:"_onWindowResize",value:function(){var e=this.context.editor;e.getSDK().resizeTo(this._getContainerDimensions()),e.zoom.set("auto")}},{key:"_onFeaturesUpdated",value:function(e){-1!==e.indexOf("drag")&&this.forceUpdate()}},{key:"componentDidMount",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var e=this.context.editor,n=e.getRenderer(),i=this.refs,r=i.canvasCell,o=i.canvas,a=r.offsetWidth,s=r.offsetHeight;n.setCanvas(o),n.resizeTo(new c.Vector2(a,s),!0),e.zoom.on("set",this._onZoomChange)}},{key:"componentWillUnmount",value:function(){this.context.editor.zoom.off("set",this._onZoomChange)}},{key:"_onZoomChange",value:function(){this.forceUpdate()}},{key:"_onDragStart",value:function(e){var t=this.context.editor;t.features.isEnabled("drag")&&(e.preventDefault(),this._dragStartPosition=c.Utils.getEventPosition(e.nativeEvent),this._dragInitialOffset=t.getOffset().clone(),document.addEventListener("mousemove",this._onDragMove),document.addEventListener("touchmove",this._onDragMove),document.addEventListener("mouseup",this._onDragEnd),document.addEventListener("touchend",this._onDragEnd))}},{key:"_onDragMove",value:function(e){var t=c.Utils.getEventPosition(e),n=t.clone().subtract(this._dragStartPosition),i=this._dragInitialOffset.clone().add(n),r=this.context.editor,o=r.getOffset().clone();r.setOffset(i),r.getOffset().equals(o)||r.render()}},{key:"_onDragEnd",value:function(e){document.removeEventListener("mousemove",this._onDragMove),document.removeEventListener("touchmove",this._onDragMove),document.removeEventListener("mouseup",this._onDragEnd),document.removeEventListener("touchend",this._onDragEnd)}},{key:"_getContainerDimensions",value:function(){var e=this.refs.canvasCell;return new c.Vector2(e.offsetWidth,e.offsetHeight)}},{key:"_getDraggableStyle",value:function(){return{top:this.state.canvasPosition.y+this.state.canvasOffset.y,left:this.state.canvasPosition.x+this.state.canvasOffset.x}}},{key:"renderWithBEM",value:function(){var e=null,t=null;this.props.largeControls?t=this.props.children:e=this.props.children;var n=this.context.editor,i=n.isReady()&&n.zoom.get()>n.zoom.getDefault(),r=n.features.isEnabled("drag")&&i;return c.ReactBEM.createElement("div",{bem:"$b:canvas e:container e:row"},c.ReactBEM.createElement("div",{bem:"e:container e:cell",ref:"canvasCell"},c.ReactBEM.createElement("div",{bem:"e:innerContainer",className:r?"is-draggable":null,onTouchStart:this._onDragStart,onMouseDown:this._onDragStart,style:this._getDraggableStyle()},c.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),e),t))}}]),t}(c.BaseComponent);t.default=u,u.contextTypes=c.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),l=i(s),c=n(108),u=i(c),f=n(41),p=i(f),h=n(113),d=i(h),_=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(l.default);_.topBarControlsComponent=u.default,_.controlsComponent=p.default,_.canvasControlsComponent=d.default,t.default=_},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(12),u=i(c),f=n(109),p=i(f),h=n(110),d=i(h),_=n(111),m=i(_),y=n(112),g=i(y),v=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"renderContent",value:function(){var e=null;this.context.options.enableUpload&&(e=l.ReactBEM.createElement(p.default,{app:this.props.app}));var t=null;return this.context.options.editor.enableZoom&&(t=l.ReactBEM.createElement(g.default,null)),l.ReactBEM.createElement("bem",{specifier:"$b:topBar"},l.ReactBEM.createElement("div",{bem:"e:left"},e),l.ReactBEM.createElement("div",{bem:"e:right"},l.ReactBEM.createElement(m.default,null),l.ReactBEM.createElement(d.default,null)),t)}}]),t}(u.default);t.default=v,v.contextTypes=u.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(25),u=i(c),f=n(24),p=i(f),h=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._bindAll("_onNewFile","_onButtonClick"),s}return a(t,e),s(t,[{key:"_onNewFile",value:function(e){var t=this.context.editor;t.reset(),t.setImage(e),t.zoom.set("auto")}},{key:"_onButtonClick",value:function(){var e=this.context.options,t=!1===e.enableWebcam||l.Utils.isMobile(),n=!!e.photoRoll.provider;t&&!n?this.refs.upload.open():n?this.props.app.switchToScreen("photoRoll"):this.props.app.switchToScreen("splash")}},{key:"renderWithBEM",value:function(){var e=this.context.options,t=null;return t=e.photoRoll.provider?this._t("editor.backgroundImage"):this._t("editor.new"),l.ReactBEM.createElement("div",null,l.ReactBEM.createElement(p.default,{onNewFile:this._onNewFile,ref:"upload"}),l.ReactBEM.createElement(u.default,{label:t,icon:"editor/new.png",onClick:this._onButtonClick}))}}]),t}(l.BaseComponent);t.default=h,h.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(1),u=i(c),f=n(25),p=i(f),h=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._bindAll("_onButtonClick"),s}return a(t,e),s(t,[{key:"_onButtonClick",value:function(){var e=this,t=this.context,n=t.options,i=t.editor,r=t.editorScreen,o=n.editor.export;r.switchToControls("home",null,function(){var t=u.default.instance.displayLoading(e._t("loading.exporting"));setTimeout(function(){i.export(o.download).then(function(){t.close()}).catch(function(n){u.default.instance.displayError(e._t("errors.title"),n.message),t.close()})},100)})}},{key:"renderWithBEM",value:function(){return this.context.options.editor.export.showButton?l.ReactBEM.createElement(p.default,{style:"blue",label:this._t("editor.export"),icon:"editor/export.png",onClick:this._onButtonClick}):null}}]),t}(l.BaseComponent);t.default=h,h.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(25),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){var e,n;r(this,t);for(var a=arguments.length,s=Array(a),c=0;c<a;c++)s[c]=arguments[c];var u=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s)));return u._bindAll("_onButtonClick","_onHistoryUpdated","_onFeaturesUpdated"),u._events=(n={},i(n,l.Constants.EVENTS.HISTORY_UPDATED,u._onHistoryUpdated),i(n,l.Constants.EVENTS.FEATURES_UPDATED,u._onFeaturesUpdated),n),u}return a(t,e),s(t,[{key:"_onFeaturesUpdated",value:function(){this.forceUpdate()}},{key:"_onHistoryUpdated",value:function(){this.forceUpdate()}},{key:"_onButtonClick",value:function(){this.context.editor.history.undo()}},{key:"renderWithBEM",value:function(){return this.context.editor.history.isAvailable()?l.ReactBEM.createElement(u.default,{label:this._t("editor.undo"),icon:"editor/undo.png",onClick:this._onButtonClick}):null}}]),t}(l.BaseComponent);t.default=f,f.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=function(e){function t(){var e,n;r(this,t);for(var a=arguments.length,s=Array(a),c=0;c<a;c++)s[c]=arguments[c];var u=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s)));return u._bindAll("_onZoomOutClick","_onZoomInClick","_onZoomDone","_onFeaturesUpdated"),u._events=(n={},i(n,l.Constants.EVENTS.ZOOM_DONE,u._onZoomDone),i(n,l.Constants.EVENTS.FEATURES_UPDATED,u._onFeaturesUpdated),n),u}return a(t,e),s(t,[{key:"_onFeaturesUpdated",value:function(){this.forceUpdate()}},{key:"_onZoomDone",value:function(){this.forceUpdate()}},{key:"_onZoomOutClick",value:function(e){var t=this.context.editor;t.features.isEnabled("zoom")&&t.zoom.out()}},{key:"_onZoomInClick",value:function(e){var t=this.context.editor;t.features.isEnabled("zoom")&&t.zoom.in()}},{key:"renderWithBEM",value:function(){var e=this.context.editor,t=e.zoom.get(),n=e.features.isEnabled("zoom");return l.ReactBEM.createElement("bem",{specifier:"b:editorScreen"},l.ReactBEM.createElement("div",{bem:"$e:zoom"},l.ReactBEM.createElement("div",{bem:"$e:button m:zoomOut",onClick:this._onZoomOutClick,className:n?null:"is-disabled"},l.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("controls/minus.png",!0)})),l.ReactBEM.createElement("div",{bem:"e:label"},this._t("editor.zoom"),l.ReactBEM.createElement("br",null),Math.round(100*t),"%"),l.ReactBEM.createElement("div",{bem:"$e:button m:zoomIn",onClick:this._onZoomInClick,className:n?null:"is-disabled"},l.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("controls/plus.png",!0)}))))}}]),t}(l.BaseComponent);t.default=c,c.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(9),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onClick"),s}return o(t,e),a(t,[{key:"_onClick",value:function(e){this._performHitTest(s.Utils.getEventPosition(e))}},{key:"_getContainerStyle",value:function(){if(!this.context.editor.isReady())return{left:0,top:0,width:1,height:1};var e=this.context.editor.getSDK().getSprite().getBounds();return{left:e.x,top:e.y,width:e.width,height:e.height}}},{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("div",{bem:"$b:canvasControls e:container m:full",ref:"container"},s.ReactBEM.createElement("div",{bem:"$b:canvasControls e:innerContainer",ref:"innerContainer",style:this._getContainerStyle(),onClick:this._onClick,onTouchStart:this._onClick}))}}]),t}(c.default);t.default=u,u.contextTypes=c.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),a=n(115),s=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(){function e(t,n,r){i(this,e),this._sdk=t,this._options=n,this._download=r}return r(e,[{key:"export",value:function(){var e=this,t=this._getRenderType();return this._sdk.export(t,this._options.format,this._options.quality).then(function(n){return e._download&&e._downloadData(t,n),n})}},{key:"_downloadData",value:function(e,t){switch(e){case o.RenderType.DATAURL:s.default.downloadDataURL(t,this._options.fileBasename);break;case o.RenderType.MSBLOB:s.default.downloadMSBlob(t,this._options.fileBasename)}}},{key:"_getRenderType",value:function(){var e=this._options;return e.type===o.RenderType.IMAGE&&this._download?o.Utils.supportsMSBlob()?o.RenderType.MSBLOB:o.RenderType.DATAURL:e.type}}]),e}();t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),a=function(){function e(){i(this,e)}return r(e,null,[{key:"downloadDataURL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"photoeditorsdk-export",n=this.createBlobURLFromDataURL(e),i=this.getExtensionFromDataURL(e),r=document.createElement("a");r.download=t+"."+i,r.href=n,document.body.appendChild(r),r.click(),document.body.removeChild(r)}},{key:"downloadMSBlob",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"photoeditorsdk-export";navigator.msSaveBlob(e,t+".png")}},{key:"getExtensionFromDataURL",value:function(e){return e.split(",")[0].split(":")[1].split(";")[0].split("/").pop()}},{key:"createBlobURLFromDataURL",value:function(e){if(!(window.Blob&&window.URL&&ArrayBuffer&&Uint8Array))return e;for(var t=o.Base64.decode(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),r=new Uint8Array(i),a=0;a<t.length;a++)r[a]=t[a];var s=new window.Blob([i],{type:n});return window.URL.createObjectURL(s)}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),a=function(){function e(t,n,r){i(this,e),this._image=t,this._maxPixels=n,this._maxDimensions=r}return r(e,[{key:"needsResize",value:function(){var e=new o.Vector2(this._image.width,this._image.height),t=e.x*e.y,n=t>this._maxPixels,i=null!==this._maxDimensions&&(e.x>this._maxDimensions||e.y>this._maxDimensions);return n||i}},{key:"resize",value:function(){var e=this,t=null,n=null,i=this._maxDimensions;return new o.Promise(function(r,a){window.setTimeout(function(){var a=new o.Vector2(e._image.width,e._image.height),s=a.clone();if(s.x*s.y>e._maxPixels&&(s.copy(e._getDimensionsByMaxPixels()),t="maxMegaPixels"),null!==i&&(s.x>i||s.y>i)){var l=Math.min(i/s.x,i/s.y);s.multiply(l),t="maxDimensions"}s.floor(),n=e._createResizedImageCanvas(s),r({canvas:n,dimensions:s,reason:t})},1e3)})}},{key:"_createResizedImageCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=this._image,i=document.createElement("canvas");i.width=e.x,i.height=e.y;var r=e.clone().subtract(t).divide(2);return i.getContext("2d").drawImage(n,0,0,n.width,n.height,r.x,r.y,t.x,t.y),i}},{key:"_getDimensionsByMaxPixels",value:function(){var e=this._image,t=this._maxPixels,n=e.width/e.height,i=e.height/e.width;return new o.Vector2(Math.sqrt(t*n),Math.sqrt(t*i)).floor()}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(7),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=n(0),l=function(){function e(t,n,r){i(this,e),this._editor=t,this._sdk=n,this._mediator=r,this._map={},this._stack=this._sdk&&this._sdk.getOperationsStack(),this._preferredOrder=this._editor.getOptions().editor.operationsOrder,this._available={};var o=a.default.Operations;for(var s in o){var l=o[s];this._available[l.identifier]=l}var c=t.getOptions(),u=c.extensions.operations;for(var f in u){var p=u[f];this._available[p.identifier]=p}this._stack&&this._fixStack()}return r(e,[{key:"exists",value:function(e){return!!this._map[e]}},{key:"add",value:function(e){var t=this,n=e.constructor.identifier;e.on("update",function(){t._mediator.emit(s.Constants.EVENTS.OPERATION_UPDATED,e)});var i=this._preferredOrder.indexOf(n);if(-1===i)throw new Error("EditorOperations#add: `"+n+"` does not appear in `operationsOrder`");this._stack.set(i,e),this._map[n]=e,this._mediator.emit(s.Constants.EVENTS.OPERATION_CREATED,e)}},{key:"remove",value:function(e){var t=e.constructor.identifier,n=this._stack.getStack();delete this._map[t];var i=n.map(function(e){return e.constructor.identifier}).indexOf(e.constructor.identifier);if(-1!==i){this._stack.removeAt(i);for(var r=i+1;r<n.length;r++){var o=n[r];o&&o.setDirty(!0)}this._mediator.emit(s.Constants.EVENTS.OPERATION_REMOVED,e)}}},{key:"get",value:function(e){return this._map[e]}},{key:"getOrCreate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._map[e]){var n=this._map[e];return n.set(t,!1),n}var i=this._available[e],r=new i(this._sdk,t);return this.add(r),r}},{key:"getStack",value:function(){return this._stack}},{key:"isAvailable",value:function(e){return!!this._available[e]}},{key:"getAvailable",value:function(){return this._available}},{key:"reset",value:function(){this._map={}}},{key:"_fixStack",value:function(){var e=this,t=this._stack.getStack().slice();this._stack.clear(),t.forEach(function(t){e.add(t)})}}]),e}();t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(43),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),s=n(0),l=function(){function e(t,n,r){i(this,e),this._editor=t,this._sdk=n,this._mediator=r,this._invalidOperationsSeen=[],this._options=this._editor.getOptions(),this._available=s.SDKUtils.extend({},a,this._options.extensions.controls)}return r(e,[{key:"isEnabled",value:function(e){var t=this,n=this.get(e);if(!n)return s.Log.info("EditorControls#isEnabled: Unknown control: "+e),!1;var i=n.requiredOperations||[],r=[];return i.forEach(function(e){t._editor.operations.isAvailable(e)||r.push(e)}),r.length?(-1===this._invalidOperationsSeen.indexOf(e)&&(this._invalidOperationsSeen.push(e),s.Log.error("Control `"+e+"` can not be used because "+(1===r.length?"operation is":"operations are")+" missing: "+r.map(function(e){return"`"+e+"`"}).join(", "))),!1):n.isAvailable&&n.isAvailable(this._editor)}},{key:"get",value:function(e){return this._available[e]}},{key:"getAvailable",value:function(){return this._available}}]),e}();t.default=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(4),c=i(l),u=n(120),f=i(u),p=["brightness","clarity","contrast","exposure","highlights","saturation","shadows","gamma"],h=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,null,[{key:"onEnter",value:function(e){var t=this.context.editor,n=t.operations.exists("adjustments"),i=t.operations.getOrCreate("adjustments"),r=i.serializeOptions();this.setSharedState({operation:i,operationExistedBefore:n,initialOptions:r})}},{key:"isAvailable",value:function(e){return e.isToolAllowed("adjustment")&&p.filter(function(t){return e.isToolEnabled(t)}).length>0}},{key:"getPreloadAssets",value:function(e){return p.filter(function(t){return e.isToolEnabled(t)}).map(function(e){return"controls/adjustments/"+e+".png"})}}]),t}(c.default);h.controlsComponent=f.default,h.identifier="adjustments",h.iconPath="controls/overview/adjustments.png",h.languageKey="controls.overview.adjustments",h.defaultOptions={},h.requiredOperations=["adjustments"],t.default=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(3),f=i(u),p=n(2),h=i(p),d=n(6),_=i(d),m=n(121),y=(i(m),c.SDK.Operations.AdjustmentsOperation),g=["brightness","saturation","contrast","gamma","clarity","exposure","shadows","highlights"],v=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));s._bindAll("_onSliderValueChange");var l=s.context.editor;return s._operation=l.operations.getOrCreate("adjustments"),s.state={selectedControls:null},s}return a(t,e),s(t,[{key:"_onBackClick",value:function(e){var n=this.context.editor,i=this.getSharedState("operationExistedBefore"),r=this.getSharedState("initialOptions");this._operation.optionsEqual(r)||n.history.add(this._operation,r,i);var o=this._operation.getDefaultOptions();this._operation.optionsEqual(o)&&n.operations.remove(this._operation),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onBackClick",this).call(this,e)}},{key:"_onSliderValueChange",value:function(e){var t=this.state.selectedControls,n=y.prototype.availableOptions[t],i=n.minValue,r=n.midValue,o=n.maxValue;e=e<0?r+(r-i)*e/100:r+(o-r)*e/100,this._operation.setOption(t,e),this.context.editor.render()}},{key:"_onButtonClick",value:function(e,t){this.setState({selectedControls:e})}},{key:"_buildSliderProps",value:function(e){var t=y.prototype.availableOptions[e],n=t.minValue,i=t.midValue,r=t.maxValue,o=this._operation?this._operation.getOption(e):i;return{minValue:-100,maxValue:100,value:100*(o<=i?(o-n)/(i-n)-1:(o-i)/(r-i)),valueUnit:"%",positiveValuePrefix:"+",label:this._t("controls.adjustments."+e),middleDot:!0,onChange:this._onSliderValueChange}}},{key:"renderOverlayControls",value:function(){var e=this.state.selectedControls;if(e){var t=this._buildSliderProps(e);return c.ReactBEM.createElement(_.default,t)}}},{key:"_renderListItems",value:function(){var e=this;return g.filter(function(t){return e.context.editor.isToolEnabled(t)}).map(function(t){var n=e.state.selectedControls===t,i=n?"is-active":null,r=void 0;return c.ReactBEM.createElement("li",{bem:"e:item",key:t,"data-identifier":t},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:e._onButtonClick.bind(e,t),className:i},c.ReactBEM.createElement("img",{bem:"e:icon",src:e._getAssetPath("controls/adjustments/"+t+".png",!0)}),c.ReactBEM.createElement("div",{bem:"e:label"},e._t("controls.adjustments."+t)),r)))})}},{key:"renderControls",value:function(){var e=this._renderListItems();return c.ReactBEM.createElement("div",{bem:"e:cell m:list"},c.ReactBEM.createElement(h.default,null,c.ReactBEM.createElement("ul",{bem:"$e:list"},e)))}}]),t}(f.default);t.default=v,v.contextTypes=f.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s.state={value:s.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0},s}return o(t,e),s(t,[{key:"componentDidMount",value:function(){this._setValue(this.state.value,!1)}},{key:"componentWillReceiveProps",value:function(e){e.value!==this.state.value&&this._setValue(e.value,!1)}},{key:"_getKnobStyle",value:function(){return{left:this.state.sliderPosition}}},{key:"_getForegroundStyle",value:function(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth}}},{key:"_displayMiddleDot",value:function(){return!1!==this.props.middleDot}},{key:"_setValue",value:function(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=Math.round(e);var t=this.props,n=t.minValue,i=t.maxValue,r=(e-n)/(i-n),o=this.refs.bar,a=o.offsetWidth,s=a*r,l=r*a,c=0;this._displayMiddleDot()&&(l=Math.abs(r-.5)*a,c=r<.5?.5*a-l:"50%"),this.setState({value:e,sliderPosition:s,foregroundWidth:l,foregroundLeft:c})}},{key:"renderWithBEM",value:function(){var e={style:this._getForegroundStyle()};return l.ReactBEM.createElement("div",{bem:"$b:miniSlider"},l.ReactBEM.createElement("div",{bem:"$e:bar",ref:"bar"},l.ReactBEM.createElement("div",{bem:"$e:background"}),l.ReactBEM.createElement("div",a({bem:"$e:foreground"},e)),l.ReactBEM.createElement("div",{bem:"e:knob",style:this._getKnobStyle()})))}}]),t}(l.BaseComponent);t.default=c,c.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(4),u=i(c),f=n(123),p=i(f),h=n(124),d=i(h),_=n(125),m=i(_),y=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,null,[{key:"onEnter",value:function(e){var t=this.context.editor,n=t.operations.exists("transform"),i=t.operations.getOrCreate("transform");i.setEnabled(!1,!1);var r=t.operations.exists("orientation"),o=t.operations.getOrCreate("orientation"),a={end:new l.Vector2(1,1),rotation:0,start:new l.Vector2(0,0),textureScale:1},s=i.getInputDimensions(!1),c=i.getNewDimensions(s),u=a;if(n){u=i.serializeOptions(),delete u.enabled;var f=u,p=f.start,h=f.end,d=f.rotation,_=i.calculateScale(d),m=i.getInputDimensions(!1),y=Math.cos(d),g=Math.sin(d),v=h.clone().subtract(p).divide(2),b=p.clone().add(v).multiply(m),k=b.subtract(m.clone().multiply(.5)),w=new l.Vector2(k.x*y-k.y*g,k.x*g+k.y*y).multiply(_),O=m.clone().multiply(.5).add(w),E=O.clone().divide(m),S=E.clone().subtract(v.clone().multiply(_)),P=E.clone().add(v.clone().multiply(_));u.start=S,u.end=P}t.broadcastTransform(i,a);var C=o.serializeOptions(),M=[10,0,68,0];t.setSpriteScale(i.calculateScale()),t.setRotation(u.rotation),t.setPadding(M),i.set(a,n),t.zoom.set("auto",function(){t.features.disable("zoom","drag")},!1),this.setSharedState({initialTransformOptions:u,initialOrientationOptions:C,operation:i,orientationOperation:o,activePadding:M,orientationOperationExistedBefore:r,transformOperationExistedBefore:n,start:l.Vector2.fromObject(u.start),end:l.Vector2.fromObject(u.end),rotation:u.rotation,orientationRotation:o.getRotation(),flipVertically:o.getFlipVertically(),flipHorizontally:o.getFlipHorizontally(),initialDimensions:c,inputDimensions:s})}},{key:"isAvailable",value:function(e){return e.isToolAllowed("transform")&&e.isToolEnabled("transform")}},{key:"getPreloadAssets",value:function(e){var t=e.getOptions(),n=l.SDKUtils.defaults(t.editor.controlsOptions.transform,this.defaultOptions),i=["controls/transform/rotate-ccw.png","controls/transform/rotate-cw.png","controls/transform/flip-h.png","controls/transform/flip-v.png"];return p.default.getRatios(n).forEach(function(e){Array.isArray(e)?e.forEach(function(e){var t=e.identifier;i.push("controls/transform/"+t+".png")}):i.push("controls/transform/"+e.identifier+".png")}),i}}]),t}(u.default);y.topBarControlsComponent=m.default,y.controlsComponent=p.default,y.canvasControlsComponent=d.default,y.identifier="transform",y.iconPath="controls/overview/transform.png",y.languageKey="controls.overview.transform",y.defaultOptions={},y.requiredOperations=["transform"],t.default=y},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},u=n(0),f=n(3),p=i(f),h=n(2),d=i(h),_=n(6),m=i(_),y=function(e){function t(){var e;o(this,t);for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];var l=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return l._bindAll("_selectRatio","_onRotationChange","_reapplyRatio"),l.state={ratio:null},l._ratios=l.constructor.getRatios(l.props.options),l._events=r({},u.Constants.EVENTS.TRANSFORM_REAPPLY_RATIO,l._reapplyRatio),l._selectInitialRatio(!l.getSharedState("transformOperationExistedBefore")),l}return s(t,e),l(t,[{key:"shouldSharedComponentUpdate",value:function(e,t){return e.ratio!==t.ratio}},{key:"_onRotationChange",value:function(e){var t=this.getSharedState("operation"),n=this.context.editor;e=e*Math.PI/180,n.setRotation(e),n.setSpriteScale(t.calculateScale(e)),n.render(),this.setSharedState({rotation:e})}},{key:"_getRotatedSpriteDimensions",value:function(){var e=this.context.editor,t=e.getRotation(),n=e.getOutputDimensions(!1);return new u.Vector2(Math.abs(n.x*Math.cos(t))+Math.abs(n.y*Math.sin(t)),Math.abs(n.x*Math.sin(t))+Math.abs(n.y*Math.cos(t)))}},{key:"_calculateTextureScale",value:function(){var e=this.getSharedState("operation"),t=this.getSharedState("ratio");if(!t||!t.dimensions)return 1;var n=this.getSharedState("start"),i=this.getSharedState("end"),r=i.clone().subtract(n),o=e.getInputDimensions(!1).multiply(r);return t.dimensions.x/o.x}},{key:"_getHistoryItems",value:function(){var e=[],t=this._getTransformHistoryItem();t&&e.push(t);var n=this._getOrientationHistoryItem();return n&&e.push(n),e}},{key:"_getTransformHistoryItem",value:function(){var e=this.context.editor,t=this.getSharedState("operation"),n=this.getSharedState("initialTransformOptions"),i=this.getSharedState("transformOperationExistedBefore");if(!t.optionsEqual(n))return{operation:t,options:n,existent:i,undo:function(t,n){e.broadcastTransform(t,n)}}}},{key:"_getOrientationHistoryItem",value:function(){var e=this.context.editor,t=this.getSharedState("orientationOperation"),n=this.getSharedState("initialOrientationOptions"),i=this.getSharedState("orientationOperationExistedBefore");if(!t.optionsEqual(n))return{operation:t,options:n,existent:i,undo:function(t,n){t.getRotation()!==n.rotation&&e.broadcastRotate(n.rotation-t.getRotation());var i=n.rotation,r=90===i||270===i;t.getFlipVertically()!==n.flipVertically?e.broadcastFlip(r?"horizontal":"vertical"):t.getFlipHorizontally()!==n.flipHorizontally&&e.broadcastFlip(r?"vertical":"horizontal")}}}},{key:"_reapplyRatio",value:function(){var e=this.getSharedState("ratio");this._selectRatio(e)}},{key:"_onBackClick",value:function(e){var n=this.context.editor,i=this.getSharedState("ratio"),r=this.getSharedState("operation"),o=this.getSharedState("orientationOperation"),a=n.getRotation(),s=this.getSharedState("start").clone(),l=this.getSharedState("end").clone();if((null===i||s.equals(0,0)&&l.equals(1,1))&&0===a)n.operations.remove(r);else{var f=this._calculateTextureScale(),p={rotation:a,start:s,end:l,textureScale:f,enabled:!0},h=r.calculateScale(a),d=r.getInputDimensions(!1),_=Math.cos(-a),m=Math.sin(-a),y=l.clone().subtract(s).divide(2),g=s.clone().add(y).multiply(d),v=g.subtract(d.clone().multiply(.5)),b=new u.Vector2(v.x*_-v.y*m,v.x*m+v.y*_).divide(h),k=d.clone().multiply(.5).add(b),w=k.clone().divide(d);p.start=w.clone().subtract(y.clone().divide(h)),p.end=w.clone().add(y.clone().divide(h)),n.broadcastTransform(r,p),r.set(p)}0!==o.getRotation()||o.getFlipVertically()||o.getFlipHorizontally()||n.operations.remove(o),n.setPadding(!1),n.setRotation(0),n.setSpriteScale(1);var O=this._getHistoryItems();O.length&&n.history.add(O),n.features.enable("zoom","drag"),n.zoom.set("auto"),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onBackClick",this).call(this,e)}},{key:"_selectInitialRatio",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.getSharedState("operation"),n=null,i=u.SDKUtils.flatten(this._ratios),r=t._ratio;if(r){n=i.filter(function(e){return e===r})[0]}if(!n){n=i.filter(function(e){return e.selected}).pop()}return n||(n=i[0]),this._selectRatio(n,e,!1)}},{key:"_selectRatio",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.getSharedState("operation");t&&e&&this._setDefaultOptionsForRatio(e,n),i._ratio=e;var r={ratio:e},o=this.context.editor;e?o.setPadding(this.getSharedState("activePadding")):(o.setPadding(!1),o.setRotation(0),o.setSpriteScale(1),r.rotation=0,r.start=new u.Vector2(0,0),r.end=new u.Vector2(1,1)),o.render(),this.setSharedState(r,n)}},{key:"_setDefaultOptionsForRatio",value:function(e){var t=e.ratio,n=(e.name,e.dimensions),i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.context.editor,o=new u.Vector2,a=new u.Vector2;if(n&&!t&&(t=n.x/n.y),"*"===t)o=new u.Vector2(0,0),a=new u.Vector2(1,1);else{var s=r.getOutputDimensions();if(s.x/s.y<=t){var l=1/s.y*(s.x/t);o.set(0,(1-l)/2),a.set(1,1-o.y)}else{var c=1/s.x*(t*s.y);o.set((1-c)/2,0),a.set(1-o.x,1)}}this.setSharedState({start:o,end:a},i)}},{key:"renderOverlayControls",value:function(){var e=180*this.getSharedState("rotation")/Math.PI;return this.getSharedState("ratio")?u.ReactBEM.createElement(m.default,{value:e,minValue:-45,middleDot:!0,maxValue:45,valueUnit:"°",label:this._t("controls.transform.rotation"),onChange:this._onRotationChange}):null}},{key:"_renderListItems",value:function(){var e=this,t=[],n=function(t){return u.ReactBEM.createElement("li",{bem:"e:item",key:t.identifier,"data-identifier":t.identifier},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:e.getSharedState("ratio")===t?"is-active":null,onClick:e._selectRatio.bind(e,t)},u.ReactBEM.createElement("img",{bem:"e:icon",src:e._getAssetPath("controls/transform/"+t.identifier+".png",!0)}),u.ReactBEM.createElement("div",{bem:"e:label"},e._t("controls.transform.ratios."+t.identifier)||t.defaultName))))};this._ratios.forEach(function(e){if(Array.isArray(e)){var i=e,r=[];i.forEach(function(e){r.push(n(e))}),r.length&&t.push(r)}else{var o=e;t.push(n(o))}});var i=[];return t.forEach(function(e){i=i.concat(e),Array.isArray(e)&&e!==t[t.length-1]&&i.push(u.ReactBEM.createElement("li",{bem:"e:separator"}))}),[u.ReactBEM.createElement("li",{bem:"e:item","data-identifier":"none",key:"noTransform"},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:this.getSharedState("ratio")?null:"is-active",onClick:this._selectRatio.bind(this,null)},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/no-transform.png",!0)}),u.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.transform.none"))))),u.ReactBEM.createElement("li",{bem:"e:separator"})].concat(i)}},{key:"renderControls",value:function(){var e=this._renderListItems();return u.ReactBEM.createElement("div",{bem:"e:cell m:list"},u.ReactBEM.createElement(d.default,null,u.ReactBEM.createElement("ul",{bem:"$e:list"},e)))}}],[{key:"getRatios",value:function(e){var t=e.ratios,n=e.replaceRatios,i=e.availableRatios;t=t||[];var r=void 0;if(r=u.Constants.DEFAULTS.TRANSFORM_RATIOS,r=n?t:r.concat(t),i&&i.length){var o=function e(t){return Array.isArray(t)?t.map(e).filter(function(e){return e}):-1===i.indexOf(t.identifier)?null:t};r=r.map(o).filter(function(e){return e})}return r}}]),t}(p.default);t.default=y,y.contextTypes=p.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(5),u=i(c),f=n(9),p=i(f),h=new l.Vector2(50,50),d=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._needsStyleFixes=!0,s._bindAll("_onCenterDragStart","_onCenterDrag"),s.state={dimensions:s.getSharedState("initialDimensions")},s}return a(t,e),s(t,[{key:"fixStyles",value:function(){if(l.Utils.Browser.isIElte(11)){var e=this.context.editor,t=this.refs.container,n=e.getCanvasDimensions(!1),i=n.y;t.style.height=i+"px"}}},{key:"sharedStateDidChange",value:function(e){e!==this.getSharedState("ratio")&&this._updateDimensions()}},{key:"_updateDimensions",value:function(){var e=this.getSharedState("operation"),t=this.getSharedState("ratio")||{ratio:"*"},n=void 0;if(t.dimensions)n=t.dimensions.clone();else{var i=e.getInputDimensions(!1),r=this.getSharedState("start");n=this.getSharedState("end").clone().subtract(r).multiply(i).floor()}this.setState({dimensions:n})}},{key:"_onCenterDragStart",value:function(){var e=this.getSharedState("start"),t=this.getSharedState("end");this._initialValues={start:e.clone(),end:t.clone(),size:t.clone().subtract(e)}}},{key:"_onCenterDrag",value:function(e){var t=this.context.editor,n=this._initialValues,i=n.start,r=n.size,o=t.getOutputDimensions(),a=e.clone().divide(o),s=new l.Vector2(0,0),c=new l.Vector2(1,1).subtract(r),u=i.clone().add(a).clamp(s,c),f=u.clone().add(r);this.setSharedState({start:u,end:f})}},{key:"_onKnobDragStart",value:function(e){this._currentDragOption=e,this._initialValues={start:this.getSharedState("start").clone(),end:this.getSharedState("end").clone()}}},{key:"_onKnobDrag",value:function(e,t){var n=this.context.editor,i=n.getOutputDimensions(),r=this.getSharedState("ratio")||{ratio:"*"},o=r.ratio,a=r.dimensions;a&&!o&&(o=a.x/a.y);var s=this._initialValues.end.clone().subtract(this._initialValues.start).multiply(i),c=void 0;"start"===e?(s.subtract(t),c=this._initialValues.end.clone().multiply(i)):"end"===e&&(s.add(t),c=new l.Vector2(1,1).subtract(this._initialValues.start).multiply(i));var u=i;if(void 0!==o&&"*"!==o&&(u=o>i.x/i.y?new l.Vector2(i.x,i.x/o):new l.Vector2(i.y*o,i.y)),s.x=Math.min(Math.max(Math.min(h.x,u.x),s.x),c.x),"*"!==o&&(s.y=s.x/o),s.y=Math.min(Math.max(Math.min(h.y,u.y),s.y),c.y),"*"!==o&&(s.x=s.y*o),"start"===e){var f=this._initialValues.end.clone().subtract(s.clone().divide(i));this.setSharedState({start:f},!1),this._updateDimensions()}else if("end"===e){var p=this._initialValues.start.clone().add(s.clone().divide(i));this.setSharedState({end:p},!1),this._updateDimensions()}}},{key:"_calculateDimensions",value:function(){var e=this.context.editor,t=this.getSharedState("start");return this.getSharedState("end").clone().subtract(t).multiply(e.getInputDimensions(!1)).round()}},{key:"_getAreaStyles",value:function(){var e=this.context.editor,t=e.getOutputDimensions(),n=e.getCanvasDimensions(),i=this.getSharedState("start").clone().multiply(t).floor(),r=this.getSharedState("end").clone().multiply(t).ceil(),o=r.clone().subtract(i),a=n.clone().subtract(t).divide(2).floor(),s=e.getPadding();return i.add(a).add(0,s[0]),{topLeft:this._getDimensionsStyles(i.x,i.y),topCenter:this._getDimensionsStyles(o.x,i.y),centerLeft:this._getDimensionsStyles(i.x,o.y),center:this._getDimensionsStyles(o.x,o.y)}}},{key:"_getDimensionsStyles",value:function(e,t){return{width:Math.max(1,e),height:Math.max(1,t)}}},{key:"renderWithBEM",value:function(){var e=this.getSharedState("ratio"),t=this.state.dimensions,n=void 0;if(e){var i=this._getAreaStyles();n=l.ReactBEM.createElement("div",{bem:"$b:transformCanvasControls"},l.ReactBEM.createElement("div",{bem:"e:row"},l.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:i.topLeft}," "),l.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:i.topCenter}," "),l.ReactBEM.createElement("div",{bem:"e:cell m:dark"})),l.ReactBEM.createElement("div",{bem:"e:row"},l.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:i.centerLeft}," "),l.ReactBEM.createElement(u.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},l.ReactBEM.createElement("div",{bem:"e:cell m:bordered",style:i.center},l.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart.bind(this,"start"),onDrag:this._onKnobDrag.bind(this,"start")},l.ReactBEM.createElement("div",{bem:"e:knob m:topLeft $b:knob"},l.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)}))),l.ReactBEM.createElement("div",{bem:"e:dimensions"},t.x+"x"+t.y),l.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart.bind(this,"end"),onDrag:this._onKnobDrag.bind(this,"end")},l.ReactBEM.createElement("div",{bem:"e:knob m:bottomRight $b:knob"},l.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)}))))),l.ReactBEM.createElement("div",{bem:"e:cell m:dark"}," ")),l.ReactBEM.createElement("div",{bem:"e:row"},l.ReactBEM.createElement("div",{bem:"e:cell m:dark"}," "),l.ReactBEM.createElement("div",{bem:"e:cell m:dark"}," "),l.ReactBEM.createElement("div",{bem:"e:cell m:dark"}," ")))}else n=l.ReactBEM.createElement("div",{bem:"$b:transformCanvasControls"},l.ReactBEM.createElement("div",{bem:"e:dimensions"},t.x+"x"+t.y));return l.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container"},n)}}]),t}(p.default);t.default=d,d.contextTypes=p.default.contextTypes},function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(12),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_onRotateClick",value:function(e){var t=void 0;"cw"===e?t=90:"ccw"===e&&(t=-90);var n=this.context.editor,i=this.getSharedState("orientationOperation"),r=(i.getRotation()+t)%360;i.set({rotation:r});var o={orientationRotation:r},a=this.getSharedState("ratio");if(a&&!a.dimensions){var s=this.getSharedState("start"),c=this.getSharedState("end"),u=s.clone();"cw"===e?(s.set(1-c.y,u.x),c.set(1-u.y,c.x)):"ccw"===e&&(s.set(u.y,1-c.x),c.set(c.y,1-u.x)),o.start=s,o.end=c}a&&a.dimensions&&this._emitEvent(l.Constants.EVENTS.TRANSFORM_REAPPLY_RATIO),this.setSharedState(o),n.broadcastRotate(t),n.zoom.set("auto")}},{key:"_onFlipClick",value:function(e){var t,n=this.context.editor,r=this.getSharedState("orientationOperation"),o=!this.getSharedState("flip"+e),a=-1*this.getSharedState("rotation");this.setSharedState((t={},i(t,"flip"+e,o),i(t,"rotation",a),t)),n.setRotation(a),r.flip(e);var s=this.getSharedState("start"),l=this.getSharedState("end"),c=s.clone();"horizontal"===e?(s.set(1-l.x,s.y),l.set(1-c.x,l.y)):"vertical"===e&&(s.set(s.x,1-l.y),l.set(l.x,1-c.y)),this.setSharedState({start:s,end:l}),n.broadcastFlip(e),n.render()}},{key:"shouldSharedComponentUpdate",value:function(e,t){return!1}},{key:"renderContent",value:function(){return l.ReactBEM.createElement("bem",{specifier:"$b:topBar"},l.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onFlipClick.bind(this,"vertical")},l.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/flip-v.png",!0)})),l.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onFlipClick.bind(this,"horizontal")},l.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/flip-h.png",!0)})),l.ReactBEM.createElement("div",{bem:"e:space"}),l.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onRotateClick.bind(this,"ccw")},l.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/rotate-ccw.png",!0)})),l.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onRotateClick.bind(this,"cw")},l.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/rotate-cw.png",!0)})))}}]),t}(u.default);t.default=f,f.contextTypes=u.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(4),u=i(c),f=n(127),p=i(f),h=n(26),d=i(h),_=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,null,[{key:"onEnter",value:function(e){var t=this.context.editor,n=t.operations.exists("filter"),i=t.operations.getOrCreate("filter"),r=i.serializeOptions(["identifier","filter","intensity"]);this.setSharedState({operation:i,operationExistedBefore:n,initialOptions:r})}},{key:"onExit",value:function(){var e=this.getSharedState("initialOptions"),t=this._operation.getFilter().constructor,n=e.filter.constructor,i=void 0;"3d-lut"===n.identifier&&(i=e.filter.getImage());var r=this._operation.getIntensity();if(this._operation.getIdentifier()!==e.identifier||r!==e.intensity){var o=this.context.editor;o.history.add(this._operation,{identifier:e.identifier,intensity:r},this.getSharedState("operationExistedBefore"),function(){var e=o.operations.getOrCreate("filter");"3d-lut"===n.identifier?e.setFilter(new n({image:i})):e.setFilter(new n)})}if(t.isIdentity){this.context.editor.operations.remove(this._operation)}}},{key:"isAvailable",value:function(e){return e.isToolAllowed("filter")&&e.isToolEnabled(this.identifier)}},{key:"getPreloadAssets",value:function(e){var t=e.getOptions(),n=l.SDKUtils.defaults(t.editor.controlsOptions.filter,this.defaultOptions),i=new d.default(e.getUI(),n),r=[];return i.getCategories().forEach(function(e){r.push("controls/filters/categories/"+e.identifier+".png"),i.getFiltersForCategory(e.identifier).forEach(function(e){r.push("controls/filters/"+e.identifier+".png"),e.lutImage&&r.push([e.lutImage,!1,!1])})}),r}}]),t}(u.default);_.controlsComponent=p.default,_.identifier="filter",_.iconPath="controls/overview/filters.png",_.languageKey="controls.overview.filters",_.defaultOptions={categories:[],replaceCategories:!1,availableFilters:null,hideCategories:!1},_.requiredOperations=["filter"],t.default=_},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(0),u=n(3),f=i(u),p=n(2),h=i(p),d=n(44),_=i(d),m=n(6),y=i(m),g=n(26),v=i(g),b=c.SDK.Operations.FilterOperation.Filters,k=function(e){function t(){var e;o(this,t);for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];var l=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return l._bindAll("_onItemClick","_onOperationUpdated","_onSliderValueChange","_onCategoryChange"),l._operation=l.getSharedState("operation"),l._events=r({},c.Constants.EVENTS.OPERATION_UPDATED,l._onOperationUpdated),l._initFilterManager(),l.state={category:l._filterManager.getCategoryByIdentifier("all")},l}return s(t,e),l(t,[{key:"_initFilterManager",value:function(){this._filterManager=new v.default(this.context.ui,this.props.options)}},{key:"_onSliderValueChange",value:function(e){this._operation.setIntensity(e/100),this.context.editor.render()}},{key:"_onCategoryChange",value:function(e){var t=this;this.setState({category:e},function(){t.refs.scrollbar.update()})}},{key:"_onOperationUpdated",value:function(e){e===this._operation&&this.forceUpdate()}},{key:"_onItemClick",value:function(e,t){var n=this;this._filterManager.instantiateFilterWithIdentifier(e).then(function(t){n._operation.set({filter:t,identifier:e,intensity:1}),n.context.editor.render(),n.forceUpdate()})}},{key:"renderOverlayControls",value:function(){if(this._operation.getFilter().isIdentity)return null;var e=this._operation.getIntensity();return c.ReactBEM.createElement(y.default,{minValue:0,maxValue:100,value:100*e,valueUnit:"%",positiveValuePrefix:"+",label:this._t("controls.filter.intensity"),onChange:this._onSliderValueChange})}},{key:"_renderListItems",value:function(){var e=this,t=this._operation.getIdentifier(),n=this._filterManager.getFiltersForCategory(this.state.category.identifier);return[b.IdentityFilter].concat(n).map(function(n){var i=n.identifier;return c.ReactBEM.createElement("li",{bem:"e:item",key:i,onClick:e._onItemClick.bind(e,i)},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withInlineLabel"},c.ReactBEM.createElement("img",{bem:"e:icon",src:e._getAssetPath("controls/filters/"+i+".png",!0)}),c.ReactBEM.createElement("div",{bem:"$e:inlineLabel",className:i===t?"is-active":null},c.ReactBEM.createElement("div",{bem:"e:label"},e._t("controls.filter.filters."+n.identifier)||n.defaultName)))))})}},{key:"_renderCategoryDropdown",value:function(){var e=this,t=this._filterManager.getCategories();if(this.props.options.hideCategories||!(t.length>1))return null;var n=t.map(function(t){return{identifier:t.identifier,item:t,label:e._t("controls.filter.categories."+t.identifier)||t.defaultName,icon:e._getAssetPath("controls/filters/categories/"+t.identifier+".png",!0)}}),i={identifier:this.state.category.identifier,item:this.state.category,label:this._t("controls.filter.categories."+this.state.category.identifier)||this.state.category.defaultName,icon:this._getAssetPath("controls/filters/categories/"+this.state.category.identifier+".png",!0)};return c.ReactBEM.createElement("div",{bem:"e:cell m:categoryDropdown"},c.ReactBEM.createElement(_.default,{items:n,selectedItem:i,onChange:this._onCategoryChange}))}},{key:"renderControls",value:function(){var e=this._renderListItems();return[this._renderCategoryDropdown(),c.ReactBEM.createElement("div",{bem:"e:cell m:list"},c.ReactBEM.createElement(h.default,{ref:"scrollbar"},c.ReactBEM.createElement("ul",{bem:"$e:list"},e)))]}}]),t}(f.default);t.default=k,k.contextTypes=f.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"_onItemClick",value:function(e){this.props.onChange&&this.props.onChange(e.item)}},{key:"_renderListItems",value:function(){var e=this;return this.props.items.map(function(t){var n=t.identifier===e.props.selectedItem.identifier;return s.ReactBEM.createElement("li",{bem:"$e:item",className:n?" is-active":"",onClick:e._onItemClick.bind(e,t)},s.ReactBEM.createElement("img",{bem:"e:icon",src:t.icon}),s.ReactBEM.createElement("div",{bem:"e:label"},t.label))})}},{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("div",{bem:"$b:categoryDropdown $e:overlay"},s.ReactBEM.createElement("ul",{bem:"$e:list"},this._renderListItems()))}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(4),c=i(l),u=n(130),f=i(u),p=n(131),h=i(p),d=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,null,[{key:"isAvailable",value:function(e){return e.isToolAllowed("focus")&&(e.isToolEnabled("radial-focus")||e.isToolEnabled("mirrored-focus"))}},{key:"onExit",value:function(){var e=this.context.editor;e.features.enable("zoom","drag");var t=this.getSharedState("initialOptions"),n=this.getSharedState("initialOperation"),i=this.getSharedState("operation");(!i&&n||i&&n&&i.constructor===n.constructor)&&e.history.add(n,t,!0),i&&!n&&e.history.add(i,{},!1),i&&n&&i.constructor!==n.constructor&&e.history.add([{operation:n,options:t,existent:!0},{operation:i,options:{},existent:!1}])}},{key:"onEnter",value:function(e){var t=this.context.editor,n=t.operations.get("mirrored-focus")||t.operations.get("radial-focus"),i={};n&&(i=n.serializeOptions(),delete i.enabled),this.setSharedState({operation:n,initialOperation:n,operationExistedBefore:!!n,initialOptions:i,inputDimensions:t.getOutputDimensions()})}},{key:"getPreloadAssets",value:function(e){var t=[];return e.isToolEnabled("radial-focus")&&t.push("controls/focus/radial.png"),e.isToolEnabled("mirrored-focus")&&t.push("controls/focus/mirrored.png"),t}}]),t}(c.default);d.controlsComponent=f.default,d.canvasControlsComponent=h.default,d.identifier="focus",d.iconPath="controls/overview/focus.png",d.languageKey="controls.overview.focus",d.defaultOptions={},d.requiredOperations=["radial-focus","mirrored-focus","linear-focus","blur"],t.default=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(0),u=n(3),f=i(u),p=n(2),h=i(p),d=n(6),_=i(d),m=[{toolName:"radial-focus",iconName:"radial",languageKey:"controls.focus.radial"},{toolName:"mirrored-focus",iconName:"mirrored",languageKey:"controls.focus.mirrored"}],y=function(e){function t(){var e;o(this,t);for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];var l=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return l._bindAll("_onBlurRadiusChange","_onOperationRemoved"),l._removedOperation=null,l._events=r({},c.Constants.EVENTS.OPERATION_REMOVED,l._onOperationRemoved),l}return s(t,e),l(t,[{key:"_onBlurRadiusChange",value:function(e){var t=this.getSharedState("operation"),n=this.getSharedState("inputDimensions");t.setBlurRadius(e/n.min()),this.context.editor.render()}},{key:"_onButtonClick",value:function(e,t){var n=this.context.editor,i=this.getSharedState("operation");i&&(this._removedOperation=i,n.operations.remove(i));var r=null;e&&(r=n.operations.getOrCreate(e)),this.setSharedState({operation:r}),n.render()}},{key:"_onOperationRemoved",value:function(e){var t=this.getSharedState("operation");if(t&&e===t&&e!==this._removedOperation&&!this._backButtonClicked){var n=this.context.editor,i=t.constructor.identifier,r=n.operations.getOrCreate(i);this.setSharedState({operation:r,operationExistedBefore:!1,initialOptions:{}})}}},{key:"renderOverlayControls",value:function(){var e=this.getSharedState("operation");if(!e)return null;var t=this.getSharedState("inputDimensions"),n=t.min(),i=e.getBlurRadius()*n;return c.ReactBEM.createElement(_.default,{minValue:0,maxValue:Math.min(180,Math.round(.1*n)),valueUnit:"px",middleDot:!1,label:this._t("controls.focus.blurRadius"),onChange:this._onBlurRadiusChange,value:i})}},{key:"_renderListItems",value:function(){var e=this,t=this.getSharedState("operation"),n=this.context.editor;return[c.ReactBEM.createElement("li",{bem:"e:item",key:"none"},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:t?null:"is-active",onClick:this._onButtonClick.bind(this,null)},c.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/focus/none.png",!0)}),c.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.focus.none")))))].concat(m.filter(function(e){var t=e.toolName;return n.isToolEnabled(t)}).map(function(n){var i=n.toolName,r=n.iconName,o=n.languageKey,a=t&&t.constructor.identifier===i;return c.ReactBEM.createElement("li",{bem:"e:item","data-identifier":i,key:i},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:a?"is-active":null,onClick:e._onButtonClick.bind(e,i)},c.ReactBEM.createElement("img",{bem:"e:icon",src:e._getAssetPath("controls/focus/"+r+".png",!0)}),c.ReactBEM.createElement("div",{bem:"e:label"},e._t(o)))))}))}},{key:"renderControls",value:function(){var e=this._renderListItems();return c.ReactBEM.createElement("div",{bem:"e:cell m:list"},c.ReactBEM.createElement(h.default,null,c.ReactBEM.createElement("ul",{bem:"$e:list"},e)))}}]),t}(f.default);t.default=y,y.contextTypes=f.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(9),u=i(c),f=n(132),p=i(f),h=n(133),d=i(h),_=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_getControlsForOperation",value:function(e){if(!e)return null;switch(e.constructor.identifier){case"mirrored-focus":return p.default;case"radial-focus":return d.default}}},{key:"renderWithBEM",value:function(){var e=this.getSharedState("operation"),t=this._getControlsForOperation(e);return t?l.ReactBEM.createElement(t,this.props):l.ReactBEM.createElement("div",null)}}]),t}(u.default);t.default=_,_.contextTypes=u.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},u=n(0),f=n(5),p=i(f),h=n(9),d=i(h),_=function(e){function t(){var e;o(this,t);for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];var l=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return l._bindAll("_onCenterDragStart","_onCenterDrag","_onKnobDragStart","_onKnobDrag","_onOperationUpdated"),l.state={areaPosition:new u.Vector2,areaDimensions:new u.Vector2,knobPosition:new u.Vector2},l._operation=l.getSharedState("operation"),l._events=r({},u.Constants.EVENTS.OPERATION_UPDATED,l._onOperationUpdated),l}return s(t,e),l(t,[{key:"_onCanvasZoomDone",value:function(){this._setStylesFromOptions()}},{key:"_onOperationUpdated",value:function(e){e===this.getSharedState("operation")&&this._setStylesFromOptions()}},{key:"sharedStateDidChange",value:function(e){e.operation&&(this._operation=e.operation,"mirrored-focus"===this._operation.constructor.identifier&&this._setStylesFromOptions())}},{key:"componentDidMount",value:function(){var e=this;c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var n=this.context.editor;n.zoom.set("auto",function(){n.features.disable("zoom","drag"),e._setStylesFromOptions()})}},{key:"_onCenterDragStart",value:function(){this._initialStart=this._operation.getStart(),this._initialEnd=this._operation.getEnd(),this._initialDist=this._initialEnd.clone().subtract(this._initialStart)}},{key:"_onCenterDrag",value:function(e){var t=this.context.editor,n=t.getOutputDimensions(),i=e.clone().divide(n),r=this._initialStart.clone().add(i).clamp(new u.Vector2(0,0),new u.Vector2(1,1).subtract(this._initialDist)),o=r.clone().add(this._initialDist);this._operation.set({start:r,end:o}),t.render(),this._setStylesFromOptions(),this.forceUpdate()}},{key:"_onKnobDragStart",value:function(e){this._initialKnobPosition=this.state.knobPosition.clone()}},{key:"_onKnobDrag",value:function(e){var t=this.context.editor,n=t.getOutputDimensions(),i=this._initialKnobPosition.clone().add(e).clamp(new u.Vector2(0,0),n),r=i.clone().subtract(this.state.areaPosition),o=this.state.areaPosition.clone().add(-r.y,r.x).divide(n),a=this.state.areaPosition.clone().add(r.y,-r.x).divide(n),s=2*r.len();this._operation.set({start:o,end:a,size:s/n.min(),gradientSize:s/n.min()}),this.setState({knobPosition:i,areaDimensions:new u.Vector2(this.state.areaDimensions.x,s)}),t.render()}},{key:"_getAreaStyle",value:function(){var e=this.state.knobPosition.clone().subtract(this.state.areaPosition),t=Math.atan2(e.x,e.y)*(180/Math.PI),n="rotate("+(-t).toFixed(2)+"deg)";return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:-.5*this.state.areaDimensions.x,marginTop:-.5*this.state.areaDimensions.y,transform:n,MozTransform:n,msTransform:n,WebkitTransform:n}}},{key:"_getKnobStyle",value:function(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y}}},{key:"_setStylesFromOptions",value:function(){var e=this.context.editor,t=e.getOutputDimensions(),n=this._operation.getStart().clone().multiply(t),i=this._operation.getEnd().clone().multiply(t),r=this._operation.getSize()*t.min(),o=i.clone().subtract(n),a=n.clone().add(o.clone().divide(2)),s=new u.Vector2(2*t.len(),r),l=o.len(),c=o.clone().divide(l).divide(2);this.setState({areaDimensions:s,areaPosition:a.clone(),knobPosition:a.clone().add(-r*c.y,r*c.x)})}},{key:"_getContainerStyle",value:function(){var e=this.context.editor.getSDK().getSprite().getBounds();return{left:e.x,top:e.y,width:e.width,height:e.height}}},{key:"renderWithBEM",value:function(){return u.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container",style:this._getContainerStyle()},u.ReactBEM.createElement("div",{bem:"$b:linearFocusCanvasControls"},u.ReactBEM.createElement(p.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},u.ReactBEM.createElement("div",{bem:"e:area",style:this._getAreaStyle()})),u.ReactBEM.createElement(p.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},u.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getKnobStyle()}))))}}]),t}(d.default);t.default=_,_.contextTypes=d.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},u=n(0),f=n(5),p=i(f),h=n(9),d=i(h),_=function(e){function t(){var e;o(this,t);for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];var l=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return l._bindAll("_onCenterDragStart","_onCenterDrag","_onKnobDragStart","_onKnobDrag","_onOperationUpdated"),l.state={areaPosition:new u.Vector2,areaDimensions:new u.Vector2,knobPosition:new u.Vector2},l._knobChangedManually=!1,l._operation=l.getSharedState("operation"),l._events=r({},u.Constants.EVENTS.OPERATION_UPDATED,l._onOperationUpdated),l}return s(t,e),l(t,[{key:"_onCanvasZoomDone",value:function(){this._setStylesFromOptions()}},{key:"_onOperationUpdated",value:function(e){e===this.getSharedState("operation")&&(this._knobChangedManually=!1,this._setStylesFromOptions())}},{key:"sharedStateDidChange",value:function(e){e.operation&&(this._operation=e.operation,"radial-focus"===this._operation.constructor.identifier&&this._setStylesFromOptions())}},{key:"componentDidMount",value:function(){var e=this;c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var n=this.context.editor;n.zoom.set("auto",function(){n.features.disable("zoom","drag"),e._setStylesFromOptions()})}},{key:"_onCenterDragStart",value:function(){this._initialPosition=this._operation.getPosition(),this._initialKnobPosition=this.state.knobPosition.clone()}},{key:"_onCenterDrag",value:function(e){var t=this.context.editor,n=t.getOutputDimensions(),i=e.clone().divide(n),r=this._initialPosition.clone().add(i),o=this._initialKnobPosition.clone().add(e);this._operation.set({position:r}),this.state.knobPosition=o,t.render(),this._setStylesFromOptions()}},{key:"_onKnobDragStart",value:function(e){this._knobChangedManually=!0,this._initialKnobPosition=this.state.knobPosition.clone()}},{key:"_onKnobDrag",value:function(e){var t=this.context.editor,n=t.getOutputDimensions(),i=this._initialKnobPosition.clone().add(e).clamp(new u.Vector2(0,0),n),r=this._operation.getPosition().clone().multiply(n),o=i.clone().subtract(r).abs().len(),a=o/2;this.setState({knobPosition:i,areaDimensions:new u.Vector2(2*o,2*o)}),this._operation.set({radius:o/n.min(),gradientRadius:a/n.min()}),t.render()}},{key:"_getAreaStyle",value:function(){return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:-.5*this.state.areaDimensions.x,marginTop:-.5*this.state.areaDimensions.y}}},{key:"_getKnobStyle",value:function(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y}}},{key:"_setStylesFromOptions",value:function(){var e=this.context.editor,t=e.getOutputDimensions(),n=this._operation.getPosition().clone().multiply(t),i=this._operation.getRadius()*t.min(),r=2*i,o=new u.Vector2(r,r),a={areaDimensions:o,areaPosition:n};this._knobChangedManually||(a.knobPosition=n.clone().add(i,0)),this.setState(a)}},{key:"_getContainerStyle",value:function(){var e=this.context.editor,t=e.getSDK().getSprite().getBounds();return{left:t.x,top:t.y,width:t.width,height:t.height}}},{key:"renderWithBEM",value:function(){return u.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container",style:this._getContainerStyle()},u.ReactBEM.createElement("div",{bem:"$b:radialFocusCanvasControls"},u.ReactBEM.createElement(p.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},u.ReactBEM.createElement("div",{bem:"e:area",style:this._getAreaStyle()})),u.ReactBEM.createElement(p.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},u.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getKnobStyle()}))))}}]),t}(d.default);t.default=_,_.contextTypes=d.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(4),u=i(c),f=n(135),p=i(f),h=n(137),d=i(h),_=l.SDK.Operations.SpriteOperation,m=_.StickerSprite,y=_.BrushSprite,g=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,null,[{key:"onExit",value:function(){var e=this.context.editor,t=this.getSharedState("operation");this.getSharedState("skipHistory")||e.history.add(t,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore")),e.zoom.restore(),e.features.enable("zoom","drag"),e.render()}},{key:"onEnter",value:function(e){var t=this.context.editor,n=t.operations.exists("sprite"),i=t.operations.getOrCreate("sprite"),r=i.getSprites(),o=i.getSpritesOfType(m),a=i.serializeOptions();t.zoom.save(),t.zoom.set("auto"),t.features.disable("zoom","drag"),this.setSharedState({operationExistedBefore:n,operation:i,sprites:r,stickers:o,initialOptions:a})}},{key:"clickAtPosition",value:function(e,t){if(!t.operations.exists("sprite"))return!1;var n=t.operations.getOrCreate("sprite"),i=n.getSpritesAtPosition(e,t.getOutputTextureDimensions()).filter(function(e){return!(e instanceof y)});return!!(i.length&&i[0]instanceof m)&&{selectedSprite:i[0]}}},{key:"isAvailable",value:function(e){return e.isToolAllowed("sticker")&&e.isToolEnabled("sticker")}}]),t}(u.default);g.controlsComponent=p.default,g.canvasControlsComponent=d.default,g.identifier="sticker",g.iconPath="controls/overview/sticker.png",g.languageKey="controls.overview.sticker",g.defaultOptions={categories:null,replaceCategories:!1,availableStickers:null,tooltips:!1,hideCategories:!1,fixedRatio:!0,snapRotation:90,snapRotationTolerance:5,smoothDownscaling:!1},g.requiredOperations=["sprite"],g.getPreloadAssets=u.default.getPreloadAssets,t.default=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},f=n(0),p=n(3),h=i(p),d=n(2),_=i(d),m=n(44),y=i(m),g=n(1),v=i(g),b=n(11),k=i(b),w=n(136),O=i(w),E=function(e){function t(){var e;o(this,t);for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];var l=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return l._bindAll("_onStickerMouseLeave","_renderTooltipCanvas","_onCategoryChange","_onBeforeHistoryUndo"),l._events=r({},f.Constants.EVENTS.HISTORY_BEFORE_UNDO,l._onBeforeHistoryUndo),l._operation=l.getSharedState("operation"),l._sprites=l.getSharedState("sprites"),l._stickers=l.getSharedState("stickers"),l._initStickerManager(),l.state={category:l._stickerManager.getCategory("all")},l}return s(t,e),c(t,[{key:"_onBeforeHistoryUndo",value:function(e){var t=e.operation,n=e.options;if(t===this.getSharedState("operation")){-1===n.sprites.indexOf(this.getSharedState("selectedSprite"))&&(this.setSharedState({skipHistory:!0},!1),this.props.onSwitchControls("home"))}}},{key:"_onCategoryChange",value:function(e){var t=this;this.setState({category:e},function(){t.refs.scrollbar.update()})}},{key:"componentDidMount",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this.props.options.stickersJSONPath&&this._loadExternalStickers();var e=this.context.editor;e.zoom.set("auto",function(){e.features.disable("zoom","drag")})}},{key:"_loadExternalStickers",value:function(){var e=this,t=null,n=setTimeout(function(){t=v.default.instance.displayLoading(e._t("loading.loading"))},100),i=function(){n&&(clearTimeout(n),n=null),t&&t.close(),e._jsonLoaded=!0};this._stickerManager.loadExternal(this.props.options.stickersJSONPath).then(function(t){i(),e.forceUpdate(function(){e.refs.scrollbar.update()})}).catch(function(t){i(),v.default.instance.displayError(e._t("errors.loadingStickersFailed.title"),t.message).on("close",function(){e.props.onBack()})})}},{key:"_renderTooltipCanvas",value:function(){var e=this,t=this.state.hoveredSticker,n=new window.Image,i=t.images.mediaBase;n.addEventListener("load",function(){if(e.state.tooltipVisible&&e.state.hoveredSticker===t){void 0!==i.width&&void 0!==i.height&&(n.width=i.width,n.height=i.height);var r=e.refs.tooltipCanvas;r.width=r.offsetWidth,r.height=r.offsetHeight;var o=r.getContext("2d"),a=Math.min(r.width/n.width,r.height/n.height),s=new f.Vector2(n.width,n.height).multiply(a),l=new f.Vector2(r.width,r.height).divide(2).subtract(s.clone().divide(2));o.drawImage(n,0,0,n.width,n.height,l.x,l.y,s.x,s.y)}});var r=this._getAssetPath(k.default.getURLForSticker(t,"base"));n.crossOrigin="Anonymous",n.src=r}},{key:"_initStickerManager",value:function(){this._stickerManager=new k.default(this.context.ui,this.props.options)}},{key:"_onBackClick",value:function(e){this._backButtonClicked=!0,this.props.onSwitchControls("home")}},{key:"_onStickerClick",value:function(e){var t=this,n=e.images.mediaBase,i=k.default.getURLForSticker(e,"base"),r=this._getAssetPath(i),o=new window.Image,a=void 0,s=setTimeout(function(){a=v.default.instance.displayLoading(t._t("loading.loading"))},100);o.addEventListener("load",function(){a&&a.close(),s&&(clearTimeout(s),s=null),void 0!==n.width&&void 0!==n.height&&(o.width=n.width,o.height=n.height);var i=t.context.editor,r=t._calculateInitialStickerScale(e,o),l=t._operation.createSticker({identifier:e.identifier,image:o,position:new f.Vector2(.5,.5),dimensions:new f.Vector2(o.width,o.height).multiply(r),rotation:0,smoothDownscaling:t.props.options.smoothDownscaling});t._operation.addSprite(l),t._stickers.push(l),i.render(function(){t.setSharedState({selectedSprite:l,sprites:t._sprites,stickers:t._stickers})})}),o.addEventListener("error",function(){a&&a.close(),s&&(clearTimeout(s),s=null),v.default.instance.displayError(t._t("errors.imageLoadFail.title"),t._t("errors.imageLoadFail.text",{path:o.src}))}),o.crossOrigin="Anonymous",o.src=r}},{key:"_calculateInitialStickerScale",value:function(e,t){var n=this.getSharedState("operation"),i=n.getInputDimensions(!1),r=new f.Vector2(t.width,t.height);return f.SDKUtils.resizeVectorToFit(r,i.clone().multiply(.5)).x/r.x}},{key:"_onStickerMouseEnter",value:function(e,t){var n=this;this.setState({tooltipVisible:!0,hoveredSticker:e,hoveredStickerElement:t.currentTarget},function(){n._renderTooltipCanvas(),n._updateTooltipPosition()})}},{key:"_updateTooltipPosition",value:function(){var e=this.state.hoveredStickerElement,t=this.refs.root,n=e.getBoundingClientRect(),i=t.getBoundingClientRect();this.setState({tooltipPosition:n.left-i.left})}},{key:"_onStickerMouseLeave",value:function(){this.setState({tooltipVisible:!1,hoveredSticker:null})}},{key:"_renderListItems",value:function(){var e=this,t=this.props.options,n=t.stickersJSONPath,i=t.replaceCategories;if(!n||!i||this._jsonLoaded){return this._stickerManager.getStickersForCategory(this.state.category.identifier).map(function(t,n){var i=e.props.options,r=i.tooltips?{onMouseEnter:e._onStickerMouseEnter.bind(e,t),onMouseLeave:e._onStickerMouseLeave}:null;return f.ReactBEM.createElement(O.default,l({sticker:t,onClick:e._onStickerClick.bind(e,t)},r))})}}},{key:"_renderTooltip",value:function(){var e=this.props.options.tooltips&&this.state.tooltipVisible,t={left:this.state.tooltipPosition};return e?f.ReactBEM.createElement("div",{bem:"e:cell m:empty"},f.ReactBEM.createElement("div",{bem:"$b:stickersControls $e:tooltip",style:t},f.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"tooltipCanvas"}))):null}},{key:"_renderCategoryDropdown",value:function(){var e=this,t=this.props.options,n=t.stickersJSONPath,i=t.replaceCategories;if(!n||!i||this._jsonLoaded){var r=this._stickerManager.getCategories(!0);if(!(!this.props.options.hideCategories&&r.length>1))return null;var o=r.map(function(t){return{identifier:t.identifier,item:t,label:e._t("controls.sticker.categories."+t.identifier)||t.defaultName,icon:e._getAssetPath("controls/stickers/categories/"+t.identifier+".png",!0)}}),a=this.state.category,s={identifier:a.identifier,item:a,label:this._t("controls.sticker.categories."+a.identifier)||a.defaultName,icon:this._getAssetPath("controls/stickers/categories/"+a.identifier+".png",!0)};return f.ReactBEM.createElement("div",{bem:"e:cell m:categoryDropdown"},f.ReactBEM.createElement(y.default,{items:o,selectedItem:s,onChange:this._onCategoryChange}))}}},{key:"renderControls",value:function(){var e=this._renderListItems();return[this._renderTooltip(),this._renderCategoryDropdown(),f.ReactBEM.createElement("div",{bem:"e:cell m:list"},f.ReactBEM.createElement(_.default,{ref:"scrollbar"},f.ReactBEM.createElement("ul",{bem:"$e:list"},e)))]}}]),t}(h.default);t.default=E,E.contextTypes=h.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(11),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s.state={sticker:s.props.sticker},s}return o(t,e),a(t,[{key:"componentDidMount",value:function(){this._renderSticker()}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.props.sticker!==e.sticker&&this.setState({sticker:e.sticker},function(){t._renderSticker()})}},{key:"_renderSticker",value:function(){var e=this.context.editor,t=e.getSDK(),n=this.props.sticker,i=n.images.mediaThumb,r=c.default.getURLForSticker(n,"thumb"),o=this._getAssetPath(r),a=this.refs["canvas-"+n.name],l=t.getPixelRatio();a.width=a.offsetWidth*l,a.height=a.offsetHeight*l,a.style.width=a.offsetWidth+"px",a.style.height=a.offsetHeight+"px";var u=a.getContext("2d"),f=new window.Image;f.addEventListener("load",function(){void 0===i.width||void 0===i.height||s.Utils.Browser.getIEVersion()||(f.width=i.width,f.height=i.height);var e=Math.min(a.width/f.width,a.height/f.height),t=new s.Vector2(f.width,f.height).multiply(e),n=new s.Vector2(a.width,a.height).divide(2).subtract(t.clone().divide(2));u.drawImage(f,0,0,f.width,f.height,n.x,n.y,t.x,t.y)}),f.crossOrigin="Anonymous",f.src=o}},{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("li",{bem:"$b:stickersControls $e:item",key:this.props.sticker.name,onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},s.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas-"+this.props.sticker.name}))}}]),t}(s.BaseComponent);t.default=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(14),u=i(c),f=n(141),p=i(f),h=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_renderOverlayControls",value:function(){if(this.getSharedState("selectedSprite"))return l.ReactBEM.createElement(p.default,{onFlip:this._onSpriteFlip,onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove})}}]),t}(u.default);t.default=h,h.contextTypes=u.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(5),f=i(u),p=n(27),h=i(p),d=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._bindAll("_onTextChange","_onItemDoubleClick","_onItemTouchStart","_onItemTouchEnd","_onResizeKnobDragStart","_onResizeKnobDrag","_onResizeKnobDragStop","_onRotationKnobDragStart","_onRotationKnobDrag","_onRotationKnobDragStop","_onBlur"),s.state={editMode:!1,text:s.props.sprite.getText()},s}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillReceiveProps",this).call(this,e),e.sprite!==this.props.sprite&&(this.refs.textarea.blur(),this.setState({text:e.sprite.getText(),editMode:!1}))}},{key:"_onTextChange",value:function(e){this.props.sprite.setText(e.target.value),this.setState({text:e.target.value})}},{key:"_onItemDoubleClick",value:function(){this.enterEditMode()}},{key:"enterEditMode",value:function(){var e=this,t=this.props.sprite;t.setVisible(!1),t._edited||(t.setText(""),this.refs.textarea.value="",t._edited=!0,this.setState({text:""})),this.setState({editMode:!0},function(){e.refs.textarea.focus(),e.refs.textarea.select()})}},{key:"leaveEditMode",value:function(){this.props.sprite.setVisible(!0)}},{key:"_onItemTouchStart",value:function(e){this._initialTouchPosition=c.Utils.getEventPosition(e),this._tapStartAt=(0,c.now)()}},{key:"_onItemTouchEnd",value:function(){(0,c.now)()-this._tapStartAt<=100&&(void 0!==this._lastTapAt&&(0,c.now)()-this._lastTapAt<=300&&this._onItemDoubleClick(),this._lastTapAt=(0,c.now)())}},{key:"_onRotationKnobDragStart",value:function(e,t){this._dragging=!0,this._initialPosition=this._getRotationKnobPosition(),this.props.onDragStart&&this.props.onDragStart()}},{key:"_onRotationKnobDrag",value:function(e,t){var n=this.props.sprite,i=this.context.editor,r=this._getAbsoluteSpritePosition(),o=this._initialPosition.clone().add(e),a=o.clone().subtract(r),s=n.getDimensions(i.getSDK(),i.getOutputDimensions()),l=Math.atan2(a.y/2,a.x/2)-Math.atan2(s.y/2,s.x/2);n.setRotation(l),i.render(),this.forceUpdate()}},{key:"_onRotationKnobDragStop",value:function(e){this.props.onDragStop&&this.props.onDragStop()}},{key:"_onResizeKnobDragStart",value:function(e,t){this._initialPosition=this._getResizeKnobPosition(),this.props.onDragStart&&this.props.onDragStart()}},{key:"_onResizeKnobDrag",value:function(e,t){var n=this.props.sprite,i=n.getRotation(),r=this.context.editor,o=r.getOutputDimensions(),a=Math.cos(i),s=Math.sin(i),l=this._initialPosition.clone().add(e),c=this._getAbsoluteSpritePosition(),u=l.clone().subtract(c),f=Math.max((u.x*a+u.y*s)/o.x*2,.1);n.setMaxWidth(f),r.render()}},{key:"_onResizeKnobDragStop",value:function(e){this.props.onDragStop&&this.props.onDragStop()}},{key:"_onBlur",value:function(){this.leaveEditMode()}},{key:"_getRotationKnobStyle",value:function(){var e=this._getRotationKnobPosition();return{left:e.x,top:e.y}}},{key:"_getResizeKnobStyle",value:function(){var e=this._getResizeKnobPosition();return{left:e.x,top:e.y}}},{key:"_getTextStyle",value:function(){var e=this.context.editor,t=this.props.sprite,n=e.getSDK(),i=e.getOutputDimensions(),r=t.getDOMStyle(n,i),o=this._getAbsoluteSpritePosition(),a=t.getDimensions(n,i);return r.height=Math.min(a.y,i.y-o.y),this.state.editMode||(r.display="none"),r}},{key:"_getItemContainerStyle",value:function(){var e=this.context.editor,t=this.props.sprite,n=e.getOutputDimensions(),i=t.getDimensions(e.getSDK(),n),r=t.getPosition().clone().multiply(n),o=180*t.getRotation()/Math.PI,a="rotateZ("+o.toFixed(2)+"deg)",s=i.x,l=i.y;return{width:s,height:l,left:r.x-.5*s,top:r.y-.5*l,marginLeft:0,marginTop:0,transform:a,MozTransform:a,msTransform:a,WebkitTransform:a,transformOrigin:"50% 50%",MozTransformOrigin:"50% 50%",msTransformOrigin:"50% 50%",WebkitTransformOrigin:"50% 50%"}}},{key:"_getRotationKnobPosition",value:function(){var e=this.props.sprite,t=this.context.editor,n=Math.sin(e.getRotation()),i=Math.cos(e.getRotation()),r=t.getOutputDimensions(),o=e.getDimensions(t.getSDK(),r),a=o.clone().divide(2);return e.getPosition().clone().multiply(r).add(a.x*i-a.y*n,a.x*n+a.y*i)}},{key:"_getResizeKnobPosition",value:function(){var e=this.props.sprite,t=this.context.editor,n=Math.sin(e.getRotation()),i=Math.cos(e.getRotation()),r=t.getOutputDimensions(),o=e.getDimensions(t.getSDK(),r),a=o.clone().divide(2);return e.getPosition().clone().multiply(r).add(a.x*i+a.y*n,a.x*n-a.y*i)}},{key:"_renderKnobs",value:function(){var e=[];return this.props.selected&&!this.state.editMode&&(e=[c.ReactBEM.createElement(f.default,{onStart:this._onRotationKnobDragStart,onDrag:this._onRotationKnobDrag,onStop:this._onRotationKnobDragStop},c.ReactBEM.createElement("div",{bem:"e:knob m:rotate $b:knob",style:this._getRotationKnobStyle()},c.ReactBEM.createElement("img",{bem:"e:icon m:larger",src:this._getAssetPath("controls/knobs/rotate.png",!0)}))),c.ReactBEM.createElement(f.default,{onStart:this._onResizeKnobDragStart,onDrag:this._onResizeKnobDrag,onStop:this._onResizeKnobDragStop},c.ReactBEM.createElement("div",{bem:"e:knob m:resize $b:knob",style:this._getResizeKnobStyle()},c.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-up.png",!0)})))]),e}},{key:"_renderItem",value:function(){var e=this._getItemContainerStyle(),t=c.ReactBEM.createElement("textarea",{bem:"e:content",ref:"textarea",style:this._getTextStyle(),value:this.state.text,disabled:!this.state.editMode,onBlur:this._onBlur,onChange:this._onTextChange});return c.ReactBEM.createElement("bem",{specifier:"e:text"},c.ReactBEM.createElement("div",{bem:"e:container",style:e},t))}},{key:"_renderSelectedOverlay",value:function(){var e=[];this.props.selected&&e.push("is-selected"),this.state.editMode&&e.push("is-disabled"),e=e.join(" ");var t=this._getItemContainerStyle();return c.ReactBEM.createElement("bem",{specifier:"e:text"},c.ReactBEM.createElement(f.default,{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected||this.props.selected&&this.state.editMode},c.ReactBEM.createElement("div",{bem:"e:selectedOverlay",onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd,style:t,className:e})))}},{key:"renderWithBEM",value:function(){return c.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},c.ReactBEM.createElement("div",{bem:"$e:item e:container"},this._renderItem(),this._renderSelectedOverlay(),this._renderKnobs()))}}]),t}(h.default);t.default=d,d.contextTypes=h.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(5),u=i(c),f=n(27),p=i(f),h=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._bindAll("_onRotateKnobDragStart","_onRotateKnobDrag","_onRotateKnobDragStop"),s._id=l.SDKUtils.getUUID(),s}return a(t,e),s(t,[{key:"_onKnobDragStart",value:function(e,t,n){var i=this.props.sprite;switch(e){case"bottom":this._initialPosition=this._getBottomDragKnobPosition();break;case"top":this._initialPosition=this._getTopDragKnobPosition()}this._initialDimensions=i.getDimensions().clone(),this.props.onDragStart&&this.props.onDragStart()}},{key:"_onKnobDrag",value:function(e,t,n){var i=this.props.sprite,r=this.context.editor,o=this._getAbsoluteSpritePosition(),a=this._initialPosition.clone().add(t),s=a.clone().subtract(o),c=this._initialPosition.clone().subtract(o);if(this.props.options.fixedRatio){var u=this._getStickerDimensions().divide(2).abs(),f=this._initialPosition.clone().subtract(o),p=void 0;switch(e){case"bottom":p=Math.atan2(s.y,s.x)-Math.atan2(u.y,u.x);break;case"top":p=Math.atan2(s.y,s.x)-Math.atan2(-u.y,-u.x)}var h=this._initialDimensions.clone().multiply(s.len()/f.len()),d=this.props.options,_=d.snapRotation,m=d.snapRotationTolerance,y=Math.round(180*p/Math.PI),g=Math.round(y/_)*_,v=y-g;Math.abs(v)<m&&(p=g*Math.PI/180),i.set({dimensions:h,rotation:p})}else{var b=this.context.editor.zoom.get(),k=i.getRotation(),w=Math.cos(-1*k),O=Math.sin(-1*k),E=new l.Vector2(s.x*w-s.y*O,s.x*O+s.y*w),S=new l.Vector2(c.x*w-c.y*O,c.x*O+c.y*w),P=void 0;switch(e){case"bottom":P=E.clone().subtract(S);break;case"top":P=S.clone().subtract(E)}var C=this._initialDimensions.clone().add(P.clone().divide(b).multiply(2));i.set({dimensions:C})}r.render()}},{key:"_onKnobDragStop",value:function(){this.props.onDragStop&&this.props.onDragStop()}},{key:"_onRotateKnobDragStart",value:function(e,t){this._initialPosition=this._getRotateKnobPosition(),this.props.onDragStart&&this.props.onDragStart()}},{key:"_onRotateKnobDragStop",value:function(){this.props.onDragStop&&this.props.onDragStop()}},{key:"_onRotateKnobDrag",value:function(e,t){var n=this.props.sprite,i=this.context.editor,r=this._getAbsoluteSpritePosition(),o=this._initialPosition.clone().add(e),a=this._getStickerDimensions().divide(2),s=o.clone().subtract(r),l=void 0;l=Math.atan2(s.y,s.x)-Math.atan2(-a.y,a.x),n.set({rotation:l}),i.render()}},{key:"_getBottomDragKnobStyle",value:function(){var e=this._getBottomDragKnobPosition();return{left:e.x,top:e.y}}},{key:"_getTopDragKnobStyle",value:function(){var e=this._getTopDragKnobPosition();return{left:e.x,top:e.y}}},{key:"_getRotateKnobStyle",value:function(){var e=this._getRotateKnobPosition();return{left:e.x,top:e.y}}},{key:"_getStickerStyle",value:function(){var e=this.props.sprite,t=this._getStickerDimensions().abs(),n=this._getAbsoluteSpritePosition().subtract(t.clone().divide(2)),i=180*e.getRotation()/Math.PI,r="rotate("+i.toFixed(2)+"deg)",o=e.getDimensions(),a=e.getFlipVertically();o.y<0&&(a=!a),a&&(r+=" scaleY(-1)");var s=e.getFlipHorizontally();return o.x<0&&(s=!s),s&&(r+=" scaleX(-1)"),{top:n.y,left:n.x,width:t.x,height:t.y,WebkitTransform:r,msTransform:r,MozTransform:r,OTransform:r}}},{key:"_getStickerDimensions",value:function(){var e=this.props.sprite,t=this.context.editor;return e.getDimensions().clone().multiply(t.zoom.get())}},{key:"_getRotateKnobPosition",value:function(){var e=this.props.sprite,t=this._getAbsoluteSpritePosition(),n=e.getRotation(),i=Math.sin(n||0),r=Math.cos(n||0),o=this._getStickerDimensions().divide(2);return t.clone().add(o.x*r+o.y*i,o.x*i-o.y*r)}},{key:"_getBottomDragKnobPosition",value:function(){var e=this.props.sprite,t=this._getAbsoluteSpritePosition(),n=e.getRotation(),i=Math.sin(n||0),r=Math.cos(n||0),o=this._getStickerDimensions().divide(2);return t.clone().add(o.x*r-o.y*i,o.x*i+o.y*r)}},{key:"_getTopDragKnobPosition",value:function(){var e=this.props.sprite,t=this._getAbsoluteSpritePosition(),n=e.getRotation(),i=Math.sin(n||0),r=Math.cos(n||0),o=this._getStickerDimensions(e).divide(2);return t.clone().subtract(o.x*r-o.y*i,o.x*i+o.y*r)}},{key:"_renderKnobs",value:function(){var e=[];return this.props.selected&&(e=[l.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart.bind(this,"bottom"),onStop:this._onKnobDragStop.bind(this,"bottom"),onDrag:this._onKnobDrag.bind(this,"bottom")},l.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getBottomDragKnobStyle()},l.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)}))),l.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart.bind(this,"top"),onStop:this._onKnobDragStop.bind(this,"top"),onDrag:this._onKnobDrag.bind(this,"top")},l.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getTopDragKnobStyle()},l.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)})))],this.props.options.fixedRatio||e.push(l.ReactBEM.createElement(u.default,{onStart:this._onRotateKnobDragStart,onStop:this._onRotateKnobDragStop,onDrag:this._onRotateKnobDrag},l.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getRotateKnobStyle()},l.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/rotate.png",!0)}))))),e}},{key:"_renderSVGFilter",value:function(){if(this.props.hideContent)return null;var e=this.props.sprite,t=e.getAdjustments(),n=t.getBrightness(),i=t.getSaturation(),r=t.getContrast(),o="<filter id='pesdk-sticker-"+this._id+"-filter'>\n        <feComponentTransfer>\n          <feFuncR type='linear' intercept='"+n+"' />\n          <feFuncG type='linear' intercept='"+n+"' />\n          <feFuncB type='linear' intercept='"+n+"' />\n        </feComponentTransfer>\n        <feColorMatrix type='saturate' values='"+i+"' />\n        <feComponentTransfer>\n          <feFuncR type='linear' slope='"+r+"' intercept='"+(-.5*r+.5)+"' />\n          <feFuncG type='linear' slope='"+r+"' intercept='"+(-.5*r+.5)+"' />\n          <feFuncB type='linear' slope='"+r+"' intercept='"+(-.5*r+.5)+"' />\n        </feComponentTransfer>\n      </filter>";return l.ReactBEM.createElement("svg",{width:"0",height:"0","color-interpolation-filters":"sRGB",is:"svg"},l.ReactBEM.createElement("defs",{key:Math.random(),dangerouslySetInnerHTML:{__html:o}}))}},{key:"_renderSelectedOverlay",value:function(){var e=[];this.props.selected&&e.push("is-selected"),e=e.join(" ");var t=this._getStickerStyle();return l.ReactBEM.createElement("bem",{specifier:"e:text"},l.ReactBEM.createElement(u.default,{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected},l.ReactBEM.createElement("div",{bem:"e:selectedOverlay",onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd,style:t,className:e})))}},{key:"_renderItem",value:function(){if(this.props.hideContent)return null;var e=this.props.sprite,t=this._getStickerStyle(),n=window.location.href.replace(window.location.hash,""),i={filter:'url("'+n+"#pesdk-sticker-"+this._id+'-filter")'},r={width:t.width,height:t.height};return l.ReactBEM.createElement("bem",{specifier:"e:sticker"},l.ReactBEM.createElement("div",{bem:"e:container",style:t},l.ReactBEM.createElement("svg",{width:parseInt(t.width),height:parseInt(t.height),"color-interpolation-filters":"sRGB",is:"svg",style:r,preserveAspectRatio:"none"},l.ReactBEM.createElement("image",{xlinkHref:e.getImage().src,width:t.width,height:t.height,style:i,preserveAspectRatio:"none"}))))}},{key:"renderWithBEM",value:function(){return l.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},l.ReactBEM.createElement("div",{bem:"$e:item e:container"},this._renderSVGFilter(),this._renderItem(),this._renderSelectedOverlay(),this._renderKnobs()))}}]),t}(p.default);t.default=h,h.contextTypes=p.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=n(27),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"componentDidMount",value:function(){if(s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),!this.props.hideContent){var e=this.props.sprite.getCanvas();this._appendCanvas(e)}}},{key:"componentWillReceiveProps",value:function(e){if(!this.props.hideContent&&e.sprite!==this.props.sprite){var t=this.props.sprite.getCanvas();t.parentNode.removeChild(t);var n=e.sprite.getCanvas();this._appendCanvas(n)}}},{key:"_isSelected",value:function(){return this.getSharedState("brush")===this.props.sprite}},{key:"_appendCanvas",value:function(e){var t=this.context.editor,n=t.getOutputDimensions();e.style.width=n.x+"px",e.style.height=n.y+"px",this.refs.brush.appendChild(e)}},{key:"renderWithBEM",value:function(){if(this.props.hideContent)return null;var e=this._isSelected()?"is-selected":null;return l.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},l.ReactBEM.createElement("div",{bem:"$e:item e:container m:full",ref:"container"},l.ReactBEM.createElement("div",{bem:"$e:brush",className:e,ref:"brush"})))}}]),t}(u.default);t.default=f,f.contextTypes=u.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"_onFlipClick",value:function(e,t){t.preventDefault(),t.stopPropagation(),this.props.onFlip&&this.props.onFlip(e)}},{key:"_onTakeToFrontClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.onTakeToFront&&this.props.onTakeToFront()}},{key:"_onRemoveClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.onRemove&&this.props.onRemove()}},{key:"_renderItems",value:function(){return[s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onFlipClick.bind(this,"h")},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/flip-h.png",!0)})),s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onFlipClick.bind(this,"v")},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/flip-v.png",!0)})),s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onTakeToFrontClick.bind(this)},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take-to-front.png",!0)})),s.ReactBEM.createElement("div",{bem:"$e:separator"}),s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onRemoveClick.bind(this)},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/remove.png",!0)}))]}},{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("div",{bem:"$b:spritesControlsOverlay"},this._renderItems())}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(4),u=i(c),f=n(143),p=i(f),h=n(145),d=i(h),_=n(46),m=i(_),y=l.SDK.Operations.SpriteOperation,g=y.TextSprite,v=y.BrushSprite,b=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,null,[{key:"onExit",value:function(){var e=this.context.editor,t=this.getSharedState("operation");this.getSharedState("skipHistory")||e.history.add(t,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore")),e.zoom.restore(),e.features.enable("zoom","drag"),e.render()}},{key:"onEnter",value:function(e,t){var n=this.context,i=n.editor,r=n.ui,o=i.operations.exists("sprite"),a=i.operations.getOrCreate("sprite"),s=a.getSprites(),l=a.serializeOptions(),c=new m.default(r,t),u=c.getDefaultVariation();this.setSharedState({operationExistedBefore:o,operation:a,sprites:s,initialOptions:l,fontManager:c,defaultFontVariation:u,fonts:c.getFonts()}),i.zoom.save(),i.render()}},{key:"clickAtPosition",value:function(e,t){if(!t.operations.exists("sprite"))return!1;var n=t.operations.getOrCreate("sprite"),i=n.getSpritesAtPosition(e,t.getOutputTextureDimensions()).filter(function(e){return!(e instanceof v)});return!!(i.length&&i[0]instanceof g)&&{selectedSprite:i[0]}}},{key:"isAvailable",value:function(e){return e.isToolAllowed("text")&&e.isToolEnabled("text")}},{key:"getPreloadAssets",value:function(e){return["controls/text/align_left.png","controls/text/align_right.png","controls/text/align_center.png","controls/text/minus.png","controls/text/plus.png"]}}]),t}(u.default);b.controlsComponent=d.default,b.canvasControlsComponent=p.default,b.identifier="text",b.iconPath="controls/overview/text.png",b.languageKey="controls.overview.text",b.defaultOptions={fonts:[],replaceFonts:!1,availableVariations:null},b.requiredOperations=["sprite"],t.default=b},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(14),f=i(u),p=n(144),h=i(p),d=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._bindAll("_onTextEdit"),s}return a(t,e),s(t,[{key:"_onItemBlur",value:function(){var e=this.getSharedState("selectedSprite");e&&""===e.getText()&&(e.setText(this._t("controls.text.defaultText")),e._edited=!1)}},{key:"_onSpriteRemove",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onSpriteRemove",this).call(this),this.props.onSwitchControls("home")}},{key:"_onTextEdit",value:function(){var e=this.getSharedState("selectedSprite");this.refs["sprite-"+e.getId()].enterEditMode()}},{key:"_renderOverlayControls",value:function(){if(this.getSharedState("selectedSprite"))return c.ReactBEM.createElement(h.default,{onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove,onEdit:this._onTextEdit})}}]),t}(f.default);t.default=d,d.contextTypes=f.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"_onEditClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.onEdit&&this.props.onEdit()}},{key:"_onTakeToFrontClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.onTakeToFront&&this.props.onTakeToFront()}},{key:"_onRemoveClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.onRemove&&this.props.onRemove()}},{key:"_renderItems",value:function(){var e=[s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onTakeToFrontClick.bind(this)},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take-to-front.png",!0)}))];return s.Utils.isTouchDevice()&&(e=e.concat([s.ReactBEM.createElement("div",{bem:"$e:separator"}),s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onEditClick.bind(this)},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/edit.png",!0)}))])),e=e.concat([s.ReactBEM.createElement("div",{bem:"$e:separator"}),s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onRemoveClick.bind(this)},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/remove.png",!0)}))])}},{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("div",{bem:"$b:spritesControlsOverlay"},this._renderItems())}}]),t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},u=n(0),f=n(3),p=i(f),h=n(2),d=i(h),_=n(28),m=i(_),y=n(6),g=i(y),v=n(45),b=i(v),k=n(150),w=i(k),O=n(1),E=i(O),S=["left","center","right"],P=function(e){function t(){var e;o(this,t);for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];var l=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return l._bindAll("_onFontSizeChange","_onFontChange","_onAlignmentClick","_onTakeToFrontClick","_onForegroundColorChange","_onBackgroundColorChange","_onBeforeHistoryUndo"),l._events=r({},u.Constants.EVENTS.HISTORY_BEFORE_UNDO,l._onBeforeHistoryUndo),l._operation=l.getSharedState("operation"),l._fontLoader=l.context.ui.getFontLoader(),l._fontLoader.setFonts(l.getSharedState("fonts")),l.state={mode:null,loading:!0},l.context.editor.render(),l._fonts=l.getSharedState("fonts"),l}return s(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this;c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var n=this.context.editor;n.zoom.set("auto",function(){n.features.disable("zoom","drag")});var i=function(){e._createText(),e.setState({loading:!1})};this._fontLoader.needsToLoad()?this._loadFonts().then(i.bind(this)):i()}},{key:"_loadFonts",value:function(){var e=this,t=E.default.instance.displayLoading(this._t("loading.loading"));return this._fontLoader.load().then(function(){t.close()}).catch(function(n){t.close(),E.default.instance.displayWarning(e._t("errors.loadingFontsFailed.title"),e._t("errors.loadingFontsFailed.text"))})}},{key:"_createText",value:function(){var e=this.context.editor,t=this.getSharedState("selectedSprite"),n=this.getSharedState("operation"),i=this.getSharedState("defaultFontVariation"),r=e.getOutputDimensions();if(!t){var o=e.getSDK(),a=o.getRenderer(),s=a.getMaxTextureSize(),l=n.createText({fontIdentifier:i.getIdentifier(),text:this._t("controls.text.defaultText"),position:new u.Vector2(.5,.5),pivot:new u.Vector2(.5,.5),maxWidth:.5,maxHeight:s?s/r.y:3,fontSize:.08,fontFamily:i.getFont().getFontFamily(),fontWeight:i.getFontWeight(),fontStyle:i.getFontStyle(),alignment:"center"});n.addSprite(l),this.setSharedState({selectedSprite:l}),e.render()}}},{key:"_onBeforeHistoryUndo",value:function(e){var t=e.operation,n=e.options;if(t===this.getSharedState("operation")){-1===n.sprites.indexOf(this.getSharedState("selectedSprite"))&&(this.setSharedState({skipHistory:!0},!1),this.props.onSwitchControls("home"))}}},{key:"_onBackClick",value:function(e){this.context.editor.render(),this._backButtonClicked=!0,this.props.onSwitchControls("home")}},{key:"sharedStateDidChange",value:function(e){"selectedSprite"in e&&this.forceUpdate()}},{key:"_onFontSizeChange",value:function(e){var t=this.context.editor,n=this.context.editor.getOutputDimensions();this.getSharedState("selectedSprite").setFontSize(e/n.y),this.forceUpdate(),t.render()}},{key:"_onFontChange",value:function(e){var t=this.context.editor,n=this.getSharedState("selectedSprite");n.setFontFamily(e.getFont().getFontFamily()),n.setFontWeight(e.getFontWeight()),n.setFontStyle(e.getFontStyle()),n.setFontIdentifier(e.getIdentifier()),this.forceUpdate(),t.render()}},{key:"_onAlignmentClick",value:function(e){var t=this.context.editor,n=this.getSharedState("selectedSprite"),i=n.getAlignment(),r=S.indexOf(i),o=(r+1)%S.length,a=S[o];n.setAlignment(a),this.forceSharedUpdate(),t.render()}},{key:"_onTakeToFrontClick",value:function(e){var t=this.context.editor;this.getSharedState("operation").takeSpriteToFront(this.getSharedState("selectedSprite")),this.forceSharedUpdate(),t.render()}},{key:"_onForegroundColorChange",value:function(e){var t=this.context.editor;this.getSharedState("selectedSprite").setColor(e),t.render()}},{key:"_onBackgroundColorChange",value:function(e){var t=this.context.editor;this.getSharedState("selectedSprite").setBackgroundColor(e),t.render()}},{key:"_switchToMode",value:function(e){e===this.state.mode&&(e=null),this.setState({mode:e})}},{key:"renderOverlayControls",value:function(){switch(this.state.mode){case"size":return this._renderFontSizeOverlayControl();case"font":return this._renderFontFamilyOverlayControl();default:return null}}},{key:"_renderFontSizeOverlayControl",value:function(){var e=this.getSharedState("selectedSprite");if(e){var t=this.context.editor,n=t.getOutputDimensions(),i=Math.round(n.y),r=Math.round(e.getFontSize()*n.y);return u.ReactBEM.createElement(g.default,{value:r,minValue:.05*n.y,maxValue:i,label:this._t("controls.text.size"),onChange:this._onFontSizeChange})}}},{key:"_renderSizeItem",value:function(){var e=this.getSharedState("selectedSprite");if(e){var t=this.context.editor.getOutputDimensions(),n=e.getFontSize(),i="size"===this.state.mode?"is-active":null;return u.ReactBEM.createElement("li",{bem:"e:item",key:"size"},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:i,"data-identifier":"fontSize",onClick:this._switchToMode.bind(this,"size")},u.ReactBEM.createElement("div",{bem:"b:fontSize e:text"},Math.round(n*t.y)),u.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.size")))))}}},{key:"_renderFontFamilyOverlayControl",value:function(){var e=this.getSharedState("selectedSprite");if(e)return u.ReactBEM.createElement(w.default,{fontFamily:e.getFontFamily(),fontWeight:e.getFontWeight(),fontStyle:e.getFontStyle(),fonts:this._fonts,onChange:this._onFontChange})}},{key:"_renderFontItem",value:function(){var e=this.getSharedState("selectedSprite");if(e){var t="font"===this.state.mode?"is-active":null;return u.ReactBEM.createElement("li",{bem:"e:item",key:"font"},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:t,"data-identifier":"font",onClick:this._switchToMode.bind(this,"font")},u.ReactBEM.createElement(b.default,{fontFamily:e.getFontFamily(),fontWeight:e.getFontWeight(),fontStyle:e.getFontStyle()}),u.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.font")))))}}},{key:"_renderAlignmentItem",value:function(){var e=this.getSharedState("selectedSprite");if(e){var t=e.getAlignment();return u.ReactBEM.createElement("li",{bem:"e:item",key:"alignment"},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:this._onAlignmentClick,"data-identifier":"alignment"},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/text/align_"+t+".png",!0)}),u.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.alignment")))))}}},{key:"_renderTakeToFrontItem",value:function(){return u.ReactBEM.createElement("li",{bem:"e:item",key:"takeToFront"},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:this._onTakeToFrontClick},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take_to_front.png",!0)}),u.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.takeToFront")))))}},{key:"renderControls",value:function(){if(this.state.loading)return u.ReactBEM.createElement("div",null);var e=[this._renderSizeItem(),this._renderFontItem(),this._renderAlignmentItem()],t=this.getSharedState("selectedSprite"),n=t.getColor().clone(),i=t.getBackgroundColor().clone();return[u.ReactBEM.createElement("div",{bem:"e:cell m:list"},u.ReactBEM.createElement(d.default,{ref:"scrollbar"},u.ReactBEM.createElement("ul",{bem:"$e:list"},e))),u.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},u.ReactBEM.createElement(m.default,{initialValue:n,label:this._t("controls.text.foreground"),onChange:this._onForegroundColorChange})),u.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},u.ReactBEM.createElement(m.default,{initialValue:i,label:this._t("controls.text.background"),onChange:this._onBackgroundColorChange}))]}}]),t}(p.default);t.default=P,P.contextTypes=p.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(147),f=i(u),p=n(148),h=i(p),d=n(149),_=i(d),m=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));s._value=s.props.initialValue.clone();var l=s._value.toHSV(),c=l[0],u=l[1],f=l[2];return s._hsv={h:c,s:u,v:f},s._bindAll("_onElementClick","_onColorChange","_onDocumentClick"),s}return a(t,e),s(t,[{key:"componentDidMount",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),document.addEventListener("click",this._onDocumentClick)}},{key:"componentWillUnmount",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this),document.removeEventListener("click",this._onDocumentClick)}},{key:"_onDocumentClick",value:function(e){for(var t=e.target;t;t=t.parentNode)if(t===this.refs.root)return;this.props.onClose&&this.props.onClose()}},{key:"_onElementClick",value:function(e){e.stopPropagation()}},{key:"_onColorChange",value:function(e){this._value=e,this.props.onChange&&this.props.onChange(e)}},{key:"renderWithBEM",value:function(){var e=void 0;return!1!==this.props.alpha&&(e=c.ReactBEM.createElement(f.default,{initialValue:this._value,onChange:this._onColorChange})),c.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:overlay",onClick:this._onElementClick,ref:"root"},e,c.ReactBEM.createElement("div",{bem:"e:bottom"},c.ReactBEM.createElement(h.default,{initialValue:this._value,onChange:this._onColorChange}),c.ReactBEM.createElement(_.default,{initialValue:this._value,onChange:this._onColorChange})))}}]),t}(c.BaseComponent);t.default=m,m.contextTypes=c.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=n(5),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onKnobDrag","_onKnobDragStart"),s._value=s.props.initialValue.clone(),s._transparentPatternCanvas=l.Utils.createTransparentPatternCanvas(),s}return o(t,e),a(t,[{key:"componentDidMount",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._renderCanvas()}},{key:"shouldComponentUpdate",value:function(e){var t=e.initialValue;return t!==this._value&&(this._value=t.clone(),this._renderCanvas(),!0)}},{key:"_onKnobDragStart",value:function(e,t){t.target===this.refs.knob?this._initialAlpha=this._value.a:this._setAlphaFromPosition(e)}},{key:"_onKnobDrag",value:function(e,t){var n=this.refs.canvas,i=n.offsetWidth,r=e.x/i;this._setAlpha(this._initialAlpha+r)}},{key:"_getKnobStyle",value:function(){return{left:(100*this._value.a).toFixed(2)+"%",top:"50%"}}},{key:"_setAlpha",value:function(e){this._value.a=e,this._value.a=Math.min(1,Math.max(0,this._value.a)),this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)}},{key:"_setAlphaFromPosition",value:function(e){var t=this.refs.canvas;this._initialAlpha=e.x/t.offsetWidth,this._setAlpha(this._initialAlpha)}},{key:"_renderCanvas",value:function(){var e=this.refs.canvas,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight;var n=t.createPattern(this._transparentPatternCanvas,"repeat");t.fillStyle=n,t.fillRect(0,0,e.width,e.height);var i=t.createLinearGradient(0,0,e.width,e.height),r=this._value.clone();r.a=0,i.addColorStop(0,r.toRGBA()),i.addColorStop(1,this._value.toHex()),t.fillStyle=i,t.fillRect(0,0,e.width,e.height)}},{key:"renderWithBEM",value:function(){return l.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:alpha"},l.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},l.ReactBEM.createElement("div",null,l.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),l.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))}}]),t}(l.BaseComponent);t.default=f,f.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=n(5),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));s._bindAll("_onKnobDrag","_onKnobDragStart"),s._value=s.props.initialValue.clone();var l=s._value.toHSV(),c=l[0],u=l[1],f=l[2];return s._hsvColor={h:c,s:u,v:f},s}return o(t,e),a(t,[{key:"componentDidMount",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._renderCanvas()}},{key:"shouldComponentUpdate",value:function(e){var t=e.initialValue;if(t!==this._value){this._value=t.clone();var n=this._value.toHSV(),i=n[0],r=n[1],o=n[2];return this._hsvColor={h:i,s:r,v:o},this._renderCanvas(),!0}return!1}},{key:"_onKnobDragStart",value:function(e,t){t.target===this.refs.knob?(this._initialValue=this._hsvColor.v,this._initialSaturation=this._hsvColor.s):this._setValuesFromPosition(e)}},{key:"_onKnobDrag",value:function(e,t){var n=this.refs.canvas,i=n.offsetWidth,r=n.offsetHeight,o=e.x/i,a=e.y/r*-1,s=this._hsvColor.h;this._setHSV(s,this._initialSaturation+o,this._initialValue+a)}},{key:"_getKnobStyle",value:function(){var e=this._hsvColor,t=e.s,n=e.v;return{left:(100*t).toFixed(2)+"%",top:(100*(1-n)).toFixed(2)+"%"}}},{key:"_setHSV",value:function(e,t,n){t=Math.max(.01,Math.min(t,.99)),n=Math.max(.01,Math.min(n,.99)),this._value=l.Color.fromHSV(e,t,n,this._value.a),this._hsvColor={h:e,s:t,v:n},this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)}},{key:"_setValuesFromPosition",value:function(e){var t=this.refs.canvas;this._initialSaturation=e.x/t.offsetWidth,this._initialValue=1-e.y/t.offsetHeight;var n=this._hsvColor.h;this._setHSV(n,this._initialSaturation,this._initialValue)}},{key:"_renderCanvas",value:function(){var e=this.refs.canvas,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight;for(var n=t.getImageData(0,0,e.width,e.height),i=0;i<e.height;i++)for(var r=(e.height-i)/e.height,o=0;o<e.width;o++){var a=o/e.width,s=l.Color.fromHSV(this._hsvColor.h,a,r),c=s.r,u=s.g,f=s.b,p=s.a,h=4*(i*e.width+o);n.data[h]=255*c,n.data[h+1]=255*u,n.data[h+2]=255*f,n.data[h+3]=255*p}t.putImageData(n,0,0)}},{key:"renderWithBEM",value:function(){return l.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:saturation"},l.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},l.ReactBEM.createElement("div",null,l.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),l.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))}}]),t}(l.BaseComponent);t.default=f,f.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=n(5),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));s._bindAll("_onKnobDrag","_onKnobDragStart"),s._value=s.props.initialValue.clone();var l=s._value.toHSV(),c=l[0],u=l[1],f=l[2];return s._hsvColor={h:c,s:u,v:f},s.state={value:s.props.initialValue},s}return o(t,e),a(t,[{key:"componentDidMount",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._renderCanvas()}},{key:"shouldComponentUpdate",value:function(e){var t=e.initialValue;if(t!==this._value){this._value=t.clone();var n=this._value.toHSV(),i=n[0],r=n[1],o=n[2];return this._hsvColor={h:i,s:r,v:o},this._renderCanvas(),!0}return!1}},{key:"_onKnobDragStart",value:function(e,t){t.target===this.refs.knob?this._initialHue=this._hsvColor.h:this._setValueFromPosition(e)}},{key:"_onKnobDrag",value:function(e,t){var n=this.refs.canvas,i=n.offsetHeight,r=e.y/i;this._setHue(this._initialHue+r)}},{key:"_getKnobStyle",value:function(){return{left:"50%",top:(100*this._hsvColor.h).toFixed(2)+"%"}}},{key:"_setHue",value:function(e){var t=this._hsvColor,n=t.s,i=t.v;e=Math.min(1,Math.max(0,e)),n=Math.max(.01,Math.min(n,.99)),i=Math.max(.01,Math.min(i,.99)),this._value=l.Color.fromHSV(e,n,i,this._value.a),this._hsvColor={h:e,s:n,v:i},this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)}},{key:"_setValueFromPosition",value:function(e){var t=this.refs.canvas;this._initialHue=e.y/t.offsetHeight,this._setHue(this._initialHue)}},{key:"_renderCanvas",value:function(){var e=this.refs.canvas,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight;for(var n=0;n<e.height;n++){var i=n/e.height,r=l.Color.fromHSV(i,1,1);t.strokeStyle=r.toRGBA(),t.beginPath(),t.moveTo(0,n),t.lineTo(e.width,n),t.stroke()}}},{key:"renderWithBEM",value:function(){return l.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:hue"},l.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},l.ReactBEM.createElement("div",null,l.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),l.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))}}]),t}(l.BaseComponent);t.default=f,f.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(2),u=i(c),f=n(45),p=i(f),h=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_onListItemClick",value:function(e,t){this.props.onChange&&this.props.onChange(e)}},{key:"_renderListItems",value:function(){var e=this;return this.props.fonts.map(function(t){var n=e.props.selectedIdentifier;return t.getVariations().map(function(i){var r=n===i.getIdentifier(),o=r?"is-active":null;return l.ReactBEM.createElement("li",{bem:"e:item",key:i.getIdentifier(),className:o,onClick:e._onListItemClick.bind(e,i)},l.ReactBEM.createElement(p.default,{fontFamily:i.getFontFamily(),fontWeight:i.getFontWeight(),fontStyle:i.getFontStyle()}),l.ReactBEM.createElement("div",{bem:"e:label"},t.getFontFamily()))})})}},{key:"renderWithBEM",value:function(){var e=this._renderListItems();return l.ReactBEM.createElement("div",{bem:"$b:controls e:overlay m:dark m:large"},l.ReactBEM.createElement(u.default,null,l.ReactBEM.createElement("ul",{bem:"$b:fontFamily e:list"},e)))}}]),t}(l.BaseComponent);t.default=h,h.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(7),s=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),t}(a.Configurable);t.default=s,s.prototype.availableOptions={fontFamily:{type:a.OptionType.STRING,required:!0},variations:{type:a.OptionType.ARRAY,required:!0}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),c=n(4),u=i(c),f=n(153),p=i(f),h=n(155),d=i(h),_=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,null,[{key:"onExit",value:function(){var e=this.context.editor;e.zoom.restore(),e.features.enable("zoom","drag"),e.render()}},{key:"onEnter",value:function(e,t){var n=this.context.editor;n.zoom.save(),n.zoom.set("auto",function(){n.render()});var i=n.getOutputDimensions(),r=n.operations.exists("sprite"),o=n.operations.getOrCreate("sprite"),a=o.createBrush(),s=o.serializeOptions(void 0,!0);o.addSprite(a);var c=Math.max(.05*i.min(),1);t.sizePresets&&t.sizePresets.length>0&&(c=t.sizePresets[0]);var u=new l.Color(1,0,0,1);this.setSharedState({operationExistedBefore:r,operation:o,brush:a,initialOptions:s,size:c,color:u,hardness:1})}},{key:"isAvailable",value:function(e){return e.isToolAllowed("brush")&&e.isToolEnabled("brush")}},{key:"getPreloadAssets",value:function(){return[]}}]),t}(u.default);_.controlsComponent=p.default,_.canvasControlsComponent=d.default,_.identifier="brush",_.iconPath="controls/overview/brush.png",_.languageKey="controls.overview.brush",_.defaultOptions={sizePresets:[]},_.requiredOperations=["sprite"],t.default=_},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},u=n(0),f=n(3),p=i(f),h=n(13),d=i(h),_=n(2),m=i(_),y=n(28),g=i(y),v=n(154),b=i(v),k=function(e){function t(){var e,n;o(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];var c=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s)));return c._hasDoneButton=!1,c._brushOptions={size:c.getSharedState("size"),color:c.getSharedState("color").clone()},c._hasPresets=c.props.options.sizePresets&&c.props.options.sizePresets.length>0,c._hasSlider=!c._hasPresets,c._bindAll("_onSizeUpdated","_onColorUpdated","_onOperationUpdated","_onOperationRemoved"),c.state={sizeControlsEnabled:!1},c._events=(n={},r(n,u.Constants.EVENTS.OPERATION_UPDATED,c._onOperationUpdated),r(n,u.Constants.EVENTS.OPERATION_REMOVED,c._onOperationRemoved),n),c}return s(t,e),l(t,[{key:"componentDidMount",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var e=this.context.editor;e.zoom.set("auto"),e.features.disable("zoom","drag")}},{key:"_onSizeClick",value:function(e){this._onSizeUpdated(e),this.forceUpdate()}},{key:"_onOperationRemoved",value:function(e){if(e===this.getSharedState("operation")&&!this._backButtonClicked){var t=this.context.editor,n=t.operations.getOrCreate("sprite"),i=n.createBrush();n.addSprite(i),this.setSharedState({operation:n,brush:i,operationExistedBefore:!1,initialOptions:{}}),t.render()}}},{key:"_onOperationUpdated",value:function(e){if(e===this.getSharedState("operation")){var t=this.getSharedState("brush");if(t){var n=e.getSprites().filter(function(e){return e.getId()===t.getId()})[0];this.setSharedState({brush:n})}this.context.editor.render()}}},{key:"_onSizeUpdated",value:function(e){this.setSharedState({size:e}),this._brushOptions.size=e}},{key:"_onColorUpdated",value:function(e){this.setSharedState({color:e}),this._brushOptions.color=e.clone()}},{key:"_renderSizeItems",value:function(){var e=this,t=this.props.options.sizePresets,n=Math.max.apply(null,t);return t.map(function(t){var i=e.getSharedState("size")===t;return u.ReactBEM.createElement(b.default,{size:t,maxSize:n,active:i,key:t,onClick:e._onSizeClick.bind(e,t)})})}},{key:"renderControls",value:function(){var e=this.context.editor,t=e.zoom.get(),n=[];if(this._hasSlider){var i=e.getFinalDimensions(),r=Math.round(i.clone().multiply(t).min()/2),o=this._brushOptions.size;n.push(u.ReactBEM.createElement("div",{bem:"e:cell m:slider"},u.ReactBEM.createElement(d.default,{style:"large",minValue:1,maxValue:r,valueUnit:"px",middleDot:!1,label:this._t("controls.brush.size"),onChange:this._onSizeUpdated,value:o})))}else this._hasPresets&&n.push(u.ReactBEM.createElement("div",{bem:"e:cell m:list"},u.ReactBEM.createElement(m.default,null,u.ReactBEM.createElement("ul",{bem:"$e:list"},this._renderSizeItems()))));return n.push(u.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},u.ReactBEM.createElement(g.default,{initialValue:this._brushOptions.color.clone(),onChange:this._onColorUpdated}))),n}}]),t}(p.default);t.default=k,k.contextTypes=p.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"componentDidMount",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._renderCanvas()}},{key:"componentDidUpdate",value:function(){this._renderCanvas()}},{key:"_renderCanvas",value:function(){var e=this.refs.canvas,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight;var n=this.props,i=n.maxSize,r=n.size,o=e.width*(r/i),a=o/2;t.fillStyle="white",t.beginPath(),t.arc(e.width/2,e.height/2,a,0,2*Math.PI),t.fill()}},{key:"renderWithBEM",value:function(){return l.ReactBEM.createElement("bem",{specifier:"$b:controls $e:list"},l.ReactBEM.createElement("li",{bem:"e:item",onClick:this.props.onClick},l.ReactBEM.createElement("bem",{specifier:"$b:controls"},l.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:this.props.active?"is-active":null},l.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),l.ReactBEM.createElement("div",{bem:"e:label"},this.props.size)))))}}]),t}(l.BaseComponent);t.default=c,c.contextTypes=l.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(14),f=function(e){return e&&e.__esModule?e:{default:e}}(u),p=c.SDK.Operations.SpriteOperation.BrushSprite,h=c.SDK.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush,d=function(e){function t(){var e;r(this,t);for(var n=arguments.length,a=Array(n),s=0;s<n;s++)a[s]=arguments[s];var l=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return l._windowResized=!1,l._drawing=!1,l._bindAll("_onMouseEnter","_onMouseLeave","_onMouseDown","_onMouseMove","_onMouseUp","_onMouseMoveOnCanvas","_onWindowResize"),l._lastDrawPosition=null,l._events=c.SDKUtils.extend(l._events,i({},c.Constants.EVENTS.WINDOW_RESIZE,l._onWindowResize)),l.state={cursorVisible:!1,cursorPosition:new c.Vector2},l}return a(t,e),s(t,[{key:"componentDidMount",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._updateContainerRect()}},{key:"componentDidUpdate",value:function(){this._windowResized&&(this._updateContainerRect(),this._windowResized=!1)}},{key:"_onWindowResize",value:function(){this._windowResized=!0}},{key:"_onOperationRemoved",value:function(e){}},{key:"_onOperationUpdated",value:function(e){e===this.getSharedState("operation")&&this.forceUpdate()}},{key:"_onMouseDown",value:function(e){e.preventDefault(),this._optionsBeforeDraw=this.getSharedState("operation").serializeOptions(),this._operationExistedBeforeDraw=this.getSharedState("operationExistedBefore"),this.setSharedState({operationExistedBefore:!0},!1);var t=this.context.editor.getOutputDimensions(),n=this._getCursorPosition(e),i=this.getSharedState("brush"),r=this.getSharedState("size")/t.min(),o=this.getSharedState("color"),a=this.getSharedState("hardness");this._drawing=!0;var s=new h({size:r,hardness:a,color:o});this._currentPath=i.createPath(s),this._currentPath.addControlPoint(n.clone().divide(t)),document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("touchmove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("touchend",this._onMouseUp)}},{key:"_onMouseUp",value:function(){this._currentPath.setClosed(!0);var e=this.context.editor,t=e.getOutputTextureDimensions();this.getSharedState("brush").render(t),this._currentPath=null,this._drawing=!1,e.history.add(this.getSharedState("operation"),this._optionsBeforeDraw,this._operationExistedBeforeDraw),document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("touchmove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("touchend",this._onMouseUp)}},{key:"_onMouseEnter",value:function(e){var t=this._getCursorPosition(e);this.setState({cursorVisible:!0,cursorPosition:t}),this._onMouseMove(e)}},{key:"_onMouseLeave",value:function(){this.setState({cursorVisible:!1})}},{key:"_onMouseMove",value:function(e){var t=this.context.editor,n=t.getOutputDimensions(),i=t.getOutputTextureDimensions(),r=t.zoom.get(),o=this._getCursorPosition(e);this.setState({cursorPosition:o});var a=void 0;if(this._lastDrawPosition){var s=this.getSharedState("size");a=this._lastDrawPosition.clone().subtract(o).abs().len()/r>=s/10}else a=!0;this._drawing&&a&&(this._currentPath.addControlPoint(o.clone().divide(n)),this.getSharedState("brush").render(i),this._lastDrawPosition=o.clone())}},{key:"_onMouseMoveOnCanvas",value:function(e){var t=this._getCursorPosition(e);this.setState({cursorPosition:t})}},{key:"_getPropsForSprite",value:function(e){var n=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_getPropsForSprite",this).call(this,e);return e instanceof p&&(n.hideContent=!1),n}},{key:"_getCursorStyle",value:function(){var e=this.getSharedState("size"),t=this.getSharedState("color"),n=this.state.cursorPosition;return{left:n.x,top:n.y,width:e,height:e,background:t.toRGBA(),marginLeft:-.5*e,marginTop:-.5*e}}},{key:"_updateContainerRect",value:function(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect()}},{key:"_getCursorPosition",value:function(e){var t=c.Utils.getEventPosition(e),n=this._containerBoundingRect;return t.subtract(n.left,n.top)}},{key:"_getContainerProps",value:function(){var e=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_getContainerProps",this).call(this);return e.onMouseDown=e.onTouchStart=this._onMouseDown,e}},{key:"_getInnerContainerProps",value:function(){var e=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_getInnerContainerProps",this).call(this);return delete e.onClick,e.onMouseEnter=this._onMouseEnter,e.onMouseLeave=this._onMouseLeave,e.onMouseMove=this._onMouseMoveOnCanvas,e}},{key:"_renderOverlayControls",value:function(){var e=this.state.cursorVisible?"is-visible":null;return c.ReactBEM.createElement("div",{bem:"$b:brushCanvasControls"},c.ReactBEM.createElement("div",{bem:"e:cursor",className:e,style:this._getCursorStyle()}))}}]),t}(f.default);t.default=d,d.contextTypes=f.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(4),c=i(l),u=n(157),f=i(u),p=n(158),h=i(p),d=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,null,[{key:"onExit",value:function(){var e=this.context.editor,t=this.getSharedState("operation");0===t.getPaths().length&&e.operations.remove(t),e.zoom.restore(),e.features.enable("zoom","drag"),e.render()}},{key:"onEnter",value:function(e,t){var n=this.context.editor;n.zoom.save(),n.zoom.set("auto",function(){n.render()});var i=n.getOutputDimensions(),r=n.operations.exists("selective-blur"),o=n.operations.getOrCreate("selective-blur"),a=o.serializeOptions(),s=o.getBrush(),l=.1*i.min(),c=o.getInputDimensions();this.setSharedState({operationExistedBefore:r,operation:o,brush:s,initialOptions:a,size:l,hardness:1,inputDimensions:c})}},{key:"isAvailable",value:function(e){return e.isToolEnabled("selective-blur")}}]),t}(c.default);d.controlsComponent=f.default,d.canvasControlsComponent=h.default,d.identifier="selective-blur",d.iconPath="controls/overview/selective-blur.png",d.languageKey="controls.overview.selective-blur",d.defaultOptions={},d.requiredOperations=["selective-blur"],t.default=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},u=n(0),f=n(3),p=i(f),h=n(13),d=i(h),_=n(6),m=i(_),y=function(e){function t(){var e,n;o(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];var c=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s)));return c._hasDoneButton=!1,c._brushSize=c.getSharedState("size"),c._bindAll("_onOperationUpdated","_onOperationRemoved","_onSizeUpdated","_onBlurRadiusChange"),c.state={sizeControlsEnabled:!1},c._events=(n={},r(n,u.Constants.EVENTS.OPERATION_UPDATED,c._onOperationUpdated),r(n,u.Constants.EVENTS.OPERATION_REMOVED,c._onOperationRemoved),n),c}return s(t,e),l(t,[{key:"componentDidMount",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var e=this.context.editor;e.zoom.set("auto"),e.features.disable("zoom","drag")}},{key:"_onOperationRemoved",value:function(e){if(e===this.getSharedState("operation")&&!this._backButtonClicked){var t=this.context.editor,n=t.operations.getOrCreate("selective-blur"),i=n.getBrush();this.setSharedState({operation:n,brush:i,operationExistedBefore:!1,initialOptions:{}}),t.render()}}},{key:"_onOperationUpdated",value:function(e){if(e===this.getSharedState("operation")){this.context.editor.render(),this.forceUpdate()}}},{key:"_onSizeUpdated",value:function(e){this.setSharedState({size:e}),this._brushSize=e}},{key:"_onBlurRadiusChange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getSharedState("inputDimensions");this.getSharedState("operation").setBlurRadius(e/i.min());var r=this.context.editor;r.render(),n&&r.history.add(this.getSharedState("operation"),{blurRadius:t/i.min()},!0)}},{key:"renderOverlayControls",value:function(){var e=this.getSharedState("inputDimensions"),t=e.min(),n=this.getSharedState("operation").getBlurRadius()*t;return u.ReactBEM.createElement(m.default,{minValue:0,maxValue:Math.min(180,Math.round(.1*t)),value:n,valueUnit:"px",label:this._t("controls.selectiveBlur.blurRadius"),onChange:this._onBlurRadiusChange})}},{key:"renderControls",value:function(){var e=this.context.editor,t=e.zoom.get(),n=[],i=e.getFinalDimensions(),r=Math.round(i.clone().multiply(t).min()/2),o=this._brushSize;return n.push(u.ReactBEM.createElement("div",{bem:"e:cell m:slider"},u.ReactBEM.createElement(d.default,{style:"large",minValue:1,maxValue:r,valueUnit:"px",middleDot:!1,label:this._t("controls.brush.size"),onChange:this._onSizeUpdated,value:o}))),n}}]),t}(p.default);t.default=y,y.contextTypes=p.default.contextTypes},function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(14),f=function(e){return e&&e.__esModule?e:{default:e}}(u),p=function(e){function t(){var e;r(this,t);for(var n=arguments.length,a=Array(n),s=0;s<n;s++)a[s]=arguments[s];var l=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return l._windowResized=!1,l._drawing=!1,l._bindAll("_onMouseEnter","_onMouseLeave","_onMouseDown","_onMouseMove","_onMouseUp","_onMouseMoveOnCanvas","_onWindowResize"),l._lastDrawPosition=null,l._events=c.SDKUtils.extend(l._events,i({},c.Constants.EVENTS.WINDOW_RESIZE,l._onWindowResize)),l.state={cursorVisible:!1,cursorPosition:new c.Vector2},l}return a(t,e),s(t,[{key:"componentDidMount",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._updateContainerRect()}},{key:"componentDidUpdate",value:function(){this._windowResized&&(this._updateContainerRect(),this._windowResized=!1)}},{key:"_onWindowResize",value:function(){this._windowResized=!0}},{key:"_onOperationRemoved",value:function(e){}},{key:"_onOperationUpdated",value:function(e){e===this.getSharedState("operation")&&this.forceUpdate()}},{key:"_onMouseDown",value:function(e){e.preventDefault();var t=this.getSharedState("operation");this._optionsBeforeDraw=t.serializeOptions(),this._operationExistedBeforeDraw=this.getSharedState("operationExistedBefore"),this.setSharedState({operationExistedBefore:!0},!1);var n=this.context.editor.getOutputDimensions(),i=this._getCursorPosition(e),r=this.getSharedState("size")/n.min(),o=this.getSharedState("hardness");this._drawing=!0,this._currentPath=t.createPath(r,o),this._currentPath.addControlPoint(i.clone().divide(n)),document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("touchmove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("touchend",this._onMouseUp)}},{key:"_onMouseUp",value:function(){this._currentPath.setClosed(!0);var e=this.context.editor;e.render(),this._currentPath=null,this._drawing=!1,e.history.add(this.getSharedState("operation"),this._optionsBeforeDraw,this._operationExistedBeforeDraw),document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("touchmove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("touchend",this._onMouseUp)}},{key:"_onMouseEnter",value:function(e){var t=this._getCursorPosition(e);this.setState({cursorVisible:!0,cursorPosition:t}),this._onMouseMove(e)}},{key:"_onMouseLeave",value:function(){this.setState({cursorVisible:!1})}},{key:"_onMouseMove",value:function(e){var t=this.context.editor,n=t.getOutputDimensions(),i=t.zoom.get(),r=this._getCursorPosition(e);this.setState({cursorPosition:r});var o=void 0;if(this._lastDrawPosition){var a=this.getSharedState("size");o=this._lastDrawPosition.clone().subtract(r).abs().len()/i>=a/10}else o=!0;this._drawing&&o&&(this._currentPath.addControlPoint(r.clone().divide(n)),this._lastDrawPosition=r.clone(),t.render())}},{key:"_onMouseMoveOnCanvas",value:function(e){var t=this._getCursorPosition(e);this.setState({cursorPosition:t})}},{key:"_getCursorStyle",value:function(){var e=this.getSharedState("size"),t=this.state.cursorPosition;return{left:t.x,top:t.y,width:e,height:e,marginLeft:-.5*e,marginTop:-.5*e}}},{key:"_updateContainerRect",value:function(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect()}},{key:"_getCursorPosition",value:function(e){var t=c.Utils.getEventPosition(e),n=this._containerBoundingRect;return t.subtract(n.left,n.top)}},{key:"_getContainerProps",value:function(){var e=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_getContainerProps",this).call(this);return e.onMouseDown=e.onTouchStart=this._onMouseDown,e}},{key:"_getInnerContainerProps",value:function(){var e=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_getInnerContainerProps",this).call(this);return delete e.onClick,e.onMouseEnter=this._onMouseEnter,e.onMouseLeave=this._onMouseLeave,e.onMouseMove=this._onMouseMoveOnCanvas,e}},{key:"_renderSpriteItems",value:function(){return null}},{key:"_renderOverlayControls",value:function(){var e=this.state.cursorVisible?"is-visible":null;return c.ReactBEM.createElement("div",{bem:"$b:selectiveBlurCanvasControls"},c.ReactBEM.createElement("div",{bem:"e:cursor",className:e,style:this._getCursorStyle()}))}}]),t}(f.default);t.default=p,p.contextTypes=f.default.contextTypes},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(4),c=i(l),u=n(160),f=i(u),p=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,null,[{key:"onExit",value:function(){var e=this.context.editor,t=this.getSharedState("operation"),n=this.getSharedState("initialOptions"),i=t.getFrame(),r=t.getScale();(i&&i.identifier)===(n.frame&&n.frame.identifier)&&r===n.scale||e.history.add(t,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore")),t.getFrame()||e.operations.remove(t),e.render()}},{key:"onEnter",value:function(e){var t=this.context.editor,n=t.operations.exists("frame"),i=t.operations.getOrCreate("frame"),r=i.serializeOptions();this.setSharedState({operation:i,operationExistedBefore:n,initialOptions:r,inputDimensions:i.getInputDimensions(),frame:i.getFrame()})}},{key:"isAvailable",value:function(e){return e.isToolAllowed("frame")&&e.isToolEnabled("frame")}}]),t}(c.default);p.controlsComponent=f.default,p.identifier="frame",p.iconPath="controls/overview/frame.png",p.languageKey="controls.overview.frame",p.defaultOptions={frames:[]},p.requiredOperations=["sprite"],p.getPreloadAssets=c.default.getPreloadAssets,t.default=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(0),u=n(3),f=i(u),p=n(2),h=i(p),d=n(1),_=i(d),m=n(48),y=i(m),g=n(161),v=i(g),b=n(28),k=i(b),w=n(6),O=i(w),E=n(49),S=i(E),P=function(e){function t(){var e,n;o(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];var u=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s)));return u._operation=u.getSharedState("operation"),u._bindAll("_onScaleChange","_onColorChange","_onOperationUpdated","_onOperationRemoved"),u._events=(n={},r(n,c.Constants.EVENTS.OPERATION_UPDATED,u._onOperationUpdated),r(n,c.Constants.EVENTS.OPERATION_REMOVED,u._onOperationRemoved),n),u._initFrameManager(),u}return s(t,e),l(t,[{key:"_initFrameManager",value:function(){this._frameManager=new y.default(this.context.ui,this.props.options)}},{key:"_onOperationUpdated",value:function(e){e===this.getSharedState("operation")&&this.forceSharedUpdate()}},{key:"_onOperationRemoved",value:function(e){if(e===this.getSharedState("operation")&&!this._backButtonClicked){var t=this.context.editor,n=t.operations.getOrCreate("frame");this.setSharedState({operation:n,frame:null,operationExistedBefore:!1,initialOptions:{}}),t.render()}}},{key:"_onScaleChange",value:function(e){var t=this.context.editor,n=this.getSharedState("inputDimensions");this._operation.setScale(e/n.min()),t.render()}},{key:"_onColorChange",value:function(e){this.getSharedState("operation").setTintColor(e.clone()),this.context.editor.render()}},{key:"_onBackClick",value:function(e){this._backButtonClicked=!0,this.props.onSwitchControls("home")}},{key:"_onFrameClick",value:function(e){var t=this,n=this.context.editor,i=this.getSharedState("operation");if(null===e)return i.setFrame(null),n.render(),this.setSharedState({frame:null});var r=void 0,o=setTimeout(function(){r=_.default.instance.displayLoading(t._t("loading.loading"))},100),a=new S.default(this.context.ui,e);a.load().then(function(){r&&r.close(),o&&(clearTimeout(o),o=null);var e=a.getFrame();i.setFrame(e),t.context.editor.render(),t.setSharedState({frame:a})})}},{key:"renderOverlayControls",value:function(){if(!this.getSharedState("frame"))return null;var e=this.getSharedState("inputDimensions"),t=Math.round(.3*e.min()),n=this._operation.getScale()*e.min();return c.ReactBEM.createElement(O.default,{minValue:5,maxValue:t,value:n,valueUnit:"px",middleDot:!1,label:this._t("controls.frame.scale"),onChange:this._onScaleChange})}},{key:"_renderListItems",value:function(){var e=this,t=this._frameManager.getFramesForCategory("all"),n=this.getSharedState("operation").getFrame();return[c.ReactBEM.createElement("li",{bem:"e:item",key:"no-frame",onClick:this._onFrameClick.bind(this,null)},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:n?null:"is-active"},c.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/frame/no-frame.png",!0)}),c.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.frame.noFrame")))))].concat(t.map(function(t,i){return c.ReactBEM.createElement(v.default,{frame:t,active:n&&n.identifier===t.identifier,onClick:e._onFrameClick.bind(e,t)})}))}},{key:"renderControls",value:function(){var e=this.getSharedState("operation").getFrame(),t=this._renderListItems(),n=[c.ReactBEM.createElement("div",{bem:"e:cell m:list"},c.ReactBEM.createElement(h.default,{ref:"scrollbar"},c.ReactBEM.createElement("ul",{bem:"$e:list"},t)))];if(e&&e.tintable){var i=this.getSharedState("operation");n.push(c.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},c.ReactBEM.createElement(k.default,{initialValue:i.getTintColor().clone(),onChange:this._onColorChange})))}return n}}]),t}(f.default);t.default=P,P.contextTypes=f.default.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s.state={frame:s.props.frame},s}return o(t,e),a(t,[{key:"componentDidMount",value:function(){this._renderFrame()}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.props.frame!==e.frame&&this.setState({frame:e.frame},function(){t._renderFrame()})}},{key:"_renderFrame",value:function(){var e=this.context.editor,t=e.getSDK(),n=this.props.frame,i=this._getAssetPath(n.thumbnail),r=this.refs["canvas-"+n.identifier],o=t.getPixelRatio();r.width=r.offsetWidth*o,r.height=r.offsetHeight*o,r.style.width=r.offsetWidth+"px",r.style.height=r.offsetHeight+"px";var a=r.getContext("2d"),l=new window.Image;l.addEventListener("load",function(){var e=Math.min(r.width/l.width,r.height/l.height),t=new s.Vector2(l.width,l.height).multiply(e),n=new s.Vector2(r.width,r.height).divide(2).subtract(t.clone().divide(2));a.drawImage(l,0,0,l.width,l.height,n.x,n.y,t.x,t.y)}),l.crossOrigin="Anonymous",l.src=i}},{key:"renderWithBEM",value:function(){return s.ReactBEM.createElement("bem",{specifier:"b:controls e:list"},s.ReactBEM.createElement("li",{bem:"e:item",key:this.props.frame.identifier,onClick:this.props.onClick},s.ReactBEM.createElement("bem",{specifier:"$b:controls"},s.ReactBEM.createElement("div",{bem:"$e:button m:withInlineLabel"},s.ReactBEM.createElement("canvas",{bem:"e:canvas m:large",ref:"canvas-"+this.props.frame.identifier}),s.ReactBEM.createElement("div",{bem:"$e:inlineLabel",className:this.props.active?"is-active":null},s.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.frame.frames."+this.props.frame.identifier)||this.props.frame.defaultName))))))}}]),t}(s.BaseComponent);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),a=function(){function e(t,n,r){i(this,e),this._editor=t,this._sdk=n,this._mediator=r,this._options=this._editor.getOptions(),this._features={drag:this._options.editor.enableDrag,zoom:this._options.editor.enableZoom}}return r(e,[{key:"isEnabled",value:function(e){var t=e.charAt(0).toUpperCase()+e.slice(1),n=this._options.editor["enable"+t];return this._features[e]&&n}},{key:"enable",value:function(){for(var e=this,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach(function(t){e._features[t]=!0}),this._mediator.emit(o.Constants.EVENTS.FEATURES_ENABLED,n),this._mediator.emit(o.Constants.EVENTS.FEATURES_UPDATED,n)}},{key:"disable",value:function(){for(var e=this,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach(function(t){e._features[t]=!1}),this._mediator.emit(o.Constants.EVENTS.FEATURES_DISABLED,n),this._mediator.emit(o.Constants.EVENTS.FEATURES_UPDATED,n)}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(e,n,o){i(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a._editor=e,a._sdk=n,a._mediator=o,a._isDefaultZoom=!1,a._zoom=a._sdk.getZoom(),a._options=a._editor.getOptions(),a._zoomLevels=[1,2,3,4,5,6.25,8.33,12.5,16.66,25,33.33,50,66.66,100,200,300,400,500,600,700,800,1200,1600,3200].map(function(e){return e/100}),a}return o(t,e),a(t,[{key:"in",value:function(){var e=this._getClosestZoomLevel(this._zoom+.001,1);if(!e)return this._zoomLevels[this._zoomLevels.length-1];this.set(e)}},{key:"out",value:function(){var e=this._getClosestZoomLevel(this._zoom-.001,-1);if(!e)return this._zoomLevels[0];this.set(e)}},{key:"_getClosestZoomLevel",value:function(e,t){return-1===t?this._zoomLevels.filter(function(t){return t<e}).pop():1===t?this._zoomLevels.filter(function(t){return t>e})[0]:void 0}},{key:"restore",value:function(){this._previousZoom&&(this.set(this._previousZoom),this._previousZoom=null)}},{key:"save",value:function(){this._previousZoom=this._zoom}},{key:"set",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._editor.isReady()){var i=e,r=this.getDefault();"auto"===e||i===r?(i=r,e="auto",this._isDefaultZoom=!0):this._isDefaultZoom=!1;var o=Math.max(1,2*r),a=n?this.getMinimum():0;i=Math.max(a,Math.min(o,i)),this._zoom=i,this._sdk.setZoom(this._zoom),this._sdk.setTextureQuality(Math.min(this._zoom,1)),this.emit("set",this._zoom,t)}}},{key:"getDefault",value:function(){var e=this._editor.getFinalDimensions(!1),t=this._editor.getCanvasDimensions();return s.SDKUtils.resizeVectorToFit(e,t).divide(e).x}},{key:"getMinimum",value:function(){var e=this._editor.getFinalDimensions();return s.SDKUtils.resizeVectorToFit(e,new s.Vector2(300,300)).divide(e).x}},{key:"isDefault",value:function(){return this._isDefaultZoom}},{key:"get",value:function(){return this._zoom}}]),t}(s.EventEmitter);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(e,n,o){i(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a._editor=e,a._sdk=n,a._mediator=o,a._history=[],a}return o(t,e),a(t,[{key:"isAvailable",value:function(){return 0!==this._history.length}},{key:"add",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=void 0;if(e instanceof Array){var a=e;this._history.push(a),a.forEach(function(e){i._mediator.emit(s.Constants.EVENTS.HISTORY_UPDATED,e.operation)}),o=a}else o={operation:e,options:t,existent:n,undo:r},this._history.push(o),this._mediator.emit(s.Constants.EVENTS.HISTORY_UPDATED,e);return o}},{key:"undo",value:function(){var e=this,t=this._editor.operations,n=this._history.pop();if(n){[].concat(n).forEach(function(n){var i=n.operation,r=n.existent,o=n.options,a=n.undo;e._mediator.emit(s.Constants.EVENTS.HISTORY_BEFORE_UNDO,n),r?(i=t.getOrCreate(i.constructor.identifier),i.set(o),e._mediator.emit(s.Constants.EVENTS.OPERATION_UPDATED,i)):t.remove(i),"function"==typeof a&&a(i,o),e._mediator.emit(s.Constants.EVENTS.HISTORY_UPDATED,i),e._mediator.emit(s.Constants.EVENTS.HISTORY_UNDO,i)}),this.emit("undo")}}},{key:"reset",value:function(){this._history=[]}}]),t}(s.EventEmitter);t.default=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(50),s=i(a),l=n(51),c=i(l),u=function(){function e(t){r(this,e),this._editor=t}return o(e,[{key:"serialize",value:function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)}},{key:"deserialize",value:function(e){return new c.default(this._editor,e).deserialize()}}]),e}();t.default=u,u.version="1.0.0"},function(e,t,n){e.exports=n(167)},function(e,t,n){var i=function(){return this}()||Function("return this")(),r=i.regeneratorRuntime&&Object.getOwnPropertyNames(i).indexOf("regeneratorRuntime")>=0,o=r&&i.regeneratorRuntime;if(i.regeneratorRuntime=void 0,e.exports=n(168),r)i.regeneratorRuntime=o;else try{delete i.regeneratorRuntime}catch(e){i.regeneratorRuntime=void 0}},function(e,t){!function(t){"use strict";function n(e,t,n,i){var o=t&&t.prototype instanceof r?t:r,a=Object.create(o.prototype),s=new h(i||[]);return a._invoke=c(e,n,s),a}function i(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function r(){}function o(){}function a(){}function s(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function l(e){function t(n,r,o,a){var s=i(e[n],e,r);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"==typeof c&&g.call(c,"__await")?Promise.resolve(c.__await).then(function(e){t("next",e,o,a)},function(e){t("throw",e,o,a)}):Promise.resolve(c).then(function(e){l.value=e,o(l)},a)}a(s.arg)}function n(e,n){function i(){return new Promise(function(i,r){t(e,n,i,r)})}return r=r?r.then(i,i):i()}var r;this._invoke=n}function c(e,t,n){var r=S;return function(o,a){if(r===C)throw new Error("Generator is already running");if(r===M){if("throw"===o)throw a;return _()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=u(s,n);if(l){if(l===j)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===S)throw r=M,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=C;var c=i(e,t,n);if("normal"===c.type){if(r=n.done?M:P,c.arg===j)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=M,n.method="throw",n.arg=c.arg)}}}function u(e,t){var n=e.iterator[t.method];if(n===m){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=m,u(e,t),"throw"===t.method))return j;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return j}var r=i(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,j;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=m),t.delegate=null,j):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,j)}function f(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function p(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(f,this),this.reset(!0)}function d(e){if(e){var t=e[b];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(g.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=m,t.done=!0,t};return i.next=i}}return{next:_}}function _(){return{value:m,done:!0}}var m,y=Object.prototype,g=y.hasOwnProperty,v="function"==typeof Symbol?Symbol:{},b=v.iterator||"@@iterator",k=v.asyncIterator||"@@asyncIterator",w=v.toStringTag||"@@toStringTag",O="object"==typeof e,E=t.regeneratorRuntime;if(E)return void(O&&(e.exports=E));E=t.regeneratorRuntime=O?e.exports:{},E.wrap=n;var S="suspendedStart",P="suspendedYield",C="executing",M="completed",j={},R={};R[b]=function(){return this};var x=Object.getPrototypeOf,B=x&&x(x(d([])));B&&B!==y&&g.call(B,b)&&(R=B);var T=a.prototype=r.prototype=Object.create(R);o.prototype=T.constructor=a,a.constructor=o,a[w]=o.displayName="GeneratorFunction",E.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===o||"GeneratorFunction"===(t.displayName||t.name))},E.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,w in e||(e[w]="GeneratorFunction")),e.prototype=Object.create(T),e},E.awrap=function(e){return{__await:e}},s(l.prototype),l.prototype[k]=function(){return this},E.AsyncIterator=l,E.async=function(e,t,i,r){var o=new l(n(e,t,i,r));return E.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},s(T),T[w]="Generator",T[b]=function(){return this},T.toString=function(){return"[object Generator]"},E.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},E.values=d,h.prototype={constructor:h,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(p),!e)for(var t in this)"t"===t.charAt(0)&&g.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=m)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,i){return o.type="throw",o.arg=e,n.next=t,i&&(n.method="next",n.arg=m),!!i}if(this.done)throw e;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],o=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var a=g.call(r,"catchLoc"),s=g.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&g.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,j):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),j},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),p(n),j}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;p(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:d(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=m),j}}}(function(){return this}()||Function("return this")())},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),a=function(){function e(t,n){i(this,e),this._ui=t,this._options=n,this._brushes=[],this._brushesById={},this._addBrushes(o.Constants.DEFAULTS.BRUSHES);var r=this._options,a=r.brushes,s=r.replaceBrushes,l=r.availableBrushes;this._options.brushes&&this._addBrushes(a,s),l&&(this._brushes=this._brushes.filter(function(e){return-1!==l.indexOf(e.identifier)}))}return r(e,[{key:"_addBrushes",value:function(e,t){var n=this;t&&(this._brushes=[],this._brushesById={}),e.forEach(function(e){n._brushes.push(e),n._brushesById[e.identifier]=e})}},{key:"getBrushByIdentifier",value:function(e){return this._brushesById[e]}},{key:"getBrushes",value:function(){return this._brushes}},{key:"getFirstBrush",value:function(){return this._brushes[0]}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(52),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u={italic:"i"},f=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"load",value:function(){return this._fonts.length&&this._addStylesheetTag(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this)}},{key:"_addStylesheetTag",value:function(){var e=this._getFamiliesString(),t=document.createElement("link");t.rel="stylesheet",t.href="https://fonts.googleapis.com/css?family="+e,document.getElementsByTagName("head")[0].appendChild(t)}},{key:"_getFamiliesString",value:function(){var e={};this._fonts.forEach(function(t){var n=t.getFontFamily(),i=t.getFontStyle(),r=t.getFontWeight();e[n]=e[n]||[],void 0!==r?e[n].push(""+r+(u[i]||"")):e[n].push(400)});var t=[];for(var n in e){var i=e[n],r=i.length?":"+i.join(","):"",o=n.replace(" ","+")+r;t.push(o)}return t.join("|")}}]),t}(c.default);t.default=f},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(172),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s="undefined"!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):n(38),l=function(){function e(t){i(this,e),this._fontVariation=t,this._defaultFontRuler=new a.default,this._customFontRuler=new a.default(this._fontVariation)}return r(e,[{key:"observe",value:function(){var e=this,t=s();return new Promise(function(n,i){var r=window.setInterval(function(){if(e._defaultFontRuler.getWidth()!==e._customFontRuler.getWidth())return window.clearInterval(r),n();if(s()-t>=5e3){var o=new Error("Failed to load font "+e._fontVariation.getFontFamily()+".");return o.font=e._fontVariation,i(o)}},50)})}},{key:"dispose",value:function(){this._defaultFontRuler.dispose(),this._customFontRuler.dispose()}}]),e}();t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(47),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){i(this,e),this._fontVariation=t||new a.default({fontFamily:"Times New Roman",fontWeight:"normal",fontStyle:"normal"}),this._createRuler()}return r(e,[{key:"_createRuler",value:function(){this._ruler=document.createElement("div"),this._ruler.innerText="abcdefghijklmnopqrstuvwxzy",document.body.appendChild(this._ruler),this._setRulerStyle()}},{key:"_setRulerStyle",value:function(){this._ruler.style.cssText="\n      position: absolute;\n      top: -9999px;\n      left: -9999px;\n      opacity: 0;\n      display: inline-block;\n      font: "+this._fontVariation.getFontStyle()+" "+this._fontVariation.getFontWeight()+" 30px "+this._fontVariation.getFontFamily()+";\n    "}},{key:"setFontVariation",value:function(e){this._fontVariation=e,this._setRulerStyle()}},{key:"getWidth",value:function(){return this._ruler.offsetWidth}},{key:"dispose",value:function(){this._ruler&&(this._ruler.parentNode.removeChild(this._ruler),this._ruler=null)}}]),e}();t.default=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(52),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"load",value:function(){var e=this,n=[];this._fonts.forEach(function(t){var i=e._ui.getAssetPath(t.getFilePath(),!1,!0);n.push('@font-face {\n        font-family: "'+t.getFontFamily()+"\";\n        src: url('"+i+"') format('woff');\n        font-weight: "+t.getFontWeight()+";\n        font-style: "+t.getFontStyle()+";\n      }")});var i=n.join("\n"),r=document.createElement("style");return r.innerHTML=i,document.getElementsByTagName("head")[0].appendChild(r),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this)}}]),t}(c.default);t.default=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(53),s=i(a),l=n(54),c=i(l),u=function(){function e(t){r(this,e),this._editor=t}return o(e,[{key:"serialize",value:function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)}},{key:"deserialize",value:function(e){return new c.default(this._editor,e).deserialize()}}]),e}();t.default=u,u.version="1.0.1"},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(30),s=i(a),l=n(31),c=i(l),u=function(){function e(t){r(this,e),this._editor=t}return o(e,[{key:"serialize",value:function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)}},{key:"deserialize",value:function(e){return new c.default(this._editor,e).deserialize()}}]),e}();t.default=u,u.version="2.0.0"},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),a=function(){function e(t,n){var r=this;i(this,e),this._ui=t,this._options=n,this._overlays=o.SharedConstants.DEFAULTS.OVERLAYS.slice(0),this._overlaysByIdentifier={},n.overlays&&(n.replaceOverlays?this._overlays=n.overlays:this._overlays=this._overlays.concat(n.overlays)),n.availableOverlays&&(this._overlays=this._overlays.filter(function(e){return-1!==n.availableOverlays.indexOf(e.identifier)})),this._overlays.forEach(function(e){r._overlaysByIdentifier[e.identifier]=e})}return r(e,[{key:"getOverlays",value:function(){return this._overlays}},{key:"getOverlayByIdentifier",value:function(e){return this._overlaysByIdentifier[e]}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(178),s=i(a),l=n(179),c=i(l),u=function(){function e(t){r(this,e),this._editor=t}return o(e,[{key:"serialize",value:function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)}},{key:"deserialize",value:function(e){return new c.default(this._editor,e).deserialize()}}]),e}();t.default=u,u.version="2.0.1"},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(30),s=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),t}(s.default);t.default=l,l.version="2.0.0"},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(31),s=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),t}(s.default);t.default=l,l.version="2.0.1"},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(181),s=i(a),l=n(182),c=i(l),u=function(){function e(t){r(this,e),this._editor=t}return o(e,[{key:"serialize",value:function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)}},{key:"deserialize",value:function(e){return new c.default(this._editor,e).deserialize()}}]),e}();t.default=u,u.version="3.0.0"},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),c=n(30),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"serialize",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this,n).then(function(t){return t.meta={platform:"html5",version:e._editor.getSDK().version,createdAt:l.SDKUtils.ISODateString(new Date)},t.image=t.inputImage,delete t.inputImage,t})}},{key:"_serializeSticker",value:function(e,n){var i=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeSticker",this).call(this,e,n);return i.options.alpha=n.getAlpha(),i.options.tintColor&&(i.options.tintColor={rgba:i.options.tintColor}),i}},{key:"_serializeText",value:function(e,n){var i=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeText",this).call(this,e,n);return i.options.color={rgba:i.options.color},i.options.backgroundColor={rgba:i.options.backgroundColor},i.options.flipHorizontally=!1,i.options.flipVertically=!1,delete i.options.fontWeight,i}},{key:"_serializePath",value:function(e){var n=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializePath",this).call(this,e);delete n.hardness,delete n.size,delete n.color;var i=e.getBrush();n.brush=i.serializeOptions(["identifier","size","color"],!0),void 0===n.brush.identifier&&delete n.brush.identifier,n.brush.color={rgba:n.brush.color};var r=i.getOption("hardness");return"undefined"!==r&&(n.brush.hardness=r),n}},{key:"_serializeFrameOperation",value:function(e,n){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeFrameOperation",this).call(this,e,n);var i=n.filter(function(e){return"sprite"===e.type}),r=void 0;if(i.length){r=i.pop();var o=r.options.sprites.filter(function(e){return"frame"===e.type})[0];e.getTintColor().equals(new l.Color(1,1,1,0))||(o.options.tintColor={rgba:e.serializeOption("tintColor",!0)});var a=e.serializeOptions(["scale","alpha"],!0);o.options=l.SDKUtils.extend(o.options,a),o.options.size=o.options.scale,delete o.options.scale}}},{key:"_serializeTransformOperation",value:function(e){var n=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeTransformOperation",this).call(this,e);return e._ratio&&(n.options.meta={identifier:e._ratio.identifier}),delete n.options.scale,n}},{key:"_serializeAdjustmentsOperation",value:function(e){var n=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeAdjustmentsOperation",this).call(this,e),i=e.availableOptions,r=i.gamma,o=e.getGamma(),a=r.minValue,l=r.midValue,c=r.maxValue;return n.options.gamma=o<=l?(o-a)/(l-a)-1:(o-l)/(c-l),n}},{key:"_serializeOperation",value:function(e,n){switch(e.constructor.identifier){case"mirrored-focus":return this._serializeMirroredFocusOperation(e);case"linear-focus":return this._serializeLinearFocusOperation(e);case"blur":return this._serializeBlurOperation(e);default:return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeOperation",this).call(this,e,n)}}},{key:"_serializeMirroredFocusOperation",value:function(e){return{type:"focus",options:{type:"mirrored",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}},{key:"_serializeLinearFocusOperation",value:function(e){var t=e.serializeOptions(["controlPoint1","controlPoint2","blurRadius"],!0);return t.start=t.controlPoint1,delete t.controlPoint1,t.end=t.controlPoint2,delete t.controlPoint2,{type:"focus",options:{type:"linear",options:t}}}},{key:"_serializeBlurOperation",value:function(e){return{type:"focus",options:{type:"gaussian",options:e.serializeOptions(["blurRadius"],!0)}}}}]),t}(u.default);t.default=f,f.version="3.0.0"},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(31),f=i(u),p=n(11),h=i(p),d=n(22),_=i(d),m=void 0;void 0!==c.SDK.Operations.SpriteOperation&&(m=c.SDK.Operations.SpriteOperation.BrushSprite.Brush);var y=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_deserializeSticker",value:function(e,t){var n=c.SDK.Operations.SpriteOperation,i=t.options,r=this._stickerManager.getStickerByIdentifier(i.identifier);if(!r)return c.Log.warn("Deserializer","Unknown sticker `"+i.identifier+"`. Skipping sprite."),Promise.resolve();var o=h.default.getURLForSticker(r,"base"),a=this._editor.getUI().getAssetPath(o),s=e.getInputDimensions(!1);return _.default.load(a).then(function(t){var o=n.StickerSprite.prototype.availableOptions.adjustments.structure,a=i.rotation,l=i.flipHorizontally,u=i.flipVertically,f={identifier:i.identifier,image:t,position:c.Vector2.fromObject(i.position),dimensions:c.Vector2.fromObject(i.dimensions).multiply(s.min()),rotation:a||0,flipHorizontally:l,flipVertically:u,adjustments:{}};return void 0!==i.adjustments&&["brightness","contrast","saturation"].forEach(function(e){void 0!==i.adjustments[e]&&(f.adjustments[e]=i.adjustments[e]+o[e].default)}),void 0!==i.tintColor&&void 0!==r.tintMode&&(f.tintColor=c.Color.fromArray(i.tintColor.rgba),f.tintMode=r.tintMode),void 0!==i.alpha&&(f.alpha=i.alpha),e.createSticker(f)})}},{key:"_deserializeTransformOperation",value:function(e){return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeTransformOperation",this).call(this,e).then(function(e){if(e)return e._ratio=null,e})}},{key:"_deserializeInputImage",value:function(){var e=this,t=this._data.image,n=t.data,i=t.type,r=t.uri;return n&&i&&(r="data:"+i+";base64,"+n),r?_.default.load(r).then(function(t){e._editor.setImage(t)}):Promise.resolve()}},{key:"_deserializeAdjustmentsOperation",value:function(e){var n=c.SDK.Operations.AdjustmentsOperation;return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeAdjustmentsOperation",this).call(this,e).then(function(t){if(!t)return null;var i=e.options;if(void 0!==i.gamma){var r=n.prototype.availableOptions.gamma,o=r.minValue,a=r.midValue,s=r.maxValue;t.setGamma(i.gamma<0?a+(a-o)*i.gamma:a+(s-a)*i.gamma)}return t})}},{key:"_deserializeFocusOperation",value:function(e){var n=e.options.options;switch(e.options.type){case"radial":return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeFocusOperation",this).call(this,e);case"linear":var i=n.start,r=n.end,o=n.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("linear-focus",{controlPoint1:c.Vector2.fromObject(i),controlPoint2:c.Vector2.fromObject(r),blurRadius:o}));case"mirrored":var a=n.start,s=n.end,u=n.size,f=n.gradientSize,p=n.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:c.Vector2.fromObject(a),end:c.Vector2.fromObject(s),size:u,gradientSize:f,blurRadius:p}));case"gaussian":var h=n.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("blur",{blurRadius:h}))}}},{key:"_deserializeText",value:function(e,t){var n=t.options,i=n.fontSize,r=n.lineHeight,o=n.fontIdentifier,a=n.alignment,s=n.rotation,l=n.maxWidth,u=n.color,f=n.backgroundColor,p=this._ui.getFontLoader(),h=this._fontManager.getVariationByIdentifier(o);return h?p.setFonts([h.getFont()]):h=this._fontManager.getDefaultVariation(),p.load().then(function(){var t=e.getInputDimensions(!1),o=l*t.min()/t.x;return e.createText({fontSize:i,lineHeight:r,fontFamily:h.getFontFamily(),fontWeight:h.getFontWeight(),fontIdentifier:h.getIdentifier(),textMetrics:h.getTextMetrics(),alignment:a,rotation:s,maxWidth:o,text:n.text,color:c.Color.fromArray(u.rgba),backgroundColor:c.Color.fromArray(f.rgba),position:c.Vector2.fromObject(n.position)})})}},{key:"_createBrushForPath",value:function(e){var t=e.brush,n=t.identifier,i=t.color,s=t.size,l=t.hardness,u=c.Color.fromArray(i.rgba),f={color:u,size:s};void 0!==l&&(f.hardness=l);var p=this._brushManager.getBrushByIdentifier(n);if(p||(p=this._brushManager.getFirstBrush()),p.prototype&&p.prototype instanceof m){return new p(f)}var h=c.SDKUtils.extend({},p);delete h.image;var d=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(m);return d.identifier=p.identifier,new d(c.SDKUtils.extend({},h,f))}},{key:"_deserializeFrame",value:function(e,n){var i=this;return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeFrame",this).call(this,e,n).then(function(){var e=i._editor.operations.get("frame"),t=n.options,r=t.size,o=t.alpha,a=t.tintColor,s={};void 0!==r&&(s.scale=r),void 0!==o&&(s.alpha=o),void 0!==a&&(s.tintColor=c.Color.fromArray(a.rgba)),e.set(s)})}}]),t}(f.default);t.default=y,y.version="3.0.0"},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},c=n(0),u=n(184),f=i(u),p=n(185),h=i(p),d=n(186),_=i(d),m=n(187),y=i(m),g=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return s._modalManager=s.props.modalManager,s._bindAll("_onModalManagerUpdate"),s}return a(t,e),s(t,[{key:"componentDidMount",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this._modalManager.on("update",this._onModalManagerUpdate)}},{key:"componentWillUnmount",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this),this._modalManager.off("update",this._onModalManagerUpdate)}},{key:"_onModalManagerUpdate",value:function(){this.forceUpdate()}},{key:"_onModalClosed",value:function(e){this._modalManager.removeModal(e)}},{key:"_renderModals",value:function(){var e=this;return this._modalManager.getModals().map(function(t){var n=void 0;switch(t.type){case"loading":n=f.default;break;case"warning":n=h.default;break;case"error":n=_.default;break;case"progress":n=y.default}return c.ReactBEM.createElement(n,{modal:t,onClose:e._onModalClosed.bind(e,t)})})}},{key:"renderWithBEM",value:function(){return c.ReactBEM.createElement("div",null,this._renderModals())}}]),t}(c.BaseComponent);t.default=g,g.contextTypes=c.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"renderWithBEM",value:function(){var e=this.props.modal;return s.ReactBEM.createElement("bem",{specifier:"$b:modals"},s.ReactBEM.createElement("div",{bem:"e:overlay"},s.ReactBEM.createElement("div",{bem:"e:modal m:loading"},s.ReactBEM.createElement("div",{bem:"e:text"},e.text))))}}]),t}(s.BaseComponent);t.default=l,l.propTypes={modal:s.PropTypes.object},l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"renderWithBEM",value:function(){var e=this.props.modal;return s.ReactBEM.createElement("bem",{specifier:"$b:modals"},s.ReactBEM.createElement("div",{bem:"e:modal m:warning"},s.ReactBEM.createElement("div",{bem:"e:title"},e.title),s.ReactBEM.createElement("div",{bem:"e:text"},e.text),s.ReactBEM.createElement("div",{bem:"e:button b:button m:inline",onClick:this.props.onClose},"OK")))}}]),t}(s.BaseComponent);t.default=l,l.propTypes={modal:s.PropTypes.object},l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){var e;i(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return s._bindAll("_onClose"),s}return o(t,e),a(t,[{key:"_onClose",value:function(){this.props.modal.close()}},{key:"renderWithBEM",value:function(){var e=this.props.modal,t=s.ReactBEM.createElement("div",{bem:"e:modal m:error"},s.ReactBEM.createElement("div",{bem:"e:title"},e.title),s.ReactBEM.createElement("div",{bem:"e:text"},e.text),s.ReactBEM.createElement("div",{bem:"e:button b:button m:inline",onClick:this._onClose},"OK")),n=e.overlay?s.ReactBEM.createElement("div",{bem:"e:overlay"},t):t;return s.ReactBEM.createElement("bem",{specifier:"$b:modals"},n)}}]),t}(s.BaseComponent);t.default=l,l.propTypes={modal:s.PropTypes.object},l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"renderWithBEM",value:function(){var e=this.props.modal,t=e.data.progress,n={width:(100*(t||0)).toFixed(2)+"%"};return s.ReactBEM.createElement("bem",{specifier:"$b:modals"},s.ReactBEM.createElement("div",{bem:"e:overlay"},s.ReactBEM.createElement("div",{bem:"e:modal m:loading"},s.ReactBEM.createElement("div",{bem:"e:text"},e.text),s.ReactBEM.createElement("bem",{specifier:"b:loadingModal"},s.ReactBEM.createElement("div",{bem:"$e:progressBar"},s.ReactBEM.createElement("div",{bem:"e:progress",style:n}))))))}}]),t}(s.BaseComponent);t.default=l,l.propTypes={modal:s.PropTypes.object},l.contextTypes=s.BaseComponent.contextTypes},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(42),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(e,n,o){i(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a._ui=e,a._options=n,a._mediator=o,a._assets={},a._editor=new c.default(e,n,o,!0),a._assets=["controls/back.png","controls/minus.png","controls/plus.png","controls/tick.png","controls/webcam/shutter.png","controls/knobs/remove.png","controls/knobs/resize-diagonal-down.png","controls/knobs/resize-diagonal-up.png","controls/knobs/rotate.png","editor/export.png","editor/new.png","editor/undo.png",["splash/photo-roll.png",!1,!0],["splash/webcam.png",!1,!0],"top-bar/back.png","close.png"],a._appendControlsAssets(),a}return o(t,e),a(t,[{key:"_appendControlsAssets",value:function(){var e=this._editor.controls.getAvailable();for(var t in e){var n=e[t];this._editor.controls.isEnabled(t)&&(this._assets=this._assets.concat(n.getPreloadAssets(this._editor)),this._assets.push(n.iconPath))}}},{key:"load",value:function(){var e=this,t=this._assets.slice(),n=t.length,i=0,r=function(){i++,e.emit("progress",i/n),i===n&&e.emit("done")},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"timed out";s.Log.warn("Preloader",e+" "+t+"."),r()},a=function(e){return window.setTimeout(function(){o(e)},5e3)};t.forEach(function(t){var n=!0,i=!0;s.SDKUtils.isArray(t)&&(i=t[2],n=t[1],t=t[0]);var l=e._ui.getAssetPath(t,i,!n),c=new window.Image,u=a(l);c.addEventListener("load",function(){e._assets[l]=c,window.clearTimeout(u),r()}),c.addEventListener("error",function(){window.clearTimeout(u),o(l,"was not found")}),c.crossOrigin="Anonymous",c.src=l})}},{key:"getAsset",value:function(e){return this._assets[e]}}]),t}(s.EventEmitter);t.default=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(190);Object.defineProperty(t,"Provider",{enumerable:!0,get:function(){return i(r).default}});var o=n(191);Object.defineProperty(t,"Library",{enumerable:!0,get:function(){return i(o).default}});var a=n(192);Object.defineProperty(t,"SearchSuggestion",{enumerable:!0,get:function(){return i(a).default}});var s=n(193);Object.defineProperty(t,"Photo",{enumerable:!0,get:function(){return i(s).default}})},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),a=function(){function e(){i(this,e)}return r(e,[{key:"getLibraries",value:function(){return o.Log.warn(this.constructor.name,"`getLibraries` is abstract and not implemented."),o.Promise.resolve([])}},{key:"getSearchSuggestions",value:function(){return o.Log.warn(this.constructor.name,"`getSearchSuggestions` is abstract and not implemented."),o.Promise.resolve([])}},{key:"getPhotosForLibrary",value:function(e){return o.Log.warn(this.constructor.name,"`getPhotosForLibrary` is abstract and not implemented."),o.Promise.resolve([])}},{key:"searchPhotos",value:function(e){return o.Log.warn(this.constructor.name,"`searchPhotos` is abstract and not implemented."),o.Promise.resolve([])}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t){i(this,e),this.name=t.name,this.coverImage=t.coverImage};t.default=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t){i(this,e),this.query=t.query,this.name=this.query,this.coverImage=t.coverImage};t.default=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,n){i(this,e),this.library=t,this.title=n.title,this.urls=n.urls};t.default=r},function(e,t){e.exports={controls:{overview:{filters:"Filter",adjustments:"Korrekturen",transform:"Zuschneiden",blur:"Weichzeichnen",frame:"Rahmen",sticker:"Sticker",text:"Text",brush:"Malen",focus:"Focus","selective-blur":"Sel. Unschärfe"},text:{foreground:"Vordergrund",background:"Hintergrund",size:"Größe",font:"Schriftart",alignment:"Ausrichtung",takeToFront:"Nach oben",defaultText:"Doppelklick zum Bearbeiten!"},adjustments:{brightness:"Helligkeit",contrast:"Kontrast",saturation:"Sättigung",gamma:"Gamma",exposure:"Belichtung",shadows:"Schatten",highlights:"Lichter",clarity:"Klarheit"},transform:{none:"Original",rotation:"Drehung"},focus:{none:"Original",radial:"Kreisförmig",mirrored:"Gespiegelt",blurRadius:"Radius"},selectiveBlur:{blurRadius:"Radius",size:"Dicke"},filters:{intensity:"Intensität",filters:{identity:"Original"}},sticker:{flip:"Spiegeln","flip-v":"Spiegeln (V)","flip-h":"Spiegeln (H)",takeToFront:"Nach oben",categories:{all:"Alle"}},brush:{size:"Dicke",color:"Farbe"},frame:{noFrame:"Kein Rahmen",scale:"Größe"}},webcam:{headline:"Mache ein Foto!"},editor:{headline:"Foto editieren",new:"Neu",backgroundImage:"Hintergrundbild",undo:"Rückgängig",export:"Speichern",zoom:"Zoom"},splash:{upload:{button:"Lade ein Foto hoch",description:"Klicke hier, um ein Foto von deinem Rechner hochzuladen oder lade es per Drag-and-Drop hoch"},webcam:{headline:"Webcam",description:"Klicke hier, um ein Foto mit deiner Webcam zu machen"},photoRoll:{headline:"Kostenloses Bildmaterial",description:"Suche dir eines von tausenden Stock Photos aus."}},photoRoll:{search:{placeholder:"Nach Fotos suchen",noSearchResults:'Entschuldigung, aber wir konnten für <strong>"${query}"</strong> leider keine Ergebnisse finden.',results:{headline:'Suchergebnisse für "${query}"'}}},generic:{back:"Zurück",cancel:"Abbrechen",color:"Farbe"},loading:{resizing:"Bild wird bearbeitet...",exporting:"Exportiere...",loading:"Lade..."},warnings:{imageResized_maxMegaPixels:{title:"Bild verkleinert",text:"Da dein Bild die maximale Größe von ${maxMegaPixels} Megapixeln überschreitet, wurde es auf ${width}x${height} Pixel verkleinert."},imageResized_maxDimensions:{title:"Bild verkleinert",text:"Aufgrund von Hardware-Beschränkungen wurde das Bild auf ${width}x${height} Pixel verkleinert."}},errors:{imageLoadFail:{title:"Bild konnte nicht geladen werden",text:"Beim Laden des Bildes unter ${path} ist ein Fehler aufgetreten."},webcamUnavailable:{title:"Webcam nicht verfügbar",text:"Webcam-Bild kann nicht dargestellt werden. (Fehler: ${error})"},webcamNotSupported:{title:"Webcam nicht unterstützt",text:"Dein Browser unterstützt das Webcam-Feature leider noch nicht."},renderingError:{title:"Rendering-Fehler",text:"Beim Rendern des Bildes ist ein Fehler aufgetreten."},context_lost:{title:"Es ist ein Fehler aufgetreten",text:"Dein Browser hat zu lange gebraucht, um das Bild zu generieren. Bitte versuche es noch einmal."},context_lost_limit:{title:"Es ist ein Fehler aufgetreten",text:"Bild-Generierung ist mehrmals fehlgeschlagen."},loadingStickersFailed:{title:"Laden der Sticker fehlgeschlagen"},loadingFontsFailed:{title:"Laden der Schriftarten fehlgeschlagen",text:"Einige Schriftarten sind möglicherweise nicht verfügbar."},photoRollLoadFail:{title:"Laden der Photo Roll fehlgeschlagen",text:"Die Photo Roll konnte nicht geladen werden: ${error}"},invalidFileType:{text:"Der Dateityp ${fileType} wird nicht unterstützt."},title:"Es ist ein Fehler aufgetreten"}}},function(e,t){e.exports={controls:{overview:{filters:"Filters",adjustments:"Adjust",transform:"Transform",focus:"Focus",frame:"Frame",sticker:"Sticker",text:"Text",brush:"Brush","selective-blur":"Selective Blur"},text:{foreground:"Foreground",background:"Background",size:"Size",font:"Font",alignment:"Alignment",takeToFront:"To Front",defaultText:"Double-click to edit"},adjustments:{brightness:"Brightness",contrast:"Contrast",saturation:"Saturation",exposure:"Exposure",gamma:"Gamma",shadows:"Shadows",highlights:"Highlights",clarity:"Clarity"},transform:{none:"Original",rotation:"Rotation"},focus:{none:"None",radial:"Radial",mirrored:"Mirrored",blurRadius:"Blur radius"},selectiveBlur:{blurRadius:"Blur radius",size:"Size"},filter:{intensity:"Intensity",filters:{identity:"None"}},sticker:{flip:"Flip","flip-v":"Flip (V)","flip-h":"Flip (H)",takeToFront:"To Front",categories:{all:"All"}},brush:{size:"Size",color:"Color"},frame:{noFrame:"No Frame",scale:"Scale"}},webcam:{headline:"Take a photo!"},editor:{headline:"Edit Photo",new:"New",backgroundImage:"Background Image",undo:"Undo",export:"Export",zoom:"Zoom"},splash:{upload:{button:"Upload your image",description:"Upload a picture from your library or just drag and drop"},webcam:{headline:"Webcam",description:"Take a picture with your webcam or phone"},photoRoll:{headline:"Free stock footage",description:"Select from thousands of Free Stock Photos"}},photoRoll:{search:{placeholder:"Search for photos",noSearchResults:'Sorry, but we couldn\'t find any photos for <strong>"${query}"</strong>.',results:{headline:'Search results for "${query}"'}}},generic:{back:"Back",cancel:"Cancel",color:"Color"},loading:{resizing:"Resizing...",exporting:"Exporting...",loading:"Loading..."},warnings:{imageResized_maxMegaPixels:{title:"Image resized",text:"Your image exceeds the maximum size of ${maxMegaPixels} megapixels and has therefore been resized to ${width}x${height} pixels."},imageResized_maxDimensions:{title:"Image resized",text:"Due to hardware limitations your image has been resized to ${width}x${height} pixels."}},errors:{imageLoadFail:{title:"Failed to load image",text:"Failed to load the image at ${path}"},webcamUnavailable:{title:"Webcam unavailable",text:"Unable to display webcam image (Error: ${error})"},webcamNotSupported:{title:"Webcam not supported",text:"The webcam feature is not supported by your browser."},renderingError:{title:"Error while rendering",text:"An error has occurred while rendering the image."},context_lost:{title:"An error has occurred",text:"Your browser took too long to render the image. Please try applying less operations."},context_lost_limit:{title:"An error has occurred",text:"Your browser failed multiple times while rendering the image."},loadingStickersFailed:{title:"Failed to load stickers"},loadingFontsFailed:{title:"Failed to load fonts",text:"Some fonts might not be available."},photoRollLoadFail:{title:"Failed to load Photo Roll",text:"Failed to load photos for the photo roll: ${error}"},invalidFileType:{text:"The file type ${fileType} is not supported."},title:"An error has occurred"}}}])});