!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.PhotoEditorSDK=e():t.PhotoEditorSDK=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=43)}([function(t,e,r){"use strict";r.d(e,"a",function(){return f}),r.d(e,"j",function(){return l});var n=r(2),i=r(8),o=r(26),s=r(27),a=r(6),h=r(9),u=r(1),c=r(28),p=r(3);r.d(e,"b",function(){return i.a}),r.d(e,"g",function(){return o.a}),r.d(e,"k",function(){return a.a}),r.d(e,"h",function(){return s.a}),r.d(e,"d",function(){return h.a}),r.d(e,"f",function(){return n.a}),r.d(e,"i",function(){return u.a}),r.d(e,"c",function(){return p}),r.d(e,"e",function(){return c.a});var f=2e3,l=20},function(t,e,r){"use strict";(function(t){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(10),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(){function e(){n(this,e)}return e.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},e.isMobile=function(){if("undefined"==typeof navigator)return!1;var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))},e.isBrowser=function(){return"undefined"!=typeof window},e.isNode=function(){return"undefined"==typeof window&&void 0!==t},e.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e},e.isDOMElement=function(t){return"object"===("undefined"==typeof HTMLElement?"undefined":o(HTMLElement))?t instanceof HTMLElement:t&&"object"===(void 0===t?"undefined":o(t))&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName},e.isTouchEvent=function(t){return-1!==t.type.indexOf("touch")},e.resizeVectorToFit=function(t,e){var r=Math.min(e.x/t.x,e.y/t.y);return t.clone().multiply(r)},e.resizeVectorToFill=function(t,e){var r=t.x/t.y;return r>e.x/e.y?e.clone().set(e.y*r,e.y):e.clone().set(e.x,e.x/r)},e.isExtendable=function(t){return void 0!==t&&null!==t&&("object"===(void 0===t?"undefined":o(t))||"function"==typeof t)},e.defaults=function(t){var e={};for(var r in t)e[r]=t[r];for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];for(var s=0;s<i.length;s++){var a=i[s];for(var h in a)void 0===e[h]&&(e[h]=a[h])}return e},e.deepDefaults=function(t){var r={};for(var n in t)r[n]=t[n];for(var i=arguments.length,o=Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];for(var a=0;a<o.length;a++){var h=o[a];for(var u in h)e.isExtendable(r[u])&&e.isExtendable(h[u])?r[u]=e.deepDefaults(r[u],h[u]):void 0===r[u]&&(r[u]=h[u])}return r},e.deepClone=function(t){var r={};for(var n in t)e.isExtendable(t[n])?r[n]=e.deepClone(t[n]):r[n]=t[n];return r},e.extend=function(t){var e={};for(var r in t)e[r]=t[r];for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];for(var s=0;s<i.length;s++){var a=i[s];for(var h in a)e[h]=a[h]}return e},e.clone=function(t){return this.extend({},t)},e.createBlobURIFromDataURI=function(e){var r="undefined"==typeof window?t:window;if(!(r.Blob&&r.URL&&ArrayBuffer&&Uint8Array))return e;for(var n=i.a.decode(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(n.length),a=new Uint8Array(s),h=0;h<n.length;h++)a[h]=n[h];var u=new r.Blob([s],{type:o});return r.URL.createObjectURL(u)},e.getUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},e.flatten=function(t){return t.reduce(function(t,r){return t.concat(Array.isArray(r)?e.flatten(r):r)},[])},e.createCanvas=function(){return document.createElement("canvas")},e.isPowerOfTwo=function(t){return 0==(t.x&t.x-1)&&0==(t.y&t.y-1)},e.nextLowestPOT=function(t){for(var e=1;e<32;e<<=1)t|=t>>e;return t-(t>>1)},e.nextHighestPOT=function(t){t--;for(var e=1;e<32;e<<=1)t|=t>>e;return t+1},e.moveArrayItem=function(t,e,r){if(r>=t.length)for(var n=r-t.length;1+n--;)t.push(void 0);t.splice(r,0,t.splice(e,1)[0])},e.ensureCanvasDimensions=function(t,e){t.width===e.x&&t.height===e.y||(t.width=e.x,t.height=e.y)},e.byteArrayToString=function(t){return t.map(function(t){return String.fromCharCode(t)}).join("")},e.clamp=function(t,e,r){return Math.max(e,Math.min(t,r))},e.wildCardMatch=function(t,e){return new RegExp("^"+e.split("*").join(".*")+"$").test(t)},e.flipObject=function(t){var e={};for(var r in t)e[t[r]]=r;return e},e.cloneOptions=function(t){var e={};for(var r in t){var n=t[r];Array.isArray(n)?n=n.slice():n.clone&&(n=n.clone()),e[r]=n}return e},e.ISODateString=function(t){function e(t){return t<10?"0"+t:t}return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"Z"},e.shallowEqual=function(t,e){if(t===e)return!0;if("object"!==(void 0===t?"undefined":o(t))||null===t||"object"!==(void 0===e?"undefined":o(e))||null===e)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(var i=hasOwnProperty.bind(e),s=0;s<r.length;s++)if(!i(r[s])||t[r[s]]!==e[r[s]])return!1;return!0},e.enableIf=function(t,e){return t?e:void 0},e.invariant=function(t,e){if(!t){throw new Error(e)}},e}();e.a=s}).call(e,r(7))},function(t,e,r){"use strict";(function(t){var r="warn",n=[{type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{type:"info",background:"#BDE5F8",color:"#00529B"},{type:"warn",background:"#FEEFB3",color:"#9F6000"},{type:"error",background:"#FFBABA",color:"#D8000C"},{type:"log",background:"#EEEEEE",color:"#1f4f6b"}],i=n.map(function(t){return t.type}),o={};o.setLevel=function(t){r=t},o.canLog=function(t){return null!==r&&!(i.indexOf(t)<i.indexOf(r))},o.hasColorfulOutput=function(){return(!t||t&&t.browser)&&"undefined"!=typeof navigator&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/)},o.printError=function(t){t.stack.split("\n").forEach(function(t){o.error("Error",t)})},n.forEach(function(t){var e=t.type,r=t.background,n=t.color;o[e]=function(t){if("undefined"!=typeof console&&o.canLog(e)){for(var i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];var h=s.map(function(t){return"string"==typeof t?t:t.toString()}).join(" ");if(!o.hasColorfulOutput())return console.log("PhotoEditorSDK | "+t+" | "+h);console.log("%c  %c PhotoEditorSDK %c  %c "+t+" %c  "+h+"  %c  ","background: #2D7BFF; line-height: 20px; padding: 4px 0","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0","background: "+r+"; color: "+n+"; line-height: 20px; padding: 4px 0; font-weight: bold","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0")}}}),e.a=o}).call(e,r(17))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"RenderType",function(){return n}),r.d(e,"ImageFormat",function(){return i}),r.d(e,"Events",function(){return o}),r.d(e,"OptionType",function(){return s}),r.d(e,"UniformType",function(){return a}),r.d(e,"RendererType",function(){return h});var n={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob",MSBLOB:"ms-blob"},i={PNG:"image/png",JPEG:"image/jpeg"},o={OPERATION_UPDATED:"operation:update"},s={NUMBER:"number",VECTOR2:"vector2",COLOR_MATRIX:"color-matrix",COLOR:"color",ARRAY:"array",OBJECT:"object",STRING:"string",BOOLEAN:"boolean",CONFIGURABLE:"configurable",IMAGE:"image",FUNCTION:"function",TEXTURE:"texture",ALL:"*"},a={SAMPLER2D:"sampler2d",INT:"i",INT1:"1i",FLOAT:"f",FLOAT1:"1f",FLOAT2:"2f",FLOAT_VECTOR2:"2fv",FLOAT3:"3f",FLOAT4:"4f",MAT3:"mat3",MAT3FV:"mat3fv",MAT4:"mat4"},h={WEBGL:"webgl",CANVAS:"canvas"}},function(t,e,r){"use strict";(function(t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=void 0===r?window:r,o="undefined"!=typeof Promise?Promise:function(){function e(t,e){d.add(t,e),l||(l=y(d.drain))}function r(t){var e,r=void 0===t?"undefined":n(t);return null==t||"object"!=r&&"function"!=r||(e=t.then),"function"==typeof e&&e}function i(){for(var t=0;t<this.chain.length;t++)o(this,1===this.state?this.chain[t].success:this.chain[t].failure,this.chain[t]);this.chain.length=0}function o(t,e,n){var i,o;try{!1===e?n.reject(t.msg):(i=!0===e?t.msg:e.call(void 0,t.msg),i===n.promise?n.reject(TypeError("Promise-chain cycle")):(o=r(i))?o.call(i,n.resolve,n.reject):n.resolve(i))}catch(t){n.reject(t)}}function s(t){var n,o=this;if(!o.triggered){o.triggered=!0,o.def&&(o=o.def);try{(n=r(t))?e(function(){var e=new u(o);try{n.call(t,function(){s.apply(e,arguments)},function(){a.apply(e,arguments)})}catch(t){a.call(e,t)}}):(o.msg=t,o.state=1,o.chain.length>0&&e(i,o))}catch(t){a.call(new u(o),t)}}}function a(t){var r=this;r.triggered||(r.triggered=!0,r.def&&(r=r.def),r.msg=t,r.state=2,r.chain.length>0&&e(i,r))}function h(t,e,r,n){for(var i=0;i<e.length;i++)!function(i){t.resolve(e[i]).then(function(t){r(i,t)},n)}(i)}function u(t){this.def=t,this.triggered=!1}function c(t){this.promise=t,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function p(t){if("function"!=typeof t)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var r=new c(this);this.then=function(t,n){var o={success:"function"!=typeof t||t,failure:"function"==typeof n&&n};return o.promise=new this.constructor(function(t,e){if("function"!=typeof t||"function"!=typeof e)throw TypeError("Not a function");o.resolve=t,o.reject=e}),r.chain.push(o),0!==r.state&&e(i,r),o.promise},this.catch=function(t){return this.then(void 0,t)};try{t.call(void 0,function(t){s.call(r,t)},function(t){a.call(r,t)})}catch(t){a.call(r,t)}}var f,l,d,_=Object.prototype.toString,y=void 0!==t?function(e){return t(e)}:setTimeout;try{Object.defineProperty({},"x",{}),f=function(t,e,r,n){return Object.defineProperty(t,e,{value:r,writable:!0,configurable:!1!==n})}}catch(t){f=function(t,e,r){return t[e]=r,t}}d=function(){function t(t,e){this.fn=t,this.self=e,this.next=void 0}var e,r,n;return{add:function(i,o){n=new t(i,o),r?r.next=n:e=n,r=n,n=void 0},drain:function(){var t=e;for(e=r=l=void 0;t;)t.fn.call(t.self),t=t.next}}}();var g=f({},"constructor",p,!1);return p.prototype=g,f(g,"__NPO__",0,!1),f(p,"resolve",function(t){var e=this;return t&&"object"==(void 0===t?"undefined":n(t))&&1===t.__NPO__?t:new e(function(e,r){if("function"!=typeof e||"function"!=typeof r)throw TypeError("Not a function");e(t)})}),f(p,"reject",function(t){return new this(function(e,r){if("function"!=typeof e||"function"!=typeof r)throw TypeError("Not a function");r(t)})}),f(p,"all",function(t){var e=this;return"[object Array]"!=_.call(t)?e.reject(TypeError("Not an array")):0===t.length?e.resolve([]):new e(function(r,n){if("function"!=typeof r||"function"!=typeof n)throw TypeError("Not a function");var i=t.length,o=Array(i),s=0;h(e,t,function(t,e){o[t]=e,++s===i&&r(o)},n)})}),f(p,"race",function(t){var e=this;return"[object Array]"!=_.call(t)?e.reject(TypeError("Not an array")):new e(function(r,n){if("function"!=typeof r||"function"!=typeof n)throw TypeError("Not a function");h(e,t,function(t,e){r(e)},n)})}),p}();i.Promise=i.Promise||o,e.a=o}).call(e,r(58).setImmediate,r(7))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(14),i=r(3),o=r(10),s=r(9),a=r(1),h=r(13),u=r(8),c=r(2),p=r(4),f=r(28),l=r(69),d=r(80);r.d(e,"requestAnimationFrame",function(){return d.b}),r.d(e,"cancelAnimationFrame",function(){return d.a}),r.d(e,"Engine",function(){return n.a}),r.d(e,"EventEmitter",function(){return s.a}),r.d(e,"Utils",function(){return a.a}),r.d(e,"Configurable",function(){return h.a}),r.d(e,"Color",function(){return u.a}),r.d(e,"Constants",function(){return i}),r.d(e,"Log",function(){return c.a}),r.d(e,"Promise",function(){return p.a}),r.d(e,"GLUtils",function(){return f.a}),r.d(e,"Base64",function(){return o.a}),r.d(e,"LicenseChecker",function(){return l.a});var _=r(37);r.d(e,"Vector2",function(){return _.Vector2}),r.d(e,"Rectangle",function(){return _.Rectangle}),r.d(e,"Matrix",function(){return _.Matrix}),r.d(e,"ColorMatrix",function(){return _.ColorMatrix})},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e,r){n(this,t),this.x=e,this.y=r,void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0)}return t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.clamp=function(e,r){var n=null!==e&&void 0!==e,i=null!==r&&void 0!==r;return e instanceof t||!n||(e=new t(e,e)),r instanceof t||!i||(r=new t(r,r)),n&&(this.x=Math.max(e.x,this.x),this.y=Math.max(e.y,this.y)),i&&(this.x=Math.min(r.x,this.x),this.y=Math.min(r.y,this.y)),this},t.prototype.divide=function(e,r){return e instanceof t?(this.x/=e.x,this.y/=e.y):(this.x/=e,this.y/=void 0===r?e:r),this},t.prototype.subtract=function(e,r){return e instanceof t?(this.x-=e.x,this.y-=e.y):(this.x-=e,this.y-=void 0===r?e:r),this},t.prototype.multiply=function(e,r){return e instanceof t?(this.x*=e.x,this.y*=e.y):(this.x*=e,this.y*=void 0===r?e:r),this},t.prototype.add=function(e,r){return e instanceof t?(this.x+=e.x,this.y+=e.y):(this.x+=e,this.y+=void 0===r?e:r),this},t.prototype.equals=function(e,r){return e instanceof t?e.x===this.x&&e.y===this.y:e===this.x&&r===this.y},t.prototype.flip=function(){var t=this.x;return this.x=this.y,this.y=t,this},t.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},t.prototype.floor=function(){return this.x=0|this.x,this.y=0|this.y,this},t.prototype.abs=function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},t.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.min=function(){return Math.min(this.x,this.y)},t.prototype.max=function(){return Math.max(this.x,this.y)},t.prototype.toObject=function(){return{x:this.x,y:this.y}},t.prototype.toString=function(){return"Vector2({ x: "+this.x+", y: "+this.y+" })"},t.prototype.roundDecimal=function(t){return this.x=parseFloat(this.x.toFixed(t)),this.y=parseFloat(this.y.toFixed(t)),this},t.fromObject=function(e){return new t(e.x,e.y)},i(t,null,[{key:"NULL",get:function(){return new t(0,0)}}]),t}();e.a=o},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function(){function t(e,r,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;n(this,t),this.r=e,this.g=r,this.b=i,this.a=o}return t.prototype.toRGBA=function(){return"rgba("+[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b),this.a.toFixed(2)].join(",")+")"},t.prototype.set=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.a;return this.r=t,this.g=e,this.b=r,this.a=n,this},t.prototype.toRGB=function(){return[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b)]},t.prototype.toHex=function(){return"#"+[this._componentToHex(Math.round(255*this.r)),this._componentToHex(Math.round(255*this.g)),this._componentToHex(Math.round(255*this.b))].join("")},t.prototype.toGLColor=function(){return[this.r,this.g,this.b,this.a]},t.prototype.toArray=function(){return this.toGLColor()},t.prototype.toRGBGLColor=function(){return[this.r,this.g,this.b]},t.prototype.toHSV=function(){var t=Math.max(this.r,this.g,this.b),e=Math.min(this.r,this.g,this.b),r=void 0,n=void 0,i=t,o=t-e;if(n=0===t?0:o/t,t===e)r=0;else{switch(t){case this.r:r=(this.g-this.b)/o,this.g<this.b&&(r+=6);break;case this.g:r=(this.b-this.r)/o+2;break;case this.b:r=(this.r-this.g)/o+4}r/=6}return[r,n,i]},t.prototype.fromHSV=function(e,r,n){return this.copy(t.fromHSV(e,r,n)),this},t.fromHSV=function(e,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=[],s=o[0],a=o[1],h=o[2],u=Math.floor(6*e),c=6*e-u,p=n*(1-r),f=n*(1-c*r),l=n*(1-(1-c)*r);switch(u%6){case 0:s=n,a=l,h=p;break;case 1:s=f,a=n,h=p;break;case 2:s=p,a=n,h=l;break;case 3:s=p,a=f,h=n;break;case 4:s=l,a=p,h=n;break;case 5:s=n,a=p,h=f}return new t(s,a,h,i)},t.fromArray=function(e){return new t(e[0],e[1],e[2],e[3])},t.fromHex=function(e){var r=e.match(/.{1,2}/g),n=i(r,3),o=n[0],s=n[1],a=n[2];return new t(parseInt(o,16)/255,parseInt(s,16)/255,parseInt(a,16)/255,1)},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},t.prototype.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},t.prototype.equals=function(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},t.prototype._componentToHex=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e},t.prototype.toString=function(){return"Color("+this.r+", "+this.g+", "+this.b+", "+this.a+")"},o(t,null,[{key:"TRANSPARENT",get:function(){return new t(0,0,0,0)}},{key:"WHITE",get:function(){return new t(1,1,1,1)}},{key:"BLACK",get:function(){return new t(0,0,0,1)}}]),t}();e.a=s},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(2),o=12,s=function(){function t(){n(this,t),this._maxListeners=o,this._events={},this._pipeDestinations=[]}return t.prototype.pipeEvents=function(t){this._pipeDestinations.push(t)},t.prototype.unpipeEvents=function(t){var e=this._pipeDestinations.indexOf(t);-1!==e&&this._pipeDestinations.splice(e,1)},t.prototype.on=function(t,e){if(void 0===t)throw new Error("Invalid event type: `"+t+"`");if("function"!=typeof e)throw new TypeError;var r=this._events[t]||(this._events[t]=[]);return-1!==r.indexOf(e)?this:(r.push(e),this._maxListeners&&r.length>this._maxListeners&&(i.a.warn("EventEmitter","Possible memory leak detected, added "+r.length+" `"+t+"` listeners (current limit is "+this._maxListeners+")"),"undefined"!=typeof console&&console.trace()),this)},t.prototype.once=function(t,e){function r(){n.off(t,r),e.apply(null,arguments)}if(void 0===t)throw new Error("Invalid event type: `"+t+"`");var n=this;return this.on(t,r)},t.prototype.off=function(t){if(void 0===t)throw new Error("Invalid event type: `"+t+"`");if(0==(arguments.length<=1?0:arguments.length-1))return this._events[t]=null,this;var e=arguments.length<=1?void 0:arguments[1];if("function"!=typeof e)throw new TypeError;var r=this._events[t];if(!r||!r.length)return this;var n=r.indexOf(e);return-1===n?this:(r.splice(n,1),this)},t.prototype.emit=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if(void 0===t)throw new Error("Invalid event type: `"+t+"`");this._pipeDestinations.forEach(function(e){e.emit.apply(e,[t].concat(r))});var i=this._events[t];return!(!i||!i.length)&&(i.slice(0).forEach(function(t){return t.apply(null,r)}),!0)},t.prototype.setMaxListeners=function(t){if(parseInt(t,10)!==t)throw new TypeError;this._maxListeners=t},t}();e.a=s},function(t,e,r){"use strict";/*
 * Extracted from MinifyJpeg (Copyright (c) 2014 Hiroaki Matoba, MIT License):
 * https://github.com/hMatoba/MinifyJpeg
 * @license
 */
var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i={encode:function(t){var e="",r=void 0,i=void 0,o=void 0,s=void 0,a=void 0,h=void 0,u=void 0,c=0;do{r=t[c++],i=t[c++],o=t[c++],s=r>>2,a=(3&r)<<4|i>>4,h=(15&i)<<2|o>>6,u=63&o,isNaN(i)?h=u=64:isNaN(o)&&(u=64),e=e+n.charAt(s)+n.charAt(a)+n.charAt(h)+n.charAt(u),r=i=o="",s=a=h=u=""}while(c<t.length);return e},decode:function(t){var e=void 0,r=void 0,i=void 0,o=void 0,s=void 0,a=void 0,h=void 0,u=0,c=[];if(/[^A-Za-z0-9+\/=]/g.exec(t))throw new Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.");t=t.replace(/[^A-Za-z0-9+\/=]/g,"");do{o=n.indexOf(t.charAt(u++)),s=n.indexOf(t.charAt(u++)),a=n.indexOf(t.charAt(u++)),h=n.indexOf(t.charAt(u++)),e=o<<2|s>>4,r=(15&s)<<4|a>>2,i=(3&a)<<6|h,c.push(e),64!==a&&c.push(r),64!==h&&c.push(i),e=r=i="",o=s=a=h=""}while(u<t.length);return c}};e.a=i},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=function(t){function e(r){n(this,e);var o=i(this,t.call(this));return o.id=e.id++,o._onSourceLoaded=o._onSourceLoaded.bind(o),o._renderers=[],o._glTextures={},o._source=r,o._dirty=!0,o._glUnit=0,o._mipMapping=!1,o._magFilter=e.DefaultMagFilter,o._minFilter=e.DefaultMinFilter,o._repeatX=e.ClampToEdge,o._repeatY=e.ClampToEdge,o._pixelRatio=1,o._loaded=!1,o._frame=new s.h(0,0,100,100),r&&o._loadSource(),o}return o(e,t),e.prototype.resizeTo=function(t){this._frame.width===t.x&&this._frame.height===t.y||(this._frame.width=t.x,this._frame.height=t.y,this._dirty=!0)},e.prototype._loadSource=function(){var t=this._source,e=t.complete,r="Canvas"===t.constructor.name||t.tagName&&"CANVAS"===t.tagName.toUpperCase();if(e||r)return this._onSourceLoaded();t.addEventListener("load",this._onSourceLoaded)},e.prototype._onSourceLoaded=function(){this._loaded=!0,this.emit("loaded"),this.update()},e.prototype._updateGLFilters=function(){var t=new s.k(this._source.width,this._source.height);s.i.isPowerOfTwo(t)?(s.f.info(this.constructor.name,"Mip-mapping enabled"),this._minFilter=e.TrilinearFilter,this._mipMapping=!0):(this._minFilter=e.LinearFilter,this._mipMapping=!1)},e.prototype.update=function(){this._frame.width===this._source.width&&this._frame.height===this._source.height||(this._frame=new s.h(0,0,this._source.width,this._source.height),this._dirty=!0),this._updateGLFilters(),this.emit("update")},e.prototype.getGLFilter=function(t,e){switch(e){case"min":return this.constructor.getGLFilter(t,this._minFilter);case"mag":return this.constructor.getGLFilter(t,this._magFilter)}},e.getGLFilter=function(t,r){switch(r){case e.LinearFilter:return t.LINEAR;case e.NearestFilter:return t.NEAREST;case e.BilinearFilter:return t.LINEAR_MIPMAP_NEAREST;case e.TrilinearFilter:return t.LINEAR_MIPMAP_LINEAR}},e.prototype.isLoaded=function(){return this._loaded},e.prototype.setLoaded=function(t){this._loaded=t},e.prototype.getSource=function(){return this._source},e.prototype.setSource=function(t){this._source=t},e.prototype.getGLTextureForRenderer=function(t){return this._glTextures[t.id]},e.prototype.setGLTextureForRenderer=function(t,e){this._renderers[e.id]=e,this._glTextures[e.id]=t},e.prototype.getFrame=function(){return this._frame},e.prototype.setFrame=function(t){this._frame=t},e.prototype.getDimensions=function(){return new s.k(this._frame.width,this._frame.height)},e.prototype.getPixelRatio=function(){return this._pixelRatio},e.prototype.setPixelRatio=function(t){this._pixelRatio=t},e.prototype.getGLUnit=function(){return this._glUnit},e.prototype.setGLUnit=function(t){this._glUnit=t},e.prototype.setMinFilter=function(t){this._minFilter=t},e.prototype.getMinFilter=function(){return this._minFilter},e.prototype.setMagFilter=function(t){this._magFilter=t},e.prototype.getMagFilter=function(){return this._magFilter},e.prototype.setRepeatX=function(t){this._repeatX=t},e.prototype.getRepeatX=function(){return this._repeatX},e.prototype.setRepeatY=function(t){this._repeatY=t},e.prototype.getRepeatY=function(){return this._repeatY},e.prototype.getGLRepeat=function(t,r){switch("x"===r?this.getRepeatX():this.getRepeatY()){case e.ClampToEdge:return t.CLAMP_TO_EDGE;case e.Repeat:return t.REPEAT;case e.MirroredRepeat:return t.MIRRORED_REPEAT}},e.prototype.isDirty=function(){return this._dirty},e.prototype.setDirty=function(t){this._dirty=t},e.prototype.disposeGLTextures=function(){for(var t in this._renderers)this.disposeGLTexturesForRenderer(this._renderers[t])},e.prototype.disposeGLTexturesForRenderer=function(t){if(this._glTextures[t.id]){t.getContext().deleteTexture(this._glTextures[t.id]),delete this._glTextures[t.id],this._renderers[t.id]||delete this._renderers[t.id]}},e.prototype.isMipMappingEnabled=function(){return this._mipMapping},e.prototype.setMipMappingEnabled=function(t){this._mipMapping=t},e.prototype.dispose=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.disposeGLTextures()},e}(s.d);a.NearestFilter=0,a.LinearFilter=1,a.BilinearFilter=2,a.TrilinearFilter=3,a.DefaultMagFilter=a.NearestFilter,a.DefaultMinFilter=a.LinearFilter,a.ClampToEdge=0,a.Repeat=1,a.MirroredRepeat=2,a.id=0,e.a=a},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(13),h=r(20),u=r(19),c=s.c.OptionType,p=s.c.UniformType,f=s.c.RendererType,l=function(t){function e(){return n(this,e),i(this,t.apply(this,arguments))}return o(e,t),e.prototype._initOptions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._shaders=[],this._availableUniforms=u.a.defaultUniforms,this._attributes=u.a.defaultAttributes,this._vertexSource=u.a.defaultVertexSource,this._fragmentSource=u.a.defaultFragmentSource,this._initUniforms(),t.prototype._initOptions.call(this,e)},e.prototype._initUniforms=function(){this._uniforms={};for(var t in this._availableUniforms){var e=this._availableUniforms[t];this._uniforms[t]={type:e.type,value:e.default||null}}for(var r in this.availableOptions){var n=this.availableOptions[r];n.uniformType?this._uniforms["u_"+r]={type:n.uniformType,value:n.default||null}:s.f.trace(this.constructor.name,"Option `"+r+"` is missing a `uniformType`!")}},e.prototype.setOption=function(e,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t.prototype.setOption.call(this,e,r,n);var i=r,o=this.availableOptions[e];if(o.uniformType){var s="u_"+e;switch(o.type){case c.COLOR:o.uniformType===p.FLOAT4?i=r.toGLColor():o.uniformType===p.FLOAT3&&(i=r.toRGBGLColor());break;case c.VECTOR2:i=[r.x,r.y];break;case c.COLOR_MATRIX:i=[r.a,r.b,r.c,r.d,r.f,r.g,r.h,r.i,r.k,r.l,r.m,r.n,r.p,r.q,r.r,r.s];var a=[r.e,r.j,r.o,r.t];this._uniforms[s+"_vec"]={value:a,type:p.FLOAT4}}this.setUniform(s,i)}},e.prototype.setUniform=function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._uniforms[t].value=e},e.prototype.setUniforms=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var r in t)this._uniforms[r].value=t[r],e&&this.syncUniform(r)},e.prototype.syncUniform=function(t){this._shaders.forEach(function(e){e.syncUniform(t)})},e.prototype.syncUniforms=function(){this._shaders.forEach(function(t){t.syncUniforms()})},e.prototype.getShaderForRenderer=function(t){var e=t.getContext(),r=this._shaders[e.id];return r||(r=new h.a(t,this._vertexSource,this._fragmentSource,this._uniforms,this._attributes),this._shaders[e.id]=r),r},e.prototype.apply=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t.isOfType(f.WEBGL)?this._applyWebGL(t,e,r,n):t.isOfType(f.CANVAS)&&this._applyCanvas(t,e,r,n)},e.prototype._applyWebGL=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.getContext(),o=this.getShaderForRenderer(t);t.setRenderTarget(r),n&&r.clear(),t.setShader(o);var s=t.getCurrentRenderTarget().getProjectionMatrix().toArray();o.setUniform("u_projMatrix",s),o.syncUniforms(),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,e.getTexture()),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0)},e.prototype._applyCanvas=function(t,e,r){var n=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],e.getCanvas()),i=r.getContext();s.f.warn(this.constructor.name,"`_applyCanvas` is not implemented. Just copying image data from `inputTarget` to `outputTarget`."),i.clearRect(0,0,n.width,n.height),i.drawImage(n,0,0)},e.prototype.dispose=function(){this._shaders.forEach(function(t){return t.dispose()}),this._shaders=[]},e}(a.a);e.a=l},function(t,e,r){"use strict";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=r(4),h=r(2),u=r(9),c=r(6),p=r(8),f=r(1),l=r(36),d=r(3),_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y=void 0;y=window.Image;var g=function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e);var s=o(this,t.call(this));return s.availableOptions=s.availableOptions||{},s.availableOptions=f.a.extend(s.availableOptions,n),s._onConfigurableUpdate=s._onConfigurableUpdate.bind(s),s._initOptions(r),s}return s(e,t),e.prototype._buildConfigError=function(t){var e="";return this.constructor.name&&(e=this.constructor.name+": "),e+=t,new Error(e)},e.prototype._onOptionsChange=function(){},e.prototype.validateSettings=function(){var t=this;return new a.a(function(e,r){for(var n in t.availableOptions){if(t.availableOptions[n].required&&void 0===t._options[n])return r(t._buildConfigError("Option `"+n+"` is required."))}e()})},e.prototype._initOptions=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._options={};var r,n,i,o=this;for(r in this.availableOptions){if(i=r.charAt(0).toUpperCase()+r.slice(1),n=this.availableOptions[r],-1===[d.OptionType.STRING,d.OptionType.NUMBER,d.OptionType.BOOLEAN,d.OptionType.OBJECT,d.OptionType.VECTOR2,d.OptionType.COLOR,d.OptionType.CONFIGURABLE,d.OptionType.COLOR_MATRIX,d.OptionType.ARRAY,d.OptionType.IMAGE,d.OptionType.FUNCTION,d.OptionType.ALL].indexOf(n.type))throw this._buildConfigError("Unknown option type: `"+n.type+"`");if(function(t,e){o["set"+i]=function(e,r,n){o.setOption(t,e,r,n)},o["get"+i]=function(){return o.getOption(t)}}(r),n.type===d.OptionType.CONFIGURABLE&&(this._options[r]=new e(void 0,n.structure||{}),this._options[r].on("update",this._onConfigurableUpdate)),!(r in t)||void 0===t[r])if(void 0!==n.default){var s=n.default;"function"==typeof n.default&&(s=n.default()),this["set"+i](s,!1,!0)}else n.type!==d.OptionType.CONFIGURABLE&&(this._options[r]=void 0)}for(r in t){if(void 0===this.availableOptions[r])throw new Error("Invalid option: "+r);void 0!==t[r]&&(i=r.charAt(0).toUpperCase()+r.slice(1),this["set"+i](t[r],!1,!0))}},e.prototype.set=function(t){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.emit("update",this,t);for(var e in t)this.setOption(e,t[e],!1);this._onOptionsChange()},e.prototype.getOption=function(t){return this._options[t]},e.prototype.hasOption=function(t){return!!this.availableOptions[t]},e.prototype.getOptionDefault=function(t){var e=this.availableOptions[t];if(!e)throw new Error("Invalid option: "+t);return e.default},e.prototype.resetOptions=function(){this.set(this.getDefaultOptions())},e.prototype.getDefaultOptions=function(){var t={};for(var e in this.availableOptions){var r=this.availableOptions[e].default;void 0!==r&&(t[e]=r)}return t},e.prototype.optionsEqual=function(t){for(var e in t){var r=t[e];if(!this._optionEquals(e,r))return!1}return!0},e.prototype._optionEquals=function(t,e){if(void 0===this.availableOptions[t])throw new Error("Invalid option: "+t);var r=this.availableOptions[t].type,n=this._options[t];if(n===e)return!0;if(void 0===e)return!1;switch(r){case d.OptionType.OBJECT:return"function"==typeof n.optionsEqual?n.optionsEqual(e._options):n===e;case d.OptionType.STRING:case d.OptionType.NUMBER:case d.OptionType.BOOLEAN:case d.OptionType.FUNCTION:case"*":return n===e;case d.OptionType.VECTOR2:return n.equals(e);case d.OptionType.COLOR:case d.OptionType.COLOR_MATRIX:return e.equals(n);case d.OptionType.CONFIGURABLE:return n.optionsEqual(e);case d.OptionType.ARRAY:return this._arrayOptionEquals(t,e);case d.OptionType.IMAGE:return n.src===e.src}},e.prototype._arrayOptionEquals=function(t,r){for(var n=this._options[t],i=!0,o=0;o<n.length;o++){var s=n[o],a=r[o];if(s instanceof e){if(void 0===a||!s.optionsEqual(a)){i=!1;break}}else if(a!==s){i=!1;break}}return i},e.prototype.serializeOptions=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.keys(this._options),r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};return e.forEach(function(e){if(void 0===t.availableOptions[e])return h.a.warn("Trying to serialize a key that does not exist: "+e);!1!==t.availableOptions[e].serializable&&(n[e]=t.serializeOption(e,r))}),n},e.prototype.serializeOption=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.availableOptions[t],n=r.type,i=this._options[t];if(!i)return i;if(!1===r.serializable)throw new Error("Option `"+t+"` is not serializable.");switch(n){case d.OptionType.STRING:case d.OptionType.NUMBER:case d.OptionType.BOOLEAN:case d.OptionType.OBJECT:case d.OptionType.FUNCTION:case d.OptionType.ALL:return i;case d.OptionType.VECTOR2:return e?i.toObject():i.clone();case d.OptionType.COLOR:case d.OptionType.COLOR_MATRIX:return e?i.toArray():i.clone();case d.OptionType.CONFIGURABLE:return i.serializeOptions(void 0,e);case d.OptionType.ARRAY:return i.slice(0);case d.OptionType.IMAGE:return e?i.src:i}},e.prototype.setOption=function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r&&this.emit("update",this,n({},t,e));var o=this.availableOptions[t];if(!o)throw new Error("Invalid option: "+t);if(void 0!==o.setter&&(e=o.setter.call(this,e,i)),void 0!==o.validation&&o.validation(e),null===e||void 0===e){if(o.required)throw this._buildConfigError("Option `"+t+"` is required.");this._options[t]=e}else switch(o.type){case d.OptionType.STRING:if((void 0===e?"undefined":_(e))!==d.OptionType.STRING)throw this._buildConfigError("Option `"+t+"` has to be a string.");var s=o.available;if(void 0!==s&&-1===s.indexOf(e))throw this._buildConfigError("Invalid value for `"+t+"` (valid values are: "+o.available.join(", ")+")");this._options[t]=e;break;case d.OptionType.NUMBER:if((void 0===e?"undefined":_(e))!==d.OptionType.NUMBER)throw this._buildConfigError("Option `"+t+"` has to be a number.");this._options[t]=e;break;case d.OptionType.BOOLEAN:if((void 0===e?"undefined":_(e))!==d.OptionType.BOOLEAN)throw this._buildConfigError("Option `"+t+"` has to be a boolean.");this._options[t]=e;break;case d.OptionType.VECTOR2:if(!(e instanceof c.a||"object"===(void 0===e?"undefined":_(e))&&"x"in e&&"y"in e))throw this._buildConfigError("Option `"+t+"` has to be an instance of Vector2 or an Object holding x and y values.");e instanceof c.a?this._options[t]=e.clone():this._options[t]=c.a.fromObject(e);break;case d.OptionType.COLOR:if(!(e instanceof p.a))throw this._buildConfigError("Option `"+t+"` has to be an instance of Color.");this._options[t]=e;break;case d.OptionType.COLOR_MATRIX:if(!(e instanceof l.a))throw this._buildConfigError("Option `"+t+"` has to be an instance of ColorMatrix.");this._options[t]=e.clone();break;case d.OptionType.FUNCTION:if("function"!=typeof e)throw this._buildConfigError("Option `"+t+"` has to be a function.");this._options[t]=e;break;case d.OptionType.OBJECT:case"*":this._options[t]=e;break;case d.OptionType.IMAGE:if("string"==typeof e){var a=new y;a.src=e,this._options[t]=a}else{if(!(e instanceof y||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement))throw this._buildConfigError("Option `"+t+"` has to be an Image or String.");this._options[t]=e}break;case d.OptionType.CONFIGURABLE:this._options[t].set(e);break;case d.OptionType.ARRAY:if(!(e instanceof Array))throw this._buildConfigError("Option `"+t+"` has to be an Array.");this._options[t]=e.slice(0);break;default:throw this._buildConfigError("Unknown option type: `"+o.type+"`")}r&&(this._onOptionsChange(),this.emit("update",this,n({},t,e)))},e.prototype._onConfigurableUpdate=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.emit.apply(this,["update"].concat(e))},e.prototype.hasChanges=function(){var t=this.getDefaultOptions();return!this.optionsEqual(t)},e}(u.a);e.a=g},function(t,e,r){"use strict";var n=r(46),i=r(48),o=r(18),s=r(22),a=r(21),h=r(34),u=r(11),c=r(35),p=r(54),f=r(16),l=r(15),d=r(55),_=r(57),y=r(20),g=r(12),v=r(60),m=r(33),b={WebGLRenderer:i.a,CanvasRenderer:n.a,WebGLFilterManager:s.a,CanvasFilterManager:o.a,DisplayObject:a.a,Container:h.a,BaseTexture:u.a,Texture:c.a,RenderTexture:p.a,WebGLRenderTarget:f.a,CanvasRenderTarget:l.a,Sprite:d.a,Shaders:_.a,Shader:y.a,Filter:g.a,Filters:v,PixelArrayImage:m.a,autoDetectRenderer:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i.a.isSupported()?new i.a(t,e,r):new n.a(t,e,r)}};e.a=b},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(0),o=r(11),s=function(){function t(e,r,i,s,a){n(this,t),this._width=e,this._height=r,this._pixelRatio=i,this._baseTexture=new o.a,this._canvas=s||this._createCanvas(),this._context=a||this._canvas.getContext("2d"),this._baseTexture.setSource(this._canvas),this._canvas.width=this._width*this._pixelRatio,this._canvas.height=this._height*this._pixelRatio,this._filterStack=[{renderTarget:this,filter:[]}]}return t.prototype._createCanvas=function(){return i.i.createCanvas()},t.prototype.clear=function(){var t=this._context;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)},t.prototype.resizeTo=function(t){this._baseTexture.resizeTo(t),this._width!==t.x&&(this._width=t.x,this._canvas.width=this._width*this._pixelRatio),this._height!==t.y&&(this._height=t.y,this._canvas.height=this._height*this._pixelRatio)},t.prototype.getCanvas=function(){return this._canvas},t.prototype.getContext=function(){return this._context},t.prototype.getFilterStack=function(){return this._filterStack},t.prototype.getWidth=function(){return this._width},t.prototype.getHeight=function(){return this._height},t.prototype.getPixelRatio=function(){return this._pixelRatio},t.prototype.setPixelRatio=function(t){this._pixelRatio=t},t.prototype.getDimensions=function(){return new i.k(this._width,this._height)},t.prototype.getBaseTexture=function(){return this._baseTexture},t.prototype.dispose=function(){this._canvas=null,this._context=null},t}();e.a=s},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(0),o=r(11),s=function(){function t(e,r,s,a){var h=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n(this,t),this._renderer=e,this._gl=e.getContext(),this._width=r,this._height=s,this._frame=null,this._pixelRatio=a,this._projectionMatrix=new i.g,this._mipMapping=!1,this._baseTexture=new o.a;var u=this._baseTexture.getFrame();u.width=r,u.height=s,this._baseTexture.setPixelRatio(a),this._baseTexture.setLoaded(!0),this._framebuffer=null,this._isRoot=h,this._filterStack=[{renderTarget:this,filter:[]}],h||this._initFrameBuffer()}return t.prototype.resizeTo=function(t){this._width=0|t.x,this._height=0|t.y,this._baseTexture.resizeTo(t),this._isRoot||this._resizeTexture(),this._baseTexture.setMinFilter(this._getMinFilter()),this._baseTexture.setMagFilter(this._getMagFilter()),this._calculateProjectionMatrix()},t.prototype._getMinFilter=function(){var t=o.a.DefaultMinFilter;return this._mipMapping&&(t=o.a.TrilinearFilter),t},t.prototype._getMagFilter=function(){return o.a.DefaultMagFilter},t.prototype._resizeTexture=function(){var t=this._gl;t.bindTexture(t.TEXTURE_2D,this._texture);var e=this._width*this._pixelRatio,r=this._height*this._pixelRatio;t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,r,0,t.RGBA,t.UNSIGNED_BYTE,null);var n=new i.k(this._width,this._height);i.i.isPowerOfTwo(n)?(i.f.info("WebGLRenderTarget","Mip-mapping enabled"),this._mipMapping=!0):this._mipMapping=!1,this._baseTexture.setMipMappingEnabled(this._mipMapping)},t.prototype.activate=function(){var t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),this._calculateProjectionMatrix(),t.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),t.disable(t.STENCIL_TEST)},t.prototype.clear=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.b.TRANSPARENT,e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),i.e.checkFramebufferStatus("WebGLRenderTarget#clear",e),e.clearColor.apply(e,t.toGLColor()),e.clear(e.COLOR_BUFFER_BIT)},t.prototype._calculateProjectionMatrix=function(){var t=this._projectionMatrix;t.reset();var e=this._frame||new i.h(0,0,this._width,this._height),r=e.x,n=e.y;this._isRoot?(t.a=1/this._width*2,t.d=-1/this._height*2,t.tx=-1-r*t.a,t.ty=1-n*t.d):(t.a=1/this._width*2,t.d=1/this._height*2,t.tx=-1-r*t.a,t.ty=-1-n*t.d)},t.prototype._initFrameBuffer=function(){var t=this._gl;this._framebuffer=t.createFramebuffer(),this._texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._texture),t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._texture,0),this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this.resizeTo(new i.k(this._width,this._height)),i.e.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",t)},t.prototype.getProjectionMatrix=function(){return this._projectionMatrix},t.prototype.getTexture=function(){return this._texture},t.prototype.getFrame=function(){return this._frame},t.prototype.setFrame=function(t){this._frame=t},t.prototype.getFilterStack=function(){return this._filterStack},t.prototype.getPixelRatio=function(){return this._pixelRatio},t.prototype.setPixelRatio=function(t){this._pixelRatio=t,this._isRoot||this._resizeTexture()},t.prototype.getBaseTexture=function(){return this._baseTexture},t.prototype.dispose=function(){var t=this._gl;this._baseTexture.disposeGLTexturesForRenderer(this._renderer),t.deleteTexture(this._texture),t.deleteFramebuffer(this._framebuffer)},t}();e.a=s},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(t){if(c===setTimeout)return setTimeout(t,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(p===clearTimeout)return clearTimeout(t);if((p===n||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}function s(){_&&l&&(_=!1,l.length?d=l.concat(d):y=-1,d.length&&a())}function a(){if(!_){var t=i(s);_=!0;for(var e=d.length;e;){for(l=d,d=[];++y<e;)l&&l[y].run();y=-1,e=d.length}l=null,_=!1,o(t)}}function h(t,e){this.fun=t,this.array=e}function u(){}var c,p,f=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(t){c=r}try{p="function"==typeof clearTimeout?clearTimeout:n}catch(t){p=n}}();var l,d=[],_=!1,y=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];d.push(new h(t,e)),1!==d.length||_||i(a)},h.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.prependListener=u,f.prependOnceListener=u,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(0),o=r(15),s=function(){function t(e){n(this,t),this._renderer=e,this._filterStack=[{renderTarget:e.getCurrentRenderTarget(),filters:[]}],this._currentFrame=null,this._textures=[],this._textureFrame=new i.h(0,0,e.getWidth(),e.getHeight())}return t.prototype.resizeTo=function(t){this._textureFrame.width=t.x,this._textureFrame.height=t.y,this._textures.forEach(function(e){return e.resizeTo(t)})},t.prototype.pushFilters=function(t,e){var r=t.getBounds();this._currentFrame=r;var n=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(n),this._filterStack.push({renderTarget:n,filters:e}),n.clear()},t.prototype.popFilters=function(){var t=this._filterStack.pop(),e=t.filters,r=t.renderTarget,n=this._filterStack[this._filterStack.length-1],i=r,o=n.renderTarget;return 1===e.length?(e[0].apply(this._renderer,i,o),this._textures.push(i)):this._applyFilters(e,i,o),e},t.prototype._applyFilters=function(t,e,r){var n=this,i=e,o=this._getOrCreateRenderTarget(!0),s=t[t.length-1];t.forEach(function(t,e){if(t===s)t.apply(n._renderer,i,r);else{t.apply(n._renderer,i,o);var a=i;i=o,o=a}}),this._textures.push(i),this._textures.push(o)},t.prototype._getOrCreateRenderTarget=function(t){var e=this._textures.pop();return e||(e=new o.a(this._textureFrame.width,this._textureFrame.height,1)),t&&e.clear(),e},t.prototype.setFilterStack=function(t){this._filterStack=t},t.prototype.dispose=function(){},t}();e.a=s},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(20),h=s.c.UniformType,u=function(t){function e(r,o,s){return n(this,e),o=o||e.defaultVertexSource,s=s||e.defaultFragmentSource,i(this,t.call(this,r,o,s,e.defaultUniforms,e.defaultAttributes))}return o(e,t),e}(a.a);u.defaultVertexSource=r(50),u.defaultFragmentSource=r(51);var c=new s.g;u.defaultUniforms={u_image:{type:h.SAMPLER2D,value:0},u_projMatrix:{type:h.MAT3,value:c.toArray()}},u.defaultAttributes=["a_position","a_texCoord","a_color"],e.a=u},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(0),o=r(3),s=i.f,a=i.i,h=function(){function t(e,r,i,o,s){n(this,t),this._renderer=e,this._vertexSource=r,this._fragmentSource=i,this._uniforms=o||{},this._uniformLocations={},this._attributes=s||[],this._attributeLocations={},this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._init()}return t.prototype._init=function(){this._compile(),this._renderer.getContext().useProgram(this._program),this._cacheUniformLocations(),this._cacheAttributeLocations()},t.prototype._onContextChange=function(){this._init()},t.prototype.setupBuffers=function(t,e){var r=this._renderer.getContext();r.bindBuffer(r.ARRAY_BUFFER,t),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),r.vertexAttribPointer(this._attributeLocations.a_position,2,r.FLOAT,!1,i.j,0),r.vertexAttribPointer(this._attributeLocations.a_texCoord,2,r.FLOAT,!1,i.j,8),r.vertexAttribPointer(this._attributeLocations.a_color,4,r.UNSIGNED_BYTE,!0,i.j,16)},t.prototype.syncUniforms=function(){var t=this;Object.keys(this._uniforms).forEach(function(e){t.syncUniform(e)})},t.prototype.syncUniform=function(t){var e=this._renderer.getContext(),r=this._uniforms[t],n=this._uniformLocations[t];switch(r.type){case o.UniformType.SAMPLER2D:e.uniform1i(n,r.value);break;case o.UniformType.INT:case o.UniformType.INT1:e.uniform1i(n,r.value);break;case o.UniformType.FLOAT:case o.UniformType.FLOAT1:e.uniform1f(n,r.value);break;case o.UniformType.FLOAT2:e.uniform2f(n,r.value[0],r.value[1]);break;case o.UniformType.FLOAT3:e.uniform3f(n,r.value[0],r.value[1],r.value[2]);break;case o.UniformType.FLOAT4:e.uniform4f(n,r.value[0],r.value[1],r.value[2],r.value[3]);break;case o.UniformType.FLOAT_VECTOR2:e.uniform2fv(n,r.value);break;case o.UniformType.MAT3:case o.UniformType.MAT3FV:e.uniformMatrix3fv(n,!1,r.value);break;case o.UniformType.MAT4:e.uniformMatrix4fv(n,!1,r.value);break;default:s.warn(this.constructor.name,"Unknown uniform type: "+r.type)}},t.prototype._cacheAttributeLocations=function(){var t=this,e=this._renderer.getContext();this._attributes.forEach(function(r){t._attributeLocations[r]=e.getAttribLocation(t._program,r)})},t.prototype._cacheUniformLocations=function(){var t=this,e=this._renderer.getContext();Object.keys(this._uniforms).forEach(function(r){t._uniformLocations[r]=e.getUniformLocation(t._program,r)})},t.prototype._addPrecisionToSource=function(t){var e=this._renderer.getMaxFloatPrecision(),r="mediump";return a.isMobile()&&"highp"===e&&(r="highp"),"precision "+r+" float;\n"+t},t.prototype._compile=function(){var t=this._renderer.getContext(),e=this._compileShader(t.VERTEX_SHADER,this._vertexSource);this._vertexShader=e;var r=this._addPrecisionToSource(this._fragmentSource),n=this._compileShader(t.FRAGMENT_SHADER,r);this._fragmentShader=n;var i=t.createProgram();if(t.attachShader(i,e),t.attachShader(i,n),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS)){var o=t.getProgramInfoLog(i);t.isContextLost()&&(o="WebGL context lost"),t.deleteProgram(i),s.error(this.constructor.name,"WebGL program linking error: "+o)}this._program=i},t.prototype._compileShader=function(t,e){var r=this._renderer.getContext(),n=r.createShader(t);if(r.shaderSource(n,e),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS)){var i=r.getShaderInfoLog(n);r.isContextLost()&&(i="WebGL context lost"),r.deleteShader(n),s.error(this.constructor.name,"WebGL shader compilation error: "+i)}return n},t.prototype.setUniform=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._uniforms[t].value=e,r&&this.syncUniform(t)},t.prototype.setUniforms=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var r in t)this._uniforms[r].value=t[r],e&&this.syncUniform(r)},t.prototype.getUniforms=function(){return this._uniforms},t.prototype.getAttributes=function(){return this._attributes},t.prototype.getAttributeLocations=function(){return this._attributeLocations},t.prototype.getProgram=function(){return this._program},t.prototype.dispose=function(){var t=this._renderer.getContext();t.deleteProgram(this._program),t.deleteShader(this._vertexShader),t.deleteShader(this._fragmentShader),this._uniforms=null,this._uniformLocations=null,this._attributes=null,this._attributeLocations=null,this._renderer.off("context",this._onContextChange)},t}();e.a=h},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(0),o=function(){function t(){n(this,t),this._position=new i.k(0,0),this._scale=new i.k(1,1),this._pivot=new i.k(0,0),this._rotation=0,this._lastRotation=null,this._alpha=1,this._visible=!0,this._worldTransform=new i.g,this._parent=null,this._shaders=[],this._boundsNeedUpdate=!0,this._bounds=new i.h(0,0,1,1),this._localBoundsNeedUpdate=!0,this._localBounds=new i.h(0,0,1,1),this._tint=16777215,this._filterRectangle=new i.h(0,0,0,0)}return t.prototype.renderWebGL=function(t){i.f.warn(this.constructor.name,"`renderWebGL` is abstract and not implemented in inherited class")},t.prototype.renderCanvas=function(t){i.f.warn(this.constructor.name,"`renderCanvas` is abstract and not implemented in inherited class")},t.prototype.updateTransform=function(){var t=this._parent?this._parent.getWorldTransform():i.g.IDENTITY,e=this._worldTransform;this._rotation!==this._lastRotation&&(this._sinRotation=Math.sin(this._rotation),this._cosRotation=Math.cos(this._rotation),this._lastRotation=this._rotation),e.a=this._cosRotation*this._scale.x,e.b=this._sinRotation*this._scale.x,e.c=-this._sinRotation*this._scale.y,e.d=this._cosRotation*this._scale.y,e.tx=this._position.x,e.ty=this._position.y,(this._pivot.x||this._pivot.y)&&(e.tx-=this._pivot.x*e.a+this._pivot.y*e.c,e.ty-=this._pivot.x*e.b+this._pivot.y*e.d),e.tx|=0,e.ty|=0,e.multiply(t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0},t.prototype.addShader=function(t){this._shaders.push(t)},t.prototype.removeShader=function(t){var e=this._shaders.indexOf(t);return-1!==e&&(this._shaders.splice(e,1),!0)},t.prototype.removeShaderAt=function(t){return!!this._shaders[t]&&(this._shaders.splice(t,1),!0)},t.prototype.getBounds=function(){return this._bounds.clone()},t.prototype.getPosition=function(){return this._position},t.prototype.setPosition=function(t,e){t instanceof i.k?this._position.copy(t):this._position.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0},t.prototype.getScale=function(){return this._scale},t.prototype.setScale=function(t,e){t instanceof i.k?this._scale.copy(t):this._scale.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0},t.prototype.getPivot=function(){return this._pivot},t.prototype.setPivot=function(t,e){t instanceof i.k?this._pivot.copy(t):this._pivot.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0},t.prototype.getRotation=function(){return this._rotation},t.prototype.setRotation=function(t){this._rotation=t,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0},t.prototype.getAlpha=function(){return this._alpha},t.prototype.setAlpha=function(t){this._alpha=t},t.prototype.getWorldAlpha=function(){return this._parent?this._parent.getAlpha()*this._alpha:this._alpha},t.prototype.getWorldTransform=function(){return this._worldTransform},t.prototype.getParent=function(){return this._parent},t.prototype.setParent=function(t){this._parent=t},t.prototype.getFilterRectangle=function(){return this._filterRectangle},t.prototype.setFilterRectangle=function(t){this._filterRectangle.copy(t)},t.prototype.getTint=function(){return this._tint},t.prototype.setTint=function(t){this._tint=t},t.prototype.isVisible=function(){return this._visible},t.prototype.setVisible=function(t){this._visible=t},t}();e.a=o},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(0),o=r(16),s=r(52),a=i.c.RendererType,h=function(){function t(e){n(this,t),this._renderer=e,this._filterStack=[{filters:[]}],this._currentFrame=null,this._renderTargets=[],this._textureFrame=new i.h(0,0,e.getWidth(),e.getHeight()),this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._onContextChange()}return t.prototype.resizeTo=function(t){this._textureFrame.width=t.x,this._textureFrame.height=t.y,this._renderTargets.forEach(function(e){return e.resizeTo(t)})},t.prototype.getFilterStack=function(){return this._filterStack},t.prototype.setFilterStack=function(t){this._filterStack=t},t.prototype._getOrCreateRenderTarget=function(t){var e=this._renderTargets.pop();return e||(e=new o.a(this._renderer,this._textureFrame.width,this._textureFrame.height,1)),e.setFrame(this._currentFrame),t&&e.clear(),e},t.prototype.pushFilters=function(t,e){var r=t.getBounds();this._currentFrame=r;var n=t.getFilterRectangle();n.width>0&&n.height>0&&(this._currentFrame=n);var i=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(i),i.clear(),this._filterStack.push({renderTarget:i,filters:e})},t.prototype.popFilters=function(){var t=this._filterStack.pop(),e=t.filters,r=t.renderTarget,n=this._filterStack[this._filterStack.length-1],i=r,o=n.renderTarget;this._quad.map(this._textureFrame,i.getFrame());var s=e[0].getShaderForRenderer(this._renderer),a=this._quad.getVertexBuffer(),h=this._quad.getIndexBuffer(),u=this._renderer.getContext();u.bindBuffer(u.ARRAY_BUFFER,a),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,h);var c=s.getAttributeLocations();return u.vertexAttribPointer(c.a_position,2,u.FLOAT,!1,0,0),u.vertexAttribPointer(c.a_texCoord,2,u.FLOAT,!1,0,32),u.vertexAttribPointer(c.a_color,4,u.FLOAT,!1,0,64),this._renderer.updateTexture(i.getBaseTexture(),!1),1===e.length?(e[0].apply(this._renderer,i,o),this._renderTargets.push(i)):this._applyFilters(e,i,o),e},t.prototype._applyFilters=function(t,e,r){var n=this,i=e,o=this._getOrCreateRenderTarget(!0);this._renderer.updateTexture(o.getBaseTexture(),!1);var s=t[t.length-1];t.forEach(function(t,e){if(t===s)t.apply(n._renderer,i,r);else{t.apply(n._renderer,i,o);var a=i;i=o,o=a}}),this._renderTargets.push(i),this._renderTargets.push(o)},t.prototype._onContextChange=function(){this._renderTargets.length=0,this._renderer.isOfType(a.WEBGL)&&(this._quad&&this._quad.dispose(),this._quad=new s.a(this._renderer))},t.prototype.dispose=function(){this._renderer.off("context",this._onContextChange),this._quad&&this._quad.dispose(),this._renderTargets.forEach(function(t){t.dispose()})},t}();e.a=h},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(10),o=r(24),s=r(1),a=r(25),h=r(83),u=r(84),c=s.a.invariant,p=a.a.MARKERS,f=new RegExp("^data:image/jpeg;base64,","i"),l=function(){function t(e){n(this,t),this._buf=e,this._stream=new o.a(this._buf),this._stream.setHead(0),this._segments=this._sliceIntoSegments(this._buf),this._exifData=new u.a(this._getMarkerBuffer(p.EXIF)),this._jfifData=new h.a(this._getMarkerBuffer(p.JFIF))}return t.toDataURL=function(t){return"data:image/jpeg;base64,"+i.a.encode(t)},t.fromDataURL=function(t){var e=t.replace("data:image/jpeg;base64,","");return i.a.decode(e)},t.prototype.restoreSegments=function(e){var r=t.fromDataURL(e);return r=this.restoreExifTagsToImageData(r),r=this.restoreJfifSegmentToImageData(r),t.toDataURL(r)},t.prototype.restoreExifTagsToImageData=function(t){if(!this._exifData.isValid())return t;var e=this._sliceIntoSegments(t),r=e[1][0],n=t.slice(0,r),i=t.slice(r),o=n.concat(this._exifData.getBuffer());return o=o.concat(i)},t.prototype.restoreJfifSegmentToImageData=function(t){if(!this._jfifData.isValid())return t;var e=this._sliceIntoSegments(t),r=this._findSegment(p.JFIF,e);c(r,"JFIF Data Error: Segment not found");var n=r[0],i=r[1],o=t.slice(0,n),s=t.slice(n,i),a=t.slice(i),u=new h.a(s);u.setDensityX(this._jfifData.getDensityX()),u.setDensityY(this._jfifData.getDensityY()),u.setUnitDensity(this._jfifData.getUnitDensity());var f=o.concat(s);return f=f.concat(a)},t.prototype.restoreExifTags=function(e){var r=t.fromDataURL(e),n=this.restoreExifTagsToImageData(r);return t.toDataURL(n)},t.prototype.restoreJfifSegment=function(e){if(!this._jfifData.isValid())return e;var r=t.fromDataURL(e),n=this.restoreJfifSegmentToImageData(r);return t.toDataURL(n)},t.prototype.setOrientation=function(t){return this._exifData.setOrientation(t)},t.isJPEG=function(t){return f.test(t)},t.bufferIsJPEG=function(t){return"JFIF"===t.slice(6,10).toString()},t.fromBase64String=function(e){var r=e.replace("data:image/jpeg;base64,","");return new t(i.a.decode(r))},t.prototype._findSegment=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._segments,r=0;r<e.length;r++){var n=e[r][0],i=e[r][1];this._stream.setHead(n);if(this._stream.peekInt16()===t)return[n,i]}return!1},t.prototype._getMarkerBuffer=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._segments,r=this._findSegment(t,e);if(r){var n=r[0],i=r[1];return this._buf.slice(n,i)}return!1},t.prototype._sliceIntoSegments=function(t){for(var e=new o.a(t),r=[];e.getHead()<t.length;){var n=e.readInt16();if(n!==p.SOI){if(n===p.SOS)break;if(!(n>=65280&&n<=65535))throw new Error("Invalid marker: 0x"+n.toString(16));var i=e.readInt16(),s=e.getHead()+i-2;r.push([e.getHead()-4,s]),e.setHead(s)}}return this._stream.setHead(0),r},t.prototype.getTags=function(){return this._exifData.getTags()},t.prototype.getTagData=function(){return this._exifData.getTagData()},t.prototype.dispose=function(){this._buf=[],this._segments=[]},t}();e.a=l},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(e){n(this,t),this._head=0,this._buf=e}return t.prototype.peekInt8=function(){return this._buf[this._head]},t.prototype.peekInt16=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._buf[this._head],r=this._buf[this._head+1];return t?(r<<8)+e:(e<<8)+r},t.prototype.peekInt24=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._buf[this._head],r=this._buf[this._head+1],n=this._buf[this._head+2];return t?(n<<16)+(r<<8)+e:(e<<16)+(r<<8)+n},t.prototype.peekInt32=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._buf[this._head],r=this._buf[this._head+1],n=this._buf[this._head+2],i=this._buf[this._head+3];return t?(i<<32)+(n<<16)+(r<<8)+e:(e<<32)+(r<<16)+(n<<8)+i},t.prototype.writeInt8=function(t){this._buf[this._head]=255&t},t.prototype.writeInt16=function(t){this._buf[this._head]=t>>8,this._buf[this._head+1]=255&t},t.prototype.readInt8=function(){var t=this.peekInt8();return this._head+=1,t},t.prototype.readInt16=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.peekInt16(t);return this._head+=2,e},t.prototype.readInt24=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.peekInt24(t);return this._head+=3,e},t.prototype.readInt32=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.peekInt32(t);return this._head+=4,e},t.prototype.readString=function(t){for(var e="",r=0;r<t;r++){var n=this.readInt8();e+=String.fromCharCode(n)}return e},t.prototype.getHead=function(){return this._head},t.prototype.setHead=function(t){this._head=t},t}();e.a=i},function(t,e,r){"use strict";var n={SOI:65496,SOS:65498,APP0:65504,APP1:65505,JFIF:65504,EXIF:65505},i={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"};e.a={MARKERS:n,EXIF_TAGS:i}},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(6),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function(){function t(){n(this,t),this.reset()}return t.prototype.multiply=function(t){var e=void 0,r=void 0,n=void 0,i=void 0,o=void 0,s=void 0;return e=this.a*t.a+this.b*t.c,r=this.a*t.b+this.b*t.d,n=this.c*t.a+this.d*t.c,i=this.c*t.b+this.d*t.d,o=this.tx*t.a+this.ty*t.c+t.tx,s=this.tx*t.b+this.ty*t.d+t.ty,this.a=e,this.b=r,this.c=n,this.d=i,this.tx=o,this.ty=s,this},t.prototype.applyToVector=function(t){var e=t,r=e.x,n=e.y;return t=t.clone(),t.x=this.a*r+this.c*n+this.tx,t.y=this.b*r+this.d*n+this.tx,t},t.prototype.applyInverseToVector=function(t){var e=1/(this.a*this.d+this.c*-this.b),r=t,n=r.x,i=r.y;return t=t.clone(),t.x=this.d*e*n+-this.c*e*i+(this.ty*this.c-this.tx*this.d)*e,t.y=this.a*e*i+-this.b*e*n+(-this.ty*this.a+this.tx*this.b)*e,t},t.prototype.rectangleToCoordinates=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.a(0,0),r=t.width*(1-e.x),n=t.width*-e.x,o=t.height*(1-e.y),s=t.height*-e.y,a=[];return a.push(new i.a(this.a*n+this.c*s+this.tx,this.d*s+this.b*n+this.ty)),a.push(new i.a(this.a*r+this.c*s+this.tx,this.d*s+this.b*r+this.ty)),a.push(new i.a(this.a*r+this.c*o+this.tx,this.d*o+this.b*r+this.ty)),a.push(new i.a(this.a*n+this.c*o+this.tx,this.d*o+this.b*n+this.ty)),a},t.prototype.reset=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},t.prototype.toArray=function(){var t=[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1];return"undefined"==typeof Float32Array?t:new Float32Array(t)},t.prototype.toString=function(){return"Matrix({ a: "+this.a+", b: "+this.b+", c: "+this.c+", d: "+this.d+", tx: "+this.tx+", ty: "+this.ty+" })"},o(t,null,[{key:"IDENTITY",get:function(){return new t}}]),t}();e.a=s},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(6),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n(this,t),this.x=e,this.y=r,this.width=i,this.height=o}return t.prototype.set=function(t,e,r,n){return this.x=t,this.y=e,this.width=r,this.height=n,this},t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.equals=function(e,r,n,i){return e instanceof t?e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height:e===this.x&&r===this.y&&n===this.width&&i===this.height},t.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=Math.round(this.width),this.height=Math.round(this.height),this},t.prototype.getPosition=function(){return new i.a(this.x,this.y)},t.prototype.getSize=function(){return new i.a(this.width,this.height)},t.prototype.toString=function(){return"Rectangle({ x: "+this.x+", y: "+this.y+", width: "+this.width+", height: "+this.height+" })"},t}();e.a=o},function(t,e,r){"use strict";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var i=r(2);e.a={checkFramebufferStatus:function(t,e){var r,o=e.checkFramebufferStatus(e.FRAMEBUFFER),s=(r={},n(r,e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,"Incomplete attachment"),n(r,e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT,"Missing attachment"),n(r,e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,"Incomplete dimensions"),n(r,e.FRAMEBUFFER_UNSUPPORTED,"Framebuffer unsupported"),r);o!==e.FRAMEBUFFER_COMPLETE&&i.a.warn(t,"Framebuffer incomplete: "+s[o])}}},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(0),o="undefined"!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):r(30),s=function(){function t(e){var r=this;n(this,t),this._context=e,this._tracking=!1;var i=this;for(var s in e)!function(t){"function"==typeof e[t]?r[t]=function(){for(var r=arguments.length,n=Array(r),s=0;s<r;s++)n[s]=arguments[s];var a=e[t];if(!i._tracking)return a.apply(e,n);var h=o(),u=a.apply(e,n),c=o()-h,p={functionName:t,arguments:n,duration:c};return i._trackedCalls.push(p),u}:r._makePropertyWrapper(t)}(s)}return t.prototype._makePropertyWrapper=function(t){if(-1===["_context","_trackedCalls","_tracking"].indexOf(t)){var e=this._context;this.__defineGetter__(t,function(){return e[t]}),this.__defineSetter__(t,function(r){e[t]=r})}},t.prototype.startFrame=function(){this._tracking=!0,this._trackedCalls=[]},t.prototype.endFrame=function(){var t="Rendering";i.f.log(t,"Frame rendering results:"),i.f.log(t,"Context calls: "+this._trackedCalls.length);var e={};this._trackedCalls.forEach(function(t){var r=t.functionName,n=t.duration;e[r]=e[r]||{totalDuration:0,calls:0},e[r].totalDuration+=n,e[r].calls++});var r=[];for(var n in e){var o=e[n];o.averageDuration=o.totalDuration/o.calls,r.push({functionName:n,data:o})}r.sort(function(t,e){return e.data.totalDuration-t.data.totalDuration}),r=r.slice(0,3),r.forEach(function(e){i.f.log(t,e.functionName+": "+e.data.calls+" calls, "+e.data.totalDuration.toFixed(2)+"ms")})},t}();e.a=s},function(t,e,r){(function(e){(function(){var r,n,i;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:void 0!==e&&null!==e&&e.hrtime?(t.exports=function(){return(r()-i)/1e6},n=e.hrtime,r=function(){var t;return t=n(),1e9*t[0]+t[1]},i=r()):Date.now?(t.exports=function(){return Date.now()-i},i=Date.now()):(t.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(e,r(17))},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(47),h=function(t){function e(r,o){var h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(this,e);var u=i(this,t.call(this));return u._options=a.a.defaults(h,{pixelRatio:1,transparent:!1,clearColor:s.b.BLACK,debug:!1}),u.setMaxListeners(0),u._width=r||800,u._height=o||600,u._dimensions=new s.k(u._width,u._height),u._maxTextureSize=null,u._pixelRatio=u._options.pixelRatio,u._clearColor=u._options.transparent?s.b.TRANSPARENT:u._options.clearColor||s.b.BLACK,u}return o(e,t),e.prototype.setCanvas=function(t){var e=this._canvas;this._canvas=t,e!==t&&(this._createContext(),this._onBeforeContext(),this._setupContext()),this.resizeTo(new s.k(this._width,this._height))},e.prototype.getCanvas=function(){return this._canvas},e.prototype._onBeforeContext=function(){},e.prototype.resizeTo=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._width=t.x*this._pixelRatio,this._height=t.y*this._pixelRatio,e&&(this._canvas.width=this._width,this._canvas.height=this._height,this._canvas.style&&(this._canvas.style.width=this._width/this._pixelRatio+"px",this._canvas.style.height=this._height/this._pixelRatio+"px")),this._dimensions=t.clone()},e.prototype._createContext=function(){s.f.warn(this.constructor.name,"`_createContext` is abstract and not implemented in inherited class")},e.prototype._setupContext=function(){s.f.warn(this.constructor.name,"`_setupContext` is abstract and not implemented in inherited class")},e.prototype.render=function(t){s.f.warn(this.constructor.name,"`render` is abstract and not implemented in inherited class")},e.prototype.getMaxDimensions=function(){return null},e.prototype.getContext=function(){return this._context},e.prototype.getWidth=function(){return this._dimensions.x},e.prototype.getHeight=function(){return this._dimensions.y},e.prototype.getDimensions=function(){return this._dimensions},e.prototype.getPixelRatio=function(){return this._pixelRatio},e.prototype.setPixelRatio=function(t){this._pixelRatio=t,this._defaultRenderTarget&&this._defaultRenderTarget.setPixelRatio(t)},e.prototype.getMaxTextureSize=function(){return this._maxTextureSize},e.prototype.getFilterManager=function(){return this._filterManager},e.prototype.setFilterManager=function(t){this._filterManager=t},e.isSupported=function(){return!0},e.prototype.isOfType=function(t){return this._type===t},e.prototype.dispose=function(){s.f.warn(this.constructor.name,"`dispose` is abstract and not implemented in inherited class")},e}(s.d);e.a=h},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(e){n(this,t),this._renderer=e,this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange)}return t.prototype._onContextChange=function(){},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.flush=function(){},t.prototype.dispose=function(){this._renderer.off("context",this._onContextChange),this._renderer=null},t}();e.a=i},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(e,r,i){n(this,t),this.width=e,this.height=r,this.data=i}return t.fromNodeCanvasImage=function(e){var r=new Canvas(e.width,e.height),n=r.getContext("2d");n.drawImage(e,0,0);var i=n.getImageData(0,0,e.width,e.height);return new t(e.width,e.height,i.data)},t}();e.a=i},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(21),h=function(t){function e(){n(this,e);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];var a=i(this,t.call.apply(t,[this].concat(o)));return a._children=[],a._filters=[],a}return o(e,t),e.prototype.addFilter=function(t){this._filters.push(t)},e.prototype.removeFilter=function(t){var e=this._filters.indexOf(t);return-1!==e&&(this._filters.splice(e,1),!0)},e.prototype.setFilters=function(t){this._filters=t},e.prototype.addChild=function(t){var e=t.getParent();null!==e&&e.removeChild(t),t.setParent(this),this._children.push(t)},e.prototype.prependChild=function(t){var e=t.getParent();null!==e&&e.removeChild(t),t.setParent(this),this._children.unshift(t)},e.prototype.hasChild=function(t){return-1!==this._children.indexOf(t)},e.prototype.removeChild=function(t){var e=this._children.indexOf(t);-1!==e?(this._children.splice(e,1),t.setParent(null)):s.f.info(this.constructor.name,"Tried to remove a child that does not exist")},e.prototype.clearChildren=function(){this._children=[]},e.prototype.renderWebGL=function(t){if(this._visible){var e=t.getFilterManager();this._filters&&this._filters.length&&e.pushFilters(this,this._filters),t.getCurrentObjectRenderer().start(),this._renderWebGL(t),this._children.forEach(function(e){e.renderWebGL(t)}),t.getCurrentObjectRenderer().flush(),this._filters&&this._filters.length&&e.popFilters(),t.getCurrentObjectRenderer().start()}},e.prototype._renderWebGL=function(t){},e.prototype.renderCanvas=function(t){if(this._visible){var e=t.getFilterManager();this._filters&&this._filters.length&&e.pushFilters(this,this._filters),this._renderCanvas(t),this._children.forEach(function(e){e.renderCanvas(t)}),this._filters&&this._filters.length&&e.popFilters()}},e.prototype._renderCanvas=function(t){},e.prototype.updateTransform=function(){t.prototype.updateTransform.call(this),this._children.forEach(function(t){t.updateTransform()})},e.prototype.getLocalBounds=function(){return this._localBoundsNeedUpdate&&(this._localBoundsNeedUpdate=!1),this._localBounds.clone()},e.prototype.getBounds=function(){return this._boundsNeedUpdate&&(this._boundsNeedUpdate=!1),this._bounds.clone()},e.prototype.getChildren=function(){return this._children},e.prototype.getFilters=function(){return this._filters},e.prototype.dispose=function(){},e}(a.a);e.a=h},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(11),h=r(53),u=function(t){function e(r,o){n(this,e);var u=i(this,t.call(this));if(!(r instanceof a.a))throw new Error("`baseTexture` should be an instance of BaseTexture");return u._uvs=new h.a,u._frame=o?o.clone():null,u._frameLocked=!!o,u._onBaseTextureLoaded=u._onBaseTextureLoaded.bind(u),u._onBaseTextureUpdated=u._onBaseTextureUpdated.bind(u),u._frame||(u._frame=new s.h(0,0,1,1)),u.setBaseTexture(r),u}return o(e,t),e.fromImage=function(t){return new e(new a.a(t))},e.fromCanvas=function(t){return new e(new a.a(t))},e.prototype._onBaseTextureLoaded=function(){if(!this._frameLocked){var t=this._baseTexture.getFrame().clone();this.setFrame(t)}this._baseTexture.on("update",this._onBaseTextureUpdated)},e.prototype._onBaseTextureUpdated=function(){var t=this._baseTexture.getFrame(),e=t.width,r=t.height;this._frame.width=e,this._frame.height=r,this.emit("update")},e.prototype._updateUVs=function(){this._uvs.update(this._frame,this._baseTexture.getFrame())},e.prototype.getBaseTexture=function(){return this._baseTexture},e.prototype.setBaseTexture=function(t){if(this._baseTexture=t,this._baseTexture.isLoaded()){var e=t.getFrame(),r=e.width,n=e.height;this._frameLocked||(this._frame=new s.h(0,0,r,n)),this._onBaseTextureLoaded()}else this._baseTexture.once("loaded",this._onBaseTextureLoaded)},e.prototype.getFrame=function(){return this._frame},e.prototype.setFrame=function(t){this._frame=t,this._updateUVs()},e.prototype.getWidth=function(){return this._frame.width},e.prototype.getHeight=function(){return this._frame.height},e.prototype.getUVs=function(){return this._uvs},e.prototype.getDimensions=function(){return new s.k(this._frame.width,this._frame.height)},e.prototype.dispose=function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this._baseTexture.dispose()},e}(s.d);e.a=u},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(8),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,p=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,l=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,d=arguments.length>12&&void 0!==arguments[12]?arguments[12]:1,_=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,y=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,g=arguments.length>15&&void 0!==arguments[15]?arguments[15]:0,v=arguments.length>16&&void 0!==arguments[16]?arguments[16]:0,m=arguments.length>17&&void 0!==arguments[17]?arguments[17]:0,b=arguments.length>18&&void 0!==arguments[18]?arguments[18]:1,T=arguments.length>19&&void 0!==arguments[19]?arguments[19]:0;n(this,t),this.set(e,r,i,o,s,a,h,u,c,p,f,l,d,_,y,g,v,m,b,T)}return t.prototype.set=function(t,e,r,n,i,o,s,a,h,u,c,p,f,l,d,_,y,g,v,m){this.a=t,this.b=e,this.c=r,this.d=n,this.e=i,this.f=o,this.g=s,this.h=a,this.i=h,this.j=u,this.k=c,this.l=p,this.m=f,this.n=l,this.o=d,this.p=_,this.q=y,this.r=g,this.s=v,this.t=m},t.prototype.reset=function(){this.a=1,this.b=0,this.c=0,this.d=0,this.e=0,this.f=0,this.g=1,this.h=0,this.i=0,this.j=0,this.k=0,this.l=0,this.m=1,this.n=0,this.o=0,this.p=0,this.q=0,this.r=0,this.s=1,this.t=0},t.prototype.apply=function(t){var e=this.a*t.r+this.b*t.g+this.c*t.b+this.d*t.a+this.e,r=this.f*t.r+this.g*t.g+this.h*t.b+this.i*t.a+this.j,n=this.k*t.r+this.l*t.g+this.m*t.b+this.n*t.a+this.o,o=this.p*t.r+this.q*t.g+this.r*t.b+this.s*t.a+this.t;return new i.a(e,r,n,o)},t.prototype.multiply=function(t){var e=void 0,r=void 0,n=void 0,i=void 0,o=void 0,s=void 0,a=void 0,h=void 0,u=void 0,c=void 0,p=void 0,f=void 0,l=void 0,d=void 0,_=void 0,y=void 0,g=void 0,v=void 0,m=void 0,b=void 0,T=t,x=this;return e=T.a*x.a+T.b*x.f+T.c*x.k+T.d*x.p,r=T.a*x.b+T.b*x.g+T.c*x.l+T.d*x.q,n=T.a*x.c+T.b*x.h+T.c*x.m+T.d*x.r,i=T.a*x.d+T.b*x.i+T.c*x.n+T.d*x.s,s=T.f*x.a+T.g*x.f+T.h*x.k+T.i*x.p,a=T.f*x.b+T.g*x.g+T.h*x.l+T.i*x.q,h=T.f*x.c+T.g*x.h+T.h*x.m+T.i*x.r,u=T.f*x.d+T.g*x.i+T.h*x.n+T.i*x.s,p=T.k*x.a+T.l*x.f+T.m*x.k+T.n*x.p,f=T.k*x.b+T.l*x.g+T.m*x.l+T.n*x.q,l=T.k*x.c+T.l*x.h+T.m*x.m+T.n*x.r,d=T.k*x.d+T.l*x.i+T.m*x.n+T.n*x.s,y=T.p*x.a+T.q*x.f+T.r*x.k+T.s*x.p,g=T.p*x.b+T.q*x.g+T.r*x.l+T.s*x.q,v=T.p*x.c+T.q*x.h+T.r*x.m+T.s*x.r,m=T.p*x.d+T.q*x.i+T.r*x.n+T.s*x.s,o=T.a*x.e+T.b*x.j+T.c*x.o+T.d*x.t+T.e,c=T.f*x.e+T.g*x.j+T.h*x.o+T.i*x.t+T.j,_=T.k*x.e+T.l*x.j+T.m*x.o+T.n*x.t+T.o,b=T.p*x.e+T.q*x.j+T.r*x.o+T.s*x.t+T.t,this.a=e,this.b=r,this.c=n,this.d=i,this.e=o,this.f=s,this.g=a,this.h=h,this.i=u,this.j=c,this.k=p,this.l=f,this.m=l,this.n=d,this.o=_,this.p=y,this.q=g,this.r=v,this.s=m,this.t=b,this},t.prototype.clone=function(){var e=new t;return e.set(this.a,this.b,this.c,this.d,this.e,this.f,this.g,this.h,this.i,this.j,this.k,this.l,this.m,this.n,this.o,this.p,this.q,this.r,this.s,this.t),e},t.prototype.equals=function(t){return this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d&&this.e===t.e&&this.f===t.f&&this.g===t.g&&this.h===t.h&&this.i===t.i&&this.j===t.j&&this.k===t.k&&this.l===t.l&&this.m===t.m&&this.n===t.n&&this.o===t.o&&this.p===t.p&&this.q===t.q&&this.r===t.r&&this.s===t.s&&this.t===t.t},t.prototype.getOffsets=function(){return[this.e,this.j,this.o,this.t]},t.prototype.toString=function(){return"ColorMatrix( "+this.a+", "+this.b+", "+this.c+", "+this.d+", "+this.e+",\n      "+this.f+", "+this.g+", "+this.h+", "+this.i+", "+this.j+",\n      "+this.k+", "+this.l+", "+this.m+", "+this.n+", "+this.o+",\n      "+this.p+", "+this.q+", "+this.r+", "+this.s+", "+this.t+" )"},t.prototype.toArray=function(){var t=this;return"abcdefghijklmnopqrst".split("").map(function(e){return t[e]})},t.createBrightnessMatrix=function(e){var r=new t;return r.e=e,r.j=e,r.o=e,r},t.createContrastMatrix=function(e){var r=new t,n=(1-e)/2;return r.a=r.g=r.m=e,r.e=r.j=r.o=n,r},t.createSaturationMatrix=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=new t,n=1-e,i=.213*n,o=.715*n,s=.072*n;return r.a=i+e,r.b=o,r.c=s,r.f=i,r.g=o+e,r.h=s,r.k=i,r.l=o,r.m=s+e,r},t.createExposureMatrix=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=Math.pow(2,e);return new t(r,0,0,0,0,0,r,0,0,0,0,0,r,0,0,0,0,0,1,0)},t.createLinearMatrix=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new t;return n.a=n.g=n.m=e,n.e=n.j=n.o=r,n},o(t,null,[{key:"IDENTITY",get:function(){return new t}}]),t}();e.a=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(6),i=r(27),o=r(26),s=r(36);r.d(e,"Vector2",function(){return n.a}),r.d(e,"Rectangle",function(){return i.a}),r.d(e,"Matrix",function(){return o.a}),r.d(e,"ColorMatrix",function(){return s.a})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(81);r.d(e,"ExifOrientationOperation",function(){return n.a})},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(3),a=r(4),h=r(2),u=r(14),c=r(13),p=r(40),f=function(t){function e(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,e);var a=i(this,t.call(this,o,{enabled:{type:s.OptionType.BOOLEAN,default:!0,serializable:!1}}));return a._sdk=r,a._cacheEnabled=!1,a._dirtiness={},a._sprite=new u.a.Sprite,a._container=new u.a.Container,a._container.addChild(a._sprite),a}return o(e,t),e.prototype._onOptionsChange=function(){this.setDirty(!0)},e.prototype.render=function(t){var e=this;if(!this.getEnabled())return h.a.info(this.constructor.name,"Disabled - skipping"),a.a.resolve(t);if(!this._renderTexture){var r=this._sdk.getSprite().getTexture().getFrame();this._renderTexture=new u.a.RenderTexture(this._sdk.getRenderer(),r.width,r.height)}var n=this._sdk.getRenderer(),i=void 0,o=void 0;if(h.a.canLog("info")&&(o=new p.a(this.constructor.name,"Rendering")),this.isDirtyForRenderer(n)){this._sprite.setTexture(t);var s=this.getNewDimensions(t.getDimensions()).floor();this._renderTexture.resizeTo(s),this._renderTexture.clear(),i=this._render(t).then(function(){return e.setDirtyForRenderer(!1,n),e._renderTexture})}else h.a.info(this.constructor.name,"Rendering from cache"),i=a.a.resolve(this._renderTexture);return i.then(function(t){return o&&o.stop(),t})},e.prototype._render=function(t){return(this._sdk.getRenderer().isOfType(s.RendererType.WEBGL)?this._renderWebGL.bind(this):this._renderCanvas.bind(this))(t)},e.prototype._renderWebGL=function(t){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")},e.prototype._renderCanvas=function(t){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")},e.prototype.getNewDimensions=function(t){return t.clone()},e.prototype.reset=function(){this._dirty=!0,this._glslPrograms={}},e.prototype.isDirtyForRenderer=function(t){var e=this._dirtiness[t.id];return void 0===e||e},e.prototype.setDirtyForRenderer=function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._dirtiness[e.id]=t},e.prototype.setDirty=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var r in this._dirtiness)this.setDirtyForRenderer(t,{id:r},e)},e.prototype.getSDK=function(){return this._sdk},e.prototype.getInputDimensions=function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=this._sdk.getInputDimensions();e&&r.multiply(this._sdk.getZoom()).floor();var n=void 0;return this._sdk.getOperationsStack().forEach(function(e){if(!n)return e===t?void(n=!0):void(r=e.getNewDimensions(r))}),r.floor()},e.prototype.clone=function(){return new(0,this.constructor)(this._sdk,this.serializeOptions())},e.prototype.disposeRenderTextures=function(){this._renderTexture&&this._renderTexture.dispose(),this._renderTexture=null},e.prototype.dispose=function(){this.disposeRenderTextures(),this._sprite.dispose()},e}(c.a);f.identifier=null,e.a=f},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(5),o="undefined"!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):r(30),s=function(){function t(e,r){n(this,t),this._tag=e,this._name=r,this._start=o()}return t.prototype.stop=function(){var t=o(),e=t-this._start,r=Math.round(1e3/e);i.Log.info(this._tag,this._name+" took "+e.toFixed(2)+"ms ("+r+" FPS)")},t}();e.a=s},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(5),a=r(4),h=r(9),u=function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n(this,e);var o=i(this,t.call(this));return o._onOperationUpdate=o._onOperationUpdate.bind(o),o._cacheEnabled=!0,o._stack=r,o._stack.forEach(function(t){t.on("update",o._onOperationUpdate)}),o}return o(e,t),e.prototype.clear=function(){var t=this;this.forEach(function(e){return t.remove(e)}),this._stack=[]},e.prototype.hasChanges=function(){return this._stack.filter(function(t){return!!t}).some(function(t){return t.hasChanges()})},e.prototype._onOperationUpdate=function(t,e){this.emit(s.Constants.Events.OPERATION_UPDATED,t,e)},e.prototype.enableCache=function(){this._cacheEnabled=!0},e.prototype.disableCache=function(){this._cacheEnabled=!1},e.prototype.forEach=function(t){return this._stack.filter(function(t){return!!t}).forEach(t)},e.prototype.render=function(t,e){var r=this,n=e,i=this._stack.filter(function(t){return!!t}).filter(function(t){return t.getEnabled()});i.reverse();var o=i.filter(function(e){return!e.isDirtyForRenderer(t.getRenderer())})[0],h=i.indexOf(o);i.reverse();var u=0;-1!==h&&(u=i.length-h-1);for(var c=0;c<u;c++)s.Log.info(this.constructor.name,"Skipping "+i[c].constructor.name);for(var p=a.a.resolve(n),f=u;f<i.length;f++)!function(t){var e=i[t],n=void 0,o=void 0;p=p.then(function(t){return e.render(t).then(function(t){return n&&t!==n&&!r._cacheEnabled&&o.disposeRenderTextures(),n=t,o=e,t})})}(f);return p},e.prototype.validateSettings=function(){return a.a.all(this._stack.filter(function(t){return!!t}).map(function(t){return t.validateSettings()}))},e.prototype.setAllToDirty=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.forEach(function(e){return e.setDirty(!0,t)})},e.prototype.updateDirtinessForRenderer=function(t){for(var e=!1,r=0;r<this._stack.length;r++){var n=this._stack[r];n&&(n.isDirtyForRenderer(t)&&(e=!0),e&&n.setDirtyForRenderer(!0,t))}},e.prototype.push=function(t){this._stack.push(t),t.on("update",this._onOperationUpdate)},e.prototype.unshift=function(t){this._stack.unshift(t),t.on("update",this._onOperationUpdate)},e.prototype.clone=function(){return new e(this._stack.slice(0))},e.prototype.get=function(t){return this._stack[t]},e.prototype.set=function(t,e){this._stack[t]&&(this._stack[t].off("update",this._onOperationUpdate),this._stack[t].dispose()),this._stack[t]=e,e.on("update",this._onOperationUpdate)},e.prototype.remove=function(t){var e=this._stack.indexOf(t);-1!==e&&(this._stack[e]&&(this._stack[e].off("update",this._onOperationUpdate),this._stack[e].dispose()),this._stack.splice(e,1))},e.prototype.removeAt=function(t){this._stack[t]&&(this._stack[t].off("update",this._onOperationUpdate),this._stack[t].dispose()),delete this._stack[t]},e.prototype.getStack=function(){return this._stack},e.prototype.dispose=function(){this.forEach(function(t){t.dispose()})},e}(h.a);e.a=u},function(t,e){t.exports={name:"photoeditorsdk",version:"4.2.1",description:"The most comprehensive photo editor SDK for HTML5",repository:"http://github.com/imgly/pesdk-html5",author:"PhotoEditor SDK <contact@photoeditorsdk.com>",license:"SEE LICENSE IN LICENSE.md",bin:{pesdk:"./bin/pesdk.js","pesdk-convert-serialization":"./bin/pesdk-convert-serialization.js"},scripts:{start:"npm run watch",release:"cross-env PESDK_CLEAN=true PESDK_ASSETS=true PESDK_RELEASE=true webpack --progress --colors && cross-env npm run prerender-desktop-css && rimraf build/examples/qa-* && rimraf build/examples/ci-* && rimraf build/**/dev.*","release:production":"cross-env ENV=production PESDK_LINT=true npm run release && rm -rf build/examples/shared","release:test":"cross-env ENV=test PESDK_CLEAN=true PESDK_ASSETS=true webpack && npm run prerender-desktop-css","release:development":"cross-env ENV=development PESDK_CLEAN=true PESDK_ASSETS=true npm run release",build:"cross-env PESDK_CLEAN=true PESDK_ASSETS=true webpack",watch:"cross-env PESDK_CLEAN=true PESDK_ASSETS=true PESDK_SERVE=true webpack --watch --progress --colors","watch:test":"cross-env PESDK_CLEAN=true PESDK_ASSETS=true ENV=test webpack --watch --progress --colors",rebuild:"cross-env PESDK_ASSETS=true webpack --progress --color",test:"cross-env ENV=test node_modules/.bin/mocha --require test/sdk/support/modules --require test/sdk/support/helpers test/sdk test/ui","test:react-ui":'cross-env ENV=test node --stack-size=65500 node_modules/.bin/mocha --require test/react-ui/support/helpers test/shared/run-server.js "test/react-ui/*.test.js" "test/react-ui/**/*.test.js"',"test:desktop-ui":'cross-env ENV=test node --stack-size=65500  node_modules/.bin/mocha --require test/desktop-ui/support/helpers test/shared/run-server.js "test/desktop-ui/*.test.js" "test/desktop-ui/**/*.test.js"',"test:node-ui":'cross-env ENV=test node --stack-size=65500 node_modules/.bin/mocha --require test/sdk/support/modules --require test/node-ui/support/helpers test/shared/run-server.js "test/node-ui/*.test.js" "test/node-ui/**/*.test.js"',"test:webgl":"cross-env RENDERER=webgl ENV=test node_modules/.bin/mocha --require test/sdk/support/modules --require test/sdk/support/helpers test/sdk","deploy:develop":"cross-env rsync --delete --rsh=ssh -av $TRAVIS_BUILD_DIR/build/* flateric@static.photoeditorsdk.com:/home/flateric/static.photoeditorsdk.com/demo-dev/","deploy:master":"cross-env rsync --delete --rsh=ssh -av $TRAVIS_BUILD_DIR/build/* flateric@static.photoeditorsdk.com:/home/flateric/static.photoeditorsdk.com/demo/",jsdoc:"jsdoc -c config/jsdoc.json -r","render-filter-previews":"node scripts/run render-filter-previews","prerender-desktop-css":"node scripts/run render-desktop-ui-css",dist:"rm -rf dist/* && cp -r build/photoeditorsdk/ dist/ && find dist -d 2 -name '*.min.*'  | sed 'p;s/.min././' | xargs -n2 mv && rm dist/server.js && rm dist/js/"},devDependencies:{ajv:"^5.5.1","babel-core":"^6.26.0","babel-eslint":"^7.1.1","babel-loader":"^7.1.2","babel-minify-webpack-plugin":"^0.2.0","babel-plugin-external-helpers":"^6.22.0","babel-plugin-transform-adonis-hash":"^0.4.0","babel-plugin-transform-class-properties":"^6.19.0","babel-plugin-transform-es2015-classes":"^6.6.4","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-plugin-transform-proto-to-assign":"^6.26.0","babel-plugin-transform-runtime":"^6.6.0","babel-preset-es2015":"^6.6.0","babel-preset-minify":"^0.2.0","babel-preset-react":"^6.5.0","babel-register":"^6.26.0","babel-runtime":"^6.26.0",chai:"^3.4.0","chai-as-promised":"^5.1.0",chromedriver:"^2.33.2",classnames:"^2.1.3","clean-webpack-plugin":"^0.1.16","compass-mixins":"^0.12.8","copy-webpack-plugin":"^4.3.0","cross-env":"^5.1.1","css-loader":"^0.28.7",del:"^2.0.0",djv:"^1.2.0",eslint:"^4.16.0",express:"^4.16.2","extract-text-webpack-plugin":"^3.0.2",inquirer:"^0.11.4","inquirer-path":"^1.0.0-beta5","isomorphic-fetch":"^2.2.1","jaguarjs-jsdoc":"git://github.com/imgly/jaguarjs-jsdoc.git#master",jsdoc:"^3.5.5","json-loader":"^0.5.7",lodash:"^4.17.4",minimist:"^1.2.0",mkdirp:"^0.5.1",mocha:"^3.5.3",nightwatch:"git://github.com/saschagehlich/nightwatch.git#feature/file-upload-and-multiple-selectors","node-sass":"^4.7.2","node-static":"^0.7.10","optimize-css-assets-webpack-plugin":"^3.2.0","performance-now":"^0.2.0","preprocess-loader":"^0.2.2","pretty-error":"^2.0.0",prompt:"^1.0.0","prop-types":"^15.6.0","raw-loader":"^0.5.1",react:"^16.2.0","react-dom":"^16.2.0",rembrandt:"^0.1.3",rimraf:"^2.6.2","sass-loader":"^6.0.6","selenium-server-standalone-jar":"3.4.0",should:"^4.3.0",sinon:"^1.17.3","sinon-chai":"^2.14.0",standard:"^9.0.0","standard-loader":"^6.0.1","stats.js":"^0.16.0","style-loader":"^0.13.1","term-img2":"^2.0.1","transform-loader":"^0.2.2","uglifyjs-webpack-plugin":"^0.4.6","vinyl-source-stream":"0.1.1",webpack:"^3.10.0","webpack-notifier":"^1.2.1",adonis:"git://github.com/imgly/adonis.git#v1.0.0"},standard:{globals:["describe","context","before","beforeEach","after","afterEach","it","expect"],parser:"babel-eslint"},dependencies:{canvas:"git://github.com/Automattic/node-canvas.git#master",gl:"^4.0.4",request:"^2.83.0"}}},function(t,e,r){t.exports=r(44).default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(45),i=r(37),o=r(38),s=r(14),a=r(8),h=r(39),u=r(9),c=r(1),p=r(86),f=r(41),l=r(23),d=r(4),_=r(13),y=r(2),g=r(3),v=r(10);/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 * @license
 */
n.a.version=r(42).version,n.a.Math=i,n.a.Operations=o,n.a.Engine=s.a,n.a.Color=a.a,n.a.Operation=h.a,n.a.EventEmitter=u.a,n.a.Utils=c.a,n.a.Env=p.a,n.a.OperationsStack=f.a,n.a.EXIF=l.a,n.a.Promise=d.a,n.a.Configurable=_.a,n.a.Log=y.a,n.a.RenderType=g.RenderType,n.a.ImageFormat=g.ImageFormat,n.a.OptionType=g.OptionType,n.a.RendererType=g.RendererType,n.a.UniformType=g.UniformType,n.a.Base64=v.a,n.a.UI={},e.default=n.a},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(5),a=r(38),h=r(41),u=r(82),c=r(23),p=r(85),f=r(40),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d=function(t){return v.byteArrayToString(x.decode(t))},_=s.Rectangle,y=s.Constants,g=s.Engine,v=s.Utils,m=s.EventEmitter,b=s.Vector2,T=s.Log,x=s.Base64,w=y.RenderType,E=y.ImageFormat,O=y.Events,R=y.RendererType,C=function(t){function e(o){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,e);var u=i(this,t.call(this));u._onOperationUpdate=u._onOperationUpdate.bind(u),u._onContextRestored=u._onContextRestored.bind(u);var c=r(42),p=c.version;if(u.version=p,u[d("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!0,u._preferredRenderer=o,u._options=v.defaults(a,{extensions:{},renderMode:"dynamic",versionCheck:!0,displayWelcomeMessage:!0,image:null,canvas:null,transparent:!1,textureQuality:1,zoom:1,spriteScale:1,rotation:0,smoothDownscaling:!1,smoothUpscaling:!1,logLevel:"warn",pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),u._options.smoothUpscaling&&(g.BaseTexture.DefaultMagFilter=g.BaseTexture.LinearFilter),u._options.extensions=v.defaults(u._options.extensions,{operations:[],controls:[],languages:[]}),T.setLevel(u._options.logLevel),!u._v())return i(u);var f=s[d("TGljZW5zZUNoZWNrZXI=")];u._l=new f(u[d("X29wdGlvbnM=")][d("bGljZW5zZQ==")]),u._cv(!0).then(function(){u._ct()}).catch(function(t){T.error(d("TGljZW5zaW5n"),t.message)}),u._defaultRenderMode=u._options.renderMode,u._renderMode=u._options.renderMode,u._textureQuality=u._options.textureQuality,u._offset=new b,u._zoom=u._options.zoom,u._spriteScale=u._options.spriteScale,u._rotation=u._options.rotation,u._operations={},u._operationsStack=null,u.setOperationsStack(new h.a),u._container=new g.Container,u._sprite=new g.Sprite,u._container.addChild(u._sprite),u._inputTexture=u._options.inputTexture,u._currentInputTexture=null,u._currentTexture=null,u._resizedTexture=null,u._resizedContainer=new g.Container,u._resizedSprite=new g.Sprite,u._resizedContainer.addChild(u._resizedSprite),u.setSmoothDownscaling(u._options.smoothDownscaling),u._checkForUpdates(),u._registerOperations(),u._initRenderer();var l=u._renderer.constructor.type;return u._options.displayWelcomeMessage&&T.log("Version:",u.version+" ("+l+") - https://www.photoeditorsdk.com"),u._options.image&&u.setImage(u._options.image),u}return o(e,t),e.prototype._v=function(){return!!this[d("X29wdGlvbnM=")][d("bGljZW5zZQ==")]||(T.error(d("TGljZW5zaW5n"),d("Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbi4=")),T.error(d("TGljZW5zaW5n"),d("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),!1)},e.prototype._ct=function(){if(this._l.exp()){this._l.isExp()?T.error(d("TGljZW5zaW5n"),d("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCB1cyBhdCBzYWxlc0BwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZS4=")):T.warn(d("TGljZW5zaW5n"),d("WW91ciB0cmlhbCBsaWNlbnNlIHdpbGwgZXhwaXJlIGluICVkIGRheXMu").replace("%d",this._l.dl()))}},e.prototype._cv=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._l.c().catch(function(r){t[d("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!1;var n=d("SW52YWxpZCBsaWNlbnNlLg==");throw e&&(n="ELICEXP"===r.code?d("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCB1cyBhdCBzYWxlc0BwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZS4="):"ELICINVHOST"===r.code?d("VGhpcyBsaWNlbnNlIGlzIG5vdCB2YWxpZCBmb3IgdGhlIGhvc3RuYW1lIA==")+window.location.hostname+".":"ELICINVPLAT"===r.code?d("VGhpcyBsaWNlbnNlIGlzIG5vdCB2YWxpZCBmb3IgdGhlIGN1cnJlbnQgcGxhdGZvcm0u"):"ELICINVFMT"===r.code?d("SW52YWxpZCBsaWNlbnNlIGZvcm1hdC4gUGxlYXNlIG1ha2Ugc3VyZSB5b3UncmUgcGFzc2luZyB5b3VyIGxpY2Vuc2UgYXMgYSBzdHJpbmcsIG5vdCBhcyBgJGZvcm1hdGAu").replace("$format",l(t._options.license)):d("ELICINV"===r.code?"SW52YWxpZCBsaWNlbnNlISBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc3VwcG9ydEBwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZSBvciBsb2cgaW4gdG8geW91ciBjdXN0b21lciBkYXNoYm9hcmQu":"SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),r.message=n,new Error(r)})},e.prototype._t=function(){this._l.t()},e.prototype._onOperationUpdate=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.emit.apply(this,[O.OPERATION_UPDATED].concat(e))},e.prototype._onContextRestored=function(){T.warn(this.constructor.name,"Trying to re-render after WebGL context has been restored."),this.setAllOperationsToDirty(),this._operationsStack.forEach(function(t){t.disposeRenderTextures()}),this.render()},e.prototype.export=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w.DATAURL,e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.PNG,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;return this._cv(!0).then(function(){return e.hasChanges()&&e._t(),new p.a(e,{renderType:t,imageFormat:r,quality:n}).export()})},e.prototype.render=function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this._inputTexture)throw new Error("You need to set an image before calling PhotoEditorSDK#render.");var r=this._renderer.getContext();r.startFrame&&r.startFrame();var n=void 0;T.canLog("info")&&(n=new f.a("⚡⚡⚡","Frame rendering")),T.info("⚡⚡⚡","Rendering starts");var i=this._operationsStack;return i.updateDirtinessForRenderer(this._renderer),this._prepareTexture().then(function(e){"export"===t._renderMode&&(e=t._inputTexture),t._currentTexture=e,t._sprite.setTexture(e),t._container.updateTransform()}).then(function(){return i.validateSettings()}).then(function(){return i.render(t,t._currentTexture)}).then(function(r){switch(t._currentTexture=r,t._sprite.setTexture(t._currentTexture),t._renderMode){case"dynamic":var n=t._renderer.getDimensions().clone().divide(2).add(t._offset);t._container.setScale(t._zoom/t.getTextureScale(),t._zoom/t.getTextureScale()),t._container.setPosition(n),t._sprite.setAnchor(.5,.5),t._sprite.setScale(t._spriteScale,t._spriteScale),t._sprite.setRotation(t._rotation);break;case"export":t._container.setScale(1,1),t._container.setPosition(0,0),t._sprite.setAnchor(0,0),t._sprite.setPosition(0,0),t._sprite.setScale(t._spriteScale,t._spriteScale),t._sprite.setRotation(0)}return e&&t._renderer.render(t._container),r}).then(function(t){return n&&n.stop(),r.endFrame&&r.endFrame(),t})},e.prototype.getTextureScale=function(){return Math.min(1,this._textureQuality*this._options.pixelRatio)},e.prototype._prepareTexture=function(){var t=this;return new Promise(function(e,r){var n=t.getTextureScale();if(1===t._textureQuality)return e(t._inputTexture);var i=t.getInputDimensions().multiply(n).floor(),o=void 0;t._resizedTexture?t._resizedTexture.getDimensions().equals(i)||(t._resizedTexture.resizeTo(i),o=!0):(t._resizedTexture=new g.RenderTexture(t._renderer,i.x,i.y),o=!0),o&&(t._resizedSprite.setScale(n,n),t._resizedSprite.setTexture(t._inputTexture),t._resizedTexture.render(t._resizedContainer)),e(t._resizedTexture)})},e.prototype._registerOperations=function(){this._operations={};for(var t in a){var e=a[t];this._operations[e.identifier]=e}this._operations=v.extend(this._operations,this._options.extensions.operations)},e.prototype.registerOperations=function(t){var e=this;t.forEach(function(t){e._operations[t.identifier]=t})},e.prototype.setAllOperationsToDirty=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._operationsStack.setAllToDirty(t)},e.prototype.createOperation=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this._operations[t];if(!n)throw new Error("No operation with identifier `"+t+"` found.");var i=new n(this,e);return r&&this.addOperation(i),i},e.prototype.addOperation=function(t){this._operationsStack.push(t)},e.prototype.removeOperation=function(t){this._operationsStack.remove(t)},e.prototype.getInputDimensions=function(){var t=this._inputTexture.getFrame();return new b(t.width,t.height)},e.prototype.getFinalDimensions=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.getInputDimensions();return this._operationsStack.forEach(function(t){t.getEnabled()&&(e=t.getNewDimensions(e))}),t&&e.multiply(this._spriteScale),e.floor()},e.prototype.getOutputDimensions=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.getFinalDimensions(t).clone().multiply(this._zoom).floor()},e.prototype.getOutputTextureDimensions=function(){var t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.getTextureScale()),e=this.getInputDimensions().multiply(t).floor();return this._operationsStack.forEach(function(t){e=t.getNewDimensions(e)}),e},e.prototype._checkForUpdates=function(){this._l.isENT()||(this._versionChecker=new u.a(this.version))},e.prototype._initRenderer=function(){var t={canvas:this._options.canvas,pixelRatio:this._options.pixelRatio,debug:this._options.debug,transparent:this._options.transparent},e=void 0,r=void 0;if("dynamic"===this._renderMode&&this._options.canvas){var n=this._options.canvas;e=n.width,r=n.height}else if(this._inputTexture){var i=this.getFinalDimensions();e=i.x,r=i.y}else e=1,r=1;switch(this._preferredRenderer){case R.WEBGL:this._renderer=g.autoDetectRenderer(e,r,t),this._renderer.on("context-restored",this._onContextRestored);break;case R.CANVAS:this._renderer=new g.CanvasRenderer(e,r,t),this._renderer.on("context-restored",this._onContextRestored);break;default:T.warn("PhotoEditorSDK","PhotoEditorSDK Error: Renderer `"+this._preferredRenderer+"` not supported. Falling back to automatically detected renderer."),this._renderer=g.autoDetectRenderer(e,r,t)}},e.prototype.resizeTo=function(t){this._renderer.resizeTo(t,!0)},e.prototype.reset=function(){this._operationsStack.clear()},e.prototype.parseExif=function(t){if(t){var e=t.src,r=!1,n=null;if(r=c.a.isJPEG(e),n=e,r){var i=null;try{i=c.a.fromBase64String(n)}catch(t){}if(!i)return;return i}}},e.prototype._handleExifOrientation=function(){var t=this._exif.getTags();if(t&&t.Orientation){var e=1!==t.Orientation&&2!==t.Orientation,r=-1!==[2,4,5,7].indexOf(t.Orientation);(e||r)&&(this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(t),this._exif.setOrientation(1))}},e.prototype.hasImage=function(){return null!==this._image&&void 0!==this._image},e.prototype.getImage=function(){return this._image},e.prototype.setImage=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._exifOperation&&(this.removeOperation(this._exifOperation),this._exifOperation=null),this._options.image=t,this._image=t,this._exif=e||this.parseExif(t),this._exif&&this._handleExifOrientation();var n=new g.BaseTexture(this._image),i=new _(0,0,this._image.naturalWidth||this._image.width,this._image.naturalHeight||this._image.height);r&&(i.width=r.x,i.height=r.y),this._resizedTexture&&this._resizedTexture.dispose(),this._resizedTexture=null,this._inputTexture&&this._inputTexture.getBaseTexture().dispose(),this._inputTexture=new g.Texture(n,i),this._currentTexture=this._inputTexture,this._sprite.setTexture(this._inputTexture),this.setAllOperationsToDirty(!0)},e.prototype.setInputTexture=function(t){this._inputTexture=t},e.prototype.getCanvas=function(){return this._renderer.getCanvas()},e.prototype.setCanvas=function(t){this._renderer.setCanvas(t)},e.prototype.getSprite=function(){return this._sprite},e.prototype.getContainer=function(){return this._container},e.prototype.getOperationsStack=function(){return this._operationsStack},e.prototype.setOperationsStack=function(t){this._operationsStack&&this._operationsStack.off(O.OPERATION_UPDATED,this._onOperationUpdate),this._operationsStack=t,this._operationsStack.on(O.OPERATION_UPDATED,this._onOperationUpdate)},e.prototype.getOperations=function(){return this._operations},e.prototype.getRenderer=function(){return this._renderer},e.prototype.getOffset=function(){return this._offset},e.prototype.setOffset=function(t,e){t instanceof b?this._offset.copy(t):this._offset.set(t,e)},e.prototype.getRenderMode=function(){return this._renderMode},e.prototype.setRenderMode=function(t){this._renderMode=t},e.prototype.getZoom=function(){return this._zoom},e.prototype.setZoom=function(t){this._zoom=t,this._container.setScale(this._zoom,this._zoom),this._container.updateTransform()},e.prototype.getTextureQuality=function(){return"export"===this._renderMode?1:this._textureQuality},e.prototype.setTextureQuality=function(t){t!==this._textureQuality&&this.setAllOperationsToDirty(!0),this._textureQuality=Math.min(1,t),1===this._textureQuality&&this._resizedTexture&&(this._resizedTexture.dispose(),this._resizedTexture=null)},e.prototype.getSpriteScale=function(){return this._spriteScale},e.prototype.setSpriteScale=function(t){this._spriteScale=t,this._sprite.setScale(t,t),this._sprite.updateTransform()},e.prototype.getPixelRatio=function(){return this._options.pixelRatio},e.prototype.getExif=function(){return this._exif},e.prototype.getOptions=function(){return this._options},e.prototype.getInputTexture=function(){return this._inputTexture},e.prototype.setSmoothDownscaling=function(t){this._options.smoothDownscaling=t,this._sprite.setSmoothDownscaling(t),this._resizedSprite.setSmoothDownscaling(t)},e.prototype.setRotation=function(t){this._rotation=t},e.prototype.getRotation=function(){return this._rotation},e.prototype.hasChanges=function(){return this.getOperationsStack().hasChanges()},e.prototype.dispose=function(){this._operationsStack.dispose(),this._renderer.dispose(),this._exif&&this._exif.dispose(),this._resizedTexture&&this._resizedTexture.dispose()},e}(m);e.a=C},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(29),h=r(31),u=r(15),c=r(18),p=s.c.RendererType,f=function(t){function e(){n(this,e);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];var a=i(this,t.call.apply(t,[this].concat(o)));return a._type=p.CANVAS,a.setCanvas(a._options.canvas||a._createCanvas()),a}return o(e,t),e.prototype._createCanvas=function(){return s.i.createCanvas()},e.prototype._createContext=function(){var t=this._canvas,r=t.getContext("2d");return this._options.debug&&(r=new a.a(r)),this.id=r.id=e.contextId++,this._context=r,r.renderer=this,this.emit("context",r),r},e.prototype._setupContext=function(){var t=this._context;"imageSmoothingEnabled"in t?t.imageSmoothingEnabled=!0:["moz","webkit","ms"].forEach(function(e){t[e]&&(t[e]=!0)}),this._defaultRenderTarget=new u.a(this._width,this._height,this._pixelRatio,this._canvas,this._context),this.setRenderTarget(this._defaultRenderTarget),this._filterManager=new c.a(this)},e.prototype.render=function(t){var e=this._renderTarget.getContext(),r=t.getParent();t.setParent(this._fakeObject),t.updateTransform(),t.setParent(r),e.setTransform(1,0,0,1,0,0),e.globalAlpha=1;var n=this._canvas,i=n.width,o=n.height;e.clearRect(0,0,i,o),0!==this._clearColor.a&&(e.save(),e.fillStyle=this._clearColor.toRGBA(),e.fillRect(0,0,i,o),e.restore()),this.renderDisplayObject(t,this._renderTarget)},e.prototype.renderDisplayObject=function(t,e){var r=this._renderTarget;this._filterManager.setFilterStack(e.getFilterStack()),this.setRenderTarget(e),t.renderCanvas(this),this.setRenderTarget(r)},e.prototype.getCurrentRenderTarget=function(){return this._renderTarget},e.prototype.setRenderTarget=function(t){this._renderTarget=t},e.prototype.getContext=function(){return this._renderTarget.getContext()},e.prototype.dispose=function(){this._filterManager.dispose()},e}(h.a);f.contextId=0,f.type="Canvas2D",e.a=f},function(t,e,r){"use strict";var n={defaults:function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i={};for(var o in t)i[o]=t[o];for(var s=0;s<r.length;s++){var a=r[s];for(var h in a)void 0===i[h]&&(i[h]=a[h])}return i},extend:function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i={};for(var o in t)i[o]=t[o];for(var s=0;s<r.length;s++){var a=r[s];for(var h in a)i[h]=a[h]}return i}};e.a=n},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(31),h=r(16),u=r(32),c=r(49),p=r(19),f=r(21),l=r(22),d=r(29),_=r(33),y=s.c.RendererType,g=function(t){function e(){n(this,e);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];var h=i(this,t.call.apply(t,[this].concat(o)));return h._type=y.WEBGL,h._textures=[],h._fakeObject=new f.a,h._onContextLost=h._onContextLost.bind(h),h._onContextRestored=h._onContextRestored.bind(h),h.setCanvas(h._options.canvas||s.i.createCanvas()),h.shaders=h._initShaders(),h.renderers=h._initRenderers(),h}return o(e,t),e.prototype._onContextLost=function(t){t.preventDefault(),s.f.warn(this.constructor.name,"WebGL context has been lost - trying to restore.")},e.prototype._onContextCreationError=function(t){t.preventDefault(),s.f.warn(this.constructor.name,"Failed to create WebGL context: "+(t.statusMessage||"Unknown error"))},e.prototype._onContextRestored=function(){var t=this;s.f.warn(this.constructor.name,"WebGL context has been restored. Clearing all textures."),this._textures.forEach(function(e){e.disposeGLTexturesForRenderer(t)}),this._createContext(),this._setupContext(),this.emit("context-restored")},e.prototype._onBeforeContext=function(){this._filterManager&&this._filterManager.dispose(),this._filterManager=new l.a(this),this._currentObjectRenderer=new u.a(this)},e.prototype.setShader=function(t){this._currentShader=t,this._context.useProgram(t.getProgram()),this._setAttributesForShader(t)},e.prototype.setCanvas=function(e){this._canvas&&this._removeContextEventListeners(),t.prototype.setCanvas.call(this,e),this._canvas.addEventListener&&this._addContextEventListeners()},e.prototype._addContextEventListeners=function(){this._canvas.addEventListener("webglcontextlost",this._onContextLost),this._canvas.addEventListener("webglcontextrestored",this._onContextRestored),this._canvas.addEventListener("webglcontextcreationerror",this._onContextCreationError)},e.prototype._removeContextEventListeners=function(){this._canvas.removeEventListener("webglcontextlost",this._onContextLost),this._canvas.removeEventListener("webglcontextrestored",this._onContextRestored),this._canvas.removeEventListener("webglcontextcreationerror",this._onContextCreationError)},e.prototype._setAttributesForShader=function(t){var e=this._context,r=t.getAttributes(),n=t.getAttributeLocations();r.forEach(function(t){var r=n[t];e.enableVertexAttribArray(r)})},e.prototype._initShaders=function(){return{default:new p.a(this)}},e.prototype._initRenderers=function(){return{sprite:new c.a(this)}},e.prototype._createContext=function(){var t=this._canvas,r=null,n={preserveDrawingBuffer:!0};if(r=t.getContext("webgl",n)||t.getContext("experimental-webgl",n),"undefined"!=typeof window&&window.WebGLDebugUtils&&this._options.debug){var i=function(t,e){console.error("gl."+t+"("+window.WebGLDebugUtils.glFunctionArgsToString(t,e)+")")};r=window.WebGLDebugUtils.makeDebugContext(r,null,i)}return this._options.debug&&(r=new d.a(r)),this.id=r.id=e.contextId++,this._context=r,r.renderer=this,this._maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.emit("context",r),r},e.prototype._setupContext=function(){var t=this._context;t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this._defaultRenderTarget=new h.a(this,this._width,this._height,this._pixelRatio,!0),this.setRenderTarget(this._defaultRenderTarget),this._getMaxPrecision()},e.prototype._getMaxPrecision=function(){var t=this._context,e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);this._maxFloatPrecision=0!==e.precision?"highp":"mediump";var r=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_INT);this._maxIntPrecision=0!==r.rangeMax?"highp":"lowp"},e.prototype.resizeTo=function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.prototype.resizeTo.call(this,e,r),this._currentRenderTarget&&this._currentRenderTarget.resizeTo(e)},e.prototype.setRenderTarget=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._defaultRenderTarget;this._currentRenderTarget=t,this._currentRenderTarget.activate()},e.prototype.setObjectRenderer=function(t){this._currentObjectRenderer.stop(),this._currentObjectRenderer=t,this._currentObjectRenderer.start()},e.prototype.render=function(t){this.setRenderTarget(this._defaultRenderTarget),this._defaultRenderTarget.clear(this._clearColor);var e=t.getParent();t.setParent(this._fakeObject),t.updateTransform(),t.setParent(e),this.renderDisplayObject(t,this._defaultRenderTarget)},e.prototype.renderDisplayObject=function(t,e){this.setRenderTarget(e),this._filterManager.setFilterStack(e.getFilterStack()),t.renderWebGL(this),this._currentObjectRenderer.flush()},e.prototype.clear=function(){var t=this._context;t.clearColor.apply(t,this._clearColor.toGLColor()),t.clear(t.COLOR_BUFFER_BIT)},e.prototype.save=function(){return{renderTarget:this._currentRenderTarget,objectRenderer:this._currentObjectRenderer,filterStack:this._filterManager.getFilterStack()}},e.prototype.restore=function(t){this.setRenderTarget(t.renderTarget),this._filterManager.setFilterStack(t.filterStack),this._currentObjectRenderer=t.objectRenderer},e.prototype.getOrCreateGLTexture=function(t){var e=this._context,r=t.getGLTextureForRenderer(this);return r||(r=e.createTexture(),t.setGLTextureForRenderer(r,this),this._textures.push(t)),r},e.prototype.updateTexture=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t.getSource(),n=!!r,i=this._context,o=t.getGLUnit(),s=this.getOrCreateGLTexture(t);i.activeTexture(i.TEXTURE0+o),i.bindTexture(i.TEXTURE_2D,s),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e&&n&&(r instanceof _.a?i.texImage2D(i.TEXTURE_2D,0,i.RGBA,r.width,r.height,0,i.RGBA,i.UNSIGNED_BYTE,r.data):i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,r)),t.isMipMappingEnabled()?i.generateMipmap(i.TEXTURE_2D):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t.getGLRepeat(i,"x")),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t.getGLRepeat(i,"y"))),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t.getGLFilter(i,"min")),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t.getGLFilter(i,"mag")),i.activeTexture(i.TEXTURE0)},e.prototype.getMaxDimensions=function(){var t=s.i.createCanvas(),e=t.getContext("webgl")||t.getContext("experimental-webgl");if(e){var r=e.getParameter(e.MAX_TEXTURE_SIZE),n=e.getExtension("WEBGL_lose_context");return n&&n.loseContext(),r}return null},e.prototype.getCurrentRenderTarget=function(){return this._currentRenderTarget},e.prototype.getCurrentObjectRenderer=function(){return this._currentObjectRenderer},e.isSupported=function(){var t=s.i.createCanvas();t.addEventListener("webglcontextcreationerror",this.prototype._onContextCreationError);var e=t.getContext("webgl")||t.getContext("experimental-webgl");return t.removeEventListener("webglcontextcreationerror",this.prototype._onContextCreationError),!!e},e.prototype.getMaxFloatPrecision=function(){return this._maxFloatPrecision},e.prototype.getMaxIntPrecision=function(){return this._maxIntPrecision},e.prototype.dispose=function(){var t=this;this._filterManager.dispose(),this._currentObjectRenderer.dispose(),this._defaultRenderTarget.dispose(),this._textures.forEach(function(e){e.disposeGLTexturesForRenderer(t)});for(var e in this.shaders)this.shaders[e].dispose(),delete this.shaders[e];this._removeContextEventListeners();var r=this._context,n=r.getExtension("WEBGL_lose_context");n&&n.loseContext()},e}(a.a);g.contextId=0,g.type="WebGL",e.a=g},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(32),h=function(t){function e(){n(this,e);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];var h=i(this,t.call.apply(t,[this].concat(o)));h._maxBatchSize=s.a,h._vertices=new ArrayBuffer(4*s.a*s.j),h._positions=new Float32Array(h._vertices),h._colors=new Uint32Array(h._vertices),h._indices=new Uint16Array(6*s.a);for(var u=0,c=0;u<6*s.a;u+=6,c+=4)h._indices[u+0]=c+0,h._indices[u+1]=c+1,h._indices[u+2]=c+2,h._indices[u+3]=c+0,h._indices[u+4]=c+2,h._indices[u+5]=c+3;return h._shaders=[],h._sprites=[],h._currentBatchSize=0,h._currentBaseTexture=null,h._onContextChange(),h}return o(e,t),e.prototype.render=function(t){var e=t.getTexture(),r=e.getFrame(),n=e.getBaseTexture();this._currentBatchSize>=this._maxBatchSize&&(this.flush(),this._currentBaseTexture=n);var i=e.getUVs();if(i){var o=this._currentBatchSize*s.j;this._addVertexCoordinates(t,o,r),this._addTextureUVs(t,o,i),this._addColors(t,o),this._sprites[this._currentBatchSize]=t,this._currentBatchSize++}},e.prototype._addColors=function(t,e){var r=this._colors,n=t.getTint(),i=(n>>16)+(65280&n)+((255&n)<<16)+(255*t.getWorldAlpha()<<24);r[e+4]=r[e+9]=r[e+14]=r[e+19]=i},e.prototype._addTextureUVs=function(t,e,r){var n=this._positions,i=r.getUVsAt(0);n[e+2]=i.x,n[e+3]=i.y,i=r.getUVsAt(1),n[e+7]=i.x,n[e+8]=i.y,i=r.getUVsAt(2),n[e+12]=i.x,n[e+13]=i.y,i=r.getUVsAt(3),n[e+17]=i.x,n[e+18]=i.y},e.prototype._addVertexCoordinates=function(t,e,r){for(var n=this._positions,i=t.getWorldTransform(),o=t.getAnchor(),s=i.rectangleToCoordinates(r,o),a=0;a<4;a++)n[e+5*a]=s[a].x,n[e+5*a+1]=s[a].y},e.prototype._onContextChange=function(){var t=this._renderer.getContext();this._shader=this._renderer.shaders.default,this._vertexBuffer=t.createBuffer(),this._indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this._vertices,t.DYNAMIC_DRAW)},e.prototype.start=function(){this._shader.setupBuffers(this._vertexBuffer,this._indexBuffer)},e.prototype.flush=function(){var t=this._renderer,e=t.getContext();if(0!==this._currentBatchSize){if(this._currentBatchSize>.5*s.a)e.bufferSubData(e.ARRAY_BUFFER,0,this._vertices);else{var r=this._positions.subarray(0,this._currentBatchSize*s.j);e.bufferSubData(e.ARRAY_BUFFER,0,r)}for(var n=0,i=null,o=null,a=null,h=null,u=!1,c=null,p=0,f=0,l=this._currentBatchSize;f<l;f++){if(c=this._sprites[f],o=c.getTexture().getBaseTexture(),h=c.getShader()||this._shader,u=a!==h,(i!==o||u)&&(this._renderBatch(i,n,p),p=f,n=0,i=o,u)){a=h,t.setShader(a);var d=t.getCurrentRenderTarget(),_=d.getProjectionMatrix().toArray();a.setUniform("u_projMatrix",_),a.syncUniforms(),e.activeTexture(e.TEXTURE0)}n++}this._renderBatch(i,n,p),this._currentBatchSize=0,this._sprites=[]}},e.prototype._renderBatch=function(t,e,r){if(0!==e){var n=this._renderer,i=n.getContext(),o=t.getGLTextureForRenderer(n);o||(o=n.getOrCreateGLTexture(t)),t.isDirty()&&(n.updateTexture(t),t.setDirty(!1)),i.activeTexture(i.TEXTURE0+t.getGLUnit()),i.bindTexture(i.TEXTURE_2D,o);var s=6*e,a=6*r*2;i.drawElements(i.TRIANGLES,s,i.UNSIGNED_SHORT,a)}},e.prototype.dispose=function(){var e=this._renderer,r=e.getContext();r.deleteBuffer(this._vertexBuffer),r.deleteBuffer(this._indexBuffer),this._vertices=null,this._positions=null,this._colors=null,this._indices=null,t.prototype.dispose.call(this)},e}(a.a);e.a=h},function(t,e){t.exports="attribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\nuniform mat3 u_projMatrix;\n\nvoid main() {\n  gl_Position = vec4((u_projMatrix * vec3(a_position, 1)).xy, 0, 1);\n  v_texCoord = a_texCoord;\n  v_color = vec4(a_color.rgb * a_color.a, a_color.a);\n}\n"},function(t,e){t.exports="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_texCoord) * v_color;\n}\n"},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(e){n(this,t),this._renderer=e,this._context=this._renderer.getContext(),this._vertices=new Float32Array([0,0,100,0,100,100,0,100]),this._uvs=new Float32Array([0,0,1,0,1,1,0,1]),this._indices=new Uint16Array([0,1,2,0,3,2]),this._colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this._initBuffers(),this._uploadBuffers()}return t.prototype.map=function(t,e){var r=e.x,n=e.y;this._uvs[2]=e.width/t.width,this._uvs[4]=this._uvs[2],this._uvs[5]=e.height/t.height,this._uvs[7]=this._uvs[5],this._vertices[0]=r,this._vertices[1]=n,this._vertices[2]=r+e.width,this._vertices[3]=n,this._vertices[4]=this._vertices[2],this._vertices[5]=n+e.height,this._vertices[6]=r,this._vertices[7]=this._vertices[5],this._uploadBuffers()},t.prototype._initBuffers=function(){var t=this._context;this._vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,128,t.DYNAMIC_DRAW),this._indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW)},t.prototype._uploadBuffers=function(){var t=this._context;t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices),t.bufferSubData(t.ARRAY_BUFFER,32,this._uvs),t.bufferSubData(t.ARRAY_BUFFER,64,this._colors)},t.prototype.getVertexBuffer=function(){return this._vertexBuffer},t.prototype.getIndexBuffer=function(){return this._indexBuffer},t.prototype.dispose=function(){var t=this._context;t.deleteBuffer(this._vertexBuffer),t.deleteBuffer(this._indexBuffer)},t}();e.a=i},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(0),o=function(){function t(){n(this,t),this._uvs=[new i.k(0,0),new i.k(1,0),new i.k(1,1),new i.k(0,1)]}return t.prototype.update=function(t,e){var r=this._uvs[0];r.x=t.x/e.width,r.y=t.y/e.height,r=this._uvs[1],r.x=(t.x+t.width)/e.width,r.y=t.y/e.height,r=this._uvs[2],r.x=(t.x+t.width)/e.width,r.y=(t.y+t.height)/e.height,r=this._uvs[3],r.x=t.x/e.width,r.y=(t.y+t.height)/e.height},t.prototype.getUVsAt=function(t){return this._uvs[t]},t.prototype.getUVs=function(){return this._uvs},t}();e.a=o},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(35),h=r(11),u=r(16),c=r(15),p=r(22),f=r(18),l=s.c.RendererType,d=function(t){function e(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;n(this,e);var c=i(this,t.call(this,new h.a,new s.h(0,0,o,a)));return c._loaded=!0,c._width=o,c._height=a,c._pixelRatio=u,c._renderer=r,c._setupFilterManager(),c._setupBuffer(),c.setBaseTexture(c._renderTarget.getBaseTexture()),c._updateUVs(),c}return o(e,t),e.prototype._setupFilterManager=function(){this._renderer.isOfType(l.WEBGL)?this._filterManager=new p.a(this._renderer):this._renderer.isOfType(l.CANVAS)&&(this._filterManager=new f.a(this._renderer)),this._filterManager.resizeTo(new s.k(this._width,this._height))},e.prototype._setupBuffer=function(){this._renderer.isOfType(l.WEBGL)?this._setupWebGLRenderTarget():this._renderer.isOfType(l.CANVAS)&&this._setupCanvasRenderTarget()},e.prototype._setupWebGLRenderTarget=function(){this._renderTarget=new u.a(this._renderer,this._width,this._height,this._pixelRatio)},e.prototype._setupCanvasRenderTarget=function(){this._renderTarget=new c.a(this._width,this._height,this._pixelRatio)},e.prototype.clear=function(t){this._renderTarget.clear(t)},e.prototype.resizeTo=function(t){this._width===t.x&&this._height===t.y||(this._width=t.x,this._height=t.y,this._frame.width=t.x,this._frame.height=t.y,this._renderTarget.resizeTo(t),this._filterManager.resizeTo(t))},e.prototype.render=function(t){if(this._renderer.isOfType(l.WEBGL))this._renderWebGL(t);else{if(!this._renderer.isOfType(l.CANVAS))throw new Error("RenderTexture does not support rendering via "+this._renderer.constructor.name);this._renderCanvas(t)}},e.prototype._renderWebGL=function(t){this._renderTarget.activate(),t.getWorldTransform().reset(),t.getChildren().forEach(function(t){t.updateTransform()});var e=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(t,this._renderTarget),this._renderer.setFilterManager(e)},e.prototype._renderCanvas=function(t){t.getWorldTransform().reset(),t.getChildren().forEach(function(t){t.updateTransform()});var e=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(t,this._renderTarget),this._renderer.setFilterManager(e)},e.prototype.getRenderTarget=function(){return this._renderTarget},e.prototype.dispose=function(){this._renderTarget.dispose(),this._filterManager.dispose()},e}(a.a);e.a=d},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(34),h=r(56),u=function(t){function e(r){n(this,e);var o=i(this,t.call(this));return o._onTextureUpdate=o._onTextureUpdate.bind(o),o._texture=r,o._shader=null,o._width=0,o._height=0,o._anchor=new s.k(0,0),o.setTexture(r),o}return o(e,t),e.prototype._onTextureUpdate=function(){this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0},e.prototype._renderWebGL=function(t){var e=t.save();this._smoothDownscaling&&(this._potRenderer||(this._potRenderer=new h.a),this._potRenderer.render(t,this,this._texture)),t.restore(e),t.setObjectRenderer(t.renderers.sprite),t.renderers.sprite.render(this)},e.prototype._renderCanvas=function(t){var e=this._worldTransform,r=this._texture.getFrame(),n=r.width,i=r.height,o=t.getCurrentRenderTarget().getPixelRatio(),s=this._anchor.x*-n|0,a=this._anchor.y*-i|0,h=t.getContext();h.setTransform(e.a,e.b,e.c,e.d,e.tx*o,e.ty*o),h.globalAlpha=this.getWorldAlpha();var u=this._texture.getBaseTexture(),c=u.getPixelRatio(),p=u.getSource();h.drawImage(this._texture.getBaseTexture().getSource(),0,0,(p.naturalWidth||n)*c,(p.naturalHeight||i)*c,s*o,a*o,n*o,i*o)},e.prototype.isAtPosition=function(t){var e=this._worldTransform.applyInverseToVector(t),r=this._texture.getFrame(),n=r.width,i=r.height,o=new s.k(-n,-i);o.multiply(this._anchor);var a=o.clone().add(n,i);return!(e.x<o.x||e.x>a.x||e.y<o.y||e.y>a.y)},e.prototype.getLocalBounds=function(){if(this._localBoundsNeedUpdate){var t=this._localBounds,e=this._texture.getFrame();t.x=-e.width*this._anchor.x,t.y=-e.height*this._anchor.y,t.width=e.width,t.height=e.height,this._localBoundsNeedUpdate=!1}return this._localBounds.clone()},e.prototype.getBounds=function(){if(this._boundsNeedUpdate){var t=this._bounds,e=this._texture.getFrame(),r=this._worldTransform,n=this._anchor,i=r.rectangleToCoordinates(e,n),o=i[0].x,s=i[0].y,a=o,h=s;i.forEach(function(t){var e=t.x,r=t.y;o=Math.min(o,e),s=Math.min(s,r),a=Math.max(a,e),h=Math.max(h,r)}),t.x=o,t.width=Math.abs(a-o),t.y=s,t.height=Math.abs(h-s),this._boundsNeedUpdate=!1}return this._bounds.clone()},e.prototype.getTexture=function(){return this._texture},e.prototype.setTexture=function(t){t&&(this._texture&&this._texture.off("update",this._onTextureUpdate),this._potRenderer&&this._potRenderer.getRenderTexture().getBaseTexture().setDirty(!0),this._texture=t,t.getBaseTexture().isLoaded()&&this._onTextureUpdate(),t.on("update",this._onTextureUpdate))},e.prototype.getShader=function(){return this._shader},e.prototype.setShader=function(t){this._shader=t},e.prototype.getWidth=function(){return this._width},e.prototype.setWidth=function(t){this._scale.x=t/this._texture.getFrame().width,this._width=t,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0},e.prototype.getHeight=function(){return this._height},e.prototype.setHeight=function(t){this._scale.y=t/this._texture.getFrame().height,this._height=t,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0},e.prototype.getDimensions=function(){return new s.k(this._width,this._height)},e.prototype.getAnchor=function(){return this._anchor},e.prototype.setAnchor=function(t,e){t instanceof s.k?this._anchor.copy(t):this._anchor.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0},e.prototype.isSmoothDownscaling=function(){return this._smoothDownscaling},e.prototype.setSmoothDownscaling=function(t){this._smoothDownscaling=t},e.prototype.dispose=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._texture&&this._texture.off("update",this._onTextureUpdate),(t||e)&&this._texture.dispose(e),this._potRenderer&&this._potRenderer.dispose()},e}(a.a);e.a=u},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(5),o=function(){function t(){n(this,t),this._container=new i.Engine.Container,this._sprite=new i.Engine.Sprite,this._container.addChild(this._sprite)}return t.prototype.render=function(t,e,r){var n=r.getDimensions(),o=this._getNextHighestPOT(n);this._renderTexture?this._renderTexture.resizeTo(o):this._renderTexture=new i.Engine.RenderTexture(t,o.x,o.y);var s=this._renderTexture.getDimensions();this._sprite.setTexture(r),this._sprite.updateTransform(),this._renderTexture.render(this._container),this._updateSprite(t,e,n,s)},t.prototype._updateSprite=function(t,e,r,n){e.setTexture(this._renderTexture),this._renderTexture.setFrame(new i.Rectangle(0,0,r.x,r.y))},t.prototype._getNextHighestPOT=function(t){return new i.Vector2(i.Utils.nextHighestPOT(t.x),i.Utils.nextHighestPOT(t.y))},t.prototype.getRenderTexture=function(){return this._renderTexture},t.prototype.dispose=function(){this._renderTexture.dispose(),this._renderTexture=null},t}();e.a=o},function(t,e,r){"use strict";var n=r(19);e.a={TextureShader:n.a}},function(t,e,r){function n(t,e){this._id=t,this._clearFn=e}var i=Function.prototype.apply;e.setTimeout=function(){return new n(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new n(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},r(59),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e,r){(function(t,e){!function(t,r){"use strict";function n(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),r=0;r<e.length;r++)e[r]=arguments[r+1];var n={callback:t,args:e};return u[h]=n,a(h),h++}function i(t){delete u[t]}function o(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(r,n)}}function s(t){if(c)setTimeout(s,0,t);else{var e=u[t];if(e){c=!0;try{o(e)}finally{i(t),c=!1}}}}if(!t.setImmediate){var a,h=1,u={},c=!1,p=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?function(){a=function(t){e.nextTick(function(){s(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}}()?function(){var e="setImmediate$"+Math.random()+"$",r=function(r){r.source===t&&"string"==typeof r.data&&0===r.data.indexOf(e)&&s(+r.data.slice(e.length))};t.addEventListener?t.addEventListener("message",r,!1):t.attachEvent("onmessage",r),a=function(r){t.postMessage(e+r,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){s(t.data)},a=function(e){t.port2.postMessage(e)}}():p&&"onreadystatechange"in p.createElement("script")?function(){var t=p.documentElement;a=function(e){var r=p.createElement("script");r.onreadystatechange=function(){s(e),r.onreadystatechange=null,t.removeChild(r),r=null},t.appendChild(r)}}():function(){a=function(t){setTimeout(s,0,t)}}(),f.setImmediate=n,f.clearImmediate=i}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,r(7),r(17))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(61);r.d(e,"UnpremultiplyFilter",function(){return n.a});var i=r(63);r.d(e,"ColorOverlayFilter",function(){return i.a});var o=r(65);r.d(e,"TintFilter",function(){return o.a});var s=r(67);r.d(e,"OverlayFilter",function(){return s.a})},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(12),a=function(t){function e(){n(this,e);var o=i(this,t.call(this));return o._fragmentSource=r(62),o}return o(e,t),e}(s.a);e.a=a},function(t,e){t.exports="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(color.a > 0. ? color.rgb / color.a : vec3(0), color.a);\n}\n"},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(12),h=s.c.OptionType,u=s.c.UniformType,c=function(t){function e(){n(this,e);for(var o=arguments.length,s=Array(o),a=0;a<o;a++)s[a]=arguments[a];var h=i(this,t.call.apply(t,[this].concat(s)));return h._fragmentSource=r(64),h}return o(e,t),e.prototype._applyCanvas=function(t,e,r){for(var n=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],e.getCanvas()),i=e.getContext(),o=r.getContext(),a=this._options.color,h=i.getImageData(0,0,n.width,n.height),u=o.getImageData(0,0,n.width,n.height),c=n.width*n.height,p=new s.b,f=new s.b,l=0;l<4*c;l+=4){p.set(h.data[l]/255,h.data[l+1]/255,h.data[l+2]/255,h.data[l+3]/255),f.set(u.data[l]/255,u.data[l+1]/255,u.data[l+2]/255,u.data[l+3]/255);var d=f.r+p.a*(p.r-f.r);u.data[l]=255*(d+p.a*(a.r-d));var _=f.g+p.a*(p.g-f.g);u.data[l+1]=255*(_+p.a*(a.g-_));var y=f.b+p.a*(p.b-f.b);u.data[l+2]=255*(y+p.a*(a.b-y))}o.putImageData(u,0,0)},e}(a.a);c.prototype.availableOptions={color:{type:h.COLOR,default:s.b.WHITE,uniformType:u.FLOAT4}},e.a=c},function(t,e){t.exports="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec4 u_color;\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;\n}\n"},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(12),h=s.c.OptionType,u=s.c.UniformType,c=function(t){function e(){n(this,e);for(var o=arguments.length,s=Array(o),a=0;a<o;a++)s[a]=arguments[a];var h=i(this,t.call.apply(t,[this].concat(s)));return h._fragmentSource=r(66),h}return o(e,t),e.prototype._applyCanvas=function(t,r,n){var i=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],r.getCanvas()),o=r.getContext(),a=n.getContext(),h=o.getImageData(0,0,i.width,i.height),u=this._options,c=u.mode,p=u.color,f=p.r,l=p.g,d=p.b,_=p.a,y=[.2125,.7154,.0721];switch(c){case e.MODES.SOLID:for(var g=0;g<i.width*i.height;g++){var v=4*g;h.data[v]+=(255*f-h.data[v])*_,h.data[v+1]+=(255*l-h.data[v+1])*_,h.data[v+2]+=(255*d-h.data[v+2])*_}break;case e.MODES.COLORIZED:for(var m=0;m<i.width*i.height;m++){var b=4*m,T=h.data[b]/255*y[0]+h.data[b+1]/255*y[1]+h.data[b+2]/255*y[2],x=new s.b(T*f,T*l,T*d);h.data[b]+=(255*x.r-h.data[b])*_,h.data[b+1]+=(255*x.g-h.data[b+1])*_,h.data[b+2]+=(255*x.b-h.data[b+2])*_}}a.putImageData(h,0,0)},e}(a.a);c.MODES={NONE:0,SOLID:1,COLORIZED:2},c.prototype.availableOptions={color:{type:h.COLOR,default:s.b.WHITE,uniformType:u.FLOAT4},mode:{type:h.NUMBER,default:c.MODES.NONE,uniformType:u.INT}},e.a=c},function(t,e){t.exports="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec4 u_color;\nuniform int u_mode;\n\nvec3 W = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  if (u_mode == 0) {\n    gl_FragColor = color * color.a;\n  } else if (u_mode == 1) {\n    gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;\n  } else if (u_mode == 2) {\n    float luminance = dot(color.rgb, W);\n    vec3 colorized = vec3(luminance) * u_color.rgb;\n    gl_FragColor = vec4(mix(color.rgb, colorized, u_color.a), color.a) * color.a;\n  }\n}\n"},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(0),a=r(12),h=s.c.OptionType,u=s.c.UniformType,c=function(t){function e(){n(this,e);for(var o=arguments.length,s=Array(o),a=0;a<o;a++)s[a]=arguments[a];var h=i(this,t.call.apply(t,[this].concat(s)));return h._fragmentSource=r(68),h._lastImage=null,h}return o(e,t),e.prototype._applyCanvas=function(t,r,n){for(var i=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],this._options.overlayTexture.getRenderTarget().getContext()),o=r.getCanvas(),a=r.getContext(),h=n.getContext(),u=a.getImageData(0,0,o.width,o.height),c=i.getImageData(0,0,o.width,o.height),p=this._options,f=p.blendMode,l=p.alpha,d=new s.b,_=new s.b,y=new s.b,g=0;g<o.width*o.height*4;g+=4){d.set(u.data[g]/255,u.data[g+1]/255,u.data[g+2]/255,u.data[g+3]/255),_.set(c.data[g]/255,c.data[g+1]/255,c.data[g+2]/255,c.data[g+3]/255);var v=void 0,m=void 0,b=void 0,T=void 0,x=void 0,w=void 0,E=void 0,O=void 0,R=void 0;switch(f){case e.BLEND_MODES.NORMAL:y.set(d.r+_.a*l*(_.r-d.r),d.g+_.a*l*(_.g-d.g),d.b+_.a*l*(_.b-d.b),d.a);break;case e.BLEND_MODES.OVERLAY:v=1-2*(1-d.r)*(1-_.r),m=2*d.r*_.r,b=v+(d.r<.5?1:0)*(m-v),T=1-2*(1-d.g)*(1-_.g),x=2*d.g*_.g,w=T+(d.g<.5?1:0)*(x-T),E=1-2*(1-d.b)*(1-_.b),O=2*d.b*_.b,R=E+(d.b<.5?1:0)*(O-E),y.set(d.r+_.a*l*(b-d.r),d.g+_.a*l*(w-d.g),d.b+_.a*l*(R-d.b),d.a);break;case e.BLEND_MODES.HARD_LIGHT:v=1-2*(1-_.r)*(1-d.r),m=2*_.r*d.r,b=v+(_.r<.5?1:0)*(m-v),T=1-2*(1-_.g)*(1-d.g),x=2*_.g*d.g,w=T+(_.g<.5?1:0)*(x-T),E=1-2*(1-_.b)*(1-d.b),O=2*_.b*d.b,R=E+(_.b<.5?1:0)*(O-E),y.set(d.r+_.a*l*(b-d.r),d.g+_.a*l*(w-d.g),d.b+_.a*l*(R-d.b),d.a);break;case e.BLEND_MODES.SOFT_LIGHT:v=2*d.r*(1-_.r)+(2*_.r-1)*Math.sqrt(d.r),m=2*d.r*_.r+d.r*d.r*(1-2*_.r),b=v+(_.r<.5?1:0)*(m-v),T=2*d.g*(1-_.g)+(2*_.g-1)*Math.sqrt(d.g),x=2*d.g*_.g+d.g*d.g*(1-2*_.g),w=T+(_.g<.5?1:0)*(x-T),E=2*d.b*(1-_.b)+(2*_.b-1)*Math.sqrt(d.b),O=2*d.b*_.b+d.b*d.b*(1-2*_.b),R=E+(_.b<.5?1:0)*(O-E),y.set(d.r+_.a*l*(b-d.r),d.g+_.a*l*(w-d.g),d.b+_.a*l*(R-d.b),d.a);break;case e.BLEND_MODES.MULTIPLY:b=d.r*_.r,w=d.g*_.g,R=d.b*_.b,y.set(d.r+_.a*l*(b-d.r),d.g+_.a*l*(w-d.g),d.b+_.a*l*(R-d.b),d.a);break;case e.BLEND_MODES.DARKEN:b=Math.min(d.r,_.r),w=Math.min(d.g,_.g),R=Math.min(d.b,_.b),y.set(d.r+_.a*l*(b-d.r),d.g+_.a*l*(w-d.g),d.b+_.a*l*(R-d.b),d.a);break;case e.BLEND_MODES.LIGHTEN:b=Math.max(d.r,_.r),w=Math.max(d.g,_.g),R=Math.max(d.b,_.b),y.set(d.r+_.a*l*(b-d.r),d.g+_.a*l*(w-d.g),d.b+_.a*l*(R-d.b),d.a);break;case e.BLEND_MODES.SCREEN:b=1-(1-d.r)*(1-_.r),w=1-(1-d.g)*(1-_.g),R=1-(1-d.b)*(1-_.b),y.set(d.r+_.a*l*(b-d.r),d.g+_.a*l*(w-d.g),d.b+_.a*l*(R-d.b),d.a);break;case e.BLEND_MODES.COLOR_BURN:b=Math.max(0,Math.min(1,1-(1-d.r)/Math.max(_.r,1e-6))),w=Math.max(0,Math.min(1,1-(1-d.g)/Math.max(_.g,1e-6))),R=Math.max(0,Math.min(1,1-(1-d.b)/Math.max(_.b,1e-6))),y.set(d.r+_.a*l*(b-d.r),d.g+_.a*l*(w-d.g),d.b+_.a*l*(R-d.b),d.a)}u.data[g]=255*y.r,u.data[g+1]=255*y.g,u.data[g+2]=255*y.b,u.data[g+3]=255*y.a}h.putImageData(u,0,0)},e}(a.a);c.BLEND_MODES={NORMAL:0,OVERLAY:1,HARD_LIGHT:2,SOFT_LIGHT:3,MULTIPLY:4,DARKEN:5,LIGHTEN:6,SCREEN:7,COLOR_BURN:8},c.prototype.availableOptions={blendMode:{type:h.NUMBER,default:c.BLEND_MODES.NORMAL,uniformType:u.INT},overlayImage:{type:h.NUMBER,required:!0,uniformType:u.SAMPLER2D},overlayTexture:{type:h.OBJECT,required:!0},alpha:{type:h.NUMBER,default:1,uniformType:u.FLOAT}},e.a=c},function(t,e){t.exports="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform sampler2D u_overlayImage;\nuniform int u_blendMode;\nuniform float u_alpha;\n\nconst float EPSILON = 0.000001;\n\nvec4 overlay(vec4 a, vec4 b) {\n    vec3 result = mix(\n          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),\n          2.0 * a.rgb * b.rgb,\n          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)\n      );\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 hardLight(vec4 b, vec4 a) {\n    vec3 result = mix(\n          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),\n          2.0 * a.rgb * b.rgb,\n          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)\n      );\n    return mix(b, vec4(result, b.a), u_alpha * a.a);\n}\n\nvec4 softLight(vec4 a, vec4 b) {\n    vec3 result = mix(\n          2.0 * a.rgb * (1.0 - b.rgb) + (2.0 * b.rgb - 1.0) * sqrt(a.rgb),\n          2.0 * a.rgb * b.rgb + a.rgb * a.rgb * (1.0 - 2.0 * b.rgb),\n          vec3(b.r < 0.5, b.g < 0.5, b.b < 0.5)\n      );\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 multiply(vec4 a, vec4 b) {\n    vec3 result = a.rgb * b.rgb;\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 darken(vec4 a, vec4 b) {\n    vec3 result = min(a.rgb, b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 lighten(vec4 a, vec4 b) {\n    vec3 result = max(a.rgb, b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 screen(vec4 a, vec4 b) {\n    vec3 result = 1.0 - (1.0 - a.rgb) * (1.0 - b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 colorBurn(vec4 a, vec4 b) {\n    vec3 result = clamp(1.0 - (1.0 - a.rgb) / max(b.rgb, EPSILON), 0.0, 1.0);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 normal(vec4 a, vec4 b) {\n    return mix(a, vec4(b.rgb, a.a), 1.0);\n}\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  vec4 overlayColor = texture2D(u_overlayImage, v_texCoord);\n\n  vec4 resultColor;\n  if (u_blendMode == 0) {\n    resultColor = normal(color, overlayColor);\n  } else if (u_blendMode == 1) {\n    resultColor = overlay(color, overlayColor);\n  } else if (u_blendMode == 2) {\n    resultColor = hardLight(color, overlayColor);\n  } else if (u_blendMode == 3) {\n    resultColor = softLight(color, overlayColor);\n  } else if (u_blendMode == 4) {\n    resultColor = multiply(color, overlayColor);\n  } else if (u_blendMode == 5) {\n    resultColor = darken(color, overlayColor);\n  } else if (u_blendMode == 6) {\n    resultColor = lighten(color, overlayColor);\n  } else if (u_blendMode == 7) {\n    resultColor = screen(color, overlayColor);\n  } else if (u_blendMode == 8) {\n    resultColor = colorBurn(color, overlayColor);\n  }\n  gl_FragColor = vec4(resultColor.rgb * resultColor.a, resultColor.a);\n}\n"},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t){return t.map(function(t){return("0"+(255&t).toString(16)).slice(-2)}).join("")}var o=r(1),s=r(70),a=r(10),h=r(71),u=r(79),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=function(t){return o.a.byteArrayToString(a.a.decode(t))},f=function(){function t(e){n(this,t),this._version="2.0",this._l="string"==typeof e?e.trim():e,this._e=this._parseBigInt("65537",10),this._n=this._parseBigInt("681984042382424091378806337544846672160292647422517223678775230983366046720611873368204040735766698395282492937192783016867164773742859209434481353888637963692711665138989982680829529436715362566735813634679619274059040232728883894511099669775400556584329435375723951309340934658571478665059403241851229195311069345899870108307225910988692123234379186643268583453907260879685992156955936561142314233983397819356937109343127504441076920088455337597736475086676246750168976219763398350254797168313954762459542746440628077261880980924552698138857743609502132632199713575442848784271304503226045319991689413234228439044522583790713890093165912455428688507463773064216328753265963237930998706891042679105987175588970202082466871461192706070321938250462103821558100761330890228135620208935801286878657384108721268761878694436895194628411397454202904351577771506916746612289964053490210990342857409030179406810634136188751670648983222653319056818302012063874664196648868156305696644664362171542503665321455971335955948698828939948786720193132672749776162913092000667953299803216404664087988046584107737900256954976744353601826341965438148646041640662195744770544094748295945844184507459808803114917301124088082458306086473490516969815873631",10),this._parseLicense()}return t.prototype.v=function(){return this._sigValid()&&!this.isExp()},t.prototype._jsonValid=function(){try{this._decLic=JSON.parse(this._l)}catch(t){return this._decLic={},!1}return!0},t.prototype._hostnameValid=function(){if("undefined"==typeof window)return!0;if(!this._decLic[p("YXBwX2lkZW50aWZpZXJz")].length)return!0;var t=window.location.hostname,e=!1;return this._decLic[p("YXBwX2lkZW50aWZpZXJz")].forEach(function(r){o.a.wildCardMatch(t,r)&&(e=!0)}),e},t.prototype._platformValid=function(){return"HTML5"===this._decLic[p("cGxhdGZvcm0=")]},t.prototype.c=function(){var t=this;return new Promise(function(e,r){if("string"!==c(t._l)||!t._jsonValid()){var n=new Error;return n.code="ELICINVFMT",r(n)}if(!t._sigValid()){var i=new Error;return i.code="ELICINV",r(i)}if(!t._hostnameValid()){var o=new Error;return o.code="ELICINVHOST",r(o)}if(!t._platformValid()){var s=new Error;return s.code="ELICINVPLAT",r(s)}if(t.isExp()){var a=new Error;return a.code="ELICEXP",r(a)}e()})},t.prototype.isToolAllowed=function(t){return this._decLic[p("ZmVhdHVyZXM=")]&&-1!==this._decLic[p("ZmVhdHVyZXM=")].indexOf(t)},t.prototype.t=function(){if(this._decLic.enterprise_license)return Promise.resolve();var t=this._decLic[p("ZG9tYWlucw==")][0]+p(p("TDNSeVlXTnJQMkZ3YVV0bGVUMD0="))+this._decLic[p("YXBpX3Rva2Vu")];return new h.a(t).load()},t.prototype.isENT=function(){return!!this._decLic&&this._decLic[p("ZW50ZXJwcmlzZV9saWNlbnNl")]},t.prototype._sigValid=function(){return this._verify(this._message,this._sig)},t.prototype.exp=function(){return!!this._decLic[p("ZXhwaXJlc19hdA==")]},t.prototype.dl=function(){return Math.ceil((this._expAt()-Date.now())/864e5)},t.prototype.isExp=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return null!==this._decLic[p("ZXhwaXJlc19hdA==")]&&t>this._expAt()},t.prototype._expAt=function(){return 1e3*this._decLic[p("ZXhwaXJlc19hdA==")]},t.prototype._verify=function(t,e){var r=void 0,n=void 0;return n=this._encodeMessage(t),r=this._decodeSignature(e),r=r.substr(-64),n===r},t.prototype._encodeMessage=function(t){return Object(u.a)(t)},t.prototype._decodeSignature=function(t){var e=void 0;return t=a.a.decode(t),t=i(t),t=this._parseBigInt(t,16),e=t.modPowInt(this._e,this._n),e=e.toString(16)},t.prototype._parseBigInt=function(t,e){return new s.a(t,e)},t.prototype._parseLicense=function(){"string"==typeof this._l&&this._jsonValid()&&(this._sig=this._decLic[p("c2lnbmF0dXJl")]||"",delete this._decLic[p("c2lnbmF0dXJl")],this._sig=this._sig.replace(/[^A-Za-z0-9+\/=]/g,""),this._message=this._l.replace(new RegExp(',"'+p("c2lnbmF0dXJl")+'":"([^"]*)"'),""))},t}();e.a=f},function(t,e,r){"use strict";function n(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function i(){return new n(null)}function o(t,e,r,n,i,o){for(;--o>=0;){var s=e*this[t++]+r[n]+i;i=Math.floor(s/67108864),r[n++]=67108863&s}return i}function s(t,e,r,n,i,o){for(var s=32767&e,a=e>>15;--o>=0;){var h=32767&this[t],u=this[t++]>>15,c=a*h+u*s;h=s*h+((32767&c)<<15)+r[n]+(1073741823&i),i=(h>>>30)+(c>>>15)+a*u+(i>>>30),r[n++]=1073741823&h}return i}function a(t,e,r,n,i,o){for(var s=16383&e,a=e>>14;--o>=0;){var h=16383&this[t],u=this[t++]>>14,c=a*h+u*s;h=s*h+((16383&c)<<14)+r[n]+i,i=(h>>28)+(c>>14)+a*u,r[n++]=268435455&h}return i}function h(t){return oe.charAt(t)}function u(t,e){var r=se[t.charCodeAt(e)];return null==r?-1:r}function c(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function p(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}function f(t){var e=i();return e.fromInt(t),e}function l(t,e){var r;if(16==e)r=4;else if(8==e)r=3;else if(256==e)r=8;else if(2==e)r=1;else if(32==e)r=5;else{if(4!=e)return void this.fromRadix(t,e);r=2}this.t=0,this.s=0;for(var i=t.length,o=!1,s=0;--i>=0;){var a=8==r?255&t[i]:u(t,i);a<0?"-"==t.charAt(i)&&(o=!0):(o=!1,0==s?this[this.t++]=a:s+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&n.ZERO.subTo(this,this)}function d(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function _(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,n=(1<<e)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(r=this[s]>>a)>0&&(i=!0,o=h(r));s>=0;)a<e?(r=(this[s]&(1<<a)-1)<<e-a,r|=this[--s]>>(a+=this.DB-e)):(r=this[s]>>(a-=e)&n,a<=0&&(a+=this.DB,--s)),r>0&&(i=!0),i&&(o+=h(r));return i?o:"0"}function y(){var t=i();return n.ZERO.subTo(this,t),t}function g(){return this.s<0?this.negate():this}function v(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0}function m(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function b(){return this.t<=0?0:this.DB*(this.t-1)+m(this[this.t-1]^this.s&this.DM)}function T(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s}function x(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s}function w(t,e){var r,n=t%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(t/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)e[r+s+1]=this[r]>>i|a,a=(this[r]&o)<<n;for(r=s-1;r>=0;--r)e[r]=0;e[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function E(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)return void(e.t=0);var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)e[s-r-1]|=(this[s]&o)<<i,e[s-r]=this[s]>>n;n>0&&(e[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}function O(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]-t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t[r],e[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[r++]=this.DV+n:n>0&&(e[r++]=n),e.t=r,e.clamp()}function R(t,e){var r=this.abs(),i=t.abs(),o=r.t;for(e.t=o+i.t;--o>=0;)e[o]=0;for(o=0;o<i.t;++o)e[o+r.t]=r.am(0,i[o],e,o,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&n.ZERO.subTo(e,e)}function C(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()}function S(t,e,r){var o=t.abs();if(!(o.t<=0)){var s=this.abs();if(s.t<o.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=i());var a=i(),h=this.s,u=t.s,c=this.DB-m(o[o.t-1]);c>0?(o.lShiftTo(c,a),s.lShiftTo(c,r)):(o.copyTo(a),s.copyTo(r));var p=a.t,f=a[p-1];if(0!=f){var l=f*(1<<this.F1)+(p>1?a[p-2]>>this.F2:0),d=this.FV/l,_=(1<<this.F1)/l,y=1<<this.F2,g=r.t,v=g-p,b=null==e?i():e;for(a.dlShiftTo(v,b),r.compareTo(b)>=0&&(r[r.t++]=1,r.subTo(b,r)),n.ONE.dlShiftTo(p,b),b.subTo(a,a);a.t<p;)a[a.t++]=0;for(;--v>=0;){var T=r[--g]==f?this.DM:Math.floor(r[g]*d+(r[g-1]+y)*_);if((r[g]+=a.am(0,T,r,v,0,p))<T)for(a.dlShiftTo(v,b),r.subTo(b,r);r[g]<--T;)r.subTo(b,r)}null!=e&&(r.drShiftTo(p,e),h!=u&&n.ZERO.subTo(e,e)),r.t=p,r.clamp(),c>0&&r.rShiftTo(c,r),h<0&&n.ZERO.subTo(r,r)}}}function F(t){var e=i();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(n.ZERO)>0&&t.subTo(e,e),e}function A(t){this.m=t}function D(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function L(t){return t}function k(t){t.divRemTo(this.m,null,t)}function B(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function I(t,e){t.squareTo(e),this.reduce(e)}function M(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function U(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function N(t){var e=i();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(n.ZERO)>0&&this.m.subTo(e,e),e}function j(t){var e=i();return t.copyTo(e),this.reduce(e),e}function P(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],n=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t[r]+=this.m.am(0,n,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function G(t,e){t.squareTo(e),this.reduce(e)}function V(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function z(){return 0==(this.t>0?1&this[0]:this.s)}function W(t,e){if(t>4294967295||t<1)return n.ONE;var r=i(),o=i(),s=e.convert(this),a=m(t)-1;for(s.copyTo(r);--a>=0;)if(e.sqrTo(r,o),(t&1<<a)>0)e.mulTo(o,s,r);else{var h=r;r=o,o=h}return e.revert(r)}function q(t,e){var r;return r=t<256||e.isEven()?new A(e):new U(e),this.exp(t,r)}function H(){var t=i();return this.copyTo(t),t}function X(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Y(){return 0==this.t?this.s:this[0]<<24>>24}function Z(){return 0==this.t?this.s:this[0]<<16>>16}function J(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function K(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function Q(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=f(r),o=i(),s=i(),a="";for(this.divRemTo(n,o,s);o.signum()>0;)a=(r+s.intValue()).toString(t).substr(1)+a,o.divRemTo(n,o,s);return s.intValue().toString(t)+a}function $(t,e){this.fromInt(0),null==e&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),o=!1,s=0,a=0,h=0;h<t.length;++h){var c=u(t,h);c<0?"-"==t.charAt(h)&&0==this.signum()&&(o=!0):(a=e*a+c,++s>=r&&(this.dMultiply(i),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(a,0)),o&&n.ZERO.subTo(this,this)}function tt(t,e,r){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(n.ONE.shiftLeft(t-1),ht,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(n.ONE.shiftLeft(t-1),this);else{var i=new Array,o=7&t;i.length=1+(t>>3),e.nextBytes(i),o>0?i[0]&=(1<<o)-1:i[0]=0,this.fromString(i,256)}}function et(){var t=this.t,e=new Array;e[0]=this.s;var r,n=this.DB-t*this.DB%8,i=0;if(t-- >0)for(n<this.DB&&(r=this[t]>>n)!=(this.s&this.DM)>>n&&(e[i++]=r|this.s<<this.DB-n);t>=0;)n<8?(r=(this[t]&(1<<n)-1)<<8-n,r|=this[--t]>>(n+=this.DB-8)):(r=this[t]>>(n-=8)&255,n<=0&&(n+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(e[i++]=r);return e}function rt(t){return 0==this.compareTo(t)}function nt(t){return this.compareTo(t)<0?this:t}function it(t){return this.compareTo(t)>0?this:t}function ot(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r[n]=e(this[n],t[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r[n]=e(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r[n]=e(i,t[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function st(t,e){return t&e}function at(t){var e=i();return this.bitwiseTo(t,st,e),e}function ht(t,e){return t|e}function ut(t){var e=i();return this.bitwiseTo(t,ht,e),e}function ct(t,e){return t^e}function pt(t){var e=i();return this.bitwiseTo(t,ct,e),e}function ft(t,e){return t&~e}function lt(t){var e=i();return this.bitwiseTo(t,ft,e),e}function dt(){for(var t=i(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function _t(t){var e=i();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function yt(t){var e=i();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function gt(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function vt(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+gt(this[t]);return this.s<0?this.t*this.DB:-1}function mt(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function bt(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=mt(this[r]^e);return t}function Tt(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function xt(t,e){var r=n.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function wt(t){return this.changeBit(t,ht)}function Et(t){return this.changeBit(t,ft)}function Ot(t){return this.changeBit(t,ct)}function Rt(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]+t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t[r],e[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e[r++]=n:n<-1&&(e[r++]=this.DV+n),e.t=r,e.clamp()}function Ct(t){var e=i();return this.addTo(t,e),e}function St(t){var e=i();return this.subTo(t,e),e}function Ft(t){var e=i();return this.multiplyTo(t,e),e}function At(){var t=i();return this.squareTo(t),t}function Dt(t){var e=i();return this.divRemTo(t,e,null),e}function Lt(t){var e=i();return this.divRemTo(t,null,e),e}function kt(t){var e=i(),r=i();return this.divRemTo(t,e,r),new Array(e,r)}function Bt(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function It(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function Mt(){}function Ut(t){return t}function Nt(t,e,r){t.multiplyTo(e,r)}function jt(t,e){t.squareTo(e)}function Pt(t){return this.exp(t,new Mt)}function Gt(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,t[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t[n],r,n,0,e-n);r.clamp()}function Vt(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r[this.t+n-e]=this.am(e-n,t[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function zt(t){this.r2=i(),this.q3=i(),n.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Wt(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=i();return t.copyTo(e),this.reduce(e),e}function qt(t){return t}function Ht(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Xt(t,e){t.squareTo(e),this.reduce(e)}function Yt(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Zt(t,e){var r,n,o=t.bitLength(),s=f(1);if(o<=0)return s;r=o<18?1:o<48?3:o<144?4:o<768?5:6,n=o<8?new A(e):e.isEven()?new zt(e):new U(e);var a=new Array,h=3,u=r-1,c=(1<<r)-1;if(a[1]=n.convert(this),r>1){var p=i();for(n.sqrTo(a[1],p);h<=c;)a[h]=i(),n.mulTo(p,a[h-2],a[h]),h+=2}var l,d,_=t.t-1,y=!0,g=i();for(o=m(t[_])-1;_>=0;){for(o>=u?l=t[_]>>o-u&c:(l=(t[_]&(1<<o+1)-1)<<u-o,_>0&&(l|=t[_-1]>>this.DB+o-u)),h=r;0==(1&l);)l>>=1,--h;if((o-=h)<0&&(o+=this.DB,--_),y)a[l].copyTo(s),y=!1;else{for(;h>1;)n.sqrTo(s,g),n.sqrTo(g,s),h-=2;h>0?n.sqrTo(s,g):(d=s,s=g,g=d),n.mulTo(g,a[l],s)}for(;_>=0&&0==(t[_]&1<<o);)n.sqrTo(s,g),d=s,s=g,g=d,--o<0&&(o=this.DB-1,--_)}return n.revert(s)}function Jt(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function Kt(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this[n])%t;return r}function Qt(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return n.ZERO;for(var r=t.clone(),i=this.clone(),o=f(1),s=f(0),a=f(0),h=f(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?(o.isEven()&&s.isEven()||(o.addTo(this,o),s.subTo(t,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?(a.isEven()&&h.isEven()||(a.addTo(this,a),h.subTo(t,h)),a.rShiftTo(1,a)):h.isEven()||h.subTo(t,h),h.rShiftTo(1,h);r.compareTo(i)>=0?(r.subTo(i,r),e&&o.subTo(a,o),s.subTo(h,s)):(i.subTo(r,i),e&&a.subTo(o,a),h.subTo(s,h))}return 0!=i.compareTo(n.ONE)?n.ZERO:h.compareTo(t)>=0?h.subtract(t):h.signum()<0?(h.addTo(t,h),h.signum()<0?h.add(t):h):h}function $t(t){var e,r=this.abs();if(1==r.t&&r[0]<=ae[ae.length-1]){for(e=0;e<ae.length;++e)if(r[0]==ae[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<ae.length;){for(var n=ae[e],i=e+1;i<ae.length&&n<he;)n*=ae[i++];for(n=r.modInt(n);e<i;)if(n%ae[e++]==0)return!1}return r.millerRabin(t)}function te(t){var e=this.subtract(n.ONE),r=e.getLowestSetBit();if(r<=0)return!1;var o=e.shiftRight(r);(t=t+1>>1)>ae.length&&(t=ae.length);for(var s=i(),a=0;a<t;++a){s.fromInt(ae[Math.floor(Math.random()*ae.length)]);var h=s.modPow(o,this);if(0!=h.compareTo(n.ONE)&&0!=h.compareTo(e)){for(var u=1;u++<r&&0!=h.compareTo(e);)if(h=h.modPowInt(2,this),0==h.compareTo(n.ONE))return!1;if(0!=h.compareTo(e))return!1}}return!0}/*!
 * Copyright (c) 2003-2005  Tom Wu
 * All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
 * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER
 * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF
 * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT
 * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * In addition, the following condition applies:
 *
 * All redistributions must retain an intact copy of this copyright notice
 * and disclaimer.
 */
var ee,re=re||{};"Microsoft Internet Explorer"==re.appName?(n.prototype.am=s,ee=30):"Netscape"!=re.appName?(n.prototype.am=o,ee=26):(n.prototype.am=a,ee=28),n.prototype.DB=ee,n.prototype.DM=(1<<ee)-1,n.prototype.DV=1<<ee;n.prototype.FV=Math.pow(2,52),n.prototype.F1=52-ee,n.prototype.F2=2*ee-52;var ne,ie,oe="0123456789abcdefghijklmnopqrstuvwxyz",se=new Array;for(ne="0".charCodeAt(0),ie=0;ie<=9;++ie)se[ne++]=ie;for(ne="a".charCodeAt(0),ie=10;ie<36;++ie)se[ne++]=ie;for(ne="A".charCodeAt(0),ie=10;ie<36;++ie)se[ne++]=ie;A.prototype.convert=D,A.prototype.revert=L,A.prototype.reduce=k,A.prototype.mulTo=B,A.prototype.sqrTo=I,U.prototype.convert=N,U.prototype.revert=j,U.prototype.reduce=P,U.prototype.mulTo=V,U.prototype.sqrTo=G,n.prototype.copyTo=c,n.prototype.fromInt=p,n.prototype.fromString=l,n.prototype.clamp=d,n.prototype.dlShiftTo=T,n.prototype.drShiftTo=x,n.prototype.lShiftTo=w,n.prototype.rShiftTo=E,n.prototype.subTo=O,n.prototype.multiplyTo=R,n.prototype.squareTo=C,n.prototype.divRemTo=S,n.prototype.invDigit=M,n.prototype.isEven=z,n.prototype.exp=W,n.prototype.toString=_,n.prototype.negate=y,n.prototype.abs=g,n.prototype.compareTo=v,n.prototype.bitLength=b,n.prototype.mod=F,n.prototype.modPowInt=q,n.ZERO=f(0),n.ONE=f(1),Mt.prototype.convert=Ut,Mt.prototype.revert=Ut,Mt.prototype.mulTo=Nt,Mt.prototype.sqrTo=jt,zt.prototype.convert=Wt,zt.prototype.revert=qt,zt.prototype.reduce=Ht,zt.prototype.mulTo=Yt,zt.prototype.sqrTo=Xt;var ae=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],he=(1<<26)/ae[ae.length-1];n.prototype.chunkSize=J,n.prototype.toRadix=Q,n.prototype.fromRadix=$,n.prototype.fromNumber=tt,n.prototype.bitwiseTo=ot,n.prototype.changeBit=xt,n.prototype.addTo=Rt,n.prototype.dMultiply=Bt,n.prototype.dAddOffset=It,n.prototype.multiplyLowerTo=Gt,n.prototype.multiplyUpperTo=Vt,n.prototype.modInt=Kt,n.prototype.millerRabin=te,n.prototype.clone=H,n.prototype.intValue=X,n.prototype.byteValue=Y,n.prototype.shortValue=Z,n.prototype.signum=K,n.prototype.toByteArray=et,n.prototype.equals=rt,n.prototype.min=nt,n.prototype.max=it,n.prototype.and=at,n.prototype.or=ut,n.prototype.xor=pt,n.prototype.andNot=lt,n.prototype.not=dt,n.prototype.shiftLeft=_t,n.prototype.shiftRight=yt,n.prototype.getLowestSetBit=vt,n.prototype.bitCount=bt,n.prototype.testBit=Tt,n.prototype.setBit=wt,n.prototype.clearBit=Et,n.prototype.flipBit=Ot,n.prototype.add=Ct,n.prototype.subtract=St,n.prototype.multiply=Ft,n.prototype.divide=Dt,n.prototype.remainder=Lt,n.prototype.divideAndRemainder=kt,n.prototype.modPow=Zt,n.prototype.modInverse=Qt,n.prototype.pow=Pt,n.prototype.gcd=Jt,n.prototype.isProbablePrime=$t,n.prototype.square=At,e.a=n},function(t,e,r){"use strict";(function(t){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(4),o=r(72),s=r.n(o),a="undefined"!=typeof window?window:t,h=function(){function t(e){n(this,t),this._url=e,this._parsedUrl=s.a.parse(this._url,!0)}return t.prototype._isJSONPRequest=function(){var t=this._parsedUrl.query;for(var e in t){if("?"===t[e])return!0}return!1},t.prototype.load=function(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON()},t.prototype._loadJSON=function(){var t=this;return new i.a(function(e,r){var n=void 0;a.XDomainRequest?(n=new a.XDomainRequest,n.onload=function(){var t=JSON.parse(n.responseText);e(t)},n.onerror=function(t){r(t)},n.open("GET",t._url,!0),n.send()):a.XMLHttpRequest&&(n=new XMLHttpRequest,n.onreadystatechange=function(t){if(4===n.readyState)if(200===n.status){var i=JSON.parse(n.responseText);e(i)}else r(new Error("HTTP Status "+n.status))},n.open("GET",t._url,!0),n.send())})},t.prototype._loadJSONP=function(){var t=this,e=!1,r=!1,n="pesdk"+Math.round(99999999999999*Math.random());return new i.a(function(i,o){var s=t._createJSONPNode(n);a[n]=function(n){t._removeJSONPNode(s),e||(r=!0,i(n))},a.setTimeout(function(){r||(t._removeJSONPNode(s),e=!0,o(new Error("Timeout of 5 seconds exceeded.")))},5e3)})},t.prototype._createJSONPNode=function(t){var e=this._buildJSONPUrl(t),r=document.querySelector("head"),n=document.createElement("script");return n.src=e,r.appendChild(n),n},t.prototype._removeJSONPNode=function(t){t.parentNode.removeChild(t)},t.prototype._buildJSONPUrl=function(t){var e=this._parsedUrl.query,r=null;for(var n in e)if("?"===e[n]){r=n;break}return delete this._parsedUrl.search,e[r]=t,s.a.format(this._parsedUrl)},t}();e.a=h}).call(e,r(7))},function(t,e,r){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(t,e,r){if(t&&u.isObject(t)&&t instanceof n)return t;var i=new n;return i.parse(t,e,r),i}function o(t){return u.isString(t)&&(t=i(t)),t instanceof n?t.format():n.prototype.format.call(t)}function s(t,e){return i(t,!1,!0).resolve(e)}function a(t,e){return t?i(t,!1,!0).resolveObject(e):e}var h=r(73),u=r(75);e.parse=i,e.resolve=s,e.resolveObject=a,e.format=o,e.Url=n;var c=/^([a-z0-9.+-]+:)/i,p=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["<",">",'"',"`"," ","\r","\n","\t"],d=["{","}","|","\\","^","`"].concat(l),_=["'"].concat(d),y=["%","/","?",";","#"].concat(_),g=["/","?","#"],v=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,b={javascript:!0,"javascript:":!0},T={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},w=r(76);n.prototype.parse=function(t,e,r){if(!u.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=-1!==n&&n<t.indexOf("#")?"?":"#",o=t.split(i),s=/\\/g;o[0]=o[0].replace(s,"/"),t=o.join(i);var a=t;if(a=a.trim(),!r&&1===t.split("#").length){var p=f.exec(a);if(p)return this.path=a,this.href=a,this.pathname=p[1],p[2]?(this.search=p[2],this.query=e?w.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var l=c.exec(a);if(l){l=l[0];var d=l.toLowerCase();this.protocol=d,a=a.substr(l.length)}if(r||l||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===a.substr(0,2);!E||l&&T[l]||(a=a.substr(2),this.slashes=!0)}if(!T[l]&&(E||l&&!x[l])){for(var O=-1,R=0;R<g.length;R++){var C=a.indexOf(g[R]);-1!==C&&(-1===O||C<O)&&(O=C)}var S,F;F=-1===O?a.lastIndexOf("@"):a.lastIndexOf("@",O),-1!==F&&(S=a.slice(0,F),a=a.slice(F+1),this.auth=decodeURIComponent(S)),O=-1;for(var R=0;R<y.length;R++){var C=a.indexOf(y[R]);-1!==C&&(-1===O||C<O)&&(O=C)}-1===O&&(O=a.length),this.host=a.slice(0,O),a=a.slice(O),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var D=this.hostname.split(/\./),R=0,L=D.length;R<L;R++){var k=D[R];if(k&&!k.match(v)){for(var B="",I=0,M=k.length;I<M;I++)k.charCodeAt(I)>127?B+="x":B+=k[I];if(!B.match(v)){var U=D.slice(0,R),N=D.slice(R+1),j=k.match(m);j&&(U.push(j[1]),N.unshift(j[2])),N.length&&(a="/"+N.join(".")+a),this.hostname=U.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),A||(this.hostname=h.toASCII(this.hostname));var P=this.port?":"+this.port:"",G=this.hostname||"";this.host=G+P,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!b[d])for(var R=0,L=_.length;R<L;R++){var V=_[R];if(-1!==a.indexOf(V)){var z=encodeURIComponent(V);z===V&&(z=escape(V)),a=a.split(V).join(z)}}var W=a.indexOf("#");-1!==W&&(this.hash=a.substr(W),a=a.slice(0,W));var q=a.indexOf("?");if(-1!==q?(this.search=a.substr(q),this.query=a.substr(q+1),e&&(this.query=w.parse(this.query)),a=a.slice(0,q)):e&&(this.search="",this.query={}),a&&(this.pathname=a),x[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var P=this.pathname||"",H=this.search||"";this.path=P+H}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&u.isObject(this.query)&&Object.keys(this.query).length&&(o=w.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||x[e])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+i+r+s+n},n.prototype.resolve=function(t){return this.resolveObject(i(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(u.isString(t)){var e=new n;e.parse(t,!1,!0),t=e}for(var r=new n,i=Object.keys(this),o=0;o<i.length;o++){var s=i[o];r[s]=this[s]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),h=0;h<a.length;h++){var c=a[h];"protocol"!==c&&(r[c]=t[c])}return x[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!x[t.protocol]){for(var p=Object.keys(t),f=0;f<p.length;f++){var l=p[f];r[l]=t[l]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||T[t.protocol])r.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var _=r.pathname||"",y=r.search||"";r.path=_+y}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var g=r.pathname&&"/"===r.pathname.charAt(0),v=t.host||t.pathname&&"/"===t.pathname.charAt(0),m=v||g||r.host&&t.pathname,b=m,w=r.pathname&&r.pathname.split("/")||[],d=t.pathname&&t.pathname.split("/")||[],E=r.protocol&&!x[r.protocol];if(E&&(r.hostname="",r.port=null,r.host&&(""===w[0]?w[0]=r.host:w.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),m=m&&(""===d[0]||""===w[0])),v)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,w=d;else if(d.length)w||(w=[]),w.pop(),w=w.concat(d),r.search=t.search,r.query=t.query;else if(!u.isNullOrUndefined(t.search)){if(E){r.hostname=r.host=w.shift();var O=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");O&&(r.auth=O.shift(),r.host=r.hostname=O.shift())}return r.search=t.search,r.query=t.query,u.isNull(r.pathname)&&u.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!w.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var R=w.slice(-1)[0],C=(r.host||t.host||w.length>1)&&("."===R||".."===R)||""===R,S=0,F=w.length;F>=0;F--)R=w[F],"."===R?w.splice(F,1):".."===R?(w.splice(F,1),S++):S&&(w.splice(F,1),S--);if(!m&&!b)for(;S--;S)w.unshift("..");!m||""===w[0]||w[0]&&"/"===w[0].charAt(0)||w.unshift(""),C&&"/"!==w.join("/").substr(-1)&&w.push("");var A=""===w[0]||w[0]&&"/"===w[0].charAt(0);if(E){r.hostname=r.host=A?"":w.length?w.shift():"";var O=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");O&&(r.auth=O.shift(),r.host=r.hostname=O.shift())}return m=m||r.host&&w.length,m&&!A&&w.unshift(""),w.length?r.pathname=w.join("/"):(r.pathname=null,r.path=null),u.isNull(r.pathname)&&u.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var t=this.host,e=p.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,r){(function(t,n){var i;!function(o){function s(t){throw new RangeError(L[t])}function a(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function h(t,e){var r=t.split("@"),n="";return r.length>1&&(n=r[0]+"@",t=r[1]),t=t.replace(D,"."),n+a(t.split("."),e).join(".")}function u(t){for(var e,r,n=[],i=0,o=t.length;i<o;)e=t.charCodeAt(i++),e>=55296&&e<=56319&&i<o?(r=t.charCodeAt(i++),56320==(64512&r)?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--)):n.push(e);return n}function c(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=I(t>>>10&1023|55296),t=56320|1023&t),e+=I(t)}).join("")}function p(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:T}function f(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function l(t,e,r){var n=0;for(t=r?B(t/O):t>>1,t+=B(t/e);t>k*w>>1;n+=T)t=B(t/k);return B(n+(k+1)*t/(t+E))}function d(t){var e,r,n,i,o,a,h,u,f,d,_=[],y=t.length,g=0,v=C,m=R;for(r=t.lastIndexOf(S),r<0&&(r=0),n=0;n<r;++n)t.charCodeAt(n)>=128&&s("not-basic"),_.push(t.charCodeAt(n));for(i=r>0?r+1:0;i<y;){for(o=g,a=1,h=T;i>=y&&s("invalid-input"),u=p(t.charCodeAt(i++)),(u>=T||u>B((b-g)/a))&&s("overflow"),g+=u*a,f=h<=m?x:h>=m+w?w:h-m,!(u<f);h+=T)d=T-f,a>B(b/d)&&s("overflow"),a*=d;e=_.length+1,m=l(g-o,e,0==o),B(g/e)>b-v&&s("overflow"),v+=B(g/e),g%=e,_.splice(g++,0,v)}return c(_)}function _(t){var e,r,n,i,o,a,h,c,p,d,_,y,g,v,m,E=[];for(t=u(t),y=t.length,e=C,r=0,o=R,a=0;a<y;++a)(_=t[a])<128&&E.push(I(_));for(n=i=E.length,i&&E.push(S);n<y;){for(h=b,a=0;a<y;++a)(_=t[a])>=e&&_<h&&(h=_);for(g=n+1,h-e>B((b-r)/g)&&s("overflow"),r+=(h-e)*g,e=h,a=0;a<y;++a)if(_=t[a],_<e&&++r>b&&s("overflow"),_==e){for(c=r,p=T;d=p<=o?x:p>=o+w?w:p-o,!(c<d);p+=T)m=c-d,v=T-d,E.push(I(f(d+m%v,0))),c=B(m/v);E.push(I(f(c,0))),o=l(r,g,n==i),r=0,++n}++r,++e}return E.join("")}function y(t){return h(t,function(t){return F.test(t)?d(t.slice(4).toLowerCase()):t})}function g(t){return h(t,function(t){return A.test(t)?"xn--"+_(t):t})}var v=("object"==typeof e&&e&&e.nodeType,"object"==typeof t&&t&&t.nodeType,"object"==typeof n&&n);var m,b=2147483647,T=36,x=1,w=26,E=38,O=700,R=72,C=128,S="-",F=/^xn--/,A=/[^\x20-\x7E]/,D=/[\x2E\u3002\uFF0E\uFF61]/g,L={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},k=T-x,B=Math.floor,I=String.fromCharCode;m={version:"1.4.1",ucs2:{decode:u,encode:c},decode:d,encode:_,toASCII:g,toUnicode:y},void 0!==(i=function(){return m}.call(e,r,e,t))&&(t.exports=i)}()}).call(e,r(74)(t),r(7))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,r){"use strict";e.decode=e.parse=r(77),e.encode=e.stringify=r(78)},function(t,e,r){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,r,o){e=e||"&",r=r||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var h=1e3;o&&"number"==typeof o.maxKeys&&(h=o.maxKeys);var u=t.length;h>0&&u>h&&(u=h);for(var c=0;c<u;++c){var p,f,l,d,_=t[c].replace(a,"%20"),y=_.indexOf(r);y>=0?(p=_.substr(0,y),f=_.substr(y+1)):(p=_,f=""),l=decodeURIComponent(p),d=decodeURIComponent(f),n(s,l)?i(s[l])?s[l].push(d):s[l]=[s[l],d]:s[l]=d}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,r){"use strict";function n(t,e){if(t.map)return t.map(e);for(var r=[],n=0;n<t.length;n++)r.push(e(t[n],n));return r}var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,r,a){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?n(s(t),function(s){var a=encodeURIComponent(i(s))+r;return o(t[s])?n(t[s],function(t){return a+encodeURIComponent(i(t))}).join(e):a+encodeURIComponent(i(t[s]))}).join(e):a?encodeURIComponent(i(a))+r+encodeURIComponent(i(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},function(t,e,r){"use strict";/*!
 *  Secure Hash Algorithm (SHA256)
 *  http://www.webtoolkit.info/
 *
 *  Original code by Angel Marin, Paul Johnston.
 */
function n(t){function e(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function r(t,e){return t>>>e|t<<32-e}function n(t,e){return t>>>e}function i(t,e,r){return t&e^~t&r}function o(t,e,r){return t&e^t&r^e&r}function s(t){return r(t,2)^r(t,13)^r(t,22)}function a(t){return r(t,6)^r(t,11)^r(t,25)}function h(t){return r(t,7)^r(t,18)^n(t,3)}function u(t){return r(t,17)^r(t,19)^n(t,10)}var c=8,p=0;return t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r);n<128?e+=String.fromCharCode(n):n>127&&n<2048?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e}(t),function(t){for(var e=p?"0123456789ABCDEF":"0123456789abcdef",r="",n=0;n<4*t.length;n++)r+=e.charAt(t[n>>2]>>8*(3-n%4)+4&15)+e.charAt(t[n>>2]>>8*(3-n%4)&15);return r}(function(t,r){var n,c,p,f,l,d,_,y,g,v,m,b,T=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),x=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),w=new Array(64);t[r>>5]|=128<<24-r%32,t[15+(r+64>>9<<4)]=r;for(var g=0;g<t.length;g+=16){n=x[0],c=x[1],p=x[2],f=x[3],l=x[4],d=x[5],_=x[6],y=x[7];for(var v=0;v<64;v++)w[v]=v<16?t[v+g]:e(e(e(u(w[v-2]),w[v-7]),h(w[v-15])),w[v-16]),m=e(e(e(e(y,a(l)),i(l,d,_)),T[v]),w[v]),b=e(s(n),o(n,c,p)),y=_,_=d,d=l,l=e(f,m),f=p,p=c,c=n,n=e(m,b);x[0]=e(n,x[0]),x[1]=e(c,x[1]),x[2]=e(p,x[2]),x[3]=e(f,x[3]),x[4]=e(l,x[4]),x[5]=e(d,x[5]),x[6]=e(_,x[6]),x[7]=e(y,x[7])}return x}(function(t){for(var e=Array(),r=(1<<c)-1,n=0;n<t.length*c;n+=c)e[n>>5]|=(t.charCodeAt(n/c)&r)<<24-n%32;return e}(t),t.length*c))}r.d(e,"a",function(){return n})},function(t,e,r){"use strict";(function(t){r.d(e,"b",function(){return i}),r.d(e,"a",function(){return o});for(var n="undefined"==typeof window?t:window,i=n.requestAnimationFrame,o=n.cancelAnimationFrame,s=0,a=["ms","moz","webkit","o"],h=0;h<a.length&&!i;++h)i=n[a[h]+"RequestAnimationFrame"],o=n[a[h]+"CancelAnimationFrame"]||n[a[h]+"CancelRequestAnimationFrame"];i&&(i=i.bind(n)),o&&(o=o.bind(n)),i||(i=function(t,e){var r=(new Date).getTime(),n=Math.max(0,16-(r-s)),i=setTimeout(function(){t(r+n)},n);return s=r+n,i}),o||(o=function(t){clearTimeout(t)})}).call(e,r(7))},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(5),a=r(4),h=r(6),u=r(39),c=s.Constants.OptionType,p=function(t){function e(){return n(this,e),i(this,t.apply(this,arguments))}return o(e,t),e.prototype._getRotation=function(){var t=0;switch(this.getTags().Orientation){case 7:case 8:t=-90;break;case 3:case 4:t=-180;break;case 5:case 6:t=90}return t},e.prototype._getFlipVertically=function(){return-1!==[5,7].indexOf(this.getTags().Orientation)},e.prototype._getFlipHorizontally=function(){return-1!==[2,4].indexOf(this.getTags().Orientation)},e.prototype._getFinalOptions=function(){return{rotation:this._getRotation(),flipVertically:this._getFlipVertically(),flipHorizontally:this._getFlipHorizontally()}},e.prototype._render=function(t){var e=this._getFinalOptions(),r=e.rotation%360,n=r*(Math.PI/180);this._sprite.setScale(e.flipHorizontally?-1:1,e.flipVertically?-1:1),this._sprite.setRotation(n),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();var i=this._sprite.getBounds();return this._renderTexture.resizeTo(new h.a(i.width,i.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2)),this._renderTexture.render(this._container),a.a.resolve()},e.prototype.getNewDimensions=function(t){var e=this._getFinalOptions();return t=t.clone(),e.rotation%180&&t.flip(),t},e}(u.a);p.identifier="exif-orientation",p.prototype.availableOptions={tags:{type:c.OBJECT,default:{}}},e.a=p},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(5),o=function(){function t(e){n(this,t),this._version=e,this._check()}return t.prototype._check=function(){var t=this;if("undefined"==typeof document)return i.Log.info(this.constructor.name,"Not in browser environment. Version check skipped.");var e=this;window.imglySDKVersionCallback=function(r){r.outdated&&i.Log.warn(t.constructor.name,"Your Version "+e._version+" is outdated. Current version is "+r.version+".")};var r=document.createElement("script");r.src="https://www.photoeditorsdk.com/version.json?sdk=html5&jsoncallback=imglySDKVersionCallback&version="+this._version,r.async=!0,document.getElementsByTagName("head")[0].appendChild(r)},t}();e.a=o},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(24),o=r(25),s=o.a.MARKERS,a=function(){function t(e){n(this,t),this._buf=e,this._stream=new i.a(this._buf),this._stream.setHead(0)}return t.prototype.isValid=function(){if(this._stream.setHead(0),this._stream.readInt16()!==s.APP0)return!1;if(!(this._stream.readInt16()>=16))return!1;var t=this._stream.readString(4),e=this._stream.readInt8();return"JFIF"===t&&0===e},t.prototype.setUnitDensity=function(t){this._stream.setHead(11),this._stream.writeInt8(t)},t.prototype.setDensityX=function(t){this._stream.setHead(12),this._stream.writeInt16(t)},t.prototype.setDensityY=function(t){this._stream.setHead(13),this._stream.writeInt16(t)},t.prototype.getUnitDensity=function(){return this._stream.setHead(11),this._stream.readInt8()},t.prototype.getDensityX=function(){return this._stream.setHead(12),this._stream.readInt16()},t.prototype.getDensityY=function(){return this._stream.setHead(14),this._stream.readInt16()},t}();e.a=a},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(24),o=r(25),s=r(1),a=s.a.invariant,h=o.a.MARKERS,u=o.a.EXIF_TAGS,c=function(){function t(e){n(this,t),this._buf=e,this._stream=new i.a(this._buf),this._stream.setHead(0),this._parse()}return t.prototype.isValid=function(){return this._stream.setHead(0),this._stream.readInt16()===h.EXIF&&(this._stream.readInt16()>0&&"Exif"===this._stream.readString(4))},t.prototype._parse=function(){if(this.isValid()){this._stream.setHead(10);var t=this._stream.getHead(),e=!1,r=this._stream.readInt16();18761===r?e=!1:19789===r?e=!0:a(!1,"Invalid TIFF data: No endian type found"),a(42===this._stream.readInt16(!e),"Invalid TIFF data: No 0x002A");var n=this._stream.readInt32(!e);a(n>=8,"Invalid TIFF data: First IFD offset < 8");var i=t+n,o=this._readTags(this._stream,t,i,e);this._tags=o.tags,this._tagData=o.tagData}},t.prototype.getTags=function(){return this._tags},t.prototype.getTagData=function(){return this._tagData},t.prototype.setOrientation=function(t){if(this._tagData.Orientation){var e=this._tagData.Orientation.entryOffset;this._stream.setHead(e+8),this._stream.writeInt16(t)}},t.prototype._readTags=function(t,e,r,n){t.setHead(r);for(var i=t.readInt16(!n),o={},s=[],a=0;a<i;a++){var h=r+12*a+2;t.setHead(h);var c=t.readInt16(!n),p=void 0,f=void 0,l=void 0;if(u[c]){c=u[c],p=t.readInt16(!n),f=t.readInt32(!n),l=t.readInt32(!n)+e;var d=null;switch(p){case 1:case 7:if(1===f)d=t.readInt8(!n);else{d=[];for(var _=0;_<f;_++)d.push(t.readInt8(!n))}break;case 2:t.setHead(f>4?l:h+8),d=t.readString(f);break;case 3:if(t.setHead(f>2?l:h+8),1===f)d=t.readInt16(!n);else{d=[];for(var y=0;y<f;y++)d.push(t.readInt16(!n))}break;case 4:case 9:if(t.setHead(f>1?l:h+8),1===f)d=t.readInt32(!n);else{d=[];for(var g=0;g<f;g++)d.push(t.readInt32(!n))}break;case 5:case 10:if(t.setHead(l),1===f){d=t.readInt32(!n)/t.readInt32(!n)}else{d=[];for(var v=0;v<f;v++){var m=t.readInt32(!n),b=t.readInt32(!n),T=m/b;d.push(T)}}}o[c]=d,s[c]={value:d,numValues:f,entryOffset:h,valueOffset:l,type:p}}}return{tags:o,tagData:s}},t.prototype.getBuffer=function(){return this._buf},t}();e.a=c},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=r(3),a=r(14),h=r(1),u=r(23),c=r(13),p=function(t){function e(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,e);var s=i(this,t.call(this,o));return s._sdk=r,s}return o(e,t),e.prototype.export=function(){var t=this,e=this._sdk.getRenderer(),r=this._options,n=r.renderType,i=r.imageFormat,o=r.quality;return this.validateSettings().then(function(){return t._prepareSDK()}).then(function(r){var a=e.getCanvas();e.isOfType(s.RendererType.WEBGL)&&(a=t._createCanvasFromTexture(r));var h=void 0;if(n===s.RenderType.IMAGE||n===s.RenderType.DATAURL){h="undefined"==typeof window?a.toDataURL(i):a.toDataURL(i,o);var c=t._sdk.getImage(),p=u.a.isJPEG(c.src),f=u.a.isJPEG(h);if(p&&f){var l=t._sdk.getExif();l&&(h=l.restoreSegments(h))}}if(n===s.RenderType.IMAGE){var d=void 0;return d=new Image,d.src=h,d}return n===s.RenderType.DATAURL?h:n===s.RenderType.BUFFER?a.toBuffer():n===s.RenderType.MSBLOB?a.msToBlob():n===s.RenderType.BLOB?new Promise(function(t,e){a.toBlob(function(e){t(e)},i,o)}):void 0}).then(function(e){return t._restoreSDK().then(function(){return e})})},e.prototype._prepareSDK=function(){var t=this._sdk.getRenderer();this._sdkSettings={dimensions:t.getDimensions().clone(),textureQuality:this._sdk.getTextureQuality(),pixelRatio:this._sdk.getPixelRatio(),renderMode:this._sdk.getRenderMode()},this._sdk.setRenderMode("export"),this._sdk.setTextureQuality(1);var e=t.isOfType(s.RendererType.CANVAS);t.setPixelRatio(1),t.resizeTo(this._sdk.getFinalDimensions(),e),this._sdk.setAllOperationsToDirty(!0);var r=this._sdk.getOperationsStack();return r.forEach(function(t){t.disposeRenderTextures()}),r.disableCache(),this._sdk.render()},e.prototype._restoreSDK=function(){this._sdk.getOperationsStack().enableCache(),this._sdk.setRenderMode(this._sdkSettings.renderMode);var t=this._sdk.getRenderer(),e=t.isOfType(s.RendererType.CANVAS);return t.setPixelRatio(this._sdkSettings.pixelRatio),t.resizeTo(this._sdkSettings.dimensions,e),this._sdk.setTextureQuality(this._sdkSettings.textureQuality),this._sdk.setAllOperationsToDirty(!0),this._sdk.render()},e.prototype._createCanvasFromTexture=function(t){var e=this._sdk.getRenderer(),r=this._sdk.getFinalDimensions(),n=this._sdk.getRenderer().getContext(),i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i);var o=t.getBaseTexture().getGLTextureForRenderer(e);n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o,0);var s=new Uint8Array(r.x*r.y*4);n.readPixels(0,0,r.x,r.y,n.RGBA,n.UNSIGNED_BYTE,s);var u=this._checkPixelsForTransparency(s),c=void 0;if(u){var p=new a.a.Sprite(t);p.setFilters([new a.a.Filters.UnpremultiplyFilter]);var f=new a.a.Container;f.addChild(p),c=new a.a.RenderTexture(e,r.x,r.y),c.render(f);var l=c.getBaseTexture().getGLTextureForRenderer(e);n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,l,0),n.readPixels(0,0,r.x,r.y,n.RGBA,n.UNSIGNED_BYTE,s),e.setRenderTarget(),c.dispose()}var d=h.a.createCanvas();d.width=r.x,d.height=r.y;var _=d.getContext("2d"),y=_.createImageData(r.x,r.y);return y.data.set(s),_.putImageData(y,0,0),n.deleteFramebuffer(i),d},e.prototype._checkPixelsForTransparency=function(t){for(var e=this._sdk.getFinalDimensions(),r=e.x*e.y*4,n=3;n<r;n+=4)if(255!==t[n])return!0;return!1},e}(c.a);p.prototype.availableOptions={renderType:{type:s.OptionType.STRING,available:h.a.values(s.RenderType),default:s.RenderType.IMAGE},imageFormat:{type:s.OptionType.STRING,available:h.a.values(s.ImageFormat),default:s.ImageFormat.PNG},quality:{type:s.OptionType.NUMBER,default:.8}},e.a=p},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(){n(this,t)}return t.current=function(){return"production"},t.isTest=function(){return!1},t.isDevelopment=function(){return!1},t.isProduction=function(){return!0},t}();e.a=i}])});