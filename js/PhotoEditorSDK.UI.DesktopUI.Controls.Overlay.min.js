!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("photoeditorsdk/PhotoEditorSDK.UI.DesktopUI.Core"),require("photoeditorsdk")):"function"==typeof define&&define.amd?define([["PhotoEditorSDK","UI","DesktopUI"],"photoeditorsdk"],t):"object"==typeof exports?exports._unexposedPESDK=t(require("photoeditorsdk/PhotoEditorSDK.UI.DesktopUI.Core"),require("photoeditorsdk")):e._unexposedPESDK=t(e.PhotoEditorSDK.UI.DesktopUI,e.PhotoEditorSDK)}("undefined"!=typeof self?self:this,function(e,t){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=71)}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},10:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(2),i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;o(this,e),this._queue=[],this._pendingPromises=0,this._maxConcurrency=t,this._maxQueueLength=n,this._minDelay=i,this._tick=this._tick.bind(this),this._lastPromiseDone=Date.now(),this._running=!0,this._animationFrameRequest=null,Object(r.b)(this._tick)}return e.prototype._tick=function(){if(this._running){Date.now()-this._lastPromiseDone>this._minDelay&&this._pendingPromises<this._maxConcurrency&&this._queue.length&&this._dequeue(),this._animationFrameRequest=Object(r.b)(this._tick)}},e.prototype.add=function(e){var t=this;return new Promise(function(n,o){if(t._queue.length>=t._maxQueueLength)return o(new Error("Max queue length reached"));t._queue.push({fn:e,resolve:n,reject:o})})},e.prototype._promisify=function(e){return void 0!==e&&"function"==typeof e.then?e:Promise.resolve(e)},e.prototype._dequeue=function(){var e=this,t=this._queue.shift(),n=Date.now();this._pendingPromises++;try{this._promisify(t.fn()).then(function(o){e._lastPromiseDone=n,e._pendingPromises--,t.resolve(o)}).catch(function(o){e._lastPromiseDone=n,e._pendingPromises--,t.reject(o)})}catch(e){this._lastPromiseDone=n,this._pendingPromises--,t.reject(e)}return!0},e.prototype.dispose=function(){this._running=!1,this._animationFrameRequest&&Object(r.a)(this._animationFrameRequest)},e}();t.a=i},13:function(e,t,n){"use strict";var o=n(1),r=(n.n(o),o.Engine.Filters.OverlayFilter);t.a={normal:r.BLEND_MODES.NORMAL,overlay:r.BLEND_MODES.OVERLAY,hardLight:r.BLEND_MODES.HARD_LIGHT,softLight:r.BLEND_MODES.SOFT_LIGHT,multiply:r.BLEND_MODES.MULTIPLY,darken:r.BLEND_MODES.DARKEN,lighten:r.BLEND_MODES.LIGHTEN,screen:r.BLEND_MODES.SCREEN,colorBurn:r.BLEND_MODES.COLOR_BURN}},2:function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});for(var o="undefined"==typeof window?e:window,r=o.requestAnimationFrame,i=o.cancelAnimationFrame,a=0,s=["ms","moz","webkit","o"],l=0;l<s.length&&!r;++l)r=o[s[l]+"RequestAnimationFrame"],i=o[s[l]+"CancelAnimationFrame"]||o[s[l]+"CancelRequestAnimationFrame"];r&&(r=r.bind(o)),i&&(i=i.bind(o)),r||(r=function(e,t){var n=(new Date).getTime(),o=Math.max(0,16-(n-a)),r=setTimeout(function(){e(n+o)},o);return a=n+o,r}),i||(i=function(e){clearTimeout(e)})}).call(t,n(4))},4:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},5:function(e,t,n){"use strict";var o=function(){function e(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.a={load:function(e){var t=this;return function(){if(e.substr(0,5),!0)return Promise.resolve([e,e])}().then(function(e){var n=o(e,2),r=n[0],i=n[1];return t._createAndLoadImage(r,i)})},_createAndLoadImage:function(e,t){return new Promise(function(e,n){var o=new window.Image;o.addEventListener("load",function(){e(o)}),o.addEventListener("error",function(){n(new Error("Failed to load image at "+t))}),o.crossOrigin="Anonymous",o.src=t})},loadXHR:function(e,t){return new Promise(function(n,o){var r=void 0;window.XDomainRequest?(r=new window.XDomainRequest,t&&r.overrideMimeType(t),r.onload=function(){n(r)},r.onerror=function(e){o(e)}):window.XMLHttpRequest&&(r=new window.XMLHttpRequest,t&&r.overrideMimeType(t),r.onreadystatechange=function(e){4===r.readyState&&(200===r.status?n(r):o(new Error("HTTP Status "+r.status)))}),r.open("GET",e,!0),r.send()})}}},71:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n.n(a),l=n(72),c=function(e){function t(){return o(this,t),r(this,e.apply(this,arguments))}return i(t,e),t.prototype._onOperationRemoved=function(e){e===this.sharedState.get("operation")&&this._onEnter()},t.prototype._onEnter=function(){var e=this.context.editor,t=e.operations.getOrCreate("overlay");this.sharedState.set({operation:t})},t.isEnabled=function(e){return e.isToolAllowed("overlay")&&e.isToolEnabled("overlay")},t}(a.BaseControls);c.clickAtPosition=a.BaseControls.clickAtPosition,c.getPreloadAssets=a.BaseControls.getPreloadAssets,c.identifier="overlay",c.controlsComponent=l.a,c.canvasControlsComponent=a.BaseControls.canvasControlsComponent,c.iconPath="editor/controls/overlay/icon.png",c.activeIconPath="editor/controls/overlay/icon-active.png",c.requiredOperations=["overlay"],c.defaultOptions={overlays:[],replaceOverlays:!1,availableOverlays:null},t.default=c,s.a.Controls.OverlayControls=c},72:function(e,t,n){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),l=(n.n(s),n(5)),c=n(10),u=n(73),p=n(13),d=s.ControlsStyles.PlainControlItem,h=s.ControlsStyles.PlainControlItemBackground,f=s.ControlsStyles.ControlItemTitle,y=function(e){function t(){r(this,t);for(var n=arguments.length,a=Array(n),l=0;l<n;l++)a[l]=arguments[l];var u=i(this,e.call.apply(e,[this].concat(a)));u._bindAll("_onOperationUpdated");var p=u.context,d=p.ui,h=p.theme;return u._thumbnailLoadQueue=new c.a(1,1/0,h.listItemSlideInDelay),u._thumbnailsLoaded={},u._overlayManager=new s.OverlayManager(d,u.props.options),u._events=o({},s.Constants.EVENTS.OPERATION_UPDATED,u._onOperationUpdated),u.state={},u}return a(t,e),t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this),this._overlayManager.getOverlays().forEach(function(e){t._thumbnailLoadQueue.add(function(){return l.a.load(t._getAssetPath(e.thumbnail)).then(function(n){t._thumbnailsLoaded[e.identifier]=n,t.forceUpdate()})})})},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this._thumbnailLoadQueue.dispose()},t.prototype._onOperationUpdated=function(e){e===this.getSharedState("operation")&&this.forceUpdate()},t.prototype._onBlendModeChange=function(){this.props.controls.addLocalHistorySnapshot("overlay-blend-mode",!1)},t.prototype._onAlphaChange=function(){this.props.controls.addLocalHistorySnapshot("overlay-alpha",!0)},t.prototype._onItemClick=function(e){var t=this,n=this.context.editor,o=this.getSharedState("operation");if(!e)return o.set({image:null,identifier:null,alpha:1}),n.render(),this.forceUpdate();if(e.identifier!==o.getIdentifier()){var r=this._getAssetPath(e.image),i=p.a[e.blendMode],a=void 0,c=setTimeout(function(){a=s.ModalManager.instance.displayLoading(t._t("loading.loading"))},100);l.a.load(r).then(function(r){a&&a.close(),c&&(clearTimeout(c),c=null);var s={identifier:e.identifier,image:r,blendMode:i,alpha:void 0===e.intensity?1:e.intensity};o.set(s),t.props.controls.addLocalHistorySnapshot("overlay-image",!1),n.render(),t.forceUpdate()})}},t.prototype._renderListItems=function(){var e=this,t=this.getSharedState("operation");return this._overlayManager.getOverlays().map(function(n){return s.React.createElement(u.a,{key:n.identifier,overlay:n,selected:t.getIdentifier()===n.identifier,visible:!!e._thumbnailsLoaded[n.identifier],onClick:e._onItemClick.bind(e,n),onBlendModeChange:e._onBlendModeChange.bind(e),onAlphaChange:e._onAlphaChange.bind(e)})})},t.prototype._getRootProps=function(){return{className:void 0,withBorderTop:!0}},t.prototype._renderContent=function(){var e=this,t=this.getSharedState("operation"),n=!t.getIdentifier();return s.React.createElement(s.ScrollableListComponent,{direction:"vertical",innerRef:function(t){e._scrollbar=t}},s.React.createElement(m,null,s.React.createElement(v,{onClick:this._onItemClick.bind(this,null)},s.React.createElement(g,{selected:n},s.React.createElement(_,null,this._t("editor.controls.overlay.overlays.none")))),this._renderListItems()))},t}(s.ControlsComponent);y.contextTypes=s.ControlsComponent.contextTypes,y.propTypes=s.ControlsComponent.propTypes,y.RootElement=s.ControlsComponent.RootElement,t.a=y;var m=s.adonis.ul("9uviv9","List"),v=Object(s.adonis)(d).div("1sgdmny","NoneItem"),g=Object(s.adonis)(h).div("yogtp1","NoneItemBackground"),_=Object(s.adonis)(f).span("5krmrh","ItemTitle")},73:function(e,t,n){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),l=(n.n(s),n(74)),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),p=s.ControlsStyles.ControlItem,d=s.ControlsStyles.ControlItemActiveOverlay,h=s.ControlsStyles.ControlItemTitle,f=function(e){function t(){var n;r(this,t);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];var u=i(this,e.call.apply(e,[this].concat(l)));return u.state={hovered:!1},u._bindAll("_onBlendModeChange","_onAlphaChange","_onHistoryChange"),u._events=(n={},o(n,s.Constants.EVENTS.HISTORY_UNDO,u._onHistoryChange),o(n,s.Constants.EVENTS.HISTORY_REDO,u._onHistoryChange),n),u}return a(t,e),t.prototype._onHistoryChange=function(){this.forceUpdate()},t.prototype._onBlendModeChange=function(e){this.props.onBeforeBlendModeChange&&this.props.onBeforeBlendModeChange();var t=this.context.editor;this.getSharedState("operation").setBlendMode(e),this.props.onBlendModeChange&&this.props.onBlendModeChange(),t.render(),this.forceUpdate()},t.prototype._onAlphaChange=function(e){this.props.onBeforeAlphaChange&&this.props.onBeforeAlphaChange();var t=this.context.editor;this.getSharedState("operation").setAlpha(e),this.props.onAlphaChange&&this.props.onAlphaChange(),t.render(),this.forceUpdate()},t.prototype.shouldComponentUpdate=function(e,t){return this.props.selected!==e.selected||this.props.visible!==e.visible||this.state.hovered!==t.hovered||this.props.overlay!==e.overlay||!(this.props.intensity===e.intensity||!e.selected)},t.prototype.render=function(){var e=this,t=this.props,n=t.lastChild,o=t.onClick,r=t.selected,i=t.visible,a=t.overlay,l=this.getSharedState("operation"),u=l.getAlpha(),p={lastChild:n,onClick:o,visible:i};return p.style={backgroundImage:"url('"+this._getAssetPath(a.thumbnail)+"')"},s.React.createElement(y,c({},p,{className:void 0,animated:!0,innerRef:function(t){e._container=t},onMouseEnter:function(){return e.setState({hovered:!0})},onMouseLeave:function(){return e.setState({hovered:!1})}}),s.React.createElement(v,{selected:r},s.React.createElement(s.Transition,{active:!r},s.React.createElement(b,null,s.React.createElement(g,{hovered:this.state.hovered},this._t("editor.controls.overlay.overlays."+a.identifier)||a.defaultName))),s.React.createElement(s.Transition,{active:r},s.React.createElement(b,null,s.React.createElement(_,null,"Blending"),s.React.createElement(E,{value:l.getBlendMode(),onChange:this._onBlendModeChange}),r&&s.React.createElement(m,null,s.React.createElement(s.SliderComponent,{minValue:0,maxValue:1,valueUnit:"",middleDot:!1,value:u,onChange:this._onAlphaChange})),s.React.createElement(C,{rendered:!0,visible:!0})))))},u(t,[{key:"container",get:function(){return this._container}}]),t}(s.SharedStateComponent);f.contextTypes=s.SharedStateComponent.contextTypes,t.a=f;var y=Object(s.adonis)(p).div("193vjnw",{lastChild:"229bd5"},"Item"),m=s.adonis.div("12dmntm","Slider"),v=s.adonis.div("1m161zg","ItemContainer"),g=Object(s.adonis)(h).span("120drhm","ItemTitle"),_=Object(s.adonis)(g)("1kbikta","BlendingLabel"),b=s.adonis.div("tj7k39",{rendered:"cuo4v2",visible:"82svov"},"ItemContent"),C=Object(s.adonis)(d).div("120drhm","Overlay"),E=Object(s.adonis)(l.a)("ii685b","BlendingControl")},74:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=(n.n(a),n(0)),l=(n.n(s),n(13)),c=s.ControlsStyles.ControlItemTitle,u=a.Utils.flipObject(l.a),p=function(e){function t(){o(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=r(this,e.call.apply(e,[this].concat(i)));return s._bindAll("_onPreviousClick","_onNextClick"),s}return i(t,e),t.prototype._onPreviousClick=function(e){e.preventDefault(),e.stopPropagation();var t=Object.keys(u),n=t.indexOf(this.props.value.toString()),o=(n+t.length-1)%t.length,r=parseInt(t[o],10);this.props.onChange&&this.props.onChange(r)},t.prototype._onNextClick=function(e){e.preventDefault(),e.stopPropagation();var t=Object.keys(u),n=t.indexOf(this.props.value.toString()),o=(n+t.length+1)%t.length,r=parseInt(t[o],10);this.props.onChange&&this.props.onChange(r)},t.prototype.render=function(){var e={backgroundImage:"url('"+this._getAssetPath("editor/controls/overlay/arrow-left.png",!0)+"')"},t={backgroundImage:"url('"+this._getAssetPath("editor/controls/overlay/arrow-right.png",!0)+"')"},n=this.props.value;return s.React.createElement(d,{styles:this.props.styles},s.React.createElement(f,{onClick:this._onPreviousClick,style:e}),s.React.createElement(h,null,this._t("editor.controls.overlay.blendModes."+u[n])),s.React.createElement(f,{onClick:this._onNextClick,style:t}))},t}(s.BaseComponent);p.contextTypes=s.BaseComponent.contextTypes,t.a=p;var d=s.adonis.div("15zte1z","BlendingControlContainer");p.RootElement=d;var h=Object(s.adonis)(c).div("1v7ogyl","Label"),f=s.adonis.div("1v32l0l","Arrow")}}).default});