(function(d,_){'object'==typeof exports&&'object'==typeof module?module.exports=_(require("photoeditorsdk"),require("react"),require("react-dom")):'function'==typeof define&&define.amd?define(['photoeditorsdk','react','react-dom'],_):'object'==typeof exports?exports.PhotoEditorReactUI=_(require("photoeditorsdk"),require("react"),require("react-dom")):d.PhotoEditorReactUI=_(d.PhotoEditorSDK,d.React,d.ReactDOM);})(this,function(o,d,_){return function(M){function R(L){if(I[L])return I[L].exports;var V=I[L]={i:L,l:!1,exports:{}};return M[L].call(V.exports,V,V.exports,R),V.l=!0,V.exports;}var I={};return R.m=M,R.c=I,R.i=function(L){return L;},R.d=function(L,V,U){Object.defineProperty(L,V,{configurable:!1,enumerable:!0,get:U});},R.n=function(L){var V=L&&L.__esModule?function(){return L['default'];}:function(){return L;};return R.d(V,'a',V),V;},R.o=function(L,V){return Object.prototype.hasOwnProperty.call(L,V);},R.p="",R(R.s=264);}([function(M,R){"use strict";R.__esModule=!0,R.default=function(I,L){if(!(I instanceof L))throw new TypeError("Cannot call a class as a function");};},function(M,R,I){"use strict";function L(xe){return xe&&xe.__esModule?xe:{default:xe};}Object.defineProperty(R,"__esModule",{value:!0}),R.ImageFormat=R.ColorMatrix=R.now=R.Log=R.cancelAnimationFrame=R.requestAnimationFrame=R.SDK=R.EXIF=R.ReactDOM=R.UniformType=R.OptionType=R.RenderType=R.Base64=R.Color=R.SharedState=R.Constants=R.EventEmitter=R.SDKUtils=R.Vector2=R.ReactBEM=R.BaseComponent=R.Classnames=R.BEM=R.React=R.Utils=R.Promise=void 0;var V=I(29),U=L(V),N=I(61),W=L(N),$=I(263),H=L($),G=I(77),Z=L(G),Y=I(68),J=L(Y),X=I(72),Q=L(X),ee=I(98),te=L(ee),oe=I(201),re=L(oe),ne=I(175),ie=L(ne),se=I(200),le=L(se),de=I(203),pe=I(75),ce=L(pe),ue=U.default.Base64,me=U.default.Color,fe=U.default.Math.ColorMatrix,ge=U.default.EventEmitter,he=U.default.EXIF,ye=U.default.OptionType,be=U.default.Promise,Ee=U.default.Utils,Se=U.default.RenderType,ve=U.default.ImageFormat,Me=U.default,Ce=U.default.UniformType,Re=U.default.Math.Vector2,Be='undefined'!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):I(89);R.Promise=be,R.Utils=re.default,R.React=W.default,R.BEM=J.default,R.Classnames=Z.default,R.BaseComponent=te.default,R.ReactBEM=Q.default,R.Vector2=Re,R.SDKUtils=Ee,R.EventEmitter=ge,R.Constants=ie.default,R.SharedState=le.default,R.Color=me,R.Base64=ue,R.RenderType=Se,R.OptionType=ye,R.UniformType=Ce,R.ReactDOM=H.default,R.EXIF=he,R.SDK=Me,R.requestAnimationFrame=de.requestAnimationFrame,R.cancelAnimationFrame=de.cancelAnimationFrame,R.Log=ce.default,R.now=Be,R.ColorMatrix=fe,R.ImageFormat=ve;},function(M,R,I){"use strict";function L(G){return G&&G.__esModule?G:{default:G};}R.__esModule=!0;var V=I(209),U=L(V),N=I(208),W=L(N),$=I(33),H=L($);R.default=function(G,Z){if("function"!=typeof Z&&null!==Z)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof Z?"undefined":(0,H.default)(Z)));G.prototype=(0,W.default)(Z&&Z.prototype,{constructor:{value:G,enumerable:!1,writable:!0,configurable:!0}}),Z&&(U.default?(0,U.default)(G,Z):G.__proto__=Z);};},function(M,R,I){"use strict";R.__esModule=!0;var V=I(33),U=function(N){return N&&N.__esModule?N:{default:N};}(V);R.default=function(N,W){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return W&&("object"===("undefined"==typeof W?"undefined":(0,U.default)(W))||"function"==typeof W)?W:N;};},function(M,R,I){"use strict";R.__esModule=!0;var V=I(76),U=function(N){return N&&N.__esModule?N:{default:N};}(V);R.default=function(N,W,$){return W in N?(0,U.default)(N,W,{value:$,enumerable:!0,configurable:!0,writable:!0}):N[W]=$,N;};},function(M,R,I){"use strict";function L(Q){return Q&&Q.__esModule?Q:{default:Q};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(11),Y=L(Z),J=12,X=function(Q){function ee(){(0,U.default)(this,ee);var te=(0,W.default)(this,Q.call(this));return te.constructor.NATIVE_SCROLLBAR_WIDTH||(te.constructor.NATIVE_SCROLLBAR_WIDTH=G.Utils.getScrollbarWidth()),te._needsStyleFixes=!0,te._isDragging=!1,te._bindAll('_onButtonDragStart','_onButtonDrag','_onButtonDragStop','_onBarDragStart','_onBarDrag','_onBarDragStop','_onListScroll'),te.state={buttonSize:0,buttonPosition:0,buttonVisible:!1},te;}return(0,H.default)(ee,Q),ee.prototype.componentDidMount=function(){Q.prototype.componentDidMount.call(this),this.update();},ee.prototype.fixStyles=function(){G.Utils.isMobile()||this._updateListSize();},ee.prototype._onListScroll=function(){if(!this._isDragging){var oe=this._getDirection(),re,ne,ie;oe===ee.HORIZONTAL?(re=this._list.scrollWidth-this._list.offsetWidth,ne=this._list.scrollLeft,ie=this._node.offsetWidth-this.state.buttonSize):oe===ee.VERTICAL&&(re=this._list.scrollHeight-this._list.offsetHeight,ne=this._list.scrollTop,ie=this._node.offsetHeight-this.state.buttonSize);var se=ne/re;this.setState({buttonPosition:ie*se});}},ee.prototype._onButtonDragStart=function(){this._isDragging=!0,this._initialButtonPosition=this.state.buttonPosition||0;},ee.prototype._onButtonDrag=function(oe){var re=this._getDirection(),ne;re===ee.HORIZONTAL?ne=this._initialButtonPosition+oe.x:re===ee.VERTICAL&&(ne=this._initialButtonPosition+oe.y),this._setButtonPosition(ne);},ee.prototype._onButtonDragStop=function(){this._isDragging=!1;},ee.prototype._onBarDragStart=function(oe){var re=G.Utils.getEventPosition(oe);this._initialPosition=re.clone();var ne=this._node.getBoundingClientRect(),ie=new G.Vector2(ne.left,ne.top),se=re.clone().subtract(ie),le=this._getDirection();le===ee.HORIZONTAL?this._setButtonPosition(se.x-this.state.buttonSize/2):le===ee.VERTICAL&&this._setButtonPosition(se.y-this.state.buttonSize/2),document.addEventListener('mousemove',this._onBarDrag),document.addEventListener('touchmove',this._onBarDrag),document.addEventListener('mouseup',this._onBarDragStop),document.addEventListener('touchend',this._onBarDragStop);},ee.prototype._onBarDrag=function(oe){var re=G.Utils.getEventPosition(oe),ne=this._node.getBoundingClientRect(),ie=new G.Vector2(ne.left,ne.top),se=re.clone().subtract(ie),le=this._getDirection();le===ee.HORIZONTAL?this._setButtonPosition(se.x-this.state.buttonSize/2):le===ee.VERTICAL&&this._setButtonPosition(se.y-this.state.buttonSize/2);},ee.prototype._onBarDragStop=function(){document.removeEventListener('mousemove',this._onBarDrag),document.removeEventListener('touchmove',this._onBarDrag),document.removeEventListener('mouseup',this._onBarDragStop),document.removeEventListener('touchend',this._onBarDragStop);},ee.prototype._setButtonPosition=function(oe){var re=this._getDirection(),ne,ie;re===ee.HORIZONTAL?(ne=this._node.offsetWidth-this.state.buttonSize,ie=this._list.scrollWidth-this._list.offsetWidth):re===ee.VERTICAL&&(ne=this._node.offsetHeight-this.state.buttonSize,ie=this._list.scrollHeight-this._list.offsetHeight),oe=Math.max(0,oe),oe=Math.min(oe,ne),this.setState({buttonPosition:oe});var se=oe/ne,le=ie*se;re===ee.HORIZONTAL?this._list.scrollLeft=le:re===ee.VERTICAL&&(this._list.scrollTop=le);},ee.prototype._updateButtonSize=function(oe){var re=0,ne=!1,le=this._getDirection(),ie,se;le===ee.HORIZONTAL?(ie=this._list.clientWidth,se=this._list.scrollWidth):le===ee.VERTICAL&&(ie=this._list.offsetHeight,se=this._list.scrollHeight),re=ie/se*ie,ne=se>ie,this.setState({buttonSize:re,buttonVisible:ne},oe);},ee.prototype._updateListSize=function(){if(this._list){var oe=this._getDirection();if(oe===ee.HORIZONTAL){this._list.style.height='';var re=this._getFullListDimensions();this._listSize=re.y,this._listContentSize=this._list.offsetHeight;}else if(oe===ee.VERTICAL){this._list.style.width='';var ne=this._getFullListDimensions();this._listSize=ne.x,this._listContentSize=this._list.offsetWidth;}}},ee.prototype._getFullListDimensions=function(){var oe=this._list.getBoundingClientRect();return new G.Vector2(oe.width,oe.height);},ee.prototype.update=function(){var oe=this;if(!G.Utils.isMobile()){var re=this.refs,ne=re.root,ie=re.list;this._node=ne,this._list=ie;var se=this._getDirection();this._updateButtonSize(function(){oe._listSize||oe._updateListSize();var le=oe._listSize;oe.state.buttonVisible&&(le+=oe.constructor.NATIVE_SCROLLBAR_WIDTH),se===ee.HORIZONTAL?(oe._list.style.height=le+'px',oe._node.style.top=oe._listContentSize-J+'px',oe._node.style.width=oe._list.offsetWidth+'px'):se===ee.VERTICAL&&(oe._list.style.width=le+'px',oe._node.style.left=oe._listContentSize-J+'px',oe._node.style.height=oe._list.offsetHeight+'px');}),this._list.addEventListener('scroll',this._onListScroll);}},ee.prototype._getDirection=function(){return this.props.direction||'horizontal';},ee.prototype._getButtonStyle=function(){var oe=this._getDirection();return'horizontal'===oe?{left:this.state.buttonPosition,width:this.state.buttonSize}:{top:this.state.buttonPosition,height:this.state.buttonSize};},ee.prototype.getList=function(){return this.refs.list;},ee.prototype.getRoot=function(){return this.refs.root;},ee.prototype.renderWithBEM=function(){if(G.Utils.isMobile())return this.props.children;var oe=this._getButtonStyle(),re={display:this.state.buttonVisible?'block':'none'},ne=G.React.cloneElement(this.props.children,{ref:'list'});return G.ReactBEM.createElement('div',null,ne,G.ReactBEM.createElement('div',{bem:'$b:scrollbar m:'+(this.props.direction||'horizontal')+' m:'+(this.state.buttonVisible?'visible':'invisible'),ref:'root',style:re,onMouseDown:this._onBarDragStart,onTouchStart:this._onBarDragStart},G.ReactBEM.createElement(Y.default,{onStart:this._onButtonDragStart,onDrag:this._onButtonDrag,onStop:this._onButtonDragStop},G.ReactBEM.createElement('div',{bem:'e:bar',style:oe,onMouseDown:this._onButtonDown}))));},ee;}(G.BaseComponent);R.default=X,X.HORIZONTAL='horizontal',X.VERTICAL='vertical',X.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Q){return Q&&Q.__esModule?Q:{default:Q};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(38),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=function(Q){function ee(te,oe,re){var ne=3<arguments.length&&void 0!==arguments[3]&&arguments[3];(0,W.default)(this,ee);var ie=(0,H.default)(this,Q.call(this));return ie.type=te,ie.title=oe,ie.text=re,ie.overlay=ne,ie.data=null,ie;}return(0,Z.default)(ee,Q),ee.prototype.setData=function(oe){this.data=oe,this.emit('update');},ee.prototype.close=function(){this.emit('close');},ee;}(Y.EventEmitter),X=function(Q){function ee(){(0,W.default)(this,ee);var te=(0,H.default)(this,Q.call(this));return te._modals=[],te;}return(0,Z.default)(ee,Q),ee.prototype.displayLoading=function(oe){var re=new J('loading',null,oe);return this.addModal(re),re;},ee.prototype.displayProgress=function(oe){var re=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,ne=new J('progress',null,oe);return ne.setData({progress:re}),this.addModal(ne),ne;},ee.prototype.displayWarning=function(oe,re){var ne=new J('warning',oe,re);return this.addModal(ne),ne;},ee.prototype.displayError=function(oe,re){var ne=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0,ie=new J('error',oe,re,ne);return this.addModal(ie),ie;},ee.prototype.addModal=function(oe){var re=this;this._modals.push(oe),oe.on('close',function(){re.removeModal(oe);}),oe.on('update',function(){re.emit('update');}),this.emit('update');},ee.prototype.removeModal=function(oe){var re=this._modals.indexOf(oe);this._modals.splice(re,1),this.emit('update');},ee.prototype.getModals=function(){return this._modals;},(0,U.default)(ee,null,[{key:'instance',get:function(){return this._instance||(this._instance=new ee()),this._instance;}}]),ee;}(Y.EventEmitter);R.default=X;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(97),Y=L(Z),J=I(149),X=L(J),Q=function(ee){function te(){(0,U.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,W.default)(this,ee.call.apply(ee,[this].concat(re)));return ie._hasBackButton=!0,ie._hasDoneButton=!1,ie._backButtonClicked=!1,ie._bindAll('_onBackClick','_onDoneClick'),ie;}return(0,H.default)(te,ee),te.prototype._onBackClick=function(){this._backButtonClicked=!0,this.props.onSwitchControls('back');},te.prototype._onDoneClick=function(){this._onBackClick();},te.prototype.renderControls=function(){return null;},te.prototype.renderOverlayControls=function(){return null;},te.prototype.renderWithBEM=function(){var re=this.props.options&&this.props.options.forcedControl,ne=this._hasBackButton&&!re?G.ReactBEM.createElement(Y.default,{onClick:this._onBackClick}):null,ie=this._hasDoneButton||re?G.ReactBEM.createElement(X.default,{onClick:this._onDoneClick}):null;return G.ReactBEM.createElement('div',{bem:'$b:controls',ref:'root'},this.renderOverlayControls(),G.ReactBEM.createElement('div',{bem:'e:table'},ne,this.renderControls(),ie));},te;}(G.BaseComponent);R.default=Q,Q.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function(W){return W&&W.__esModule?W:{default:W};}(V),N=function(){function W(){(0,U.default)(this,W);}return W.prototype.getInitialSharedState=function(){return{};},W.prototype.isAvailable=function(){return!1;},W.getPreloadAssets=function(){return[];},W;}();N.topBarControlsComponent=null,N.controlsComponent=null,N.canvasControlsComponent=null,N.identifier=null,N.iconPath=null,N.languageKey=null,N.defaultOptions={},R.default=N;},function(M){var I=M.exports={version:'2.5.0'};'number'==typeof __e&&(__e=I);},function(M,R,I){var L=I(54)('wks'),V=I(35),U=I(13).Symbol,N='function'==typeof U,W=M.exports=function($){return L[$]||(L[$]=N&&U[$]||(N?U:V)('Symbol.'+$));};W.store=L;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){(0,U.default)(this,J);for(var X=arguments.length,Q=Array(X),ee=0;ee<X;ee++)Q[ee]=arguments[ee];var te=(0,W.default)(this,Y.call.apply(Y,[this].concat(Q)));return te._bindAll('_onDragStart','_onDragMove','_onDragEnd'),te;}return(0,H.default)(J,Y),J.prototype._onDragStart=function(Q){if(!this.props.disabled){Q.preventDefault(),Q.stopPropagation(),this._initialMousePosition=G.Utils.getEventPosition(Q),document.addEventListener('mousemove',this._onDragMove),document.addEventListener('touchmove',this._onDragMove),document.addEventListener('mouseup',this._onDragEnd),document.addEventListener('touchend',this._onDragEnd);var ee=this.refs.element,te=ee.getBoundingClientRect(),oe=new G.Vector2(te.left,te.top),re=this._initialMousePosition.clone().subtract(oe);this.props.onStart&&this.props.onStart(re,Q);}},J.prototype._onDragMove=function(Q){Q.preventDefault(),Q.stopPropagation();var ee=G.Utils.getEventPosition(Q);if(ee){var te=ee.clone().subtract(this._initialMousePosition);this.props.onDrag&&this.props.onDrag(te,Q);}},J.prototype._onDragEnd=function(Q){Q.preventDefault(),Q.stopPropagation(),Q.stopImmediatePropagation(),this._onDragMove(Q),document.removeEventListener('mousemove',this._onDragMove),document.removeEventListener('touchmove',this._onDragMove),document.removeEventListener('mouseup',this._onDragEnd),document.removeEventListener('touchend',this._onDragEnd),this.props.onStop&&this.props.onStop(Q);},J.prototype.render=function(){if(!this.props.children||this.props.children instanceof Array)throw new Error('DraggableComponent expects exactly one child.');return G.React.cloneElement(this.props.children,{onMouseDown:this._onDragStart,onTouchStart:this._onDragStart,ref:'element'});},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(30),Y=L(Z),J=function(X){function Q(){(0,U.default)(this,Q);for(var ee=arguments.length,te=Array(ee),oe=0;oe<ee;oe++)te[oe]=arguments[oe];var re=(0,W.default)(this,X.call.apply(X,[this].concat(te)));return re._bindAll('_onSliderValueChange'),re.state={value:re.props.value},re;}return(0,H.default)(Q,X),Q.prototype.componentWillReceiveProps=function(te){te.value!==this.state.value&&(this.state.value=te.value);},Q.prototype._onSliderValueChange=function(te){this.props.onChange&&this.props.onChange(te),this.setState({value:te});},Q.prototype._renderSlider=function(){var te=G.SDKUtils.defaults(this.props,{style:'',middleDot:!1,minValue:1,maxValue:100,label:'Label',onChange:this._onSliderValueChange,value:this.state.value});return G.ReactBEM.createElement(Y.default,te);},Q.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',{bem:'$b:controls e:overlay m:slider m:dark'},this._renderSlider());},Q;}(G.BaseComponent);R.default=J,J.contextTypes=G.BaseComponent.contextTypes;},function(M){var I=M.exports='undefined'!=typeof window&&window.Math==Math?window:'undefined'!=typeof self&&self.Math==Math?self:Function('return this')();'number'==typeof __g&&(__g=I);},function(M,R,I){var L=I(15),V=I(80),U=I(57),N=Object.defineProperty;R.f=I(16)?Object.defineProperty:function($,H,G){if(L($),H=U(H,!0),L(G),V)try{return N($,H,G);}catch(Z){}if('get'in G||'set'in G)throw TypeError('Accessors not supported!');return'value'in G&&($[H]=G.value),$;};},function(M,R,I){var L=I(26);M.exports=function(V){if(!L(V))throw TypeError(V+' is not an object!');return V;};},function(M,R,I){M.exports=!I(25)(function(){return 7!=Object.defineProperty({},'a',{get:function(){return 7;}}).a;});},function(M,R,I){var L=I(13),V=I(9),U=I(46),N=I(22),W='prototype',$=function(H,G,Z){var Y=H&$.F,J=H&$.G,X=H&$.S,Q=H&$.P,ee=H&$.B,te=H&$.W,oe=J?V:V[G]||(V[G]={}),re=oe[W],ne=J?L:X?L[G]:(L[G]||{})[W],ie,se,le;for(ie in J&&(Z=G),Z)se=!Y&&ne&&void 0!==ne[ie],se&&ie in oe||(le=se?ne[ie]:Z[ie],oe[ie]=J&&'function'!=typeof ne[ie]?Z[ie]:ee&&se?U(le,L):te&&ne[ie]==le?function(de){var pe=function(ce,ue,me){if(this instanceof de){switch(arguments.length){case 0:return new de();case 1:return new de(ce);case 2:return new de(ce,ue);}return new de(ce,ue,me);}return de.apply(this,arguments);};return pe[W]=de[W],pe;}(le):Q&&'function'==typeof le?U(Function.call,le):le,Q&&((oe.virtual||(oe.virtual={}))[ie]=le,H&$.R&&re&&!re[ie]&&N(re,ie,le)));};$.F=1,$.G=2,$.S=4,$.P=8,$.B=16,$.W=32,$.U=64,$.R=128,M.exports=$;},function(M){var I={}.hasOwnProperty;M.exports=function(L,V){return I.call(L,V);};},function(M,R,I){var L=I(81),V=I(47);M.exports=function(U){return L(V(U));};},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){(0,U.default)(this,J);for(var X=arguments.length,Q=Array(X),ee=0;ee<X;ee++)Q[ee]=arguments[ee];var te=(0,W.default)(this,Y.call.apply(Y,[this].concat(Q)));return te._bindAll('_onCanvasZoomDone'),te;}return(0,H.default)(J,Y),J.prototype._performHitTest=function(Q){var ee=this.refs.container,te=ee.getBoundingClientRect(),oe=new G.Vector2(te.left,te.top),re=Q.subtract(oe),ne=this.context.editor,ie=ne.controls.getAvailable();for(var se in ie){var le=ie[se],de=le.clickAtPosition&&le.clickAtPosition(re,ne);if(de)return de.selectedSprite===this.getSharedState('selectedSprite')||(this.props.onSwitchControls(le,de),!0);}return!1;},J.prototype._onCanvasZoomDone=function(){this.forceUpdate();},J.prototype._bindEvents=function(){Y.prototype._bindEvents.call(this),this.context.mediator.on(G.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone);},J.prototype._unbindEvents=function(){Y.prototype._unbindEvents.call(this),this.context.mediator.off(G.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone);},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(150),Y=L(Z),J=function(X){function Q(){return(0,U.default)(this,Q),(0,W.default)(this,X.apply(this,arguments));}return(0,H.default)(Q,X),Q.prototype._renderHeader=function(){return this.context.options.showHeader?G.ReactBEM.createElement(Y.default,null):null;},Q.prototype._renderScreen=function(){return G.ReactBEM.createElement('div',null);},Q.prototype.renderWithBEM=function(){var te='b:screen';return this.context.options.showHeader||(te+=' m:noHeader'),G.ReactBEM.createElement('div',{bem:te,className:this.props.visible?null:'is-hidden'},this._renderHeader(),this._renderScreen());},Q;}(G.BaseComponent);R.default=J,J.propTypes={editor:G.React.PropTypes.any},J.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){var L=I(14),V=I(28);M.exports=I(16)?function(U,N,W){return L.f(U,N,V(1,W));}:function(U,N,W){return U[N]=W,U;};},function(M){M.exports={};},function(M,R,I){"use strict";R.__esModule=!0;var V=I(207),U=function(N){return N&&N.__esModule?N:{default:N};}(V);R.default=U.default||function(N){for(var W=1,$;W<arguments.length;W++)for(var H in $=arguments[W],$)Object.prototype.hasOwnProperty.call($,H)&&(N[H]=$[H]);return N;};},function(M){M.exports=function(I){try{return!!I();}catch(L){return!0;}};},function(M){M.exports=function(I){return'object'==typeof I?null!==I:'function'==typeof I;};},function(M,R,I){var L=I(85),V=I(48);M.exports=Object.keys||function(N){return L(N,V);};},function(M){M.exports=function(I,L){return{enumerable:!(1&I),configurable:!(2&I),writable:!(4&I),value:L};};},function(M){M.exports=o;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(24),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(11),X=L(J),Q=function(ee){function te(){(0,W.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,H.default)(this,ee.call.apply(ee,[this].concat(re)));return ie._bindAll('_onKnobDragStart','_onKnobDrag','_onKnobDragStop','_onBarDragStart','_onBarDrag','_onBarDragStop','_onMiddleDotClick'),ie.state={value:ie.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0},ie;}return(0,Z.default)(te,ee),te.prototype.componentDidMount=function(){this._setValue(this.state.value,!1);},te.prototype.componentWillReceiveProps=function(re){re.value!==this.state.value&&this._setValue(re.value,!1);},te.prototype._onMiddleDotClick=function(){this._previousValue=this.state.value;var re=this.props.minValue+(this.props.maxValue-this.props.minValue)/2;this._setValue(re,!0,!0);},te.prototype._onKnobDragStart=function(re){this._previousValue=this.state.value,this._initialSliderPosition=this.state.sliderPosition,this._initialPosition=re;},te.prototype._onKnobDrag=function(re){var ne=this.refs.bar,ie=ne.offsetWidth,se=this._initialSliderPosition+re.x;se=Math.max(0,Math.min(se,ie));var le=se/ie,de=this.props.minValue+(this.props.maxValue-this.props.minValue)*le;this._setValue(de);},te.prototype._onKnobDragStop=function(){this._setValue(this.state.value,!0,!0);},te.prototype._onBarDragStart=function(re){this._previousValue=this.state.value,this._initialPosition=re.clone();var ne=this.refs.bar,ie=ne.offsetWidth,se=re.x/ie,le=this.props.minValue+(this.props.maxValue-this.props.minValue)*se;this._setValue(le);},te.prototype._onBarDrag=function(re){var ne=this._initialPosition.clone().add(re),ie=this.refs.bar,se=ie.offsetWidth,le=ne.x/se,de=this.props.minValue+(this.props.maxValue-this.props.minValue)*le;de=Math.max(this.props.minValue,Math.min(this.props.maxValue,de)),this._setValue(de);},te.prototype._onBarDragStop=function(){this._setValue(this.state.value,!0,!0);},te.prototype._getKnobStyle=function(){return{left:this.state.sliderPosition};},te.prototype._getForegroundStyle=function(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth};},te.prototype._displayMiddleDot=function(){return!1!==this.props.middleDot;},te.prototype._setValue=function(re){var ne=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,ie=2<arguments.length&&void 0!==arguments[2]&&arguments[2];re=Math.round(re);var se=this.props,le=se.minValue,de=se.maxValue,pe=(re-le)/(de-le),ce=this.refs.bar,ue=ce.offsetWidth,fe=pe*ue,ge=0;this._displayMiddleDot()&&(fe=Math.abs(pe-0.5)*ue,ge=0.5>pe?0.5*ue-fe:'50%'),this.setState({value:re,sliderPosition:ue*pe,foregroundWidth:fe,foregroundLeft:ge}),ne&&this.props.onChange&&this.props.onChange(re,this._previousValue,ie);},te.prototype._buildValue=function(re){return 0!=re%1&&(re=re.toFixed(2)),this.props.positiveValuePrefix&&0<=re&&(re=''+this.props.positiveValuePrefix+re),this.props.valueUnit&&(re+=this.props.valueUnit),re;},te.prototype.renderWithBEM=function(){var re=null;this._displayMiddleDot()&&(re=Y.ReactBEM.createElement('div',{bem:'e:middleDot',onClick:this._onMiddleDotClick}));var ne={style:this._getForegroundStyle()},ie='$b:slider'+(this.props.style?' m:'+this.props.style:'');return Y.ReactBEM.createElement('div',{bem:ie},Y.ReactBEM.createElement('div',{bem:'$e:bar',ref:'bar'},Y.ReactBEM.createElement(X.default,{onStart:this._onBarDragStart,onDrag:this._onBarDrag,onStop:this._onBarDragStop},Y.ReactBEM.createElement('div',null,Y.ReactBEM.createElement('div',{bem:'$e:background'}),Y.ReactBEM.createElement('div',(0,U.default)({bem:'$e:foreground'},ne)),Y.ReactBEM.createElement(X.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag,onStop:this._onKnobDragStop},Y.ReactBEM.createElement('div',{bem:'e:knob b:knob m:slider',style:this._getKnobStyle()})))),re),Y.ReactBEM.createElement('div',{bem:'$e:labels'},Y.ReactBEM.createElement('div',{bem:'e:label m:lowerBoundary'},this._buildValue(this.props.minValue)),Y.ReactBEM.createElement('div',{bem:'e:label m:value'},this.props.label,' ',this._buildValue(this.state.value)),Y.ReactBEM.createElement('div',{bem:'e:label m:upperBoundary'},this._buildValue(this.props.maxValue))));},te;}(Y.BaseComponent);R.default=Q,Q.contextTypes=Y.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(me){return me&&me.__esModule?me:{default:me};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(24),U=L(V),N=I(4),W=L(N),$=I(0),H=L($),G=I(3),Z=L(G),Y=I(2),J=L(Y),X=I(1),Q=I(138),ee=L(Q),te=I(137),oe=L(te),re=I(136),ne=L(re),ie=I(20),se=L(ie),le=X.SDK.Operations.SpriteOperation,de=le.Sticker,pe=le.Text,ce=le.Brush,ue=function(me){function fe(){var ge;(0,H.default)(this,fe);for(var he=arguments.length,ye=Array(he),be=0;be<he;be++)ye[be]=arguments[be];var Ee=(0,Z.default)(this,me.call.apply(me,[this].concat(ye)));return Ee._bindAll('_onCanvasClick','_onSpriteDragStart','_onSpriteDragStop','_onOperationUpdated','_onOperationRemoved','_onSpriteFlip','_onSpriteTakeToFront','_onSpriteRemove'),Ee._canvasClickDisabled=!1,Ee._events=(ge={},(0,W.default)(ge,X.Constants.EVENTS.OPERATION_UPDATED,Ee._onOperationUpdated),(0,W.default)(ge,X.Constants.EVENTS.OPERATION_REMOVED,Ee._onOperationRemoved),ge),Ee;}return(0,J.default)(fe,me),fe.prototype._onOperationRemoved=function(he){var ye=this.getSharedState('selectedSprite');if(he===this.getSharedState('operation')&&ye){var be=this.context.editor,Ee=be.operations.getOrCreate('sprite',{sprites:[ye],enabled:!1});this.setSharedState({operation:Ee,operationExistedBefore:!1,initialOptions:{}});}},fe.prototype._onOperationUpdated=function(he){var ye=this.getSharedState('selectedSprite');if(he===this.getSharedState('operation')&&ye){var be=he.getSprites();-1===be.indexOf(ye)&&be.push(ye),this.forceUpdate();}},fe.prototype._onItemBlur=function(){},fe.prototype._onCanvasClick=function(he){if(!this._canvasClickDisabled){var ye=this._performHitTest(X.Utils.getEventPosition(he));ye||(this.getSharedState('selectedSprite')&&this._onItemBlur(),this.props.onSwitchControls('home'));}},fe.prototype._onSpriteFlip=function(he){var ye=this.getSharedState('selectedSprite');'h'===he?ye.setFlipHorizontally(!ye.getFlipHorizontally()):'v'===he?ye.setFlipVertically(!ye.getFlipVertically()):void 0;},fe.prototype._onSpriteTakeToFront=function(){var ye=this.getSharedState('operation');ye.takeSpriteToFront(this.getSharedState('selectedSprite')),this.forceSharedUpdate();},fe.prototype._onSpriteRemove=function(){var he=this.getSharedState('operation'),ye=this.getSharedState('selectedSprite');he.removeSprite(ye),ye.dispose(),this.setSharedState({selectedSprite:null});},fe.prototype._onSpriteDragStart=function(){this._canvasClickDisabled=!0;},fe.prototype._onSpriteDragStop=function(){var he=this;setTimeout(function(){he._canvasClickDisabled=!1;},100);},fe.prototype._getContainerStyle=function(){var he=this.context.editor,ye=he.getCanvasDimensions(),be=he.getOutputDimensions(),Ee=ye.clone().divide(2).subtract(be.clone().divide(2)),Se=Ee.x,ve=Ee.y;return{left:Se,top:ve,width:be.x,height:be.y};},fe.prototype._getContainerProps=function(){return{};},fe.prototype._getInnerContainerProps=function(){return{style:this._getContainerStyle(),onClick:this._onCanvasClick};},fe.prototype._renderSpriteItems=function(){var he=this,ye=this.getSharedState('operation'),be=ye.getSprites(),Ee=this.getSharedState('selectedSprite');return be.map(function(Se){var Me=null;return Se instanceof pe?Me=ee.default:Se instanceof de?Me=oe.default:Se instanceof ce&&(Me=ne.default),X.ReactBEM.createElement(Me,{operation:ye,sharedState:he.props.sharedState,sprite:Se,selected:Se===Ee,onDragStart:he._onSpriteDragStart,onDragStop:he._onSpriteDragStop,onRemove:he._onSpriteRemove.bind(he,Se),options:he.props.options,ref:'sprite-'+Se.getId()});});},fe.prototype._renderOverlayControls=function(){return null;},fe.prototype.renderWithBEM=function(){return X.ReactBEM.createElement('div',(0,U.default)({bem:'$b:canvasControls e:container m:full',ref:'container'},this._getContainerProps()),X.ReactBEM.createElement('div',(0,U.default)({bem:'b:canvasControls e:innerContainer',ref:'innerContainer'},this._getInnerContainerProps()),X.ReactBEM.createElement('div',{bem:'$b:spritesCanvasControls',ref:'container'},this._renderSpriteItems(),this._renderOverlayControls())));},fe;}(se.default);R.default=ue,ue.contextTypes=se.default.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.renderContent=function(){return this.props.children;},J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',{bem:'$b:topBar e:row'},G.ReactBEM.createElement('div',{bem:'e:cell'},this.renderContent()));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(H){return H&&H.__esModule?H:{default:H};}R.__esModule=!0;var V=I(211),U=L(V),N=I(210),W=L(N),$="function"==typeof W.default&&"symbol"==typeof U.default?function(H){return typeof H;}:function(H){return H&&"function"==typeof W.default&&H.constructor===W.default&&H!==W.default.prototype?"symbol":typeof H;};R.default="function"==typeof W.default&&"symbol"===$(U.default)?function(H){return"undefined"==typeof H?"undefined":$(H);}:function(H){return H&&"function"==typeof W.default&&H.constructor===W.default&&H!==W.default.prototype?"symbol":"undefined"==typeof H?"undefined":$(H);};},function(M,R){R.f={}.propertyIsEnumerable;},function(M){var I=0,L=Math.random();M.exports=function(V){return'Symbol('.concat(V===void 0?'':V,')_',(++I+L).toString(36));};},function(M,R,I){"use strict";var L=I(242)(!0);I(82)(String,'String',function(V){this._t=V+'',this._i=0;},function(){var V=this._t,U=this._i,N;return U>=V.length?{value:void 0,done:!0}:(N=L(V,U),this._i+=N.length,{value:N,done:!1});});},function(M,R,I){"use strict";function L(J){return J&&J.__esModule?J:{default:J};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(29),W=L(N),$=I(260),H=L($),Z=W.default.Promise,Y=function(){function J(X){(0,U.default)(this,J),this._url=X,this._parsedUrl=H.default.parse(this._url,!0);}return J.prototype._isJSONPRequest=function(){var Q=this._parsedUrl.query;for(var ee in Q){var te=Q[ee];if('?'===te)return!0;}return!1;},J.prototype.load=function(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON();},J.prototype._loadJSON=function(){var Q=this;return new Z(function(ee,te){var oe;window.XDomainRequest?(oe=new window.XDomainRequest(),oe.onload=function(){var re=JSON.parse(oe.responseText);ee(re);},oe.onerror=function(re){te(re);}):window.XMLHttpRequest&&(oe=new XMLHttpRequest(),oe.onreadystatechange=function(){if(4===oe.readyState)if(200===oe.status){var ne=JSON.parse(oe.responseText);ee(ne);}else te(new Error('HTTP Status '+oe.status));}),oe.open('GET',Q._url,!0),oe.send();});},J.prototype._loadJSONP=function(){var Q=this,ee=!1,te=!1,oe='pesdk'+Math.round(99999999999999*Math.random());return new Z(function(re,ne){var ie=Q._createJSONPNode(oe);window[oe]=function(se){Q._removeJSONPNode(ie),ee||(te=!0,re(se));},window.setTimeout(function(){te||(Q._removeJSONPNode(ie),ee=!0,ne(new Error('Timeout of 5 seconds exceeded.')));},5e3);});},J.prototype._createJSONPNode=function(Q){var ee=this._buildJSONPUrl(Q),te=document.querySelector('head'),oe=document.createElement('script');return oe.src=ee,te.appendChild(oe),oe;},J.prototype._removeJSONPNode=function(Q){Q.parentNode.removeChild(Q);},J.prototype._buildJSONPUrl=function(Q){var ee=this._parsedUrl.query,te=null;for(var oe in ee)if('?'===ee[oe]){te=oe;break;}return delete this._parsedUrl.search,ee[te]=Q,H.default.format(this._parsedUrl);},J;}();R.default=Y;},function(M,R,I){"use strict";R.__esModule=!0;var V=I(76),U=function(N){return N&&N.__esModule?N:{default:N};}(V);R.default=function(){function N(W,$){for(var H=0,G;H<$.length;H++)G=$[H],G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),(0,U.default)(W,G.key,G);}return function(W,$,H){return $&&N(W.prototype,$),H&&N(W,H),W;};}();},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(103),X=L(J),Q=function(ee){function te(){(0,W.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,H.default)(this,ee.call.apply(ee,[this].concat(re)));return ie._value=ie.props.initialValue.clone(),ie._bindAll('_onButtonClick','_onValueChange','_onColorPickerOpen','_onColorPickerClose'),ie._events=(0,U.default)({},Y.Constants.EVENTS.COLORPICKER_OPEN,ie._onColorPickerOpen),ie.state={overlayVisible:!1},ie._transparentPatternCanvas=Y.Utils.createTransparentPatternCanvas(),ie;}return(0,Z.default)(te,ee),te.prototype.componentWillReceiveProps=function(re){re.initialValue!==this.props.initialValue&&(this._value=re.initialValue.clone(),this._renderColor());},te.prototype.componentDidMount=function(){ee.prototype.componentDidMount.call(this),this._renderColor();},te.prototype.componentDidUpdate=function(){this._renderColor();},te.prototype._onColorPickerOpen=function(re){re===this||this.setState({overlayVisible:!1});},te.prototype._onColorPickerClose=function(){this.setState({overlayVisible:!1});},te.prototype._onButtonClick=function(re){re.preventDefault(),re.stopPropagation(),this.state.overlayVisible||this._emitEvent(Y.Constants.EVENTS.COLORPICKER_OPEN,this),this.setState({overlayVisible:!this.state.overlayVisible});},te.prototype._onValueChange=function(re){this._value=re,this._renderColor(),this.forceUpdate(),this.props.onChange&&this.props.onChange(re);},te.prototype._renderColor=function(){var re=this.refs.canvas,ne=re.getContext('2d');re.width=re.offsetWidth,re.height=re.offsetHeight;var ie=ne.createPattern(this._transparentPatternCanvas,'repeat');ne.fillStyle=ie,ne.fillRect(0,0,re.width,re.height),ne.fillStyle=this._value.toRGBA(),ne.fillRect(0,0,re.width,re.height);},te.prototype.renderWithBEM=function(){var re=null;this.state.overlayVisible&&(re=Y.ReactBEM.createElement(X.default,{initialValue:this._value,onChange:this._onValueChange,onClose:this._onColorPickerClose,alpha:this.props.alpha}));var ne=this.state.overlayVisible?'is-active':null;return Y.ReactBEM.createElement('bem',{specifier:'$b:controls'},Y.ReactBEM.createElement('div',{bem:'$b:colorPicker',className:ne,onClick:this._onButtonClick},Y.ReactBEM.createElement('canvas',{bem:'e:preview',ref:'canvas'}),Y.ReactBEM.createElement('div',{bem:'e:label'},this.props.label||this._t('generic.color')),re));},te;}(Y.BaseComponent);R.default=Q,Q.contextTypes=Y.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){(0,U.default)(this,J);for(var X=arguments.length,Q=Array(X),ee=0;ee<X;ee++)Q[ee]=arguments[ee];var te=(0,W.default)(this,Y.call.apply(Y,[this].concat(Q)));return te._bindAll('_onItemDragStart','_onItemDragStop','_onItemDrag','_onSpriteUpdate'),te;}return(0,H.default)(J,Y),J.prototype._getAbsoluteSpritePosition=function(){var Q=this.context.editor,ee=Q.getOutputDimensions();return this.props.sprite.getPosition().clone().multiply(ee);},J.prototype.componentDidMount=function(){Y.prototype.componentDidMount.call(this),this.props.sprite.on('update',this._onSpriteUpdate);},J.prototype.componentWillUnmount=function(){Y.prototype.componentWillUnmount.call(this),this.props.sprite.off('update',this._onSpriteUpdate);},J.prototype.componentWillReceiveProps=function(Q){this.props.sprite.off('update',this._onSpriteUpdate),Q.sprite.on('update',this._onSpriteUpdate);},J.prototype._onSpriteUpdate=function(){this.forceUpdate();},J.prototype._onItemDragStart=function(){var Q=this.props.sprite;this._initialPosition=Q.getPosition(),this.props.onDragStart&&this.props.onDragStart();},J.prototype._onItemDrag=function(Q){var ee=this.props.sprite,te=this.context.editor,oe=te.getOutputDimensions(),re=this._initialPosition.clone().add(Q.divide(oe));ee.setPosition(re);},J.prototype._onItemDragStop=function(){this.props.onDragStop&&this.props.onDragStop();},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){(0,U.default)(this,J);for(var X=arguments.length,Q=Array(X),ee=0;ee<X;ee++)Q[ee]=arguments[ee];var te=(0,W.default)(this,Y.call.apply(Y,[this].concat(Q)));return te._bindAll('_onClick'),te;}return(0,H.default)(J,Y),J.prototype._onClick=function(){this.props.onClick&&this.props.onClick();},J.prototype._renderContent=function(){return null;},J.prototype.renderWithBEM=function(){var Q='$e:row m:'+this._modifier;return this.props.totalRows&&(Q+=' m:row-'+this.props.totalRows),G.ReactBEM.createElement('bem',{specifier:'b:splashScreen'},G.ReactBEM.createElement('div',{bem:Q},this._renderContent()));},J;}(G.BaseComponent);R.default=Z,Z.propTypes={onClick:G.React.PropTypes.func},Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(183),Y=L(Z),J=function(X){function Q(){(0,U.default)(this,Q);for(var ee=arguments.length,te=Array(ee),oe=0;oe<ee;oe++)te[oe]=arguments[oe];var re=(0,W.default)(this,X.call.apply(X,[this].concat(te)));return re._bindAll('_onNewFile'),re;}return(0,H.default)(Q,X),Q.prototype.componentDidMount=function(){this._fileLoader=new Y.default(this.refs.fileInput),this._fileLoader.on('file',this._onNewFile);},Q.prototype.componentWillUnmount=function(){this._fileLoader.off('file',this._onNewFile),this._fileLoader.dispose(),this._fileLoader=null;},Q.prototype._onNewFile=function(te){this.props.onNewFile&&this.props.onNewFile(te);},Q.prototype.open=function(){this._fileLoader.open();},Q.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('input',{type:'file',bem:'b:hiddenFileInput',ref:'fileInput'});},Q;}(G.BaseComponent);R.default=J,J.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.renderWithBEM=function(){var Q='$e:button';this.props.style&&(Q+=' m:'+this.props.style),this.props.icon&&(Q+=' m:withIcon');var ee=null;return this.props.icon&&(ee=G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath(this.props.icon,!0)})),G.ReactBEM.createElement('bem',{specifier:'$b:topBar'},G.ReactBEM.createElement('div',{bem:Q,onClick:this.props.onClick},ee,G.ReactBEM.createElement('div',{bem:'e:label'},this.props.label||'Button')));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function($){return $&&$.__esModule?$:{default:$};}(V),N=I(1),W=function(){function $(H){(0,U.default)(this,$),this._options=H,this._categoriesById={},this._categories=[{name:'retro',filters:[N.SDK.Filters.CelsiusFilter,N.SDK.Filters.ChestFilter,N.SDK.Filters.FixieFilter,N.SDK.Filters.LeninFilter,N.SDK.Filters.PolaFilter,N.SDK.Filters.Pola669Filter,N.SDK.Filters.K1Filter,N.SDK.Filters.K2Filter,N.SDK.Filters.K6Filter,N.SDK.Filters.KDynamicFilter]},{name:'bw',filters:[N.SDK.Filters.BWFilter,N.SDK.Filters.BWHardFilter,N.SDK.Filters.X400Filter]},{name:'summer',filters:[N.SDK.Filters.FrontFilter,N.SDK.Filters.MellowFilter,N.SDK.Filters.SemiredFilter,N.SDK.Filters.SunnyFilter,N.SDK.Filters.TexasFilter]},{name:'winter',filters:[N.SDK.Filters.MetalFilter,N.SDK.Filters.A15Filter,N.SDK.Filters.BreezeFilter,N.SDK.Filters.FridgeFilter,N.SDK.Filters.OrchidFilter,N.SDK.Filters.QuoziFilter]},{name:'special',filters:[N.SDK.Filters.FoodFilter,N.SDK.Filters.GlamFilter,N.SDK.Filters.LomoFilter,N.SDK.Filters.GobblinFilter]}],this._initCategories();}return $.prototype._initCategories=function(){var G=this;if(this._options.categories&&(this._options.replaceCategories?this._categories=this._options.categories:this._categories=N.Utils.mergeCategories(this._categories,this._options.categories,'filters')),this._options.selectableFilters){var Z=[];this._categories.forEach(function(J){var X=J.filters.filter(function(Q){return-1!==G._options.selectableFilters.indexOf(Q.identifier);});0<X.length&&Z.push({name:J.name,filters:X});}),this._categories=Z;}var Y={name:'all',filters:this._categories.map(function(J){return J.filters;}).reduce(function(J,X){return J.concat(X);})};this._categories.unshift(Y),this._categories.forEach(function(J){G._categoriesById[J.name]=J;});},$.prototype.getFiltersForCategory=function(G){if(!this._categoriesById[G])throw new Error('Unknown filter category \''+G+'\'');return this._categoriesById[G].filters;},$.prototype.getCategories=function(){return this._categories;},$;}();R.default=W;},function(M){var I={}.toString;M.exports=function(L){return I.call(L).slice(8,-1);};},function(M,R,I){var L=I(223);M.exports=function(V,U,N){return(L(V),void 0===U)?V:1===N?function(W){return V.call(U,W);}:2===N?function(W,$){return V.call(U,W,$);}:3===N?function(W,$,H){return V.call(U,W,$,H);}:function(){return V.apply(U,arguments);};};},function(M){M.exports=function(I){if(I==void 0)throw TypeError("Can't call method on  "+I);return I;};},function(M){M.exports='constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'.split(',');},function(M){M.exports=!0;},function(M,R,I){var L=I(15),V=I(238),U=I(48),N=I(53)('IE_PROTO'),W=function(){},$='prototype',H=function(){var G=I(79)('iframe'),Z=U.length,Y='<',J='>',X;for(G.style.display='none',I(228).appendChild(G),G.src='javascript:',X=G.contentWindow.document,X.open(),X.write(Y+'script'+J+'document.F=Object'+Y+'/script'+J),X.close(),H=X.F;Z--;)delete H[$][U[Z]];return H();};M.exports=Object.create||function(Z,Y){var J;return null===Z?J=H():(W[$]=L(Z),J=new W(),W[$]=null,J[N]=Z),void 0===Y?J:V(J,Y);};},function(M,R){R.f=Object.getOwnPropertySymbols;},function(M,R,I){var L=I(14).f,V=I(18),U=I(10)('toStringTag');M.exports=function(N,W,$){N&&!V(N=$?N:N.prototype,U)&&L(N,U,{configurable:!0,value:W});};},function(M,R,I){var L=I(54)('keys'),V=I(35);M.exports=function(U){return L[U]||(L[U]=V(U));};},function(M,R,I){var L=I(13),V='__core-js_shared__',U=L[V]||(L[V]={});M.exports=function(N){return U[N]||(U[N]={});};},function(M){var I=Math.ceil,L=Math.floor;M.exports=function(V){return isNaN(V=+V)?0:(0<V?L:I)(V);};},function(M,R,I){var L=I(47);M.exports=function(V){return Object(L(V));};},function(M,R,I){var L=I(26);M.exports=function(V,U){if(!L(V))return V;var N,W;if(U&&'function'==typeof(N=V.toString)&&!L(W=N.call(V)))return W;if('function'==typeof(N=V.valueOf)&&!L(W=N.call(V)))return W;if(!U&&'function'==typeof(N=V.toString)&&!L(W=N.call(V)))return W;throw TypeError("Can't convert object to primitive value");};},function(M,R,I){var L=I(13),V=I(9),U=I(49),N=I(59),W=I(14).f;M.exports=function($){var H=V.Symbol||(V.Symbol=U?{}:L.Symbol||{});'_'==$.charAt(0)||$ in H||W(H,$,{value:N.f($)});};},function(M,R,I){R.f=I(10);},function(M,R,I){I(247);for(var L=I(13),V=I(22),U=I(23),N=I(10)('toStringTag'),W='CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList'.split(','),$=0;$<W.length;$++){var H=W[$],G=L[H],Z=G&&G.prototype;Z&&!Z[N]&&V(Z,N,H),U[H]=U.Array;}},function(M){M.exports=d;},function(M,R,I){"use strict";function L(J){return J&&J.__esModule?J:{default:J};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(106);Object.defineProperty(R,'adjustments',{enumerable:!0,get:function(){return L(V).default;}});var U=I(114);Object.defineProperty(R,'crop',{enumerable:!0,get:function(){return L(U).default;}});var N=I(116);Object.defineProperty(R,'filter',{enumerable:!0,get:function(){return L(N).default;}});var W=I(119);Object.defineProperty(R,'focus',{enumerable:!0,get:function(){return L(W).default;}});var $=I(139);Object.defineProperty(R,'sticker',{enumerable:!0,get:function(){return L($).default;}});var H=I(145);Object.defineProperty(R,'text',{enumerable:!0,get:function(){return L(H).default;}});var G=I(109);Object.defineProperty(R,'brush',{enumerable:!0,get:function(){return L(G).default;}});var Z=I(133);Object.defineProperty(R,'selectiveBlur',{enumerable:!0,get:function(){return L(Z).default;}});var Y=I(124);Object.defineProperty(R,'frame',{enumerable:!0,get:function(){return L(Y).default;}});},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(100),Y=L(Z),J=function(X){function Q(){(0,U.default)(this,Q);var ee=(0,W.default)(this,X.call(this));return ee._bindAll('_onButtonClick'),ee.state={overlayVisible:!1},ee;}return(0,H.default)(Q,X),Q.prototype._onButtonClick=function(te){te.preventDefault(),te.stopPropagation(),this.setState({overlayVisible:!this.state.overlayVisible});},Q.prototype.renderWithBEM=function(){var te=null;this.state.overlayVisible&&(te=G.ReactBEM.createElement(Y.default,{items:this.props.items,selectedItem:this.props.selectedItem,onChange:this.props.onChange}));var oe=this.state.overlayVisible?'is-active':null;return G.ReactBEM.createElement('bem',{specifier:'$b:controls'},G.ReactBEM.createElement('div',{bem:'$e:categoryDropdown',className:oe,onClick:this._onButtonClick},G.ReactBEM.createElement('img',{bem:'e:icon',src:this.props.selectedItem.icon}),G.ReactBEM.createElement('div',{bem:'e:label'},this.props.selectedItem.label),te));},Q;}(G.BaseComponent);R.default=J,J.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(7),Y=L(Z),J=I(5),X=L(J),Q=function(ee){function te(){(0,U.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,W.default)(this,ee.call.apply(ee,[this].concat(re)));return ie._hasBackButton=!1,ie;}return(0,H.default)(te,ee),te.prototype._onItemClick=function(re){this.props.onSwitchControls(re);},te.prototype._renderListItems=function(){var re=this,ne=this.context.editor,ie=[],se=function(ce){var ue=ne.controls.get(ce);return G.ReactBEM.createElement('li',{bem:'e:item',key:ue.identifier,"data-identifier":ue.identifier,onClick:re._onItemClick.bind(re,ue)},G.ReactBEM.createElement('bem',{specifier:'$b:controls'},G.ReactBEM.createElement('div',{bem:'$e:button m:withLabel'},G.ReactBEM.createElement('img',{bem:'e:icon',src:re._getAssetPath(ue.iconPath,!0)}),G.ReactBEM.createElement('div',{bem:'e:label'},re._t(ue.languageKey)))));},le=this.context.options.editor.controlsOrder;le.forEach(function(pe){if(Array.isArray(pe)){var ue=[];pe.forEach(function(fe){ne.controls.isEnabled(fe)&&ue.push(se(fe));}),ue.length&&ie.push(ue);}else{var me=pe;if(!ne.controls.isEnabled(me))return;ie.push(se(me));}});var de=[];return ie.forEach(function(pe){de=de.concat(pe),pe!==ie[ie.length-1]&&de.push(G.ReactBEM.createElement('li',{bem:'e:separator'}));}),de;},te.prototype.renderControls=function(){var re=this._renderListItems();return G.ReactBEM.createElement('div',{bem:'e:cell m:list'},G.ReactBEM.createElement(X.default,null,G.ReactBEM.createElement('ul',{bem:'$e:list'},re)));},te;}(Y.default);R.default=Q,Q.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.componentDidMount=function(){Y.prototype.componentDidMount.call(this),this._renderCanvas();},J.prototype.componentDidUpdate=function(){this._renderCanvas();},J.prototype._renderCanvas=function(){var Q=this.refs.canvas,ee=this.context.editor,te=ee.getSDK(),oe=te.getPixelRatio();Q.width=Q.offsetWidth*oe,Q.height=Q.offsetHeight*oe,Q.style.width=Q.offsetWidth+'px',Q.style.height=Q.offsetHeight+'px';var re=Q.getContext('2d');re.fillStyle='red',re.clearRect(0,0,Q.width,Q.height),re.font=(this.props.fontStyle||'')+' '+(this.props.fontWeight||'')+' '+24*oe+'px '+this.props.fontFamily,re.textBaseline='middle',re.textAlign='center',re.fillStyle='white',re.fillText('Abc',Q.width/2,Q.height/2);},J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('canvas',{bem:'b:fontFamily e:canvas',ref:'canvas'});},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){(0,U.default)(this,J);for(var X=arguments.length,Q=Array(X),ee=0;ee<X;ee++)Q[ee]=arguments[ee];var te=(0,W.default)(this,Y.call.apply(Y,[this].concat(Q)));return te._bindAll('_onClick'),te;}return(0,H.default)(J,Y),J.prototype._onClick=function(){this.props.onClick&&this.props.onClick(this.props.searchSuggestion);},J.prototype.renderWithBEM=function(){var Q=this.props.searchSuggestion,ee={backgroundImage:'url('+Q.coverImage+')'};return G.ReactBEM.createElement('bem',{specifier:'b:photoRoll e:libraryList'},G.ReactBEM.createElement('li',{bem:'e:item',style:ee,onClick:this._onClick},G.ReactBEM.createElement('div',{bem:'e:overlay'}),G.ReactBEM.createElement('div',{bem:'e:name'},Q.query)));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(re){return re&&re.__esModule?re:{default:re};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(6),Y=L(Z),J=I(160),X=L(J),Q=I(5),ee=L(Q),oe=function(re){function ne(){(0,U.default)(this,ne);for(var ie=arguments.length,se=Array(ie),le=0;le<ie;le++)se[le]=arguments[le];var de=(0,W.default)(this,re.call.apply(re,[this].concat(se)));return de._needsStyleFixes=!0,de._totalPhotosHeight=0,de.state={loading:!1,photos:[]},de;}return(0,H.default)(ne,re),ne.prototype.componentDidMount=function(){re.prototype.componentDidMount.call(this),this._loadPhotos();},ne.prototype.componentDidUpdate=function(){this.refs.scrollbar&&this.refs.scrollbar.update();},ne.prototype._onPhotoClicked=function(se){this.props.onPhotoClicked&&this.props.onPhotoClicked(se);},ne.prototype._getHeadline=function(){return this.props.library.name;},ne.prototype.fixStyles=function(){if(G.Utils.Browser.isIElte(11)){var se=this.refs.cell,le=this.refs.scrollbar.getList();if(!(se&&le))return;var de=se.offsetHeight;le.style.height=de+'px';}this.refs.scrollbar&&this.refs.scrollbar.update();},ne.prototype._renderColumns=function(){for(var se=this,le=this.state.photos,de=3,pe=[],ce=[],ue=0;ue<de;ue++)ce.push([]),pe.push(0);return le.forEach(function(me){for(var fe=me.dimensions,ge=null,he=Infinity,ye=0;ye<de;ye++)pe[ye]<he&&(ge=ye,he=pe[ye]);ce[ge].push(G.ReactBEM.createElement(X.default,{photo:me.obj,onClick:se._onPhotoClicked.bind(se,me.obj)})),pe[ge]+=fe.y;}),ce;},ne.prototype._renderPhotos=function(){var se=this._renderColumns();return G.ReactBEM.createElement('div',{bem:'$b:photoRoll e:row m:fullHeight'},G.ReactBEM.createElement('div',{bem:'e:cell',ref:'cell'},G.ReactBEM.createElement(ee.default,{direction:'vertical',ref:'scrollbar'},G.ReactBEM.createElement('div',{bem:'e:container',ref:'container'},G.ReactBEM.createElement('div',{bem:'e:innerContainer'},G.ReactBEM.createElement('div',{bem:'e:headline'},this._getHeadline()),G.ReactBEM.createElement('bem',{specifier:'e:photoList'},se.map(function(le){return G.ReactBEM.createElement('ul',{bem:'$e:list'},le);})))))));},ne.prototype._loadPhotos=function(){var se=this;this._totalPhotosHeight=0;var le=Y.default.instance.displayProgress(this._t('loading.loading')),de=this.context.options.photoRoll.provider,pe=new de();pe.getPhotosForLibrary(this.props.library).then(function(ce){return se._preloadPhotos(ce,le);}).then(function(ce){se.setState({photos:ce,loading:!1}),le.close();}).catch(function(ce){console.log(ce),le.close(),Y.default.instance.displayError(se._t('errors.photoRollLoadFail.title'),se._t('errors.photoRollLoadFail.text',{error:ce.message}));});},ne.prototype._preloadPhotos=function(se,le){var de=this,pe=se.length,ce=0;return Promise.all(se.map(function(ue){return de._preloadPhoto(ue).then(function(me){var fe=new G.Vector2(me.width,me.height);return fe.multiply(240/me.width),de._totalPhotosHeight+=fe.y,ce++,le.setData({progress:ce/pe}),{obj:ue,dimensions:fe};});}));},ne.prototype._preloadPhoto=function(se){return new Promise(function(le){var pe=new window.Image();pe.addEventListener('load',function(){le(pe);}),pe.addEventListener('error',function(){le(pe);}),pe.crossOrigin='Anonymous',pe.src=se.urls.thumb;});},ne.prototype.renderWithBEM=function(){return this.state.loading?G.ReactBEM.createElement('div',null):this._renderPhotos();},ne;}(G.BaseComponent);R.default=oe,oe.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(38),W=L(N),Z=function(){function Y(J,X,Q){(0,U.default)(this,Y),this._parent=J,this._type=X,this._name=Q;}return Y.prototype.element=function(X){return new Y(this,'element',X);},Y.prototype.modifier=function(X){return new Y(this,'modifier',X);},(0,W.default)(Y,[{key:'str',get:function(){var X=this._parent?this._parent.str:'';switch(this._type){case'block':X+=''+'pesdk-react-'+this._name;break;case'element':X+=''+'__'+this._name;break;case'modifier':X+=''+'--'+this._name;}return X;}}]),Y;}();R.default={block:function(J){return new Z(null,'block',J);}};},function(M,R,I){"use strict";function L(ce){return ce&&ce.__esModule?ce:{default:ce};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(181),Y=L(Z),J=I(188),X=L(J),Q=I(179),ee=L(Q),te=I(176),oe=L(te),re=I(177),ne=L(re),ie=I(180),se=L(ie),le=I(178),de=L(le),pe=function(ce){function ue(me,fe,ge){var he=3<arguments.length&&void 0!==arguments[3]&&arguments[3];(0,U.default)(this,ue);var ye=(0,W.default)(this,ce.call(this));return ye._ui=me,ye._options=fe,ye._mediator=ge,ye._ready=!1,ye._padding=[0,0,0,0],he||(ye._initSDK(),ye._onZoom=ye._onZoom.bind(ye),ye._onUndo=ye._onUndo.bind(ye),ye.operations=new ee.default(ye,ye._sdk,ye._mediator),ye.history=new de.default(ye,ye._sdk,ye._mediator),ye.history.on('undo',ye._onUndo),ye.zoom=new se.default(ye,ye._sdk,ye._mediator),ye.zoom.on('set',ye._onZoom),ye._initSerializers()),ye.controls=new oe.default(ye,ye._sdk,ye._mediator),ye.features=new ne.default(ye,ye._sdk,ye._mediator),ye._running=!1,ye._renderRequested=!0,ye._renderCallbacks=[],ye._animationFrameRequest=null,ye.render=ye.render.bind(ye),ye._tick=ye._tick.bind(ye),ye;}return(0,H.default)(ue,ce),ue.prototype.setImage=function(){var fe=this,ge=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._options.editor.image,he=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,ye=this._sdk.getRenderer(),be=new G.Vector2(ge.naturalWidth,ge.naturalHeight),Ee=1e6*this.getMaxMegapixels(),Se=ye.getMaxDimensions();he&&this.reset();var ve=new X.default(ge,Ee,Se),Me=null,Ce=function(Be){var xe=1<arguments.length&&void 0!==arguments[1]?arguments[1]:be,ke=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;fe._setImage(Be,Me,xe),fe._initWatermark(),fe._ready=!0,fe.emit('ready');};ve.needsResize()?(this.emit('resize'),Me=this._sdk.parseExif(ge),ve.resize().then(function(Re){var Be=Re.canvas,xe=Re.dimensions,ke=Re.reason;Be.src='data:image/jpeg;base64,',fe.emit('resized',{dimensions:xe,reason:ke}),Ce(Be,xe,ke);})):Ce(ge);},ue.prototype._initWatermark=function(){this._options.editor.watermarkImage&&(this._watermarkOperation=this.operations.getOrCreate('watermark',{image:this._options.editor.watermarkImage}));},ue.prototype._initSDK=function(){var fe=this._options,ge=fe.logLevel,he=fe.displayWelcomeMessage,ye=fe.debug,be=fe.apiKey,Ee=this._options.editor,Se=Ee.smoothDownscaling,ve=Ee.smoothUpscaling,Me=Ee.preferredRenderer,Ce=Ee.pixelRatio;this._sdk=new G.SDK(Me,{logLevel:ge,debug:ye,displayWelcomeMessage:he,pixelRatio:Ce,smoothDownscaling:Se,smoothUpscaling:ve,transparent:!0,apiKey:be});},ue.prototype._onZoom=function(){var ge=this,he=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.fixOffset(),this.render(function(){ge._mediator.emit(G.Constants.EVENTS.ZOOM_DONE),he&&he();});},ue.prototype._onUndo=function(){this.render();},ue.prototype.getRotation=function(){return this._sdk.getRotation();},ue.prototype.setRotation=function(fe){this._sdk.setRotation(fe);},ue.prototype.getSpriteScale=function(){return this._sdk.getSpriteScale();},ue.prototype.setSpriteScale=function(fe){this._sdk.setSpriteScale(fe);},ue.prototype.isToolEnabled=function(fe){return-1!==this._options.editor.tools.indexOf(fe);},ue.prototype.getMaxMegapixels=function(){var fe=this._options.editor.maxMegaPixels;return G.Utils.isMobile()?fe.mobile:fe.desktop;},ue.prototype.getOutputDimensions=function(){var fe=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this._sdk.getOutputDimensions(fe);},ue.prototype.getOutputTextureDimensions=function(){var fe=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this._sdk.getOutputTextureDimensions(fe);},ue.prototype.getFinalDimensions=function(){var fe=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this._sdk.getFinalDimensions(fe);},ue.prototype.getCanvasDimensions=function(){var fe=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,ge=this._sdk.getCanvas(),he=new G.Vector2(ge.offsetWidth,ge.offsetHeight);return fe&&he.subtract(this._padding[1]+this._padding[3],this._padding[0]+this._padding[2]),he;},ue.prototype._setImage=function(){var fe=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._options.editor.image,ge=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,he=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;this._sdk.setAllOperationsToDirty(),this._options.editor.image=fe,this._sdk.setImage(fe,ge,he),this.zoom.set('auto'),this.emit('new-image');},ue.prototype.export=function(){var fe=this,ge=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._watermarkOperation&&this._watermarkOperation.setEnabled(!1),this._sdk.setAllOperationsToDirty();var he=this._options.editor.export,ye=new Y.default(this._sdk,he,ge);return ye.export().then(function(be){return fe.emit('export',be),fe._mediator.emit(G.Constants.EVENTS.EXPORT,be,fe),fe._watermarkOperation&&(fe._watermarkOperation.setEnabled(!0),fe._sdk.render()),fe._sdk.setAllOperationsToDirty(),be;});},ue.prototype._initSerializers=function(){this._serializers={"1.0.0":I(196).default,"1.0.1":I(198).default};},ue.prototype.serialize=function(){var fe=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},ge=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'1.0.1',he=this._serializers[ge];if(!he)return G.Promise.reject(new Error('No serializer for version '+ge+' found.'));var ye=new he(this);return ye.serialize(fe);},ue.prototype.deserialize=function(fe){var ge=this._serializers[fe.version];if(!ge)return G.Promise.reject(new Error('No serializer for version '+fe.version+' found.'));var he=new ge(this);return he.deserialize(fe);},ue.prototype._applyOffset=function(){var fe=this._offset.clone();fe.x-=this._padding[1]/2,fe.x+=this._padding[3]/2,fe.y-=this._padding[2]/2,fe.y+=this._padding[0]/2,this._sdk.setOffset(fe);},ue.prototype.start=function(){this.zoom.set('auto'),this._animationFrameRequest=(0,G.requestAnimationFrame)(this._tick);},ue.prototype.stop=function(){this._running=!1,this._animationFrameRequest&&((0,G.cancelAnimationFrame)(this._animationFrameRequest),this._renderCallbacks=[]);},ue.prototype.render=function(fe){this._renderRequested=!0,fe&&this._renderCallbacks.push(fe);},ue.prototype.setOffset=function(fe){this._offset=this._clampOffset(fe);},ue.prototype.getOffset=function(){return this._offset;},ue.prototype.fixOffset=function(){this.setOffset(this._sdk.getOffset());},ue.prototype._clampOffset=function(fe){var ge=this._sdk.getRenderer(),he=new G.Vector2(ge.getWidth(),ge.getHeight()),ye=this._sdk.getOutputDimensions(!1),be=he.clone().subtract(ye).divide(2).clamp(null,new G.Vector2(0,0)),Ee=ye.clone().subtract(he).divide(2).clamp(new G.Vector2(0,0),null),Se=fe.clone().clamp(be,Ee).round();return Se;},ue.prototype._tick=function(){var fe=this;if(this._renderRequested){var ge=this._renderCallbacks.slice(0);this._renderCallbacks=[],this._render().then(function(){ge.forEach(function(he){return he();}),fe._animationFrameRequest=(0,G.requestAnimationFrame)(fe._tick);}).catch(function(he){G.Log.printError(he);}),this._renderRequested=!1;}else this._animationFrameRequest=(0,G.requestAnimationFrame)(this._tick);},ue.prototype._render=function(){var fe=this;return this._ready?(this._applyOffset(),this._sdk.render().then(function(){fe._lastOutputBounds=fe._sdk.getSprite().getBounds();}).catch(function(ge){fe.emit('render-error',ge);})):G.Promise.resolve();},ue.prototype.reset=function(){this._sdk.reset(),this.history.reset(),this.operations.reset();},ue.prototype.dispose=function(){this.stop(),this._sdk.dispose();},ue.prototype.isReady=function(){return this._ready;},ue.prototype.getRenderer=function(){return this._sdk.getRenderer();},ue.prototype.getSDK=function(){return this._sdk;},ue.prototype.getInputDimensions=function(){return this._sdk.getInputDimensions();},ue.prototype.getPadding=function(){return this._padding;},ue.prototype.setPadding=function(fe){this._padding=fe?fe:[0,0,0,0];},ue.prototype.getImage=function(){return this._options.editor.image;},ue.prototype.getOptions=function(){return this._options;},ue.prototype.getUI=function(){return this._ui;},ue.prototype.broadcastCrop=function(fe,ge){var he=this;['sprite','selective-blur'].forEach(function(be){var Ee=he.operations.get(be);Ee&&Ee.crop(fe,ge);});},ue.prototype.broadcastFlip=function(fe){var ge=this;['linear-focus','radial-focus','sprite','selective-blur'].forEach(function(ye){var be=ge.operations.get(ye);be&&be.flip(fe);});},ue.prototype.broadcastRotate=function(fe){var ge=this;['crop','linear-focus','radial-focus','sprite','selective-blur'].forEach(function(ye){var be=ge.operations.get(ye);be&&be.rotate(fe);});},ue;}(G.EventEmitter);R.default=pe;},function(M,R,I){"use strict";function L(J){return J&&J.__esModule?J:{default:J};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=G.SDK.OptionType,Y=function(J){function X(){return(0,U.default)(this,X),(0,W.default)(this,J.apply(this,arguments));}return(0,H.default)(X,J),X;}(G.SDK.Configurable);R.default=Y,Y.prototype.availableOptions={name:{type:Z.STRING,required:!0},fontWeight:{type:Z.ALL,default:400},fontFamily:{type:Z.STRING,required:!0},fontStyle:{type:Z.STRING,default:'normal'},provider:{type:Z.STRING,available:['google']},default:{type:Z.BOOLEAN,default:!1}};},function(M,R,I){"use strict";function L(G){return G&&G.__esModule?G:{default:G};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(1),W=I(37),$=L(W),H=function(){function G(Z){(0,U.default)(this,G),this._options=Z,this._categoriesById={},this._categories=N.Constants.DEFAULTS.STICKER_CATEGORIES.slice(0),this._options.categories?this._addCategories(this._options.categories):(this._updateCategoriesMap(),this._updateAllCategory());}return G.prototype.loadExternal=function(Y){var J=this,X=new $.default(Y);return X.load().then(function(Q){J._addCategories(Q.categories);});},G.prototype._addCategories=function(Y){var J=this._options.replaceCategories;this._categories=J?Y.slice(0):N.Utils.mergeCategories(this._categories,Y,'stickers'),this._updateCategoriesMap(),this._updateAllCategory();},G.prototype._updateCategoriesMap=function(){var Y=this;this._categoriesById={},this._categories.forEach(function(J){Y._categoriesById[J.name]=J;});},G.prototype._updateAllCategory=function(){this._allCategory={name:'all',label:this._options.allCategoryLabel,stickers:this._categories.map(function(Y){return Y.stickers;}).reduce(function(Y,J){return Y.concat(J);},[])},this._categoriesById.all=this._allCategory;},G.prototype.getStickersForCategory=function(Y){if(!this._categoriesById[Y])throw new Error('Unknown sticker category \''+Y+'\'');return this._categoriesById[Y].stickers;},G.prototype.getCategories=function(){return[this._allCategory].concat(this._categories);},G.prototype.getCategory=function(Y){return this._categoriesById[Y];},G;}();R.default=H;},function(M,R,I){"use strict";function L(te){return te&&te.__esModule?te:{default:te};}function V(te){for(var oe=[],re=0;re<te.length;re++)te[re]instanceof Array?oe=oe.concat(V(te[re])):oe.push(te[re]);return oe;}Object.defineProperty(R,"__esModule",{value:!0});var U=I(213),N=L(U),W=I(33),$=L(W),H=I(61),G=L(H),Z=I(77),Y=L(Z),J=I(68),X=L(J),Q={b:'block',e:'element',m:'modifier'};R.default={_parseBemSpecifier:function(oe){if(!oe)return[];var re=oe.split(' '),ne=re.map(function(ie){var se=ie.match(/^(\$)?([bem]):(.*)$/i);if(!se)throw new Error('Invalid BEM specifier: '+ie);var le='undefined'!=typeof se[1],de=Q[se[2]],pe=se[3];return{type:de,name:pe,pass:le};});return ne;},_getBemInfoForNode:function(oe){var re='bem'===oe.type,ne=re?oe.props.specifier:oe.props.bem;if(re&&!ne)throw new Error('<bem> elements should always have a `specifier` property');var ie=this._parseBemSpecifier(ne);return re&&ie.forEach(function(se){se.pass=!0;}),{data:ie,isBemNode:re};},createElement:function(oe,re){for(var ne=arguments.length,ie=Array(2<ne?ne-2:0),se=2;se<ne;se++)ie[se-2]=arguments[se];return re=re||{},ie=ie.filter(function(le){return null!==le&&'undefined'!=typeof le;}),{type:oe,props:re,children:ie};},_isNodeBEMable:function(oe){return null!==oe&&'object'===('undefined'==typeof oe?'undefined':(0,$.default)(oe))&&!G.default.isValidElement(oe);},_applyBEMClasses:function(oe){var re=this;if(!this._isNodeBEMable(oe))return oe;var ne=oe.props.className?[oe.props.className]:[],ie=this._getBemInfoForNode(oe),se=oe.props.__bemObject,le=oe.props.__bemObject;ie.data.forEach(function(pe){if('block'===pe.type)se=X.default.block(pe.name),pe.pass&&(le=X.default.block(pe.name)),ne.push(se.str);else if('element'===pe.type){if(!se)throw new Error('Tried to create an element, but no parent block has been found.');se=se.element(pe.name),pe.pass&&(le=le.element(pe.name)),ne.push(se.str);}else if('modifier'===pe.type){if(!se)throw new Error('Tried to create a modifier, but no parent block has been found.');pe.pass&&(le=le.modifier(pe.name)),ne.push(se.modifier(pe.name).str);}});var de=(0,Y.default)(ne);return de&&(oe.props.className=de),oe.children=V(oe.children),oe.children.forEach(function(pe){re._isNodeBEMable(pe)&&(pe.props.__bemObject=le);}),oe.children=oe.children.map(function(pe){return re._applyBEMClasses(pe);}),oe.children=V(oe.children),delete oe.props.__bemObject,delete oe.props.bem,ie.isBemNode&&(oe.children instanceof Array&&1===oe.children.length?oe=oe.children[0]:oe=oe.children),oe;},_transformToReact:function(oe){var re=this;return this._isNodeBEMable(oe)?(oe.children=oe.children.map(function(ne){return re._transformToReact(ne);}),G.default.createElement.apply(G.default,[oe.type,oe.props].concat((0,N.default)(oe.children)))):oe;},transform:function(oe){return(oe=this._applyBEMClasses(oe),oe instanceof Array)?oe:(oe=this._transformToReact(oe),oe);}};},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(1),W=I(44),$=L(W),H=I(71),G=L(H),Z=function(){function Y(J,X){(0,U.default)(this,Y),this._editor=J,this._data=X,this._filterManager=new $.default(this._editor._options),this._stickerManager=new G.default(this._editor._options);}return Y.prototype.deserialize=function(){var X=this;return this._validateVersion().then(function(){return X._deserializeInputImage();}).then(function(){return X._deserializeOperations();}).then(function(){return X._editor.zoom.set('auto');});},Y.prototype._validateVersion=function(){return'1.0.0'===this._data.version?Promise.resolve():Promise.reject(new Error('Invalid version '+this._data.version+', expected 1.0.0'));},Y.prototype._deserializeInputImage=function(){var X=this;return new Promise(function(Q){var te=X._data.inputImage,oe=te.data,re=te.type;if(oe&&re){var ne=new window.Image();ne.addEventListener('load',function(){X._editor.setImage(ne),Q();}),ne.src='data:'+re+';base64,'+oe;}else Q();});},Y.prototype._deserializeOperations=function(){var X=this,Q=this._data.operations.map(function(ee){switch(ee.type){case'crop':return X._deserializeCropOperation(ee);case'orientation':return X._deserializeOrientationOperation(ee);case'filter':return X._deserializeFilterOperation(ee);case'adjustments':return X._deserializeAdjustmentsOperation(ee);case'sprite':return X._deserializeSpriteOperation(ee);case'focus':return X._deserializeFocusOperation(ee);}});return Promise.all(Q);},Y.prototype._deserializeCropOperation=function(X){var Q=X.options,ee=Q.scale,te=Q.rotation,oe=N.Vector2.fromObject(Q.start),re=N.Vector2.fromObject(Q.end);return te>Math.PI&&(te-=2*Math.PI),this._editor.operations.getOrCreate('crop',{start:oe,end:re,scale:ee,rotation:te}),Promise.resolve();},Y.prototype._deserializeOrientationOperation=function(X){var Q=X.options;this._editor.operations.getOrCreate('orientation',Q);},Y.prototype._deserializeFilterOperation=function(X){for(var Q=X.options,ee=this._filterManager.getFiltersForCategory('all'),te=void 0,oe=0,re;oe<ee.length;oe++)if(re=ee[oe],re.identifier===Q.name){te=re;break;}if(!te)throw new Error('Unknown filter \''+Q.name+'\'');this._editor.operations.getOrCreate('filter',{filter:new te(),intensity:Q.intensity});},Y.prototype._deserializeAdjustmentsOperation=function(X){var Q=N.SDK.Operations.AdjustmentsOperation,ee=X.options,te={};for(var oe in ee){var re=ee[oe],ne=Q.prototype.availableOptions[oe].default;te[oe]=re+ne;}this._editor.operations.getOrCreate('adjustments',te);},Y.prototype._deserializeSpriteOperation=function(X){var Q=this,ee=X.options,te=this._editor.operations.getOrCreate('sprite'),oe=ee.sprites.map(function(re){switch(re.type){case'sticker':return Q._deserializeSticker(te,re);case'text':return Q._deserializeText(te,re);case'brush':return Q._deserializeBrush(te,re);}}).filter(function(re){return!!re;});return Promise.all(oe).then(function(re){te.setSprites(re);});},Y.prototype._deserializeSticker=function(X,Q){for(var ee=this,te=N.SDK.Operations.SpriteOperation,oe=Q.options,re=this._stickerManager.getStickersForCategory('all'),ne=void 0,ie=0;ie<re.length;ie++)if(re[ie].name===oe.name){ne=re[ie];continue;}if(!ne)throw new Error('Unknown sticker \''+oe.name+'\'');return new Promise(function(se){var de=new window.Image();de.addEventListener('load',function(){var pe=te.Sticker.prototype.availableOptions.adjustments.structure,ce=oe.rotation,ue=oe.flipHorizontally,me=oe.flipVertically;se(X.createSticker({image:de,position:N.Vector2.fromObject(oe.position),dimensions:N.Vector2.fromObject(oe.dimensions),rotation:ce,flipHorizontally:ue,flipVertically:me,adjustments:{brightness:oe.adjustments.brightness+pe.brightness.default,saturation:oe.adjustments.saturation+pe.saturation.default,contrast:oe.adjustments.contrast+pe.contrast.default}}));}),de.crossOrigin='Anonymous',de.src=ee._editor.getUI().getAssetPath(ne.images.mediaBase.uri);});},Y.prototype._deserializeText=function(X,Q){var ee=Q.options,te=ee.fontSize,oe=ee.lineHeight,re=ee.fontFamily,ne=ee.fontWeight,ie=ee.alignment,se=ee.rotation,le=ee.maxWidth,de=ee.color,pe=ee.backgroundColor;return Promise.resolve(X.createText({fontSize:te,lineHeight:oe,fontFamily:re,fontWeight:ne,alignment:ie,rotation:se,maxWidth:le,text:ee.text,color:N.Color.fromArray(de),backgroundColor:N.Color.fromArray(pe),position:N.Vector2.fromObject(ee.position)}));},Y.prototype._deserializeBrush=function(X,Q){var ee=Q.options,te=ee.paths,oe=X.createBrush();return te.forEach(function(re){var ne=re.color,ie=re.size,se=re.points,le=new N.Color(ne[0],ne[1],ne[2],ne[3]),de=oe.createPath(ie,1,le);se.forEach(function(pe){de.addControlPoint(N.Vector2.fromObject(pe));});}),Promise.resolve(oe);},Y.prototype._deserializeFocusOperation=function(X){var Q=X.options.options;switch(X.options.type){case'radial':{var ee=Q.position,te=Q.radius,oe=Q.gradientRadius,re=Q.blurRadius;this._editor.operations.getOrCreate('radial-focus',{position:N.Vector2.fromObject(ee),radius:te,gradientRadius:oe,blurRadius:re});}break;case'linear':{var ne=Q.start,ie=Q.end,se=Q.size,le=Q.gradientSize,de=Q.blurRadius;this._editor.operations.getOrCreate('linear-focus',{start:N.Vector2.fromObject(ne),end:N.Vector2.fromObject(ie),size:se,gradientSize:le,blurRadius:de});}}},Y.prototype._getInputDimensionsForOperation=function(X){var Q=!1,ee=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(function(te){te===X&&(Q=!0),Q||(ee=te.getNewDimensions(ee));}),ee;},Y;}();R.default=Z;},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function(H){return H&&H.__esModule?H:{default:H};}(V),N=I(1),W=2*Math.PI,$=function(){function H(G){(0,U.default)(this,H),this._editor=G,this._serializeOperations=this._serializeOperations.bind(this);}return H.prototype.serialize=function(){var Z=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._options=N.SDKUtils.defaults(Z,{image:!0});return this._serializeInputImage({version:'1.0.0'}).then(this._serializeOperations);},H.prototype._serializeInputImage=function(Z){var Y=this._editor.getImage();if(!this._options.image)return Z.inputImage={width:Y.width,height:Y.height},Promise.resolve(Z);var J=new N.SDK('webgl',{image:Y});return J.export(N.RenderType.DATA_URL,N.ImageFormat.PNG).then(function(X){var Q=Y.width,ee=Y.height;return Z.inputImage={type:N.ImageFormat.PNG,data:X.replace(/^data:image\/(.*?);base64,/,''),width:Q,height:ee},Z;});},H.prototype._serializeOperations=function(Z){var Y=this,J=[],X=this._editor.operations.getStack();return X.forEach(function(Q){J.push(Y._serializeOperation(Q));}),Z.operations=J,Promise.resolve(Z);},H.prototype._serializeOperation=function(Z){switch(Z.constructor.identifier){case'crop':return this._serializeCropOperation(Z);case'orientation':return this._serializeOrientationOperation(Z);case'filter':return this._serializeFilterOperation(Z);case'adjustments':return this._serializeAdjustmentsOperation(Z);case'sprite':return this._serializeSpriteOperation(Z);case'radial-focus':return this._serializeRadialFocusOperation(Z);case'linear-focus':return this._serializeLinearFocusOperation(Z);default:throw new Error('Unable to serialize operation of type '+Z.constructor.identifier);}},H.prototype._serializeCropOperation=function(Z){var Y=Z.serializeOptions(['start','end','rotation','scale'],!0);return Y.rotation=(Y.rotation+W)%W,{type:'crop',options:Y};},H.prototype._serializeOrientationOperation=function(Z){return{type:'orientation',options:Z.serializeOptions(['flipVertically','flipHorizontally','rotation'],!0)};},H.prototype._serializeFilterOperation=function(Z){return{type:'filter',options:{intensity:Z.getIntensity(),name:Z.getFilter().constructor.identifier}};},H.prototype._serializeAdjustmentsOperation=function(Z){var Y=Z.availableOptions,J={};for(var X in Y){var Q=Y[X],ee=Z.getOption(X);ee!==Q.default&&(J[X]=ee-Q.default);}return{type:'adjustments',options:J};},H.prototype._serializeSpriteOperation=function(Z){var Y=this,J=Z.getSprites().map(function(X){return X instanceof Z.constructor.Sticker?Y._serializeSticker(Z,X):X instanceof Z.constructor.Text?Y._serializeText(Z,X):X instanceof Z.constructor.Brush?Y._serializeBrush(Z,X):void 0;});return{type:'sprite',options:{sprites:J}};},H.prototype._serializeSticker=function(Z,Y){var J=Y.getAdjustments(),X=Y.serializeOptions(['name','position','dimensions','flipVertically','flipHorizontally','rotation'],!0);X.rotation=(X.rotation+W)%W;var Q=J.availableOptions;return X.adjustments={brightness:J.getBrightness()-Q.brightness.default,saturation:J.getSaturation()-Q.saturation.default,contrast:J.getContrast()-Q.contrast.default},{type:'sticker',options:X};},H.prototype._serializeText=function(Z,Y){var J=Y.serializeOptions(['fontSize','lineHeight','fontFamily','fontWeight','alignment','color','backgroundColor','position','rotation','text','maxWidth'],!0);return J.rotation=(J.rotation+W)%W,{type:'text',options:J};},H.prototype._serializeBrush=function(Z,Y){var J=this;return{type:'brush',options:{paths:Y.getPaths().map(function(X){return J._serializePath(X);})}};},H.prototype._serializePath=function(Z){var Y=Z.serializeOptions(['color','thickness'],!0);return Y.size=Y.thickness,delete Y.thickness,Y.points=Z.getControlPoints().map(function(J){return J.getPosition().toObject();}),Y;},H.prototype._serializeRadialFocusOperation=function(Z){return{type:'focus',options:{type:'radial',options:Z.serializeOptions(['position','radius','gradientRadius','blurRadius'],!0)}};},H.prototype._serializeLinearFocusOperation=function(Z){return{type:'focus',options:{type:'linear',options:Z.serializeOptions(['start','end','blurRadius','size','gradientSize'],!0)}};},H.prototype._getInputDimensionsForOperation=function(Z){var Y=!1,J=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(function(X){X===Z&&(Y=!0),Y||(J=X.getNewDimensions(J));}),J;},H;}();R.default=$;},function(M,R,I){"use strict";(function(L){Object.defineProperty(R,"__esModule",{value:!0});var V='warn',U=[{type:'trace',background:'#EEEEEE',color:'#AAAAAA'},{type:'info',background:'#BDE5F8',color:'#00529B'},{type:'warn',background:'#FEEFB3',color:'#9F6000'},{type:'error',background:'#FFBABA',color:'#D8000C'},{type:'log',background:'#EEEEEE',color:'#1f4f6b'}],N=U.map(function($){return $.type;}),W={};W.setLevel=function($){V=$;},W.canLog=function($){if(null===V)return!1;var H=N.indexOf($),G=N.indexOf(V);return!(H<G);},W.hasColorfulOutput=function(){return(!L||L&&L.browser)&&'undefined'!=typeof navigator&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/);},W.printError=function($){var H=$.stack.split('\n');H.forEach(function(G){W.error('Error',G);});},U.forEach(function($){var H=$.type,G=$.background,Z=$.color;W[H]=function(Y){if(W.canLog(H)){for(var J=arguments.length,X=Array(1<J?J-1:0),Q=1;Q<J;Q++)X[Q-1]=arguments[Q];var ee=X.map(function(te){return'string'==typeof te?te:te.toString();}).join(' ');return W.hasColorfulOutput()?void console.log('%c  %c PhotoEditorSDK %c  %c '+Y+' %c  '+ee+'  %c  ','background: #43ADEB; line-height: 20px; padding: 4px 0','background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0','background: #43ADEB; line-height: 20px; padding: 4px 0','background: '+G+'; color: '+Z+'; line-height: 20px; padding: 4px 0; font-weight: bold','background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0','background: #43ADEB; line-height: 20px; padding: 4px 0'):console.log('PhotoEditorSDK | '+Y+' | '+ee);}};}),R.default=W;}).call(R,I(90));},function(M,R,I){M.exports={default:I(219),__esModule:!0};},function(M,R){var L,V;(function(){'use strict';function U(){for(var W=[],$=0,H;$<arguments.length;$++)if(H=arguments[$],H){var G=typeof H;if('string'==G||'number'==G)W.push(H);else if(Array.isArray(H))W.push(U.apply(null,H));else if('object'==G)for(var Z in H)N.call(H,Z)&&H[Z]&&W.push(Z);}return W.join(' ');}var N={}.hasOwnProperty;'undefined'!=typeof M&&M.exports?M.exports=U:(L=[],V=function(){return U;}.apply(R,L),!(V!==void 0&&(M.exports=V)));})();},function(M,R,I){var L=I(45),V=I(10)('toStringTag'),U='Arguments'==L(function(){return arguments;}()),N=function(W,$){try{return W[$];}catch(H){}};M.exports=function(W){var $,H,G;return W===void 0?'Undefined':null===W?'Null':'string'==typeof(H=N($=Object(W),V))?H:U?L($):'Object'==(G=L($))&&'function'==typeof $.callee?'Arguments':G;};},function(M,R,I){var L=I(26),V=I(13).document,U=L(V)&&L(V.createElement);M.exports=function(N){return U?V.createElement(N):{};};},function(M,R,I){M.exports=!I(16)&&!I(25)(function(){return 7!=Object.defineProperty(I(79)('div'),'a',{get:function(){return 7;}}).a;});},function(M,R,I){var L=I(45);M.exports=Object('z').propertyIsEnumerable(0)?Object:function(V){return'String'==L(V)?V.split(''):Object(V);};},function(M,R,I){"use strict";var L=I(49),V=I(17),U=I(86),N=I(22),W=I(18),$=I(23),H=I(232),G=I(52),Z=I(240),Y=I(10)('iterator'),J=!([].keys&&'next'in[].keys()),Q='keys',ee='values',te=function(){return this;};M.exports=function(oe,re,ne,ie,se,le,de){H(ne,re,ie);var pe=function(Me){return!J&&Me in fe?fe[Me]:Me===Q?function(){return new ne(this,Me);}:Me===ee?function(){return new ne(this,Me);}:function(){return new ne(this,Me);};},ce=re+' Iterator',ue=se==ee,me=!1,fe=oe.prototype,ge=fe[Y]||fe['@@iterator']||se&&fe[se],he=ge||pe(se),ye=se?ue?pe('entries'):he:void 0,be='Array'==re?fe.entries||ge:ge,Ee,Se,ve;if(be&&(ve=Z(be.call(new oe())),ve!==Object.prototype&&ve.next&&(G(ve,ce,!0),!L&&!W(ve,Y)&&N(ve,Y,te))),ue&&ge&&ge.name!==ee&&(me=!0,he=function(){return ge.call(this);}),(!L||de)&&(J||me||!fe[Y])&&N(fe,Y,he),$[re]=he,$[ce]=te,se)if(Ee={values:ue?he:pe(ee),keys:le?he:pe(Q),entries:ye},de)for(Se in Ee)Se in fe||U(fe,Se,Ee[Se]);else V(V.P+V.F*(J||me),re,Ee);return Ee;};},function(M,R,I){var L=I(34),V=I(28),U=I(19),N=I(57),W=I(18),$=I(80),H=Object.getOwnPropertyDescriptor;R.f=I(16)?H:function(Z,Y){if(Z=U(Z),Y=N(Y,!0),$)try{return H(Z,Y);}catch(J){}return W(Z,Y)?V(!L.f.call(Z,Y),Z[Y]):void 0;};},function(M,R,I){var L=I(85),V=I(48).concat('length','prototype');R.f=Object.getOwnPropertyNames||function(N){return L(N,V);};},function(M,R,I){var L=I(18),V=I(19),U=I(225)(!1),N=I(53)('IE_PROTO');M.exports=function(W,$){var H=V(W),G=0,Z=[],Y;for(Y in H)Y!=N&&L(H,Y)&&Z.push(Y);for(;$.length>G;)L(H,Y=$[G++])&&(~U(Z,Y)||Z.push(Y));return Z;};},function(M,R,I){M.exports=I(22);},function(M,R,I){var L=I(55),V=Math.min;M.exports=function(U){return 0<U?V(L(U),0x1fffffffffffff):0;};},function(M,R,I){var L=I(78),V=I(10)('iterator'),U=I(23);M.exports=I(9).getIteratorMethod=function(N){if(N!=void 0)return N[V]||N['@@iterator']||U[L(N)];};},function(M,R,I){(function(L){(function(){var V,U,N;"undefined"!=typeof performance&&null!==performance&&performance.now?M.exports=function(){return performance.now();}:"undefined"!=typeof L&&null!==L&&L.hrtime?(M.exports=function(){return(V()-N)/1e6;},U=L.hrtime,V=function(){var W;return W=U(),1e9*W[0]+W[1];},N=V()):Date.now?(M.exports=function(){return Date.now()-N;},N=Date.now()):(M.exports=function(){return new Date().getTime()-N;},N=new Date().getTime());}).call(this);}).call(R,I(90));},function(M){function I(){throw new Error('setTimeout has not been defined');}function L(){throw new Error('clearTimeout has not been defined');}function V(te){if(Z===setTimeout)return setTimeout(te,0);if((Z===I||!Z)&&setTimeout)return Z=setTimeout,setTimeout(te,0);try{return Z(te,0);}catch(oe){try{return Z.call(null,te,0);}catch(re){return Z.call(this,te,0);}}}function U(te){if(Y===clearTimeout)return clearTimeout(te);if((Y===L||!Y)&&clearTimeout)return Y=clearTimeout,clearTimeout(te);try{return Y(te);}catch(oe){try{return Y.call(null,te);}catch(re){return Y.call(this,te);}}}function N(){X&&Q&&(X=!1,Q.length?J=Q.concat(J):ee=-1,J.length&&W());}function W(){if(!X){var te=V(N);X=!0;for(var oe=J.length;oe;){for(Q=J,J=[];++ee<oe;)Q&&Q[ee].run();ee=-1,oe=J.length;}Q=null,X=!1,U(te);}}function $(te,oe){this.fun=te,this.array=oe;}function H(){}var G=M.exports={},Z,Y;(function(){try{Z='function'==typeof setTimeout?setTimeout:I;}catch(te){Z=I;}try{Y='function'==typeof clearTimeout?clearTimeout:L;}catch(te){Y=L;}})();var J=[],X=!1,Q,ee=-1;G.nextTick=function(te){var oe=Array(arguments.length-1);if(1<arguments.length)for(var re=1;re<arguments.length;re++)oe[re-1]=arguments[re];J.push(new $(te,oe)),1!==J.length||X||V(W);},$.prototype.run=function(){this.fun.apply(null,this.array);},G.title='browser',G.browser=!0,G.env={},G.argv=[],G.version='',G.versions={},G.on=H,G.addListener=H,G.once=H,G.off=H,G.removeListener=H,G.removeAllListeners=H,G.emit=H,G.prependListener=H,G.prependOnceListener=H,G.listeners=function(){return[];},G.binding=function(){throw new Error('process.binding is not supported');},G.cwd=function(){return'/';},G.chdir=function(){throw new Error('process.chdir is not supported');},G.umask=function(){return 0;};},function(M){var I=function(){return this;}();try{I=I||Function("return this")()||(1,eval)("this");}catch(L){"object"==typeof window&&(I=window);}M.exports=I;},function(M,R,I){"use strict";function L(ge){return ge&&ge.__esModule?ge:{default:ge};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(158),X=L(J),Q=I(169),ee=L(Q),te=I(163),oe=L(te),re=I(173),ne=L(re),ie=I(157),se=L(ie),le=I(21),de=L(le),pe=I(151),ce=L(pe),ue=I(6),me=L(ue),fe=function(ge){function he(){(0,W.default)(this,he);for(var ye=arguments.length,be=Array(ye),Ee=0;Ee<ye;Ee++)be[Ee]=arguments[Ee];var Se=(0,H.default)(this,ge.call.apply(ge,[this].concat(be)));Se._screens={loading:X.default,splash:ee.default,photoRoll:oe.default,webcam:ne.default,editor:se.default,empty:de.default};var ve;return Se.props.options.preloader&&(ve='loading'),Se._screenAfterLoading,Se._screenAfterLoading=Se.props.options.editor.image?'editor':'splash',ve||(ve=Se._screenAfterLoading),Se._previousScreensStack=[],Se.state={activeScreen:Se._screens[ve],activeScreenName:ve,screens:(0,U.default)({},ve,Se._screens[ve])},Se;}return(0,Z.default)(he,ge),he.prototype.hasPreviousScreen=function(){return!!this._previousScreensStack.length;},he.prototype.getPreviousScreen=function(){var be=this._previousScreensStack;return be[be.length-1];},he.prototype.switchToScreen=function(be){var Ee=this,Se=null;if('back'!==be){if('post-loading'===be&&(be=this._screenAfterLoading),Se=this._screens[be],!Se)throw new Error('Unknown screen `'+be+'`');this._previousScreensStack.push(this.state.activeScreen);}else if(Se=this._previousScreensStack.pop(),!Se)throw new Error('Unable to switch to previous screen - no previous screen found.');return this.state.screens[be]||(this.state.screens[be]=Se),'editor'!==this.state.activeScreenName&&delete this.state.screens[this.state.activeScreenName],new Y.Promise(function(ve){Ee.setState({activeScreen:Se,activeScreenName:be},function(){ve();});});},he.prototype.setImage=function(be,Ee){var Se=this,ve=this.props.options;ve.editor.image=be;var Me=!this.refs.editorScreen;this.switchToScreen('editor').then(function(){Me||Se.refs.editorScreen.setImage(be,Ee);});},he.prototype.export=function(){if(this.state.activeScreen!==this._screens.editor)return Y.Promise.reject(new Error('Unable to export: Active screen is not the editor screen.'));if(this.state.screens.editor){var be;return(be=this.refs.editorScreen).export.apply(be,arguments);}},he.prototype.getEditor=function(){return this.state.activeScreen===this._screens.editor?this.state.screens.editor?this.refs.editorScreen.getEditor():void 0:Y.Promise.reject(new Error('Unable to get editor: Active screen is not the editor screen.'));},he.prototype.serialize=function(){var be;return this.state.screens.editor?(be=this.refs.editorScreen).serialize.apply(be,arguments):Y.Promise.reject(new Error('Editor screen unavailable'));},he.prototype.deserialize=function(be){return this.state.screens.editor?this.refs.editorScreen.deserialize(be):Y.Promise.reject(new Error('Editor screen unavailable'));},he.prototype.getChildContext=function(){return{ui:this.props.ui,options:this.props.options,mediator:this.props.mediator};},he.prototype._renderScreens=function(){var be=[];for(var Ee in this.state.screens){var Se=this.state.screens[Ee],ve=this.state.activeScreen===Se;be.push(Y.ReactBEM.createElement(Se,{ref:Ee+'Screen',app:this,visible:ve}));}return be;},he.prototype.render=function(){return Y.ReactBEM.transform(Y.ReactBEM.createElement('div',{bem:'b:editor'},Y.ReactBEM.createElement(ce.default,{modalManager:me.default.instance}),this._renderScreens()));},he;}(Y.React.Component);R.default=fe,fe.childContextTypes={ui:Y.React.PropTypes.object.isRequired,mediator:Y.React.PropTypes.object.isRequired,options:Y.React.PropTypes.object.isRequired},fe.propTypes={ui:Y.React.PropTypes.object.isRequired,mediator:Y.React.PropTypes.object.isRequired,options:Y.React.PropTypes.object.isRequired};},function(M,R,I){"use strict";function L(H){return H&&H.__esModule?H:{default:H};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(185),W=L(N),$=function(){function H(G){(0,U.default)(this,H),this._fonts=G,this._loadedFonts=[];}return H.prototype.setFonts=function(Z){this._fonts=Z;},H.prototype.needsToLoad=function(){for(var Z=0,Y;Z<this._fonts.length;Z++)if(Y=this._fonts[Z].getProvider(),Y)return!0;},H.prototype._getFontIdentifier=function(Z){return Z.getName()+'-'+Z.getFontWeight()+'-'+Z.getFontFamily()+'-'+Z.getFontStyle();},H.prototype.fontLoaded=function(Z){var Y=this._getFontIdentifier(Z);return-1!==this._loadedFonts.indexOf(Y);},H.prototype.setFontLoaded=function(Z){if(!this.fontLoaded(Z)){var Y=this._getFontIdentifier(Z);this._loadedFonts.push(Y);}},H.prototype.load=function(){var Z=this,Y=this._fonts.slice(),J={google:new W.default()};Y.filter(function(ee){return!Z.fontLoaded(ee);}).forEach(function(ee){var te=ee.getProvider();if(te){var oe=J[te];oe.add(ee);}});var X=[];for(var Q in J)X.push(J[Q].load());return Promise.all(X).then(function(){Y.forEach(function(ee){Z.setFontLoaded(ee);});});},H;}();R.default=$;},function(M,R,I){"use strict";function L($){return $&&$.__esModule?$:{default:$};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(193);Object.defineProperty(R,'Provider',{enumerable:!0,get:function(){return L(V).default;}});var U=I(191);Object.defineProperty(R,'Library',{enumerable:!0,get:function(){return L(U).default;}});var N=I(194);Object.defineProperty(R,'SearchSuggestion',{enumerable:!0,get:function(){return L(N).default;}});var W=I(192);Object.defineProperty(R,'Photo',{enumerable:!0,get:function(){return L(W).default;}});},function(M){M.exports={controls:{overview:{filters:'Filter',adjustments:'Korrekturen',crop:'Zuschneiden',blur:'Weichzeichnen',frame:'Rahmen',sticker:'Sticker',text:'Text',brush:'Malen',"selective-blur":'Sel. Unsch\xE4rfe'},text:{foreground:'Vordergrund',background:'Hintergrund',size:'Gr\xF6\xDFe',font:'Schriftart',alignment:'Ausrichtung',takeToFront:'Nach oben'},adjustments:{brightness:'Helligkeit',contrast:'Kontrast',saturation:'S\xE4ttigung',gamma:'Gamma',exposure:'Belichtung',shadows:'Schatten',highlights:'Lichter',clarity:'Klarheit'},crop:{none:'Original',custom:'Manuell',square:'Quadratisch',"4-3":'4:3',"16-9":'16:9',social:'Social Media',"fb-ad":'FB Ad',"fb-post":'FB Post',"fb-cover":'FB Cover',rotation:'Drehung'},focus:{none:'Original',radial:'Kreisf\xF6rmig',linear:'Linear',blurRadius:'Radius'},selectiveBlur:{blurRadius:'Radius',thickness:'Dicke'},filters:{intensity:'Intensit\xE4t',categories:{all:'Alle',retro:'Retro',bw:'Schwarz & Wei\xDF',summer:'Sommer',winter:'Winter',special:'Spezial'}},sticker:{brightness:'Helligkeit',contrast:'Kontrast',saturation:'S\xE4ttigung',blur:'Weichzeichnen',flip:'Spiegeln',"flip-v":'Spiegeln (V)',"flip-h":'Spiegeln (H)',takeToFront:'Nach oben',categories:{all:'Alle'}},brush:{thickness:'Dicke',color:'Farbe'},frame:{noFrame:'Kein Rahmen',scale:'Gr\xF6\xDFe'}},webcam:{headline:'Mache ein Foto!'},editor:{headline:'Foto editieren',new:'Neu',backgroundImage:'Hintergrundbild',undo:'R\xFCckg\xE4ngig',export:'Speichern',zoom:'Zoom'},splash:{upload:{button:'Lade ein Foto hoch',description:'Klicke hier, um ein Foto von deinem Rechner hochzuladen oder lade es per Drag-and-Drop hoch'},webcam:{headline:'Webcam',description:'Klicke hier, um ein Foto mit deiner Webcam zu machen'},photoRoll:{headline:'Kostenloses Bildmaterial',description:'Suche dir eines von tausenden Stock Photos aus.'}},photoRoll:{search:{placeholder:'Nach Fotos suchen',noSearchResults:'Entschuldigung, aber wir konnten f\xFCr <strong>"${query}"</strong> leider keine Ergebnisse finden.',results:{headline:'Suchergebnisse f\xFCr "${query}"'}}},generic:{back:'Zur\xFCck',cancel:'Abbrechen',color:'Farbe'},loading:{resizing:'Bild wird bearbeitet...',exporting:'Exportiere...',loading:'Lade...'},warnings:{imageResized_maxMegaPixels:{title:'Bild verkleinert',text:'Da dein Bild die maximale Gr\xF6\xDFe von ${maxMegaPixels} Megapixeln \xFCberschreitet, wurde es auf ${width}x${height} Pixel verkleinert.'},imageResized_maxDimensions:{title:'Bild verkleinert',text:'Aufgrund von Hardware-Beschr\xE4nkungen wurde das Bild auf ${width}x${height} Pixel verkleinert.'}},errors:{imageLoadFail:{title:'Bild konnte nicht geladen werden',text:'Beim Laden des Bildes unter ${path} ist ein Fehler aufgetreten.'},webcamUnavailable:{title:'Webcam nicht verf\xFCgbar',text:'Webcam-Bild kann nicht dargestellt werden. (Fehler: ${error})'},webcamNotSupported:{title:'Webcam nicht unterst\xFCtzt',text:'Dein Browser unterst\xFCtzt das Webcam-Feature leider noch nicht.'},renderingError:{title:'Rendering-Fehler',text:'Beim Rendern des Bildes ist ein Fehler aufgetreten.'},context_lost:{title:'Es ist ein Fehler aufgetreten',text:'Dein Browser hat zu lange gebraucht, um das Bild zu generieren. Bitte versuche es noch einmal.'},context_lost_limit:{title:'Es ist ein Fehler aufgetreten',text:'Bild-Generierung ist mehrmals fehlgeschlagen.'},loadingStickersFailed:{title:'Laden der Sticker fehlgeschlagen'},loadingFontsFailed:{title:'Laden der Schriftarten fehlgeschlagen',text:'Einige Schriftarten sind m\xF6glicherweise nicht verf\xFCgbar.'},photoRollLoadFail:{title:'Laden der Photo Roll fehlgeschlagen',text:'Die Photo Roll konnte nicht geladen werden: ${error}'},title:'Es ist ein Fehler aufgetreten'}};},function(M){M.exports={controls:{overview:{filters:'Filters',adjustments:'Adjust',crop:'Crop',focus:'Focus',frame:'Frame',sticker:'Sticker',text:'Text',brush:'Brush',"selective-blur":'Selective Blur'},text:{foreground:'Foreground',background:'Background',size:'Size',font:'Font',alignment:'Alignment',takeToFront:'To Front'},adjustments:{brightness:'Brightness',contrast:'Contrast',saturation:'Saturation',exposure:'Exposure',gamma:'Gamma',shadows:'Shadows',highlights:'Highlights',clarity:'Clarity'},crop:{none:'Original',custom:'Custom',square:'Square',"4-3":'4:3',"16-9":'16:9',social:'Social Media',"fb-ad":'FB Ad',"fb-post":'FB Post',"fb-cover":'FB Cover',rotation:'Rotation'},focus:{none:'None',radial:'Radial',linear:'Linear',blurRadius:'Blur radius'},selectiveBlur:{blurRadius:'Blur radius',thickness:'Thickness'},filters:{intensity:'Intensity',categories:{all:'All',retro:'Retro',bw:'Black & White',summer:'Summer',winter:'Winter',special:'Special'}},sticker:{brightness:'Brightness',contrast:'Contrast',saturation:'Saturation',blur:'Blur',flip:'Flip',"flip-v":'Flip (V)',"flip-h":'Flip (H)',takeToFront:'To Front',categories:{all:'All'}},brush:{thickness:'Thickness',color:'Color'},frame:{noFrame:'No Frame',scale:'Scale'}},webcam:{headline:'Take a photo!'},editor:{headline:'Edit Photo',new:'New',backgroundImage:'Background Image',undo:'Undo',export:'Export',zoom:'Zoom'},splash:{upload:{button:'Upload your image',description:'Upload a picture from your library or just drag and drop'},webcam:{headline:'Webcam',description:'Take a picture with your webcam or phone'},photoRoll:{headline:'Free stock footage',description:'Select from thousands of Free Stock Photos'}},photoRoll:{search:{placeholder:'Search for photos',noSearchResults:'Sorry, but we couldn\'t find any photos for <strong>"${query}"</strong>.',results:{headline:'Search results for "${query}"'}}},generic:{back:'Back',cancel:'Cancel',color:'Color'},loading:{resizing:'Resizing...',exporting:'Exporting...',loading:'Loading...'},warnings:{imageResized_maxMegaPixels:{title:'Image resized',text:'Your image exceeds the maximum size of ${maxMegaPixels} megapixels and has therefore been resized to ${width}x${height} pixels.'},imageResized_maxDimensions:{title:'Image resized',text:'Due to hardware limitations your image has been resized to ${width}x${height} pixels.'}},errors:{imageLoadFail:{title:'Failed to load image',text:'Failed to load the image at ${path}'},webcamUnavailable:{title:'Webcam unavailable',text:'Unable to display webcam image (Error: ${error})'},webcamNotSupported:{title:'Webcam not supported',text:'The webcam feature is not supported by your browser.'},renderingError:{title:'Error while rendering',text:'An error has occurred while rendering the image.'},context_lost:{title:'An error has occurred',text:'Your browser took too long to render the image. Please try applying less operations.'},context_lost_limit:{title:'An error has occurred',text:'Your browser failed multiple times while rendering the image.'},loadingStickersFailed:{title:'Failed to load stickers'},loadingFontsFailed:{title:'Failed to load fonts',text:'Some fonts might not be available.'},photoRollLoadFail:{title:'Failed to load Photo Roll',text:'Failed to load photos for the photo roll: ${error}'},title:'An error has occurred'}};},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('bem',{specifier:'$b:controls'},G.ReactBEM.createElement('div',{bem:'e:cell m:largeButton'},G.ReactBEM.createElement('div',{bem:'$e:largeButton',onClick:this.props.onClick},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/back.png',!0)}))));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Q){return Q&&Q.__esModule?Q:{default:Q};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(61),Z=L(G),Y=I(72),J=L(Y),X=function(Q){function ee(){(0,U.default)(this,ee);for(var te=arguments.length,oe=Array(te),re=0;re<te;re++)oe[re]=arguments[re];var ne=(0,W.default)(this,Q.call.apply(Q,[this].concat(oe)));return ne._events={},ne._needsStyleFixes=!1,ne._bindAll('_onSharedStateUpdate','fixStyles'),ne;}return(0,H.default)(ee,Q),ee.prototype.fixStyles=function(){},ee.prototype.componentDidMount=function(){this._bindEvents(),this.props.sharedState&&this.props.sharedState.on('update',this._onSharedStateUpdate),this._needsStyleFixes&&(this.fixStyles(),this.context.options.responsive&&window.addEventListener('resize',this.fixStyles));},ee.prototype.componentWillUnmount=function(){this._unbindEvents(),this.props.sharedState&&this.props.sharedState.off('update',this._onSharedStateUpdate),this.context.options.responsive&&this._needsStyleFixes&&window.removeEventListener('resize',this.fixStyles);},ee.prototype.componentWillReceiveProps=function(oe){oe.sharedState&&(this.props.sharedState&&this.props.sharedState.off('update',this._onSharedStateUpdate),oe.sharedState.on('update',this._onSharedStateUpdate));},ee.prototype._bindAll=function(){for(var oe=this,re=arguments.length,ne=Array(re),ie=0;ie<re;ie++)ne[ie]=arguments[ie];ne.forEach(function(se){if('function'!=typeof oe[se])throw new Error('_bindAll: '+oe.constructor.name+'.'+se+' is not a function.');oe[se]=oe[se].bind(oe);});},ee.prototype._t=function(oe,re){return this.context.ui.translate(oe,re);},ee.prototype._getAssetPath=function(){var oe;return(oe=this.context.ui).getAssetPath.apply(oe,arguments);},ee.prototype._onSharedStateUpdate=function(oe,re){this.sharedStateDidChange(re),this.shouldSharedComponentUpdate(oe,re)&&this.forceUpdate();},ee.prototype.shouldSharedComponentUpdate=function(){return!0;},ee.prototype.sharedStateDidChange=function(){},ee.prototype.setSharedState=function(oe,re){this.props.sharedState.set(oe,re);},ee.prototype.getSharedState=function(oe){return this.props.sharedState.get(oe);},ee.prototype.forceSharedUpdate=function(){this.props.sharedState.broadcastUpdate();},ee.prototype._bindEvents=function(){for(var oe in this._events){var re=this._events[oe];this.context.mediator.on(oe,re);}},ee.prototype._unbindEvents=function(){for(var oe in this._events){var re=this._events[oe];this.context.mediator.off(oe,re);}},ee.prototype._emitEvent=function(oe){for(var ne=arguments.length,ie=Array(1<ne?ne-1:0),se=1,re;se<ne;se++)ie[se-1]=arguments[se];(re=this.context.mediator).emit.apply(re,[oe].concat(ie));},ee.prototype.renderWithBEM=function(){return J.default.createElement('div');},ee.prototype.render=function(){return J.default.transform(this.renderWithBEM());},ee;}(Z.default.Component);R.default=X,X.contextTypes={editor:Z.default.PropTypes.object,ui:Z.default.PropTypes.object,options:Z.default.PropTypes.object,mediator:Z.default.PropTypes.object,editorScreen:Z.default.PropTypes.object},X.propTypes={sharedState:Z.default.PropTypes.any};},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.renderWithBEM=function(){var Q='b:button';return this.props.uppercase&&(Q+=' m:uppercase'),G.ReactBEM.createElement('button',{bem:Q,className:this.props.className,onClick:this.props.onClick},this.props.children);},J;}(G.BaseComponent);R.default=Z,Z.propTypes={onClick:G.React.PropTypes.func,children:G.React.PropTypes.any.isRequired,className:G.React.PropTypes.string},Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype._onItemClick=function(Q){this.props.onChange&&this.props.onChange(Q);},J.prototype._renderListItems=function(){var Q=this;return this.props.items.map(function(ee){var te=ee.name===Q.props.selectedItem.name;return G.ReactBEM.createElement('li',{bem:'$e:item',className:te?' is-active':'',onClick:Q._onItemClick.bind(Q,ee)},G.ReactBEM.createElement('img',{bem:'e:icon',src:ee.icon}),G.ReactBEM.createElement('div',{bem:'e:label'},ee.label));});},J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',{bem:'$b:categoryDropdown $e:overlay'},G.ReactBEM.createElement('ul',{bem:'$e:list'},this._renderListItems()));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(11),Y=L(Z),J=function(X){function Q(){(0,U.default)(this,Q);for(var ee=arguments.length,te=Array(ee),oe=0;oe<ee;oe++)te[oe]=arguments[oe];var re=(0,W.default)(this,X.call.apply(X,[this].concat(te)));return re._bindAll('_onKnobDrag','_onKnobDragStart'),re._value=re.props.initialValue.clone(),re._transparentPatternCanvas=G.Utils.createTransparentPatternCanvas(),re;}return(0,H.default)(Q,X),Q.prototype.componentDidMount=function(){X.prototype.componentDidMount.call(this),this._renderCanvas();},Q.prototype.shouldComponentUpdate=function(te){var oe=te.initialValue;return oe!==this._value&&(this._value=oe.clone(),this._renderCanvas(),!0);},Q.prototype._onKnobDragStart=function(te,oe){oe.target===this.refs.knob?this._initialAlpha=this._value.a:this._setAlphaFromPosition(te);},Q.prototype._onKnobDrag=function(te){var re=this.refs.canvas,ne=re.offsetWidth,ie=te.x/ne;this._setAlpha(this._initialAlpha+ie);},Q.prototype._getKnobStyle=function(){return{left:(100*this._value.a).toFixed(2)+'%',top:'50%'};},Q.prototype._setAlpha=function(te){this._value.a=te,this._value.a=Math.min(1,Math.max(0,this._value.a)),this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value);},Q.prototype._setAlphaFromPosition=function(te){var oe=this.refs.canvas;this._initialAlpha=te.x/oe.offsetWidth,this._setAlpha(this._initialAlpha);},Q.prototype._renderCanvas=function(){var te=this.refs.canvas,oe=te.getContext('2d');te.width=te.offsetWidth,te.height=te.offsetHeight;var re=oe.createPattern(this._transparentPatternCanvas,'repeat');oe.fillStyle=re,oe.fillRect(0,0,te.width,te.height);var ne=oe.createLinearGradient(0,0,te.width,te.height),ie=this._value.clone();ie.a=0,ne.addColorStop(0,ie.toRGBA()),ne.addColorStop(1,this._value.toHex()),oe.fillStyle=ne,oe.fillRect(0,0,te.width,te.height);},Q.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',{bem:'$b:colorPicker $e:alpha'},G.ReactBEM.createElement(Y.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},G.ReactBEM.createElement('div',null,G.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'}),G.ReactBEM.createElement('div',{bem:'e:knob $b:knob m:transparent',ref:'knob',style:this._getKnobStyle()}))));},Q;}(G.BaseComponent);R.default=J,J.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(11),Y=L(Z),J=function(X){function Q(){(0,U.default)(this,Q);for(var ee=arguments.length,te=Array(ee),oe=0;oe<ee;oe++)te[oe]=arguments[oe];var re=(0,W.default)(this,X.call.apply(X,[this].concat(te)));re._bindAll('_onKnobDrag','_onKnobDragStart'),re._value=re.props.initialValue.clone();var ne=re._value.toHSV(),ie=ne[0],se=ne[1],le=ne[2];return re._hsvColor={h:ie,s:se,v:le},re;}return(0,H.default)(Q,X),Q.prototype.componentDidMount=function(){X.prototype.componentDidMount.call(this),this._renderCanvas();},Q.prototype.shouldComponentUpdate=function(te){var oe=te.initialValue;if(oe!==this._value){this._value=oe.clone();var re=this._value.toHSV(),ne=re[0],ie=re[1],se=re[2];return this._hsvColor={h:ne,s:ie,v:se},this._renderCanvas(),!0;}return!1;},Q.prototype._onKnobDragStart=function(te,oe){oe.target===this.refs.knob?this._initialHue=this._hsvColor.h:this._setValueFromPosition(te);},Q.prototype._onKnobDrag=function(te){var re=this.refs.canvas,ne=re.offsetHeight,ie=te.y/ne;this._setHue(this._initialHue+ie);},Q.prototype._getKnobStyle=function(){return{left:'50%',top:(100*this._hsvColor.h).toFixed(2)+'%'};},Q.prototype._setHue=function(te){var oe=this._hsvColor,re=oe.s,ne=oe.v;te=Math.min(1,Math.max(0,te)),re=Math.max(0.01,Math.min(re,0.99)),ne=Math.max(0.01,Math.min(ne,0.99)),this._value=G.Color.fromHSV(te,re,ne,this._value.a),this._hsvColor={h:te,s:re,v:ne},this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value);},Q.prototype._setValueFromPosition=function(te){var oe=this.refs.canvas;this._initialHue=te.y/oe.offsetHeight,this._setHue(this._initialHue);},Q.prototype._renderCanvas=function(){var te=this.refs.canvas,oe=te.getContext('2d');te.width=te.offsetWidth,te.height=te.offsetHeight;for(var re=0;re<te.height;re++){var ne=re/te.height,ie=G.Color.fromHSV(ne,1,1);oe.strokeStyle=ie.toRGBA(),oe.beginPath(),oe.moveTo(0,re),oe.lineTo(te.width,re),oe.stroke();}},Q.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',{bem:'$b:colorPicker $e:hue'},G.ReactBEM.createElement(Y.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},G.ReactBEM.createElement('div',null,G.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'}),G.ReactBEM.createElement('div',{bem:'e:knob $b:knob m:transparent',ref:'knob',style:this._getKnobStyle()}))));},Q;}(G.BaseComponent);R.default=J,J.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(oe){return oe&&oe.__esModule?oe:{default:oe};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(101),Y=L(Z),J=I(104),X=L(J),Q=I(102),ee=L(Q),te=function(oe){function re(){(0,U.default)(this,re);for(var ne=arguments.length,ie=Array(ne),se=0;se<ne;se++)ie[se]=arguments[se];var le=(0,W.default)(this,oe.call.apply(oe,[this].concat(ie)));le._value=le.props.initialValue.clone();var de=le._value.toHSV(),pe=de[0],ce=de[1],ue=de[2];return le._hsv={h:pe,s:ce,v:ue},le._bindAll('_onElementClick','_onColorChange','_onDocumentClick'),le;}return(0,H.default)(re,oe),re.prototype.componentDidMount=function(){oe.prototype.componentDidMount.call(this),document.addEventListener('click',this._onDocumentClick);},re.prototype.componentWillUnmount=function(){oe.prototype.componentWillUnmount.call(this),document.removeEventListener('click',this._onDocumentClick);},re.prototype._onDocumentClick=function(ie){for(var se=ie.target;se;se=se.parentNode)if(se===this.refs.root)return;this.props.onClose&&this.props.onClose();},re.prototype._onElementClick=function(ie){ie.stopPropagation();},re.prototype._onColorChange=function(ie){this._value=ie,this.props.onChange&&this.props.onChange(ie);},re.prototype.renderWithBEM=function(){var ie;return!1!==this.props.alpha&&(ie=G.ReactBEM.createElement(Y.default,{initialValue:this._value,onChange:this._onColorChange})),G.ReactBEM.createElement('div',{bem:'$b:colorPicker $e:overlay',onClick:this._onElementClick,ref:'root'},ie,G.ReactBEM.createElement('div',{bem:'e:bottom'},G.ReactBEM.createElement(X.default,{initialValue:this._value,onChange:this._onColorChange}),G.ReactBEM.createElement(ee.default,{initialValue:this._value,onChange:this._onColorChange})));},re;}(G.BaseComponent);R.default=te,te.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(11),Y=L(Z),J=function(X){function Q(){(0,U.default)(this,Q);for(var ee=arguments.length,te=Array(ee),oe=0;oe<ee;oe++)te[oe]=arguments[oe];var re=(0,W.default)(this,X.call.apply(X,[this].concat(te)));re._bindAll('_onKnobDrag','_onKnobDragStart'),re._value=re.props.initialValue.clone();var ne=re._value.toHSV(),ie=ne[0],se=ne[1],le=ne[2];return re._hsvColor={h:ie,s:se,v:le},re;}return(0,H.default)(Q,X),Q.prototype.componentDidMount=function(){X.prototype.componentDidMount.call(this),this._renderCanvas();},Q.prototype.shouldComponentUpdate=function(te){var oe=te.initialValue;if(oe!==this._value){this._value=oe.clone();var re=this._value.toHSV(),ne=re[0],ie=re[1],se=re[2];return this._hsvColor={h:ne,s:ie,v:se},this._renderCanvas(),!0;}return!1;},Q.prototype._onKnobDragStart=function(te,oe){oe.target===this.refs.knob?(this._initialValue=this._hsvColor.v,this._initialSaturation=this._hsvColor.s):this._setValuesFromPosition(te);},Q.prototype._onKnobDrag=function(te){var re=this.refs.canvas,ne=re.offsetWidth,ie=re.offsetHeight,se=te.x/ne,le=-1*(te.y/ie),de=this._hsvColor.h;this._setHSV(de,this._initialSaturation+se,this._initialValue+le);},Q.prototype._getKnobStyle=function(){var te=this._hsvColor,oe=te.s,re=te.v;return{left:(100*oe).toFixed(2)+'%',top:(100*(1-re)).toFixed(2)+'%'};},Q.prototype._setHSV=function(te,oe,re){oe=Math.max(0.01,Math.min(oe,0.99)),re=Math.max(0.01,Math.min(re,0.99)),this._value=G.Color.fromHSV(te,oe,re,this._value.a),this._hsvColor={h:te,s:oe,v:re},this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value);},Q.prototype._setValuesFromPosition=function(te){var oe=this.refs.canvas;this._initialSaturation=te.x/oe.offsetWidth,this._initialValue=1-te.y/oe.offsetHeight;var re=this._hsvColor.h;this._setHSV(re,this._initialSaturation,this._initialValue);},Q.prototype._renderCanvas=function(){var te=this.refs.canvas,oe=te.getContext('2d');te.width=te.offsetWidth,te.height=te.offsetHeight;for(var re=oe.getImageData(0,0,te.width,te.height),ne=0,ie;ne<te.height;ne++){ie=(te.height-ne)/te.height;for(var se=0;se<te.width;se++){var le=se/te.width,de=G.Color.fromHSV(this._hsvColor.h,le,ie),pe=de.r,ce=de.g,ue=de.b,me=de.a,fe=4*(ne*te.width+se);re.data[fe]=255*pe,re.data[fe+1]=255*ce,re.data[fe+2]=255*ue,re.data[fe+3]=255*me;}}oe.putImageData(re,0,0);},Q.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',{bem:'$b:colorPicker $e:saturation'},G.ReactBEM.createElement(Y.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},G.ReactBEM.createElement('div',null,G.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'}),G.ReactBEM.createElement('div',{bem:'e:knob $b:knob m:transparent',ref:'knob',style:this._getKnobStyle()}))));},Q;}(G.BaseComponent);R.default=J,J.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(ie){return ie&&ie.__esModule?ie:{default:ie};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(7),Y=L(Z),J=I(5),X=L(J),Q=I(12),ee=L(Q),te=I(125),oe=L(te),re=[{identifier:'brightness',isAvailable:function(se){return se.isToolEnabled('brightness');},minValue:-1,midValue:0,maxValue:1},{identifier:'saturation',isAvailable:function(se){return se.isToolEnabled('saturation');},minValue:0,midValue:1,maxValue:2},{identifier:'contrast',isAvailable:function(se){return se.isToolEnabled('contrast');},minValue:0,midValue:1,maxValue:2},{identifier:'gamma',isAvailable:function(se){return se.isToolEnabled('gamma');},minValue:0.5,midValue:1,maxValue:3},{identifier:'clarity',isAvailable:function(se){return se.isToolEnabled('clarity');},minValue:-1,midValue:0,maxValue:1},{identifier:'exposure',isAvailable:function(se){return se.isToolEnabled('exposure');},minValue:-1,midValue:0,maxValue:1},{identifier:'shadows',isAvailable:function(se){return se.isToolEnabled('shadows');},minValue:0,midValue:1,maxValue:2},{identifier:'highlights',isAvailable:function(se){return se.isToolEnabled('highlights');},minValue:-1,midValue:0,maxValue:1}],ne=function(ie){function se(){(0,U.default)(this,se);for(var le=arguments.length,de=Array(le),pe=0;pe<le;pe++)de[pe]=arguments[pe];var ce=(0,W.default)(this,ie.call.apply(ie,[this].concat(de)));ce._bindAll('_onSliderValueChange');var ue=ce.context.editor;return ce._operation=ue.operations.getOrCreate('adjustments'),ce.state={selectedControls:null},ce;}return(0,H.default)(se,ie),se.prototype._onBackClick=function(de){var pe=this.context.editor,ce=this.getSharedState('operationExistedBefore'),ue=this.getSharedState('initialOptions');this._operation.optionsEqual(ue)||pe.history.add(this._operation,ue,ce);var me=this._operation.getDefaultOptions();this._operation.optionsEqual(me)&&pe.operations.remove(this._operation),ie.prototype._onBackClick.call(this,de);},se.prototype._onSliderValueChange=function(de){var pe=this.state.selectedControls,ce=pe.identifier,ue=pe.minValue,me=pe.midValue,fe=pe.maxValue;de=0>de?me+(me-ue)*de/100:me+(fe-me)*de/100,this._operation.setOption(ce,de);var ge=this.context.editor;ge.render();},se.prototype._onButtonClick=function(de){this.setState({selectedControls:de});},se.prototype._buildSliderProps=function(de){var pe=de.identifier,ce=de.minValue,ue=de.midValue,me=de.maxValue,fe=this._operation?this._operation.getOption(pe):ue,ge=100*(fe<=ue?(fe-ce)/(ue-ce)-1:(fe-ue)/(me-ue));return{minValue:-100,maxValue:100,value:ge,valueUnit:'%',positiveValuePrefix:'+',label:this._t('controls.adjustments.'+pe),middleDot:!0,onChange:this._onSliderValueChange};},se.prototype.renderOverlayControls=function(){var de=this.state.selectedControls;if(de){var pe=this._buildSliderProps(de);return G.ReactBEM.createElement(ee.default,pe);}},se.prototype._renderListItems=function(){var de=this;return re.filter(function(pe){return pe.isAvailable(de.context.editor);}).map(function(pe){var ce=de.state.selectedControls===pe,ue=ce?'is-active':null,me;return G.ReactBEM.createElement('li',{bem:'e:item',key:pe.identifier,"data-identifier":pe.identifier},G.ReactBEM.createElement('bem',{specifier:'$b:controls'},G.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',onClick:de._onButtonClick.bind(de,pe),className:ue},G.ReactBEM.createElement('img',{bem:'e:icon',src:de._getAssetPath('controls/adjustments/'+pe.identifier+'.png',!0)}),G.ReactBEM.createElement('div',{bem:'e:label'},de._t('controls.adjustments.'+pe.identifier)),me)));});},se.prototype.renderControls=function(){var de=this._renderListItems();return G.ReactBEM.createElement('div',{bem:'e:cell m:list'},G.ReactBEM.createElement(X.default,null,G.ReactBEM.createElement('ul',{bem:'$e:list'},de)));},se;}(Y.default);R.default=ne,ne.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(8),Z=L(G),Y=I(105),J=L(Y),X=['brightness','clarity','contrast','exposure','highlights','saturation','shadows','gamma'],Q=function(ee){function te(){return(0,U.default)(this,te),(0,W.default)(this,ee.apply(this,arguments));}return(0,H.default)(te,ee),te.onEnter=function(){var ne=this.context.editor,ie=ne.operations.exists('adjustments'),se=ne.operations.getOrCreate('adjustments'),le=se.serializeOptions();this.setSharedState({operation:se,operationExistedBefore:ie,initialOptions:le});},te.isAvailable=function(re){return 0<X.filter(function(ne){return re.isToolEnabled(ne);}).length;},te.getPreloadAssets=function(re){return X.filter(function(ne){return re.isToolEnabled(ne);}).map(function(ne){return'controls/adjustments/'+ne+'.png';});},te;}(Z.default);Q.controlsComponent=J.default,Q.identifier='adjustments',Q.iconPath='controls/overview/adjustments.png',Q.languageKey='controls.overview.adjustments',Q.defaultOptions={},R.default=Q;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(31),X=L(J),Q=function(ee){function te(){(0,W.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,H.default)(this,ee.call.apply(ee,[this].concat(re)));return ie._windowResized=!1,ie._drawing=!1,ie._bindAll('_onMouseEnter','_onMouseLeave','_onMouseDown','_onMouseMove','_onMouseUp','_onMouseMoveOnCanvas','_onWindowResize'),ie._lastDrawPosition=null,ie._events=Y.SDKUtils.extend(ie._events,(0,U.default)({},Y.Constants.EVENTS.WINDOW_RESIZE,ie._onWindowResize)),ie.state={cursorVisible:!1,cursorPosition:new Y.Vector2()},ie;}return(0,Z.default)(te,ee),te.prototype.componentDidMount=function(){ee.prototype.componentDidMount.call(this),this._updateContainerRect();},te.prototype.componentDidUpdate=function(){this._windowResized&&(this._updateContainerRect(),this._windowResized=!1);},te.prototype._onWindowResize=function(){this._windowResized=!0;},te.prototype._onOperationRemoved=function(){},te.prototype._onOperationUpdated=function(re){re===this.getSharedState('operation')&&this.forceUpdate();},te.prototype._onMouseDown=function(re){re.preventDefault(),this._optionsBeforeDraw=this.getSharedState('operation').serializeOptions(),delete this._optionsBeforeDraw.enabled,this._operationExistedBeforeDraw=this.getSharedState('operationExistedBefore'),this.setSharedState({operationExistedBefore:!0},!1);var ne=this.context.editor.getOutputDimensions(),ie=this._getCursorPosition(re),se=this.getSharedState('brush'),le=this.getSharedState('thickness')/ne.min(),de=this.getSharedState('color'),pe=this.getSharedState('hardness');this._drawing=!0,this._currentPath=se.createPath(le,pe,de),this._currentPath.addControlPoint(ie.clone().divide(ne)),document.addEventListener('mousemove',this._onMouseMove),document.addEventListener('touchmove',this._onMouseMove),document.addEventListener('mouseup',this._onMouseUp),document.addEventListener('touchend',this._onMouseUp);},te.prototype._onMouseUp=function(){this._currentPath.setClosed(!0);var re=this.context.editor,ne=re.getOutputTextureDimensions();this.getSharedState('brush').render(ne),this._currentPath=null,this._drawing=!1,re.history.add(this.getSharedState('operation'),this._optionsBeforeDraw,this._operationExistedBeforeDraw),document.removeEventListener('mousemove',this._onMouseMove),document.removeEventListener('touchmove',this._onMouseMove),document.removeEventListener('mouseup',this._onMouseUp),document.removeEventListener('touchend',this._onMouseUp);},te.prototype._onMouseEnter=function(re){var ne=this._getCursorPosition(re);this.setState({cursorVisible:!0,cursorPosition:ne}),this._onMouseMove(re);},te.prototype._onMouseLeave=function(){this.setState({cursorVisible:!1});},te.prototype._onMouseMove=function(re){var ne=this.context.editor,ie=ne.getOutputDimensions(),se=ne.getOutputTextureDimensions(),le=ne.zoom.get(),de=this._getCursorPosition(re);this.setState({cursorPosition:de});var pe;if(!this._lastDrawPosition)pe=!0;else{var ce=this.getSharedState('thickness'),ue=this._lastDrawPosition.clone().subtract(de).abs().len()/le;pe=ue>=ce/10;}this._drawing&&pe&&(this._currentPath.addControlPoint(de.clone().divide(ie)),this.getSharedState('brush').render(se),this._lastDrawPosition=de.clone());},te.prototype._onMouseMoveOnCanvas=function(re){var ne=this._getCursorPosition(re);this.setState({cursorPosition:ne});},te.prototype._getCursorStyle=function(){var re=this.getSharedState('thickness'),ne=this.getSharedState('color'),ie=this.state.cursorPosition;return{left:ie.x,top:ie.y,width:re,height:re,background:ne.toRGBA(),marginLeft:-0.5*re,marginTop:-0.5*re};},te.prototype._updateContainerRect=function(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect();},te.prototype._getCursorPosition=function(re){var ne=Y.Utils.getEventPosition(re),ie=this._containerBoundingRect;return ne.subtract(ie.left,ie.top);},te.prototype._getContainerProps=function(){var re=ee.prototype._getContainerProps.call(this);return re.onMouseDown=re.onTouchStart=this._onMouseDown,re;},te.prototype._getInnerContainerProps=function(){var re=ee.prototype._getInnerContainerProps.call(this);return delete re.onClick,re.onMouseEnter=this._onMouseEnter,re.onMouseLeave=this._onMouseLeave,re.onMouseMove=this._onMouseMoveOnCanvas,re;},te.prototype._renderOverlayControls=function(){var re=this.state.cursorVisible?'is-visible':null;return Y.ReactBEM.createElement('div',{bem:'$b:brushCanvasControls'},Y.ReactBEM.createElement('div',{bem:'e:cursor',className:re,style:this._getCursorStyle()}));},te;}(X.default);R.default=Q,Q.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(de){return de&&de.__esModule?de:{default:de};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(7),X=L(J),Q=I(30),ee=L(Q),te=I(5),oe=L(te),re=I(39),ne=L(re),ie=I(110),se=L(ie),le=function(de){function pe(){var ce;(0,W.default)(this,pe);for(var ue=arguments.length,me=Array(ue),fe=0;fe<ue;fe++)me[fe]=arguments[fe];var ge=(0,H.default)(this,de.call.apply(de,[this].concat(me)));return ge._hasDoneButton=!1,ge._brushOptions={thickness:ge.getSharedState('thickness'),color:ge.getSharedState('color').clone()},ge._hasPresets=ge.props.options.thicknessPresets&&0<ge.props.options.thicknessPresets.length,ge._hasSlider=!ge._hasPresets,ge._bindAll('_onThicknessUpdated','_onColorUpdated','_onOperationUpdated','_onOperationRemoved'),ge.state={thicknessControlsEnabled:!1},ge._events=(ce={},(0,U.default)(ce,Y.Constants.EVENTS.OPERATION_UPDATED,ge._onOperationUpdated),(0,U.default)(ce,Y.Constants.EVENTS.OPERATION_REMOVED,ge._onOperationRemoved),ce),ge;}return(0,Z.default)(pe,de),pe.prototype.componentDidMount=function(){de.prototype.componentDidMount.call(this);var ue=this.context.editor;ue.zoom.set('auto'),ue.features.disable('zoom','drag');},pe.prototype._onThicknessClick=function(ue){this._onThicknessUpdated(ue),this.forceUpdate();},pe.prototype._onOperationRemoved=function(ue){if(ue===this.getSharedState('operation')&&!this._backButtonClicked){var me=this.context.editor,fe=me.operations.getOrCreate('sprite'),ge=fe.createBrush();fe.addSprite(ge),this.setSharedState({operation:fe,brush:ge,operationExistedBefore:!1,initialOptions:{}}),me.render();}},pe.prototype._onOperationUpdated=function(ue){var me=this;if(ue===this.getSharedState('operation')){var fe=this.getSharedState('brush');if(fe){var ge=ue.getSprites().filter(function(he){return he.getId()===fe.getId();})[0];this.setSharedState({brush:ge});}ue.setEnabled(!0),this.context.editor.render(function(){ue.setEnabled(!1),me.context.editor.render();});}},pe.prototype._onThicknessUpdated=function(ue){this.setSharedState({thickness:ue}),this._brushOptions.thickness=ue;},pe.prototype._onColorUpdated=function(ue){this.setSharedState({color:ue}),this._brushOptions.color=ue.clone();},pe.prototype._renderThicknessItems=function(){var ue=this,me=this.props.options.thicknessPresets,fe=Math.max.apply(null,me);return me.map(function(ge){var he=ue.getSharedState('thickness')===ge;return Y.ReactBEM.createElement(se.default,{thickness:ge,maxThickness:fe,active:he,key:ge,onClick:ue._onThicknessClick.bind(ue,ge)});});},pe.prototype.renderControls=function(){var ue=this.context.editor,me=ue.zoom.get(),fe=[];if(this._hasSlider){var ge=ue.getFinalDimensions(),ye=Math.round(ge.clone().multiply(me).min()/2),be=this._brushOptions.thickness;fe.push(Y.ReactBEM.createElement('div',{bem:'e:cell m:slider'},Y.ReactBEM.createElement(ee.default,{style:'large',minValue:1,maxValue:ye,valueUnit:'px',middleDot:!1,label:this._t('controls.brush.thickness'),onChange:this._onThicknessUpdated,value:be})));}else this._hasPresets&&fe.push(Y.ReactBEM.createElement('div',{bem:'e:cell m:list'},Y.ReactBEM.createElement(oe.default,null,Y.ReactBEM.createElement('ul',{bem:'$e:list'},this._renderThicknessItems()))));return fe.push(Y.ReactBEM.createElement('div',{bem:'e:cell m:colorPicker'},Y.ReactBEM.createElement(ne.default,{initialValue:this._brushOptions.color.clone(),onChange:this._onColorUpdated}))),fe;},pe;}(X.default);R.default=le,le.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(oe){return oe&&oe.__esModule?oe:{default:oe};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(8),Y=L(Z),J=I(108),X=L(J),Q=I(107),ee=L(Q),te=function(oe){function re(){return(0,U.default)(this,re),(0,W.default)(this,oe.apply(this,arguments));}return(0,H.default)(re,oe),re.onExit=function(){var ie=this.context.editor,se=this.getSharedState('operation');se.setEnabled(!0),ie.zoom.restore(),ie.features.enable('zoom','drag'),ie.render();},re.onEnter=function(ie,se){var le=this.context.editor;le.zoom.save(),le.zoom.set('auto',function(){ce.setEnabled(!1),le.render();});var de=le.getOutputDimensions(),pe=le.operations.exists('sprite'),ce=le.operations.getOrCreate('sprite'),ue=ce.createBrush(),me=ce.serializeOptions();ce.addSprite(ue);var fe=Math.max(0.05*de.min(),1);se.thicknessPresets&&0<se.thicknessPresets.length&&(fe=se.thicknessPresets[0]);var ge=new G.Color(1,0,0,1);this.setSharedState({operationExistedBefore:pe,operation:ce,brush:ue,initialOptions:me,thickness:fe,color:ge,hardness:1});},re.isAvailable=function(ie){return ie.isToolEnabled('brush');},re.getPreloadAssets=function(){return['controls/brush/thickness.png'];},re;}(Y.default);te.controlsComponent=X.default,te.canvasControlsComponent=ee.default,te.identifier='brush',te.iconPath='controls/overview/brush.png',te.languageKey='controls.overview.brush',te.defaultOptions={thicknessPresets:[]},R.default=te;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.componentDidMount=function(){Y.prototype.componentDidMount.call(this),this._renderCanvas();},J.prototype.componentDidUpdate=function(){this._renderCanvas();},J.prototype._renderCanvas=function(){var Q=this.refs.canvas,ee=Q.getContext('2d');Q.width=Q.offsetWidth,Q.height=Q.offsetHeight;var te=this.props,oe=te.maxThickness,re=te.thickness,ne=Q.width*(re/oe);ee.fillStyle='white',ee.beginPath(),ee.arc(Q.width/2,Q.height/2,ne/2,0,2*Math.PI),ee.fill();},J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('bem',{specifier:'$b:controls $e:list'},G.ReactBEM.createElement('li',{bem:'e:item',onClick:this.props.onClick},G.ReactBEM.createElement('bem',{specifier:'$b:controls'},G.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:this.props.active?'is-active':null},G.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'}),G.ReactBEM.createElement('div',{bem:'e:label'},this.props.thickness)))));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(te){return te&&te.__esModule?te:{default:te};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(11),Y=L(Z),J=I(20),X=L(J),Q=new G.Vector2(50,50),ee=function(te){function oe(){(0,U.default)(this,oe);for(var re=arguments.length,ne=Array(re),ie=0;ie<re;ie++)ne[ie]=arguments[ie];var se=(0,W.default)(this,te.call.apply(te,[this].concat(ne)));return se._needsStyleFixes=!0,se._bindAll('_onCenterDragStart','_onCenterDrag'),se.state={dimensions:se.getSharedState('initialDimensions')},se;}return(0,H.default)(oe,te),oe.prototype.fixStyles=function(){if(G.Utils.Browser.isIElte(11)){var ne=this.context.editor,ie=this.refs.container,se=ne.getCanvasDimensions(!1),le=se.y;ie.style.height=le+'px';}},oe.prototype.sharedStateDidChange=function(ne){ne!==this.getSharedState('ratio')&&this._updateDimensions();},oe.prototype._updateDimensions=function(){var ne=this.getSharedState('operation'),ie=this.getSharedState('ratio')||{ratio:'*'},se;if(ie.dimensions)se=ie.dimensions.clone();else{var le=ne.getInputDimensions(),de=this.getSharedState('start'),pe=this.getSharedState('end'),ce=pe.clone().subtract(de);se=ce.multiply(le).floor();}this.setState({dimensions:se});},oe.prototype._onCenterDragStart=function(){var ne=this.getSharedState('start'),ie=this.getSharedState('end');this._initialValues={start:ne.clone(),end:ie.clone(),size:ie.clone().subtract(ne)};},oe.prototype._onCenterDrag=function(ne){var ie=this.context.editor,se=this._initialValues,le=se.start,de=se.size,pe=ie.getOutputDimensions(),ce=ne.clone().divide(pe),ue=new G.Vector2(0,0),me=new G.Vector2(1,1).subtract(de),fe=le.clone().add(ce).clamp(ue,me),ge=fe.clone().add(de);this.setSharedState({start:fe,end:ge});},oe.prototype._onKnobDragStart=function(ne){this._currentDragOption=ne,this._initialValues={start:this.getSharedState('start').clone(),end:this.getSharedState('end').clone()};},oe.prototype._onKnobDrag=function(ne,ie){var se=this.context.editor,le=se.getOutputDimensions(),de=this.getSharedState('ratio')||{ratio:'*'},pe=de.ratio,ce=de.dimensions;ce&&!pe&&(pe=ce.x/ce.y);var ue=this._initialValues.end.clone().subtract(this._initialValues.start).multiply(le),me;'start'===ne?(ue.subtract(ie),me=this._initialValues.end.clone().multiply(le)):'end'===ne&&(ue.add(ie),me=new G.Vector2(1,1).subtract(this._initialValues.start).multiply(le));var fe=le;if('undefined'!=typeof pe&&'*'!==pe&&(pe>le.x/le.y?fe=new G.Vector2(le.x,le.x/pe):fe=new G.Vector2(le.y*pe,le.y)),ue.x=Math.min(Math.max(Math.min(Q.x,fe.x),ue.x),me.x),'*'!==pe&&(ue.y=ue.x/pe),ue.y=Math.min(Math.max(Math.min(Q.y,fe.y),ue.y),me.y),'*'!==pe&&(ue.x=ue.y*pe),'start'===ne){var ge=this._initialValues.end.clone().subtract(ue.clone().divide(le));this.setSharedState({start:ge},!1),this._updateDimensions();}else if('end'===ne){var he=this._initialValues.start.clone().add(ue.clone().divide(le));this.setSharedState({end:he},!1),this._updateDimensions();}},oe.prototype._calculateDimensions=function(){var ne=this.context.editor,ie=this.getSharedState('start'),se=this.getSharedState('end');return se.clone().subtract(ie).multiply(ne.getInputDimensions()).round();},oe.prototype._getAreaStyles=function(){var ne=this.context.editor,ie=ne.getOutputDimensions(),se=ne.getCanvasDimensions(),le=this.getSharedState('start').clone().multiply(ie).floor(),de=this.getSharedState('end').clone().multiply(ie).ceil(),pe=de.clone().subtract(le),ce=se.clone().subtract(ie).divide(2).floor(),ue=ne.getPadding();return le.add(ce).add(0,ue[0]),{topLeft:this._getDimensionsStyles(le.x,le.y),topCenter:this._getDimensionsStyles(pe.x,le.y),centerLeft:this._getDimensionsStyles(le.x,pe.y),center:this._getDimensionsStyles(pe.x,pe.y)};},oe.prototype._getDimensionsStyles=function(ne,ie){return{width:Math.max(1,ne),height:Math.max(1,ie)};},oe.prototype.renderWithBEM=function(){var ne=this.getSharedState('ratio'),ie=this.state.dimensions,se;if(ne){var le=this._getAreaStyles();se=G.ReactBEM.createElement('div',{bem:'$b:cropCanvasControls'},G.ReactBEM.createElement('div',{bem:'e:row'},G.ReactBEM.createElement('div',{bem:'e:cell m:dark',style:le.topLeft},'\xA0'),G.ReactBEM.createElement('div',{bem:'e:cell m:dark',style:le.topCenter},'\xA0'),G.ReactBEM.createElement('div',{bem:'e:cell m:dark'})),G.ReactBEM.createElement('div',{bem:'e:row'},G.ReactBEM.createElement('div',{bem:'e:cell m:dark',style:le.centerLeft},'\xA0'),G.ReactBEM.createElement(Y.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},G.ReactBEM.createElement('div',{bem:'e:cell m:bordered',style:le.center},G.ReactBEM.createElement(Y.default,{onStart:this._onKnobDragStart.bind(this,'start'),onDrag:this._onKnobDrag.bind(this,'start')},G.ReactBEM.createElement('div',{bem:'e:knob m:topLeft $b:knob'},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/resize-diagonal-down.png',!0)}))),G.ReactBEM.createElement('div',{bem:'e:dimensions'},ie.x+'x'+ie.y),G.ReactBEM.createElement(Y.default,{onStart:this._onKnobDragStart.bind(this,'end'),onDrag:this._onKnobDrag.bind(this,'end')},G.ReactBEM.createElement('div',{bem:'e:knob m:bottomRight $b:knob'},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/resize-diagonal-down.png',!0)}))))),G.ReactBEM.createElement('div',{bem:'e:cell m:dark'},'\xA0')),G.ReactBEM.createElement('div',{bem:'e:row'},G.ReactBEM.createElement('div',{bem:'e:cell m:dark'},'\xA0'),G.ReactBEM.createElement('div',{bem:'e:cell m:dark'},'\xA0'),G.ReactBEM.createElement('div',{bem:'e:cell m:dark'},'\xA0')));}else se=G.ReactBEM.createElement('div',{bem:'$b:cropCanvasControls'},G.ReactBEM.createElement('div',{bem:'e:dimensions'},ie.x+'x'+ie.y));return G.ReactBEM.createElement('div',{bem:'b:canvasControls e:container m:full',ref:'container'},se);},oe;}(X.default);R.default=ee,ee.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(ne){return ne&&ne.__esModule?ne:{default:ne};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(7),X=L(J),Q=I(5),ee=L(Q),te=I(12),oe=L(te),re=function(ne){function ie(){(0,W.default)(this,ie);for(var se=arguments.length,le=Array(se),de=0;de<se;de++)le[de]=arguments[de];var pe=(0,H.default)(this,ne.call.apply(ne,[this].concat(le)));return pe._bindAll('_selectRatio','_onRotationChange','_reapplyRatio'),pe.state={ratio:null},pe._ratios=pe.constructor.getRatios(pe.props.options),pe._events=(0,U.default)({},Y.Constants.EVENTS.CROP_REAPPLY_RATIO,pe._reapplyRatio),pe._selectInitialRatio(!pe.getSharedState('cropOperationExistedBefore')),pe;}return(0,Z.default)(ie,ne),ie.getRatios=function(le){var de=le.ratios,pe=le.replaceRatios,ce=le.selectableRatios;de=de||[];var ue;if(ue=Y.Constants.DEFAULTS.CROP_RATIOS,ue=pe?de:ue.concat(de),ce&&ce.length){var me=function fe(ge){return Array.isArray(ge)?ge.map(fe).filter(function(he){return he;}):-1===ce.indexOf(ge.name)?null:ge;};ue=ue.map(me).filter(function(fe){return fe;});}return ue;},ie.prototype.shouldSharedComponentUpdate=function(le,de){return le.ratio!==de.ratio;},ie.prototype._onRotationChange=function(le){var de=this.context.editor;le=le*Math.PI/180,de.setRotation(le),this._updateSpriteScale(),de.render(),this.setSharedState({rotation:le});},ie.prototype._updateSpriteScale=function(){var le=this.context.editor,de=this._getRotatedSpriteDimensions(),pe=le.getOutputDimensions(!1),ce=pe.clone().multiply(0.5);ce.subtract(de.clone().divide(2)),ce.abs();var ue=1;ue=ce.y>ce.x?2*ce.y/pe.y+1:2*ce.x/pe.x+1,le.setSpriteScale(ue);},ie.prototype._getRotatedSpriteDimensions=function(){var le=this.context.editor,de=le.getRotation(),pe=le.getOutputDimensions(!1);return new Y.Vector2(Math.abs(pe.x*Math.cos(de))+Math.abs(pe.y*Math.sin(de)),Math.abs(pe.x*Math.sin(de))+Math.abs(pe.y*Math.cos(de)));},ie.prototype._calculateTextureScale=function(){var le=this.getSharedState('operation'),de=this.getSharedState('ratio');if(!de.dimensions)return 1;var pe=this.getSharedState('start'),ce=this.getSharedState('end'),ue=ce.clone().subtract(pe),me=le.getInputDimensions().multiply(ue);return de.dimensions.x/me.x;},ie.prototype._getHistoryItems=function(){var le=[],de=this._getCropHistoryItem();de&&le.push(de);var pe=this._getOrientationHistoryItem();return pe&&le.push(pe),le;},ie.prototype._getCropHistoryItem=function(){var le=this.context.editor,de=this.getSharedState('operation'),pe=this.getSharedState('initialCropOptions'),ce=this.getSharedState('cropOperationExistedBefore');if(!de.optionsEqual(pe))return{operation:de,options:pe,existent:ce,undo:function(me,fe){le.broadcastCrop(me,fe);}};},ie.prototype._getOrientationHistoryItem=function(){var le=this.context.editor,de=this.getSharedState('orientationOperation'),pe=this.getSharedState('initialOrientationOptions'),ce=this.getSharedState('orientationOperationExistedBefore');if(!de.optionsEqual(pe))return{operation:de,options:pe,existent:ce,undo:function(me,fe){me.getRotation()!==fe.rotation&&le.broadcastRotate(fe.rotation-me.getRotation());var ge=fe.rotation,he=90===ge||270===ge;me.getFlipVertically()===fe.flipVertically?me.getFlipHorizontally()!==fe.flipHorizontally&&le.broadcastFlip(he?'vertical':'horizontal'):le.broadcastFlip(he?'horizontal':'vertical');}};},ie.prototype._reapplyRatio=function(){var le=this.getSharedState('ratio');this._selectRatio(le);},ie.prototype._onBackClick=function(le){var de=this.context.editor,pe=this.getSharedState('ratio'),ce=this.getSharedState('operation'),ue=this.getSharedState('orientationOperation'),me=de.getRotation(),fe=this.getSharedState('start'),ge=this.getSharedState('end');if((null===pe||fe.equals(0,0)&&ge.equals(1,1))&&0===me)de.operations.remove(ce);else{var he=this._calculateTextureScale(),ye={rotation:me,scale:de.getSpriteScale(),start:fe,end:ge,textureScale:he,enabled:!0};de.broadcastCrop(ce,ye),ce.set(ye);}0!==ue.getRotation()||ue.getFlipVertically()||ue.getFlipHorizontally()||de.operations.remove(ue),de.setPadding(!1),de.setRotation(0),de.setSpriteScale(1);var be=this._getHistoryItems();be.length&&de.history.add(be),de.features.enable('zoom','drag'),de.zoom.set('auto'),ne.prototype._onBackClick.call(this,le);},ie.prototype._selectInitialRatio=function(){var le=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,de=this.getSharedState('operation'),pe=null,ce=Y.SDKUtils.flatten(this._ratios),ue=de._ratio;if(ue){var me=ce.filter(function(ge){return ge===ue;});pe=me[0];}if(!pe){var fe=ce.filter(function(ge){return ge.selected;});pe=fe.pop();}return pe||(pe=ce[0]),this._selectRatio(pe,le,!1);},ie.prototype._selectRatio=function(le){var de=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,pe=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0,ce=this.getSharedState('operation');de&&le&&this._setDefaultOptionsForRatio(le,pe),ce._ratio=le;var ue={ratio:le},me=this.context.editor;le?me.setPadding(this.getSharedState('activePadding')):(me.setPadding(!1),me.setRotation(0),me.setSpriteScale(1),ue.rotation=0,ue.start=new Y.Vector2(0,0),ue.end=new Y.Vector2(1,1)),me.render(),this.setSharedState(ue,pe);},ie.prototype._setDefaultOptionsForRatio=function(le){var de=le.ratio,pe=le.name,ce=le.dimensions,ue=1<arguments.length&&void 0!==arguments[1]&&arguments[1],me=this.context.editor,fe=new Y.Vector2(),ge=new Y.Vector2();if(ce&&!de&&(de=ce.x/ce.y),'*'===de)fe=new Y.Vector2(0,0),ge=new Y.Vector2(1,1);else{var he=me.getOutputDimensions(),ye=he.x/he.y;if(ye<=de){var be=1/he.y*(he.x/de);fe.set(0,(1-be)/2),ge.set(1,1-fe.y);}else{var Ee=1/he.x*(de*he.y);fe.set((1-Ee)/2,0),ge.set(1-fe.x,1);}}this.setSharedState({start:fe,end:ge},ue);},ie.prototype.renderOverlayControls=function(){var le=180*this.getSharedState('rotation')/Math.PI;return this.getSharedState('ratio')?Y.ReactBEM.createElement(oe.default,{value:le,minValue:-45,middleDot:!0,maxValue:45,valueUnit:'\xB0',label:this._t('controls.crop.rotation'),onChange:this._onRotationChange}):null;},ie.prototype._renderListItems=function(){var le=this,de=[],pe=function(fe){return Y.ReactBEM.createElement('li',{bem:'e:item',key:fe.name,"data-identifier":fe.name},Y.ReactBEM.createElement('bem',{specifier:'$b:controls'},Y.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:le.getSharedState('ratio')===fe?'is-active':null,onClick:le._selectRatio.bind(le,fe)},Y.ReactBEM.createElement('img',{bem:'e:icon',src:le._getAssetPath('controls/crop/'+fe.name+'.png',!0)}),Y.ReactBEM.createElement('div',{bem:'e:label'},le._t('controls.crop.'+fe.name)))));};this._ratios.forEach(function(me){if(Array.isArray(me)){var ge=[];me.forEach(function(ye){ge.push(pe(ye));}),ge.length&&de.push(ge);}else{de.push(pe(me));}});var ce=[];de.forEach(function(me){ce=ce.concat(me),Array.isArray(me)&&me!==de[de.length-1]&&ce.push(Y.ReactBEM.createElement('li',{bem:'e:separator'}));});var ue=Y.ReactBEM.createElement('li',{bem:'e:item',"data-identifier":'none',key:'noCrop'},Y.ReactBEM.createElement('bem',{specifier:'$b:controls'},Y.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:this.getSharedState('ratio')?null:'is-active',onClick:this._selectRatio.bind(this,null)},Y.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/crop/none.png',!0)}),Y.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.crop.none')))));return[ue,Y.ReactBEM.createElement('li',{bem:'e:separator'})].concat(ce);},ie.prototype.renderControls=function(){var le=this._renderListItems();return Y.ReactBEM.createElement('div',{bem:'e:cell m:list'},Y.ReactBEM.createElement(ee.default,null,Y.ReactBEM.createElement('ul',{bem:'$e:list'},le)));},ie;}(X.default);R.default=re,re.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(32),X=L(J),Q=function(ee){function te(){return(0,W.default)(this,te),(0,H.default)(this,ee.apply(this,arguments));}return(0,Z.default)(te,ee),te.prototype._onRotateClick=function(re){var ne;'cw'===re?ne=90:'ccw'===re&&(ne=-90);var ie=this.context.editor,se=this.getSharedState('orientationOperation'),le=(se.getRotation()+ne)%360;se.set({rotation:le});var de={orientationRotation:le},pe=this.getSharedState('ratio');if(pe&&!pe.dimensions){var ce=this.getSharedState('start'),ue=this.getSharedState('end'),me=ce.clone();'cw'===re?(ce.set(1-ue.y,me.x),ue.set(1-me.y,ue.x)):'ccw'===re&&(ce.set(me.y,1-ue.x),ue.set(ue.y,1-me.x)),de.start=ce,de.end=ue;}pe&&pe.dimensions&&this._emitEvent(Y.Constants.EVENTS.CROP_REAPPLY_RATIO),this.setSharedState(de),ie.broadcastRotate(ne),ie.zoom.set('auto');},te.prototype._onFlipClick=function(re){var ie=this.context.editor,se=this.getSharedState('orientationOperation'),le=!this.getSharedState('flip'+re),de=-1*this.getSharedState('rotation'),ne;this.setSharedState((ne={},(0,U.default)(ne,'flip'+re,le),(0,U.default)(ne,'rotation',de),ne)),ie.setRotation(de),se.flip(re);var pe=this.getSharedState('start'),ce=this.getSharedState('end'),ue=pe.clone();'horizontal'===re?(pe.set(1-ce.x,pe.y),ce.set(1-ue.x,ce.y)):'vertical'===re&&(pe.set(pe.x,1-ce.y),ce.set(ce.x,1-ue.y)),this.setSharedState({start:pe,end:ce}),ie.broadcastFlip(re),ie.render();},te.prototype.shouldSharedComponentUpdate=function(){return!1;},te.prototype.renderContent=function(){return Y.ReactBEM.createElement('bem',{specifier:'$b:topBar'},Y.ReactBEM.createElement('div',{bem:'$e:iconButton',onClick:this._onFlipClick.bind(this,'vertical')},Y.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/crop/flip-v.png',!0)})),Y.ReactBEM.createElement('div',{bem:'$e:iconButton',onClick:this._onFlipClick.bind(this,'horizontal')},Y.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/crop/flip-h.png',!0)})),Y.ReactBEM.createElement('div',{bem:'e:space'}),Y.ReactBEM.createElement('div',{bem:'$e:iconButton',onClick:this._onRotateClick.bind(this,'ccw')},Y.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/crop/rotate-ccw.png',!0)})),Y.ReactBEM.createElement('div',{bem:'$e:iconButton',onClick:this._onRotateClick.bind(this,'cw')},Y.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/crop/rotate-cw.png',!0)})));},te;}(X.default);R.default=Q,Q.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(ne){return ne&&ne.__esModule?ne:{default:ne};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(8),Y=L(Z),J=I(112),X=L(J),Q=I(111),ee=L(Q),te=I(113),oe=L(te),re=function(ne){function ie(){return(0,U.default)(this,ie),(0,W.default)(this,ne.apply(this,arguments));}return(0,H.default)(ie,ne),ie.onEnter=function(){var de=this.context.editor,pe=de.operations.exists('crop'),ce=de.operations.getOrCreate('crop');ce.setEnabled(!1,!1);var ue=de.operations.exists('orientation'),me=de.operations.getOrCreate('orientation'),fe={end:new G.Vector2(1,1),rotation:0,start:new G.Vector2(0,0),scale:1,textureScale:1},ge=ce.getInputDimensions(),he=ce.getNewDimensions(ge),ye=fe;pe&&(ye=ce.serializeOptions(),delete ye.enabled),de.broadcastCrop(ce,fe),ce.set(fe,pe);var be=me.serializeOptions();delete be.enabled;var Ee=[10,0,68,0];de.setSpriteScale(ye.scale),de.setRotation(ye.rotation),de.setPadding(Ee),de.zoom.set('auto',function(){de.features.disable('zoom','drag');},!1),this.setSharedState({initialCropOptions:ye,initialOrientationOptions:be,operation:ce,orientationOperation:me,activePadding:Ee,orientationOperationExistedBefore:ue,cropOperationExistedBefore:pe,start:G.Vector2.fromObject(ye.start),end:G.Vector2.fromObject(ye.end),rotation:ye.rotation,orientationRotation:me.getRotation(),flipVertically:me.getFlipVertically(),flipHorizontally:me.getFlipHorizontally(),initialDimensions:he,inputDimensions:ge});},ie.isAvailable=function(le){return le.isToolEnabled('crop');},ie.getPreloadAssets=function(le){var de=le.getOptions(),pe=G.SDKUtils.defaults(de.editor.controlsOptions.crop,this.defaultOptions),ce=['controls/crop/rotate-ccw.png','controls/crop/rotate-cw.png','controls/crop/flip-h.png','controls/crop/flip-v.png'],ue=X.default.getRatios(pe);return ue.forEach(function(me){Array.isArray(me)?me.forEach(function(fe){var ge=fe.name;ce.push('controls/crop/'+ge+'.png');}):ce.push('controls/crop/'+me.name+'.png');}),ce;},ie;}(Y.default);re.topBarControlsComponent=oe.default,re.controlsComponent=X.default,re.canvasControlsComponent=ee.default,re.identifier='crop',re.iconPath='controls/overview/crop.png',re.languageKey='controls.overview.crop',re.defaultOptions={},R.default=re;},function(M,R,I){"use strict";function L(de){return de&&de.__esModule?de:{default:de};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(7),X=L(J),Q=I(5),ee=L(Q),te=I(63),oe=L(te),re=I(12),ne=L(re),ie=I(44),se=L(ie),le=function(de){function pe(){(0,W.default)(this,pe);for(var ce=arguments.length,ue=Array(ce),me=0;me<ce;me++)ue[me]=arguments[me];var fe=(0,H.default)(this,de.call.apply(de,[this].concat(ue)));return fe._bindAll('_onItemClick','_onOperationUpdated','_onSliderValueChange','_onCategoryChange'),fe._operation=fe.getSharedState('operation'),fe._events=(0,U.default)({},Y.Constants.EVENTS.OPERATION_UPDATED,fe._onOperationUpdated),fe._initFilterManager(),fe.state={category:'all'},fe;}return(0,Z.default)(pe,de),pe.prototype._initFilterManager=function(){this._filterManager=new se.default(this.props.options);},pe.prototype._onSliderValueChange=function(ue){this._operation.setIntensity(ue/100);var me=this.context.editor;me.render();},pe.prototype._onCategoryChange=function(ue){var me=this;this.setState({category:ue.name},function(){me.refs.scrollbar.update();});},pe.prototype._onOperationUpdated=function(ue){ue===this._operation&&this.forceUpdate();},pe.prototype._onItemClick=function(ue){this._operation.set({filter:new ue({intensity:1}),intensity:1});var fe=this.context.editor;fe.render(),this.forceUpdate();},pe.prototype.renderOverlayControls=function(){var ue=this._operation.getFilter();if(ue.isIdentity)return null;var me=this._operation.getIntensity();return Y.ReactBEM.createElement(ne.default,{minValue:0,maxValue:100,value:100*me,valueUnit:'%',positiveValuePrefix:'+',label:this._t('controls.filters.intensity'),onChange:this._onSliderValueChange});},pe.prototype._renderListItems=function(){var ue=this,me=this._operation.getFilter(),fe=this._filterManager.getFiltersForCategory(this.state.category);return[Y.SDK.Filters.IdentityFilter].concat(fe).map(function(ge){var he=ge.identifier;return Y.ReactBEM.createElement('li',{bem:'e:item',key:he,onClick:ue._onItemClick.bind(ue,ge)},Y.ReactBEM.createElement('bem',{specifier:'$b:controls'},Y.ReactBEM.createElement('div',{bem:'$e:button m:withInlineLabel'},Y.ReactBEM.createElement('img',{bem:'e:icon',src:ue._getAssetPath('controls/filters/'+he+'.png',!0)}),Y.ReactBEM.createElement('div',{bem:'$e:inlineLabel',className:me instanceof ge?'is-active':null},Y.ReactBEM.createElement('div',{bem:'e:label'},ge.displayName)))));});},pe.prototype._renderCategoryDropdown=function(){var ue=this,me=this._filterManager.getCategories(),fe=!this.props.options.hideCategories&&1<me.length;if(!fe)return null;var ge=me.map(function(ye){return{name:ye.name,label:ue._t('controls.filters.categories.'+ye.name),icon:ue._getAssetPath('controls/filters/categories/'+ye.name+'.png',!0)};}),he={name:this.state.category,label:this._t('controls.filters.categories.'+this.state.category),icon:this._getAssetPath('controls/filters/categories/'+this.state.category+'.png',!0)};return Y.ReactBEM.createElement('div',{bem:'e:cell m:categoryDropdown'},Y.ReactBEM.createElement(oe.default,{items:ge,selectedItem:he,onChange:this._onCategoryChange}));},pe.prototype.renderControls=function(){var ue=this._renderListItems(),me=this._renderCategoryDropdown();return[me,Y.ReactBEM.createElement('div',{bem:'e:cell m:list'},Y.ReactBEM.createElement(ee.default,{ref:'scrollbar'},Y.ReactBEM.createElement('ul',{bem:'$e:list'},ue)))];},pe;}(X.default);R.default=le,le.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(oe){return oe&&oe.__esModule?oe:{default:oe};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(8),Y=L(Z),J=I(115),X=L(J),Q=I(44),ee=L(Q),te=function(oe){function re(){return(0,U.default)(this,re),(0,W.default)(this,oe.apply(this,arguments));}return(0,H.default)(re,oe),re.onEnter=function(){var se=this.context.editor,le=se.operations.exists('filter'),de=se.operations.getOrCreate('filter'),pe=de.serializeOptions(['filter','intensity']);this.setSharedState({operation:de,operationExistedBefore:le,initialOptions:pe});},re.onExit=function(){var ie=this.getSharedState('initialOptions'),se=this._operation.getFilter().constructor,le=ie.filter.constructor,de=this._operation.getIntensity();if(se!==ie.filter.constructor||de!==ie.intensity){var pe=this.context.editor;pe.history.add(this._operation,{filter:new le(),intensity:de},this.getSharedState('operationExistedBefore'));}if(se.isIdentity){var ce=this.context.editor;ce.operations.remove(this._operation);}},re.isAvailable=function(ie){return ie.isToolEnabled(this.identifier);},re.getPreloadAssets=function(ie){var se=ie.getOptions(),le=G.SDKUtils.defaults(se.editor.controlsOptions.filter,this.defaultOptions),de=new ee.default(le),pe=[],ce=de.getCategories();return ce.forEach(function(ue){pe.push('controls/filters/categories/'+ue.name+'.png');var me=de.getFiltersForCategory(ue.name);me.forEach(function(fe){pe.push('controls/filters/'+fe.identifier+'.png');});}),pe;},re;}(Y.default);te.controlsComponent=X.default,te.identifier='filter',te.iconPath='controls/overview/filters.png',te.languageKey='controls.overview.filters',te.defaultOptions={categories:[],replaceCategories:!1,selectableFilters:null,hideCategories:!1},R.default=te;},function(M,R,I){"use strict";function L(oe){return oe&&oe.__esModule?oe:{default:oe};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(20),Y=L(Z),J=I(120),X=L(J),Q=I(121),ee=L(Q),te=function(oe){function re(){return(0,U.default)(this,re),(0,W.default)(this,oe.apply(this,arguments));}return(0,H.default)(re,oe),re.prototype._getControlsForOperation=function(ie){if(!ie)return null;switch(ie.constructor.identifier){case'linear-focus':return X.default;case'radial-focus':return ee.default;}},re.prototype.renderWithBEM=function(){var ie=this.getSharedState('operation'),se=this._getControlsForOperation(ie);return se?G.ReactBEM.createElement(se,this.props):G.ReactBEM.createElement('div',null);},re;}(Y.default);R.default=te,te.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(ie){return ie&&ie.__esModule?ie:{default:ie};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(7),X=L(J),Q=I(5),ee=L(Q),te=I(12),oe=L(te),re=[{toolName:'radial-focus',iconName:'radial',languageKey:'controls.focus.radial'},{toolName:'linear-focus',iconName:'linear',languageKey:'controls.focus.linear'}],ne=function(ie){function se(){(0,W.default)(this,se);for(var le=arguments.length,de=Array(le),pe=0;pe<le;pe++)de[pe]=arguments[pe];var ce=(0,H.default)(this,ie.call.apply(ie,[this].concat(de)));return ce._bindAll('_onBlurRadiusChange','_onOperationRemoved'),ce._removedOperation=null,ce._events=(0,U.default)({},Y.Constants.EVENTS.OPERATION_REMOVED,ce._onOperationRemoved),ce;}return(0,Z.default)(se,ie),se.prototype._onBlurRadiusChange=function(de){var pe=this.getSharedState('operation'),ce=this.getSharedState('inputDimensions');pe.setBlurRadius(de/ce.min());var ue=this.context.editor;ue.render();},se.prototype._onButtonClick=function(de){var ce=this.context.editor,ue=this.getSharedState('operation');ue&&(this._removedOperation=ue,ce.operations.remove(ue));var me=null;de&&(me=ce.operations.getOrCreate(de)),this.setSharedState({operation:me}),ce.render();},se.prototype._onOperationRemoved=function(de){var pe=this.getSharedState('operation');if(pe&&de===pe&&de!==this._removedOperation&&!this._backButtonClicked){var ce=this.context.editor,ue=pe.constructor.identifier,me=ce.operations.getOrCreate(ue);this.setSharedState({operation:me,operationExistedBefore:!1,initialOptions:{}});}},se.prototype.renderOverlayControls=function(){var de=this.getSharedState('operation');if(!de)return null;var pe=this.getSharedState('inputDimensions'),ce=pe.min(),ue=de.getBlurRadius()*ce;return Y.ReactBEM.createElement(oe.default,{minValue:0,maxValue:Math.min(180,Math.round(0.1*ce)),valueUnit:'px',middleDot:!1,label:this._t('controls.focus.blurRadius'),onChange:this._onBlurRadiusChange,value:ue});},se.prototype._renderListItems=function(){var de=this,pe=this.getSharedState('operation'),ce=this.context.editor,ue=Y.ReactBEM.createElement('li',{bem:'e:item',key:'none'},Y.ReactBEM.createElement('bem',{specifier:'$b:controls'},Y.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:pe?null:'is-active',onClick:this._onButtonClick.bind(this,null)},Y.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/focus/none.png',!0)}),Y.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.focus.none')))));return[ue].concat(re.filter(function(me){var fe=me.toolName;return ce.isToolEnabled(fe);}).map(function(me){var fe=me.toolName,ge=me.iconName,he=me.languageKey,ye=pe&&pe.constructor.identifier===fe;return Y.ReactBEM.createElement('li',{bem:'e:item',"data-identifier":fe,key:fe},Y.ReactBEM.createElement('bem',{specifier:'$b:controls'},Y.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:ye?'is-active':null,onClick:de._onButtonClick.bind(de,fe)},Y.ReactBEM.createElement('img',{bem:'e:icon',src:de._getAssetPath('controls/focus/'+ge+'.png',!0)}),Y.ReactBEM.createElement('div',{bem:'e:label'},de._t(he)))));}));},se.prototype.renderControls=function(){var de=this._renderListItems();return Y.ReactBEM.createElement('div',{bem:'e:cell m:list'},Y.ReactBEM.createElement(ee.default,null,Y.ReactBEM.createElement('ul',{bem:'$e:list'},de)));},se;}(X.default);R.default=ne,ne.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(te){return te&&te.__esModule?te:{default:te};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(8),Z=L(G),Y=I(118),J=L(Y),X=I(117),Q=L(X),ee=function(te){function oe(){return(0,U.default)(this,oe),(0,W.default)(this,te.apply(this,arguments));}return(0,H.default)(oe,te),oe.isAvailable=function(ne){return ne.isToolEnabled('radial-focus')||ne.isToolEnabled('linear-focus');},oe.onExit=function(){var ne=this.context.editor;ne.features.enable('zoom','drag');var ie=this.getSharedState('initialOptions'),se=this.getSharedState('initialOperation'),le=this.getSharedState('operation');(!le&&se||le&&se&&le.constructor===se.constructor)&&ne.history.add(se,ie,!0),le&&!se&&ne.history.add(le,{},!1),le&&se&&le.constructor!==se.constructor&&ne.history.add([{operation:se,options:ie,existent:!0},{operation:le,options:{},existent:!1}]);},oe.onEnter=function(){var ie=this.context.editor,se=ie.operations.get('linear-focus')||ie.operations.get('radial-focus'),le={};se&&(le=se.serializeOptions(),delete le.enabled),this.setSharedState({operation:se,initialOperation:se,operationExistedBefore:!!se,initialOptions:le,inputDimensions:ie.getOutputDimensions()});},oe.getPreloadAssets=function(ne){var ie=[];return ne.isToolEnabled('radial-focus')&&ie.push('controls/focus/radial.png'),ne.isToolEnabled('linear-focus')&&ie.push('controls/focus/linear.png'),ie;},oe;}(Z.default);ee.controlsComponent=J.default,ee.canvasControlsComponent=Q.default,ee.identifier='focus',ee.iconPath='controls/overview/focus.png',ee.languageKey='controls.overview.focus',ee.defaultOptions={},R.default=ee;},function(M,R,I){"use strict";function L(oe){return oe&&oe.__esModule?oe:{default:oe};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(11),X=L(J),Q=I(20),ee=L(Q),te=function(oe){function re(){(0,W.default)(this,re);for(var ne=arguments.length,ie=Array(ne),se=0;se<ne;se++)ie[se]=arguments[se];var le=(0,H.default)(this,oe.call.apply(oe,[this].concat(ie)));return le._bindAll('_onCenterDragStart','_onCenterDrag','_onKnobDragStart','_onKnobDrag','_onOperationUpdated'),le.state={areaPosition:new Y.Vector2(),areaDimensions:new Y.Vector2(),knobPosition:new Y.Vector2()},le._operation=le.getSharedState('operation'),le._events=(0,U.default)({},Y.Constants.EVENTS.OPERATION_UPDATED,le._onOperationUpdated),le;}return(0,Z.default)(re,oe),re.prototype._onCanvasZoomDone=function(){this._setStylesFromOptions();},re.prototype._onOperationUpdated=function(ie){ie!==this.getSharedState('operation')||this._setStylesFromOptions();},re.prototype.sharedStateDidChange=function(ie){ie.operation&&(this._operation=ie.operation,'linear-focus'===this._operation.constructor.identifier&&this._setStylesFromOptions());},re.prototype.componentDidMount=function(){var ie=this;oe.prototype.componentDidMount.call(this);var se=this.context.editor;se.zoom.set('auto',function(){se.features.disable('zoom','drag'),ie._setStylesFromOptions();});},re.prototype._onCenterDragStart=function(){this._initialStart=this._operation.getStart(),this._initialEnd=this._operation.getEnd(),this._initialDist=this._initialEnd.clone().subtract(this._initialStart);},re.prototype._onCenterDrag=function(ie){var se=this.context.editor,le=se.getOutputDimensions(),de=ie.clone().divide(le),pe=this._initialStart.clone().add(de).clamp(new Y.Vector2(0,0),new Y.Vector2(1,1).subtract(this._initialDist)),ce=pe.clone().add(this._initialDist);this._operation.set({start:pe,end:ce}),se.render(),this._setStylesFromOptions(),this.forceUpdate();},re.prototype._onKnobDragStart=function(){this._initialKnobPosition=this.state.knobPosition.clone();},re.prototype._onKnobDrag=function(ie){var se=this.context.editor,le=se.getOutputDimensions(),de=this._initialKnobPosition.clone().add(ie).clamp(new Y.Vector2(0,0),le),pe=de.clone().subtract(this.state.areaPosition),ce=this.state.areaPosition.clone().add(-pe.y,pe.x).divide(le),ue=this.state.areaPosition.clone().add(pe.y,-pe.x).divide(le),me=2*pe.len();this._operation.set({start:ce,end:ue,size:me/le.min(),gradientSize:me/le.min()}),this.setState({knobPosition:de,areaDimensions:new Y.Vector2(this.state.areaDimensions.x,me)}),se.render();},re.prototype._getAreaStyle=function(){var ie=this.state.knobPosition.clone().subtract(this.state.areaPosition),se=Math.atan2(ie.x,ie.y)*(180/Math.PI),le='rotate('+(-se).toFixed(2)+'deg)';return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:-0.5*this.state.areaDimensions.x,marginTop:-0.5*this.state.areaDimensions.y,transform:le,MozTransform:le,msTransform:le,WebkitTransform:le};},re.prototype._getKnobStyle=function(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y};},re.prototype._setStylesFromOptions=function(){var ie=this.context.editor,se=ie.getOutputDimensions(),le=this._operation.getStart().clone().multiply(se),de=this._operation.getEnd().clone().multiply(se),pe=this._operation.getSize()*se.min(),ce=de.clone().subtract(le),ue=le.clone().add(ce.clone().divide(2)),me=new Y.Vector2(2*se.len(),pe),fe=ce.len(),ge=ce.clone().divide(fe).divide(2);this.setState({areaDimensions:me,areaPosition:ue.clone(),knobPosition:ue.clone().add(-pe*ge.y,pe*ge.x)});},re.prototype._getContainerStyle=function(){var ie=this.context.editor.getSDK().getSprite().getBounds(),se=ie.x,le=ie.y,de=ie.width,pe=ie.height;return{left:se,top:le,width:de,height:pe};},re.prototype.renderWithBEM=function(){return Y.ReactBEM.createElement('div',{bem:'b:canvasControls e:container m:full',ref:'container',style:this._getContainerStyle()},Y.ReactBEM.createElement('div',{bem:'$b:linearFocusCanvasControls'},Y.ReactBEM.createElement(X.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},Y.ReactBEM.createElement('div',{bem:'e:area',style:this._getAreaStyle()})),Y.ReactBEM.createElement(X.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},Y.ReactBEM.createElement('div',{bem:'e:knob $b:knob',style:this._getKnobStyle()}))));},re;}(ee.default);R.default=te,te.contextTypes=ee.default.contextTypes;},function(M,R,I){"use strict";function L(oe){return oe&&oe.__esModule?oe:{default:oe};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(11),X=L(J),Q=I(20),ee=L(Q),te=function(oe){function re(){(0,W.default)(this,re);for(var ne=arguments.length,ie=Array(ne),se=0;se<ne;se++)ie[se]=arguments[se];var le=(0,H.default)(this,oe.call.apply(oe,[this].concat(ie)));return le._bindAll('_onCenterDragStart','_onCenterDrag','_onKnobDragStart','_onKnobDrag','_onOperationUpdated'),le.state={areaPosition:new Y.Vector2(),areaDimensions:new Y.Vector2(),knobPosition:new Y.Vector2()},le._knobChangedManually=!1,le._operation=le.getSharedState('operation'),le._events=(0,U.default)({},Y.Constants.EVENTS.OPERATION_UPDATED,le._onOperationUpdated),le;}return(0,Z.default)(re,oe),re.prototype._onCanvasZoomDone=function(){this._setStylesFromOptions();},re.prototype._onOperationUpdated=function(ie){ie!==this.getSharedState('operation')||(this._knobChangedManually=!1,this._setStylesFromOptions());},re.prototype.sharedStateDidChange=function(ie){ie.operation&&(this._operation=ie.operation,'radial-focus'===this._operation.constructor.identifier&&this._setStylesFromOptions());},re.prototype.componentDidMount=function(){var ie=this;oe.prototype.componentDidMount.call(this);var se=this.context.editor;se.zoom.set('auto',function(){se.features.disable('zoom','drag'),ie._setStylesFromOptions();});},re.prototype._onCenterDragStart=function(){this._initialPosition=this._operation.getPosition(),this._initialKnobPosition=this.state.knobPosition.clone();},re.prototype._onCenterDrag=function(ie){var se=this.context.editor,le=se.getOutputDimensions(),de=ie.clone().divide(le),pe=this._initialPosition.clone().add(de),ce=this._initialKnobPosition.clone().add(ie);this._operation.set({position:pe}),this.state.knobPosition=ce,se.render(),this._setStylesFromOptions();},re.prototype._onKnobDragStart=function(){this._knobChangedManually=!0,this._initialKnobPosition=this.state.knobPosition.clone();},re.prototype._onKnobDrag=function(ie){var se=this.context.editor,le=se.getOutputDimensions(),de=this._initialKnobPosition.clone().add(ie).clamp(new Y.Vector2(0,0),le),pe=this._operation.getPosition().clone().multiply(le),ce=de.clone().subtract(pe).abs().len();this.setState({knobPosition:de,areaDimensions:new Y.Vector2(2*ce,2*ce)}),this._operation.set({radius:ce/le.min(),gradientRadius:ce/2/le.min()}),se.render();},re.prototype._getAreaStyle=function(){return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:-0.5*this.state.areaDimensions.x,marginTop:-0.5*this.state.areaDimensions.y};},re.prototype._getKnobStyle=function(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y};},re.prototype._setStylesFromOptions=function(){var ie=this.context.editor,se=ie.getOutputDimensions(),le=this._operation.getPosition().clone().multiply(se),de=this._operation.getRadius()*se.min(),pe=2*de,ce=new Y.Vector2(pe,pe),ue={areaDimensions:ce,areaPosition:le};this._knobChangedManually||(ue.knobPosition=le.clone().add(de,0)),this.setState(ue);},re.prototype._getContainerStyle=function(){var ie=this.context.editor,se=ie.getSDK().getSprite().getBounds(),le=se.x,de=se.y,pe=se.width,ce=se.height;return{left:le,top:de,width:pe,height:ce};},re.prototype.renderWithBEM=function(){return Y.ReactBEM.createElement('div',{bem:'b:canvasControls e:container m:full',ref:'container',style:this._getContainerStyle()},Y.ReactBEM.createElement('div',{bem:'$b:radialFocusCanvasControls'},Y.ReactBEM.createElement(X.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},Y.ReactBEM.createElement('div',{bem:'e:area',style:this._getAreaStyle()})),Y.ReactBEM.createElement(X.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},Y.ReactBEM.createElement('div',{bem:'e:knob $b:knob',style:this._getKnobStyle()}))));},re;}(ee.default);R.default=te,te.contextTypes=ee.default.contextTypes;},function(M,R,I){"use strict";function L(me){return me&&me.__esModule?me:{default:me};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(7),X=L(J),Q=I(5),ee=L(Q),te=I(6),oe=L(te),re=I(190),ne=L(re),ie=I(123),se=L(ie),le=I(39),de=L(le),pe=I(12),ce=L(pe),ue=function(me){function fe(){var ge;(0,W.default)(this,fe);for(var he=arguments.length,ye=Array(he),be=0;be<he;be++)ye[be]=arguments[be];var Ee=(0,H.default)(this,me.call.apply(me,[this].concat(ye)));return Ee._operation=Ee.getSharedState('operation'),Ee._bindAll('_onScaleChange','_onColorChange','_onOperationUpdated','_onOperationRemoved'),Ee._events=(ge={},(0,U.default)(ge,Y.Constants.EVENTS.OPERATION_UPDATED,Ee._onOperationUpdated),(0,U.default)(ge,Y.Constants.EVENTS.OPERATION_REMOVED,Ee._onOperationRemoved),ge),Ee._initFrameManager(),Ee;}return(0,Z.default)(fe,me),fe.prototype._initFrameManager=function(){this._frameManager=new ne.default(this.context.ui,this.props.options);},fe.prototype._onOperationUpdated=function(he){he===this.getSharedState('operation')&&this.forceSharedUpdate();},fe.prototype._onOperationRemoved=function(he){if(he===this.getSharedState('operation')&&!this._backButtonClicked){var ye=this.context.editor,be=ye.operations.getOrCreate('frame');this.setSharedState({operation:be,frame:null,operationExistedBefore:!1,initialOptions:{}}),ye.render();}},fe.prototype._onScaleChange=function(he){var ye=this.context.editor,be=this.getSharedState('inputDimensions');this._operation.setScale(he/be.min()),ye.render();},fe.prototype._onColorChange=function(he){var ye=this.getSharedState('operation');ye.setTintColor(he.clone());var be=this.context.editor;be.render();},fe.prototype._onBackClick=function(){this._backButtonClicked=!0,this.props.onSwitchControls('home');},fe.prototype._onFrameClick=function(he){var ye=this,be=this.context.editor,Ee=this.getSharedState('operation');if(null===he)return Ee.setFrame(null),be.render(),this.setSharedState({frame:he});var ve=setTimeout(function(){Se=oe.default.instance.displayLoading(ye._t('loading.loading'));},100),Se;he.load().then(function(){Se&&Se.close(),ve&&(clearTimeout(ve),ve=null);var Me=he.getFrame();Ee.setFrame(Me);var Ce=ye.context.editor;Ce.render(),ye.setSharedState({frame:he});});},fe.prototype.renderOverlayControls=function(){var he=this.getSharedState('frame');if(!he)return null;var ye=this.getSharedState('inputDimensions'),Ee=Math.round(0.3*ye.min()),Se=this._operation.getScale()*ye.min();return Y.ReactBEM.createElement(ce.default,{minValue:5,maxValue:Ee,value:Se,valueUnit:'px',middleDot:!1,label:this._t('controls.frame.scale'),onChange:this._onScaleChange});},fe.prototype._renderListItems=function(){var he=this,ye=this._frameManager.getFrames(),be=this.getSharedState('operation').getFrame(),Ee=Y.ReactBEM.createElement('li',{bem:'e:item',key:'no-frame',onClick:this._onFrameClick.bind(this,null)},Y.ReactBEM.createElement('bem',{specifier:'$b:controls'},Y.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:be?null:'is-active'},Y.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/frame/no-frame.png',!0)}),Y.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.frame.noFrame')))));return[Ee].concat(ye.map(function(Se){return Y.ReactBEM.createElement(se.default,{frame:Se,active:be&&be.name===Se.getName(),onClick:he._onFrameClick.bind(he,Se)});}));},fe.prototype.renderControls=function(){var he=this.getSharedState('operation').getFrame(),ye=this._renderListItems(),be=[Y.ReactBEM.createElement('div',{bem:'e:cell m:list'},Y.ReactBEM.createElement(ee.default,{ref:'scrollbar'},Y.ReactBEM.createElement('ul',{bem:'$e:list'},ye)))];if(he&&he.tintable){var Ee=this.getSharedState('operation');be.push(Y.ReactBEM.createElement('div',{bem:'e:cell m:colorPicker'},Y.ReactBEM.createElement(de.default,{initialValue:Ee.getTintColor().clone(),onChange:this._onColorChange})));}return be;},fe;}(X.default);R.default=ue,ue.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){(0,U.default)(this,J);for(var X=arguments.length,Q=Array(X),ee=0;ee<X;ee++)Q[ee]=arguments[ee];var te=(0,W.default)(this,Y.call.apply(Y,[this].concat(Q)));return te.state={frame:te.props.frame},te;}return(0,H.default)(J,Y),J.prototype.componentDidMount=function(){this._renderFrame();},J.prototype.componentWillReceiveProps=function(Q){var ee=this;this.props.frame!==Q.frame&&this.setState({frame:Q.frame},function(){ee._renderFrame();});},J.prototype._renderFrame=function(){var Q=this.context.editor,ee=Q.getSDK(),te=this.props.frame,oe=this._getAssetPath(te.getIcon()),re=this.refs['canvas-'+te.getName()],ne=ee.getPixelRatio();re.width=re.offsetWidth*ne,re.height=re.offsetHeight*ne,re.style.width=re.offsetWidth+'px',re.style.height=re.offsetHeight+'px';var ie=re.getContext('2d'),se=new window.Image();se.addEventListener('load',function(){var le=Math.min(re.width/se.width,re.height/se.height),de=new G.Vector2(se.width,se.height).multiply(le),pe=new G.Vector2(re.width,re.height).divide(2).subtract(de.clone().divide(2));ie.drawImage(se,0,0,se.width,se.height,pe.x,pe.y,de.x,de.y);}),se.crossOrigin='Anonymous',se.src=oe;},J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('bem',{specifier:'b:controls e:list'},G.ReactBEM.createElement('li',{bem:'e:item',key:this.props.frame.getName(),onClick:this.props.onClick},G.ReactBEM.createElement('bem',{specifier:'$b:controls'},G.ReactBEM.createElement('div',{bem:'$e:button m:withInlineLabel'},G.ReactBEM.createElement('canvas',{bem:'e:canvas m:large',ref:'canvas-'+this.props.frame.getName()}),G.ReactBEM.createElement('div',{bem:'$e:inlineLabel',className:this.props.active?'is-active':null},G.ReactBEM.createElement('div',{bem:'e:label'},this.props.frame.getLabel()))))));},J;}(G.BaseComponent);R.default=Z;},function(M,R,I){"use strict";function L(Q){return Q&&Q.__esModule?Q:{default:Q};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(8),Z=L(G),Y=I(122),J=L(Y),X=function(Q){function ee(){return(0,U.default)(this,ee),(0,W.default)(this,Q.apply(this,arguments));}return(0,H.default)(ee,Q),ee.onExit=function(){var oe=this.context.editor,re=this.getSharedState('operation'),ne=this.getSharedState('initialOptions'),ie=re.getFrame(),se=re.getScale();((ie&&ie.name)!==(ne.frame&&ne.frame.name)||se!==ne.scale)&&oe.history.add(re,this.getSharedState('initialOptions'),this.getSharedState('operationExistedBefore')),re.getFrame()||oe.operations.remove(re),oe.render();},ee.onEnter=function(){var re=this.context.editor,ne=re.operations.exists('frame'),ie=re.operations.getOrCreate('frame'),se=ie.serializeOptions();this.setSharedState({operation:ie,operationExistedBefore:ne,initialOptions:se,inputDimensions:ie.getInputDimensions(),frame:ie.getFrame()});},ee.isAvailable=function(oe){return oe.isToolEnabled('frame');},ee;}(Z.default);X.controlsComponent=J.default,X.identifier='frame',X.iconPath='controls/overview/frame.png',X.languageKey='controls.overview.frame',X.defaultOptions={frames:[]},R.default=X;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(24),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=function(X){function Q(){(0,W.default)(this,Q);for(var ee=arguments.length,te=Array(ee),oe=0;oe<ee;oe++)te[oe]=arguments[oe];var re=(0,H.default)(this,X.call.apply(X,[this].concat(te)));return re.state={value:re.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0},re;}return(0,Z.default)(Q,X),Q.prototype.componentDidMount=function(){this._setValue(this.state.value,!1);},Q.prototype.componentWillReceiveProps=function(te){te.value!==this.state.value&&this._setValue(te.value,!1);},Q.prototype._getKnobStyle=function(){return{left:this.state.sliderPosition};},Q.prototype._getForegroundStyle=function(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth};},Q.prototype._displayMiddleDot=function(){return!1!==this.props.middleDot;},Q.prototype._setValue=function(te){1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0;te=Math.round(te);var re=this.props,ne=re.minValue,ie=re.maxValue,se=(te-ne)/(ie-ne),le=this.refs.bar,de=le.offsetWidth,ce=se*de,ue=0;this._displayMiddleDot()&&(ce=Math.abs(se-0.5)*de,ue=0.5>se?0.5*de-ce:'50%'),this.setState({value:te,sliderPosition:de*se,foregroundWidth:ce,foregroundLeft:ue});},Q.prototype.renderWithBEM=function(){var te={style:this._getForegroundStyle()};return Y.ReactBEM.createElement('div',{bem:'$b:miniSlider'},Y.ReactBEM.createElement('div',{bem:'$e:bar',ref:'bar'},Y.ReactBEM.createElement('div',{bem:'$e:background'}),Y.ReactBEM.createElement('div',(0,U.default)({bem:'$e:foreground'},te)),Y.ReactBEM.createElement('div',{bem:'e:knob',style:this._getKnobStyle()})));},Q;}(Y.BaseComponent);R.default=J,J.contextTypes=Y.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(re){return re&&re.__esModule?re:{default:re};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(8),Z=L(G),Y=I(130),J=L(Y),X=I(64),Q=L(X),ee=I(127),te=L(ee),oe=function(re){function ne(){return(0,U.default)(this,ne),(0,W.default)(this,re.apply(this,arguments));}return(0,H.default)(ne,re),ne;}(Z.default);oe.topBarControlsComponent=J.default,oe.controlsComponent=Q.default,oe.canvasControlsComponent=te.default,R.default=oe;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(20),Y=L(Z),J=function(X){function Q(){(0,U.default)(this,Q);for(var ee=arguments.length,te=Array(ee),oe=0;oe<ee;oe++)te[oe]=arguments[oe];var re=(0,W.default)(this,X.call.apply(X,[this].concat(te)));return re._bindAll('_onClick'),re;}return(0,H.default)(Q,X),Q.prototype._onClick=function(te){this._performHitTest(G.Utils.getEventPosition(te));},Q.prototype._getContainerStyle=function(){if(!this.context.editor.isReady())return{left:0,top:0,width:1,height:1};var te=this.context.editor.getSDK().getSprite().getBounds(),oe=te.x,re=te.y,ne=te.width,ie=te.height;return{left:oe,top:re,width:ne,height:ie};},Q.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',{bem:'$b:canvasControls e:container m:full',ref:'container'},G.ReactBEM.createElement('div',{bem:'$b:canvasControls e:innerContainer',ref:'innerContainer',style:this._getContainerStyle(),onClick:this._onClick,onTouchStart:this._onClick}));},Q;}(Y.default);R.default=J,J.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(6),Y=L(Z),J=I(43),X=L(J),Q=function(ee){function te(){(0,U.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,W.default)(this,ee.call.apply(ee,[this].concat(re)));return ie._bindAll('_onButtonClick'),ie;}return(0,H.default)(te,ee),te.prototype._onButtonClick=function(){var re=this,ne=this.context,ie=ne.options,se=ne.editor,le=ne.editorScreen,de=ie.editor.export;le.switchToControls('home',null,function(){var pe=Y.default.instance.displayLoading(re._t('loading.exporting'));setTimeout(function(){se.export(de.download).then(function(){pe.close();}).catch(function(ce){Y.default.instance.displayError(re._t('errors.title'),ce.message),pe.close();});},100);});},te.prototype.renderWithBEM=function(){var re=this.context.options;return re.editor.export.showButton?G.ReactBEM.createElement(X.default,{style:'blue',label:this._t('editor.export'),icon:'editor/export.png',onClick:this._onButtonClick}):null;},te;}(G.BaseComponent);R.default=Q,Q.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(43),Y=L(Z),J=I(42),X=L(J),Q=function(ee){function te(){(0,U.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,W.default)(this,ee.call.apply(ee,[this].concat(re)));return ie._bindAll('_onNewFile','_onButtonClick'),ie;}return(0,H.default)(te,ee),te.prototype._onNewFile=function(re){var ne=this.context.editor;ne.reset(),ne.setImage(re),ne.zoom.set('auto');},te.prototype._onButtonClick=function(){var re=this.context.options,ne=!1===re.enableWebcam||G.Utils.isMobile(),ie=!!re.photoRoll.provider;ne&&!ie?this.refs.upload.open():ie?this.props.app.switchToScreen('photoRoll'):this.props.app.switchToScreen('splash');},te.prototype.renderWithBEM=function(){var re=this.context.options,ne=null;return ne=re.photoRoll.provider?this._t('editor.backgroundImage'):this._t('editor.new'),G.ReactBEM.createElement('div',null,G.ReactBEM.createElement(X.default,{onNewFile:this._onNewFile,ref:'upload'}),G.ReactBEM.createElement(Y.default,{label:ne,icon:'editor/new.png',onClick:this._onButtonClick}));},te;}(G.BaseComponent);R.default=Q,Q.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(se){return se&&se.__esModule?se:{default:se};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(32),Y=L(Z),J=I(129),X=L(J),Q=I(128),ee=L(Q),te=I(131),oe=L(te),re=I(132),ne=L(re),ie=function(se){function le(){return(0,U.default)(this,le),(0,W.default)(this,se.apply(this,arguments));}return(0,H.default)(le,se),le.prototype.renderContent=function(){var pe=null;this.context.options.enableUpload&&(pe=G.ReactBEM.createElement(X.default,{app:this.props.app}));var ce=null;return this.context.options.editor.enableZoom&&(ce=G.ReactBEM.createElement(ne.default,null)),G.ReactBEM.createElement('bem',{specifier:'$b:topBar'},G.ReactBEM.createElement('div',{bem:'e:left'},pe),G.ReactBEM.createElement('div',{bem:'e:right'},G.ReactBEM.createElement(oe.default,null),G.ReactBEM.createElement(ee.default,null)),ce);},le;}(Y.default);R.default=ie,ie.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(43),X=L(J),Q=function(ee){function te(){var oe;(0,W.default)(this,te);for(var re=arguments.length,ne=Array(re),ie=0;ie<re;ie++)ne[ie]=arguments[ie];var se=(0,H.default)(this,ee.call.apply(ee,[this].concat(ne)));return se._bindAll('_onButtonClick','_onHistoryUpdated','_onFeaturesUpdated'),se._events=(oe={},(0,U.default)(oe,Y.Constants.EVENTS.HISTORY_UPDATED,se._onHistoryUpdated),(0,U.default)(oe,Y.Constants.EVENTS.FEATURES_UPDATED,se._onFeaturesUpdated),oe),se;}return(0,Z.default)(te,ee),te.prototype._onFeaturesUpdated=function(){this.forceUpdate();},te.prototype._onHistoryUpdated=function(){this.forceUpdate();},te.prototype._onButtonClick=function(){var re=this.context.editor;re.history.undo();},te.prototype.renderWithBEM=function(){var re=this.context.editor;return re.history.isAvailable()?Y.ReactBEM.createElement(X.default,{label:this._t('editor.undo'),icon:'editor/undo.png',onClick:this._onButtonClick}):null;},te;}(Y.BaseComponent);R.default=Q,Q.contextTypes=Y.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=function(X){function Q(){var ee;(0,W.default)(this,Q);for(var te=arguments.length,oe=Array(te),re=0;re<te;re++)oe[re]=arguments[re];var ne=(0,H.default)(this,X.call.apply(X,[this].concat(oe)));return ne._bindAll('_onZoomOutClick','_onZoomInClick','_onZoomDone','_onFeaturesUpdated'),ne._events=(ee={},(0,U.default)(ee,Y.Constants.EVENTS.ZOOM_DONE,ne._onZoomDone),(0,U.default)(ee,Y.Constants.EVENTS.FEATURES_UPDATED,ne._onFeaturesUpdated),ee),ne;}return(0,Z.default)(Q,X),Q.prototype._onFeaturesUpdated=function(){this.forceUpdate();},Q.prototype._onZoomDone=function(){this.forceUpdate();},Q.prototype._onZoomOutClick=function(){var oe=this.context.editor;oe.features.isEnabled('zoom')&&oe.zoom.zoomOut();},Q.prototype._onZoomInClick=function(){var oe=this.context.editor;oe.features.isEnabled('zoom')&&oe.zoom.zoomIn();},Q.prototype.renderWithBEM=function(){var te=this.context.editor,oe=te.zoom.get(),re=te.features.isEnabled('zoom');return Y.ReactBEM.createElement('bem',{specifier:'b:editorScreen'},Y.ReactBEM.createElement('div',{bem:'$e:zoom'},Y.ReactBEM.createElement('div',{bem:'$e:button m:zoomOut',onClick:this._onZoomOutClick,className:re?null:'is-disabled'},Y.ReactBEM.createElement('img',{bem:'e:image',src:this._getAssetPath('controls/minus.png',!0)})),Y.ReactBEM.createElement('div',{bem:'e:label'},this._t('editor.zoom'),Y.ReactBEM.createElement('br',null),Math.round(100*oe),'%'),Y.ReactBEM.createElement('div',{bem:'$e:button m:zoomIn',onClick:this._onZoomInClick,className:re?null:'is-disabled'},Y.ReactBEM.createElement('img',{bem:'e:image',src:this._getAssetPath('controls/plus.png',!0)}))));},Q;}(Y.BaseComponent);R.default=J,J.contextTypes=Y.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(te){return te&&te.__esModule?te:{default:te};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(8),Z=L(G),Y=I(135),J=L(Y),X=I(134),Q=L(X),ee=function(te){function oe(){return(0,U.default)(this,oe),(0,W.default)(this,te.apply(this,arguments));}return(0,H.default)(oe,te),oe.onExit=function(){var ne=this.context.editor,ie=this.getSharedState('operation');0===ie.getPaths().length&&ne.operations.remove(ie),ne.zoom.restore(),ne.features.enable('zoom','drag'),ne.render();},oe.onEnter=function(){var se=this.context.editor;se.zoom.save(),se.zoom.set('auto',function(){se.render();});var le=se.getOutputDimensions(),de=se.operations.exists('selective-blur'),pe=se.operations.getOrCreate('selective-blur'),ce=pe.serializeOptions(),ue=pe.getBrush(),me=0.1*le.min(),ge=pe.getInputDimensions();this.setSharedState({operationExistedBefore:de,operation:pe,brush:ue,initialOptions:ce,thickness:me,hardness:1,inputDimensions:ge});},oe.isAvailable=function(ne){return ne.isToolEnabled('selective-blur');},oe;}(Z.default);ee.controlsComponent=J.default,ee.canvasControlsComponent=Q.default,ee.identifier='selective-blur',ee.iconPath='controls/overview/selective-blur.png',ee.languageKey='controls.overview.selective-blur',ee.defaultOptions={},R.default=ee;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(31),X=L(J),Q=function(ee){function te(){(0,W.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,H.default)(this,ee.call.apply(ee,[this].concat(re)));return ie._windowResized=!1,ie._drawing=!1,ie._bindAll('_onMouseEnter','_onMouseLeave','_onMouseDown','_onMouseMove','_onMouseUp','_onMouseMoveOnCanvas','_onWindowResize'),ie._lastDrawPosition=null,ie._events=Y.SDKUtils.extend(ie._events,(0,U.default)({},Y.Constants.EVENTS.WINDOW_RESIZE,ie._onWindowResize)),ie.state={cursorVisible:!1,cursorPosition:new Y.Vector2()},ie;}return(0,Z.default)(te,ee),te.prototype.componentDidMount=function(){ee.prototype.componentDidMount.call(this),this._updateContainerRect();},te.prototype.componentDidUpdate=function(){this._windowResized&&(this._updateContainerRect(),this._windowResized=!1);},te.prototype._onWindowResize=function(){this._windowResized=!0;},te.prototype._onOperationRemoved=function(){},te.prototype._onOperationUpdated=function(re){re===this.getSharedState('operation')&&this.forceUpdate();},te.prototype._onMouseDown=function(re){re.preventDefault();var ne=this.getSharedState('operation');this._optionsBeforeDraw=ne.serializeOptions(),delete this._optionsBeforeDraw.enabled,this._operationExistedBeforeDraw=this.getSharedState('operationExistedBefore'),this.setSharedState({operationExistedBefore:!0},!1);var ie=this.context.editor.getOutputDimensions(),se=this._getCursorPosition(re),le=this.getSharedState('thickness')/ie.min(),de=this.getSharedState('hardness');this._drawing=!0,this._currentPath=ne.createPath(le,de),this._currentPath.addControlPoint(se.clone().divide(ie)),document.addEventListener('mousemove',this._onMouseMove),document.addEventListener('touchmove',this._onMouseMove),document.addEventListener('mouseup',this._onMouseUp),document.addEventListener('touchend',this._onMouseUp);},te.prototype._onMouseUp=function(){this._currentPath.setClosed(!0);var re=this.context.editor;re.render(),this._currentPath=null,this._drawing=!1,re.history.add(this.getSharedState('operation'),this._optionsBeforeDraw,this._operationExistedBeforeDraw),document.removeEventListener('mousemove',this._onMouseMove),document.removeEventListener('touchmove',this._onMouseMove),document.removeEventListener('mouseup',this._onMouseUp),document.removeEventListener('touchend',this._onMouseUp);},te.prototype._onMouseEnter=function(re){var ne=this._getCursorPosition(re);this.setState({cursorVisible:!0,cursorPosition:ne}),this._onMouseMove(re);},te.prototype._onMouseLeave=function(){this.setState({cursorVisible:!1});},te.prototype._onMouseMove=function(re){var ne=this.context.editor,ie=ne.getOutputDimensions(),se=ne.zoom.get(),le=this._getCursorPosition(re);this.setState({cursorPosition:le});var de;if(!this._lastDrawPosition)de=!0;else{var pe=this.getSharedState('thickness'),ce=this._lastDrawPosition.clone().subtract(le).abs().len()/se;de=ce>=pe/10;}this._drawing&&de&&(this._currentPath.addControlPoint(le.clone().divide(ie)),this._lastDrawPosition=le.clone(),ne.render());},te.prototype._onMouseMoveOnCanvas=function(re){var ne=this._getCursorPosition(re);this.setState({cursorPosition:ne});},te.prototype._getCursorStyle=function(){var re=this.getSharedState('thickness'),ne=this.state.cursorPosition;return{left:ne.x,top:ne.y,width:re,height:re,marginLeft:-0.5*re,marginTop:-0.5*re};},te.prototype._updateContainerRect=function(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect();},te.prototype._getCursorPosition=function(re){var ne=Y.Utils.getEventPosition(re),ie=this._containerBoundingRect;return ne.subtract(ie.left,ie.top);},te.prototype._getContainerProps=function(){var re=ee.prototype._getContainerProps.call(this);return re.onMouseDown=re.onTouchStart=this._onMouseDown,re;},te.prototype._getInnerContainerProps=function(){var re=ee.prototype._getInnerContainerProps.call(this);return delete re.onClick,re.onMouseEnter=this._onMouseEnter,re.onMouseLeave=this._onMouseLeave,re.onMouseMove=this._onMouseMoveOnCanvas,re;},te.prototype._renderSpriteItems=function(){return null;},te.prototype._renderOverlayControls=function(){var re=this.state.cursorVisible?'is-visible':null;return Y.ReactBEM.createElement('div',{bem:'$b:selectiveBlurCanvasControls'},Y.ReactBEM.createElement('div',{bem:'e:cursor',className:re,style:this._getCursorStyle()}));},te;}(X.default);R.default=Q,Q.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(ne){return ne&&ne.__esModule?ne:{default:ne};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(7),X=L(J),Q=I(30),ee=L(Q),te=I(12),oe=L(te),re=function(ne){function ie(){var se;(0,W.default)(this,ie);for(var le=arguments.length,de=Array(le),pe=0;pe<le;pe++)de[pe]=arguments[pe];var ce=(0,H.default)(this,ne.call.apply(ne,[this].concat(de)));return ce._hasDoneButton=!1,ce._brushThickness=ce.getSharedState('thickness'),ce._bindAll('_onOperationUpdated','_onOperationRemoved','_onThicknessUpdated','_onBlurRadiusChange'),ce.state={thicknessControlsEnabled:!1},ce._events=(se={},(0,U.default)(se,Y.Constants.EVENTS.OPERATION_UPDATED,ce._onOperationUpdated),(0,U.default)(se,Y.Constants.EVENTS.OPERATION_REMOVED,ce._onOperationRemoved),se),ce;}return(0,Z.default)(ie,ne),ie.prototype.componentDidMount=function(){ne.prototype.componentDidMount.call(this);var le=this.context.editor;le.zoom.set('auto'),le.features.disable('zoom','drag');},ie.prototype._onOperationRemoved=function(le){if(le===this.getSharedState('operation')&&!this._backButtonClicked){var de=this.context.editor,pe=de.operations.getOrCreate('selective-blur'),ce=pe.getBrush();this.setSharedState({operation:pe,brush:ce,operationExistedBefore:!1,initialOptions:{}}),de.render();}},ie.prototype._onOperationUpdated=function(le){if(le===this.getSharedState('operation')){var de=this.context.editor;de.render(),this.forceUpdate();}},ie.prototype._onThicknessUpdated=function(le){this.setSharedState({thickness:le}),this._brushThickness=le;},ie.prototype._onBlurRadiusChange=function(le,de){var pe=2<arguments.length&&void 0!==arguments[2]&&arguments[2],ce=this.getSharedState('inputDimensions');this.getSharedState('operation').setBlurRadius(le/ce.min());var ue=this.context.editor;ue.render(),pe&&ue.history.add(this.getSharedState('operation'),{blurRadius:de/ce.min()},!0);},ie.prototype.renderOverlayControls=function(){var le=this.getSharedState('inputDimensions'),de=le.min(),pe=this.getSharedState('operation').getBlurRadius()*de;return Y.ReactBEM.createElement(oe.default,{minValue:0,maxValue:Math.min(180,Math.round(0.1*de)),value:pe,valueUnit:'px',label:this._t('controls.selectiveBlur.blurRadius'),onChange:this._onBlurRadiusChange});},ie.prototype.renderControls=function(){var le=this.context.editor,de=le.zoom.get(),pe=[],ce=le.getFinalDimensions(),me=Math.round(ce.clone().multiply(de).min()/2),fe=this._brushThickness;return pe.push(Y.ReactBEM.createElement('div',{bem:'e:cell m:slider'},Y.ReactBEM.createElement(ee.default,{style:'large',minValue:1,maxValue:me,valueUnit:'px',middleDot:!1,label:this._t('controls.brush.thickness'),onChange:this._onThicknessUpdated,value:fe}))),pe;},ie;}(X.default);R.default=re,re.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(40),Y=L(Z),J=function(X){function Q(){return(0,U.default)(this,Q),(0,W.default)(this,X.apply(this,arguments));}return(0,H.default)(Q,X),Q.prototype.componentDidMount=function(){X.prototype.componentDidMount.call(this);var te=this.props.sprite.getCanvas();this._appendCanvas(te);},Q.prototype.componentWillReceiveProps=function(te){if(te.sprite!==this.props.sprite){var oe=this.props.sprite.getCanvas();oe.parentNode.removeChild(oe);var re=te.sprite.getCanvas();this._appendCanvas(re);}},Q.prototype._appendCanvas=function(te){var oe=this.context.editor,re=oe.getOutputDimensions();te.style.width=re.x+'px',te.style.height=re.y+'px',this.refs.brush.appendChild(te);},Q.prototype._isSelected=function(){return this.getSharedState('brush')===this.props.sprite;},Q.prototype.renderWithBEM=function(){var te=this._isSelected()?'is-selected':null;return G.ReactBEM.createElement('bem',{specifier:'b:spritesCanvasControls'},G.ReactBEM.createElement('div',{bem:'$e:item e:container m:full',ref:'container'},G.ReactBEM.createElement('div',{bem:'$e:brush',className:te,ref:'brush'})));},Q;}(Y.default);R.default=J,J.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(11),Y=L(Z),J=I(40),X=L(J),Q=function(ee){function te(){(0,U.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,W.default)(this,ee.call.apply(ee,[this].concat(re)));return ie._bindAll('_onRotateKnobDragStart','_onRotateKnobDrag','_onRotateKnobDragStop'),ie._id=G.SDKUtils.getUUID(),ie;}return(0,H.default)(te,ee),te.prototype._onKnobDragStart=function(re){var se=this.props.sprite;'bottom'===re?this._initialPosition=this._getBottomDragKnobPosition():'top'===re?this._initialPosition=this._getTopDragKnobPosition():void 0,this._initialDimensions=se.getDimensions().clone(),this.props.onDragStart&&this.props.onDragStart();},te.prototype._onKnobDrag=function(re,ne){var se=this.props.sprite,le=this._getAbsoluteSpritePosition(),de=this._initialPosition.clone().add(ne),pe=de.clone().subtract(le),ce=this._initialPosition.clone().subtract(le);if(this.props.options.fixedRatio){var ue=this._getStickerDimensions().divide(2).abs(),me=this._initialPosition.clone().subtract(le),fe;'bottom'===re?fe=Math.atan2(pe.y,pe.x)-Math.atan2(ue.y,ue.x):'top'===re?fe=Math.atan2(pe.y,pe.x)-Math.atan2(-ue.y,-ue.x):void 0;var ge=this._initialDimensions.clone().multiply(pe.len()/me.len()),he=this.props.options,ye=he.snapRotation,be=he.snapRotationTolerance,Ee=Math.round(180*fe/Math.PI),Se=Math.round(Ee/ye)*ye;Math.abs(Ee-Se)<be&&(fe=Se*Math.PI/180),se.set({dimensions:ge,rotation:fe});}else{var Me=this.context.editor.zoom.get(),Ce=se.getRotation(),Re=Math.cos(-1*Ce),Be=Math.sin(-1*Ce),xe=new G.Vector2(pe.x*Re-pe.y*Be,pe.x*Be+pe.y*Re),ke=new G.Vector2(ce.x*Re-ce.y*Be,ce.x*Be+ce.y*Re),De;'bottom'===re?De=xe.clone().subtract(ke):'top'===re?De=ke.clone().subtract(xe):void 0;var Pe=this._initialDimensions.clone().add(De.clone().divide(Me).multiply(2));se.set({dimensions:Pe});}},te.prototype._onKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop();},te.prototype._onRotateKnobDragStart=function(){this._initialPosition=this._getRotateKnobPosition(),this.props.onDragStart&&this.props.onDragStart();},te.prototype._onRotateKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop();},te.prototype._onRotateKnobDrag=function(re){var ie=this.props.sprite,se=this._getAbsoluteSpritePosition(),le=this._initialPosition.clone().add(re),de=this._getStickerDimensions().divide(2),pe=le.clone().subtract(se),ce;ce=Math.atan2(pe.y,pe.x)-Math.atan2(-de.y,de.x),ie.set({rotation:ce});},te.prototype._getBottomDragKnobStyle=function(){var re=this._getBottomDragKnobPosition();return{left:re.x,top:re.y};},te.prototype._getTopDragKnobStyle=function(){var re=this._getTopDragKnobPosition();return{left:re.x,top:re.y};},te.prototype._getRotateKnobStyle=function(){var re=this._getRotateKnobPosition();return{left:re.x,top:re.y};},te.prototype._getStickerStyle=function(){var re=this.props.sprite,ne=this._getStickerDimensions().abs(),ie=this._getAbsoluteSpritePosition().subtract(ne.clone().divide(2)),se=180*re.getRotation()/Math.PI,le='rotate('+se.toFixed(2)+'deg)',de=re.getDimensions(),pe=re.getFlipVertically();0>de.y&&(pe=!pe),pe&&(le+=' scaleY(-1)');var ce=re.getFlipHorizontally();return 0>de.x&&(ce=!ce),ce&&(le+=' scaleX(-1)'),{top:ie.y,left:ie.x,width:ne.x,height:ne.y,WebkitTransform:le,msTransform:le,MozTransform:le,OTransform:le};},te.prototype._getStickerDimensions=function(){var re=this.props.sprite,ne=this.context.editor;return re.getDimensions().clone().multiply(ne.zoom.get());},te.prototype._getRotateKnobPosition=function(){var re=this.props.sprite,ne=this._getAbsoluteSpritePosition(),ie=re.getRotation(),se=Math.sin(ie||0),le=Math.cos(ie||0),de=this._getStickerDimensions().divide(2);return ne.clone().add(de.x*le+de.y*se,de.x*se-de.y*le);},te.prototype._getBottomDragKnobPosition=function(){var re=this.props.sprite,ne=this._getAbsoluteSpritePosition(),ie=re.getRotation(),se=Math.sin(ie||0),le=Math.cos(ie||0),de=this._getStickerDimensions().divide(2);return ne.clone().add(de.x*le-de.y*se,de.x*se+de.y*le);},te.prototype._getTopDragKnobPosition=function(){var re=this.props.sprite,ne=this._getAbsoluteSpritePosition(),ie=re.getRotation(),se=Math.sin(ie||0),le=Math.cos(ie||0),de=this._getStickerDimensions(re).divide(2);return ne.clone().subtract(de.x*le-de.y*se,de.x*se+de.y*le);},te.prototype._renderKnobs=function(){var re=[];return this.props.selected&&(re=[G.ReactBEM.createElement(Y.default,{onStart:this._onKnobDragStart.bind(this,'bottom'),onStop:this._onKnobDragStop.bind(this,'bottom'),onDrag:this._onKnobDrag.bind(this,'bottom')},G.ReactBEM.createElement('div',{bem:'e:knob $b:knob',style:this._getBottomDragKnobStyle()},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/resize-diagonal-down.png',!0)}))),G.ReactBEM.createElement(Y.default,{onStart:this._onKnobDragStart.bind(this,'top'),onStop:this._onKnobDragStop.bind(this,'top'),onDrag:this._onKnobDrag.bind(this,'top')},G.ReactBEM.createElement('div',{bem:'e:knob $b:knob',style:this._getTopDragKnobStyle()},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/resize-diagonal-down.png',!0)})))],!this.props.options.fixedRatio&&re.push(G.ReactBEM.createElement(Y.default,{onStart:this._onRotateKnobDragStart,onStop:this._onRotateKnobDragStop,onDrag:this._onRotateKnobDrag},G.ReactBEM.createElement('div',{bem:'e:knob $b:knob',style:this._getRotateKnobStyle()},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/rotate.png',!0)}))))),re;},te.prototype._renderSVGFilter=function(){var re=this.props.sprite,ne=re.getAdjustments(),ie=ne.getBrightness(),se=ne.getSaturation(),le=ne.getContrast(),de='<filter id=\'pesdk-sticker-'+this._id+'-filter\'>\n        <feComponentTransfer>\n          <feFuncR type=\'linear\' intercept=\''+ie+'\' />\n          <feFuncG type=\'linear\' intercept=\''+ie+'\' />\n          <feFuncB type=\'linear\' intercept=\''+ie+'\' />\n        </feComponentTransfer>\n        <feColorMatrix type=\'saturate\' values=\''+se+'\' />\n        <feComponentTransfer>\n          <feFuncR type=\'linear\' slope=\''+le+'\' intercept=\''+(-(0.5*le)+0.5)+'\' />\n          <feFuncG type=\'linear\' slope=\''+le+'\' intercept=\''+(-(0.5*le)+0.5)+'\' />\n          <feFuncB type=\'linear\' slope=\''+le+'\' intercept=\''+(-(0.5*le)+0.5)+'\' />\n        </feComponentTransfer>\n      </filter>';return G.ReactBEM.createElement('svg',{width:'0',height:'0',"color-interpolation-filters":'sRGB',is:'svg'},G.ReactBEM.createElement('defs',{key:Math.random(),dangerouslySetInnerHTML:{__html:de}}));},te.prototype._renderSelectedOverlay=function(){var re=[];this.props.selected&&re.push('is-selected'),re=re.join(' ');var ne=this._getStickerStyle();return G.ReactBEM.createElement('bem',{specifier:'e:text'},G.ReactBEM.createElement(Y.default,{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected},G.ReactBEM.createElement('div',{bem:'e:selectedOverlay',onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd,style:ne,className:re})));},te.prototype._renderItem=function(){var re=this.props.sprite,ne=this._getStickerStyle(),ie=window.location.href.replace(window.location.hash,''),se={filter:'url("'+ie+'#pesdk-sticker-'+this._id+'-filter")'},le={width:ne.width,height:ne.height};return G.ReactBEM.createElement('bem',{specifier:'e:sticker'},G.ReactBEM.createElement('div',{bem:'e:container',style:ne},G.ReactBEM.createElement('svg',{width:parseInt(ne.width),height:parseInt(ne.height),"color-interpolation-filters":'sRGB',is:'svg',style:le,preserveAspectRatio:'none'},G.ReactBEM.createElement('image',{xlinkHref:re.getImage().src,width:ne.width,height:ne.height,style:se,preserveAspectRatio:'none'}))));},te.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('bem',{specifier:'b:spritesCanvasControls'},G.ReactBEM.createElement('div',{bem:'$e:item e:container'},this._renderSVGFilter(),this._renderItem(),this._renderSelectedOverlay(),this._renderKnobs()));},te;}(X.default);R.default=Q,Q.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(11),Y=L(Z),J=I(40),X=L(J),Q=function(ee){function te(){(0,U.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,W.default)(this,ee.call.apply(ee,[this].concat(re)));return ie._bindAll('_onTextChange','_onItemDoubleClick','_onItemTouchStart','_onItemTouchEnd','_onResizeKnobDragStart','_onResizeKnobDrag','_onResizeKnobDragStop','_onRotationKnobDragStart','_onRotationKnobDrag','_onRotationKnobDragStop'),ie.state={editMode:!1,text:ie.props.sprite.getText()},ie;}return(0,H.default)(te,ee),te.prototype.componentWillReceiveProps=function(re){ee.prototype.componentWillReceiveProps.call(this,re),re.sprite!==this.props.sprite&&(this.refs.textarea.blur(),this.setState({text:re.sprite.getText(),editMode:!1}));},te.prototype._onTextChange=function(re){var ne=this.props.sprite;ne.setText(re.target.value),this.setState({text:re.target.value});},te.prototype._onItemDoubleClick=function(){this.enterEditMode();},te.prototype.enterEditMode=function(){var re=this,ne=this.props.sprite;ne._edited||(ne.setText(''),this.refs.textarea.value='',ne._edited=!0,this.forceUpdate()),this.setState({editMode:!0},function(){re.refs.textarea.focus(),re.refs.textarea.select();});},te.prototype._onItemTouchStart=function(re){this._initialTouchPosition=G.Utils.getEventPosition(re),this._tapStartAt=(0,G.now)();},te.prototype._onItemTouchEnd=function(){100>=(0,G.now)()-this._tapStartAt&&('undefined'!=typeof this._lastTapAt&&300>=(0,G.now)()-this._lastTapAt&&this._onItemDoubleClick(),this._lastTapAt=(0,G.now)());},te.prototype._onRotationKnobDragStart=function(){this._dragging=!0,this._initialPosition=this._getRotationKnobPosition(),this.props.onDragStart&&this.props.onDragStart();},te.prototype._onRotationKnobDrag=function(re){var ie=this.props.sprite,se=this.context.editor,le=this._getAbsoluteSpritePosition(),de=this._initialPosition.clone().add(re),pe=de.clone().subtract(le),ce=ie.getBoundingBox(se.getSDK(),se.getOutputDimensions()),ue=Math.atan2(pe.y,pe.x)-Math.atan2(ce.y,ce.x/2);ie.setRotation(ue);},te.prototype._onRotationKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop();},te.prototype._onResizeKnobDragStart=function(){this._initialPosition=this._getResizeKnobPosition(),this.props.onDragStart&&this.props.onDragStart();},te.prototype._onResizeKnobDrag=function(re){var ie=this.props.sprite,se=ie.getRotation(),le=this.context.editor,de=le.getOutputDimensions(),pe=Math.cos(se),ce=Math.sin(se),ue=this._initialPosition.clone().add(re),me=this._getAbsoluteSpritePosition(),fe=ue.clone().subtract(me),ge=Math.max(2*((fe.x*pe+fe.y*ce)/de.x),0.1);ie.setMaxWidth(ge);},te.prototype._onResizeKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop();},te.prototype._getRotationKnobStyle=function(){var re=this._getRotationKnobPosition();return{left:re.x,top:re.y};},te.prototype._getResizeKnobStyle=function(){var re=this._getResizeKnobPosition();return{left:re.x,top:re.y};},te.prototype._getTextStyle=function(){var re=this.context.editor,ne=this.props.sprite,ie=re.getSDK(),se=re.getOutputDimensions(),le=ne.getDOMStyle(ie,se),de=this._getAbsoluteSpritePosition(),pe=ne.getBoundingBox(ie,se);return le.height=Math.min(pe.y,se.y-de.y),le;},te.prototype._getItemContainerStyle=function(){var re=this.context.editor,ne=re.getOutputDimensions(),ie=this.props.sprite,se=ie.getPosition().clone().multiply(ne),le=180*ie.getRotation()/Math.PI,de='rotateZ('+le.toFixed(2)+'deg)',pe='50% 0',ce=ie.getMaxWidth()*ne.x;return{width:ce,left:se.x,top:se.y,marginLeft:-0.5*ce,transform:de,MozTransform:de,msTransform:de,WebkitTransform:de,transformOrigin:pe,MozTransformOrigin:pe,msTransformOrigin:pe,WebkitTransformOrigin:pe};},te.prototype._getRotationKnobPosition=function(){var re=this.props.sprite,ne=this.context.editor,ie=Math.sin(re.getRotation()),se=Math.cos(re.getRotation()),le=ne.getOutputDimensions(),de=re.getBoundingBox(ne.getSDK(),le),pe=de.clone().divide(2),ce=re.getPosition().clone().multiply(le).add(pe.x*se-de.y*ie,pe.x*ie+de.y*se);return ce;},te.prototype._getResizeKnobPosition=function(){var re=this.props.sprite,ne=this.context.editor,ie=Math.sin(re.getRotation()),se=Math.cos(re.getRotation()),le=ne.getOutputDimensions(),de=re.getBoundingBox(ne.getSDK(),le),pe=de.clone().divide(2),ce=re.getPosition().clone().multiply(le).add(pe.x*se,pe.x*ie);return ce;},te.prototype._renderKnobs=function(){var re=[];return this.props.selected&&!this.state.editMode&&(re=[G.ReactBEM.createElement(Y.default,{onStart:this._onRotationKnobDragStart,onDrag:this._onRotationKnobDrag,onStop:this._onRotationKnobDragStop},G.ReactBEM.createElement('div',{bem:'e:knob m:rotate $b:knob',style:this._getRotationKnobStyle()},G.ReactBEM.createElement('img',{bem:'e:icon m:larger',src:this._getAssetPath('controls/knobs/rotate.png',!0)}))),G.ReactBEM.createElement(Y.default,{onStart:this._onResizeKnobDragStart,onDrag:this._onResizeKnobDrag,onStop:this._onResizeKnobDragStop},G.ReactBEM.createElement('div',{bem:'e:knob m:resize $b:knob',style:this._getResizeKnobStyle()},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/resize-diagonal-up.png',!0)})))]),re;},te.prototype._renderItem=function(){var re=this._getItemContainerStyle(),ne=G.ReactBEM.createElement('textarea',{bem:'e:content',ref:'textarea',style:this._getTextStyle(),value:this.state.text,disabled:!this.state.editMode,onChange:this._onTextChange});return G.ReactBEM.createElement('bem',{specifier:'e:text'},G.ReactBEM.createElement('div',{bem:'e:container',style:re},ne));},te.prototype._renderSelectedOverlay=function(){var re=this._getTextStyle(),ne=[];this.props.selected&&ne.push('is-selected'),this.state.editMode&&ne.push('is-disabled'),ne=ne.join(' ');var ie=this._getItemContainerStyle();return ie.height=re.height,G.ReactBEM.createElement('bem',{specifier:'e:text'},G.ReactBEM.createElement(Y.default,{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected||this.props.selected&&this.state.editMode},G.ReactBEM.createElement('div',{bem:'e:selectedOverlay',onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd,style:ie,className:ne})));},te.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('bem',{specifier:'b:spritesCanvasControls'},G.ReactBEM.createElement('div',{bem:'$e:item e:container'},this._renderItem(),this._renderSelectedOverlay(),this._renderKnobs()));},te;}(X.default);R.default=Q,Q.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(re){return re&&re.__esModule?re:{default:re};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(8),Y=L(Z),J=I(141),X=L(J),Q=I(140),ee=L(Q),te=G.SDK.Operations.SpriteOperation.Sticker,oe=function(re){function ne(){return(0,U.default)(this,ne),(0,W.default)(this,re.apply(this,arguments));}return(0,H.default)(ne,re),ne.onExit=function(){var se=this.context.editor,le=this.getSharedState('operation');this.getSharedState('skipHistory')||se.history.add(le,this.getSharedState('initialOptions'),this.getSharedState('operationExistedBefore')),le.setEnabled(!0),se.zoom.restore(),se.features.enable('zoom','drag'),se.render();},ne.onEnter=function(){var le=this.context.editor,de=le.operations.exists('sprite'),pe=le.operations.getOrCreate('sprite'),ce=pe.getSprites(),ue=pe.getSpritesOfType(te),me=pe.serializeOptions();pe.setEnabled(!1),le.zoom.save(),le.zoom.set('auto'),le.features.disable('zoom','drag'),this.setSharedState({operationExistedBefore:de,operation:pe,sprites:ce,stickers:ue,initialOptions:me});},ne.clickAtPosition=function(se,le){if(!le.operations.exists('sprite'))return!1;var de=le.operations.getOrCreate('sprite'),pe=de.getSpritesAtPosition(se,le.getOutputTextureDimensions()).filter(function(ce){return ce instanceof te;});return!!pe.length&&{selectedSprite:pe[0]};},ne.isAvailable=function(se){return se.isToolEnabled('sticker');},ne;}(Y.default);oe.controlsComponent=X.default,oe.canvasControlsComponent=ee.default,oe.identifier='sticker',oe.iconPath='controls/overview/sticker.png',oe.languageKey='controls.overview.sticker',oe.defaultOptions={categories:null,replaceCategories:!1,selectableStickers:null,tooltips:!1,hideCategories:!1,fixedRatio:!0,snapRotation:90,snapRotationTolerance:5,smoothDownscaling:!1},R.default=oe;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(31),Y=L(Z),J=I(142),X=L(J),Q=function(ee){function te(){return(0,U.default)(this,te),(0,W.default)(this,ee.apply(this,arguments));}return(0,H.default)(te,ee),te.prototype._renderOverlayControls=function(){return this.getSharedState('selectedSprite')?G.ReactBEM.createElement(X.default,{onFlip:this._onSpriteFlip,onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove}):void 0;},te;}(Y.default);R.default=Q,Q.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(me){return me&&me.__esModule?me:{default:me};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(24),U=L(V),N=I(4),W=L(N),$=I(0),H=L($),G=I(3),Z=L(G),Y=I(2),J=L(Y),X=I(1),Q=I(7),ee=L(Q),te=I(5),oe=L(te),re=I(63),ne=L(re),ie=I(6),se=L(ie),le=I(71),de=L(le),pe=I(143),ce=L(pe),ue=function(me){function fe(){(0,H.default)(this,fe);for(var ge=arguments.length,he=Array(ge),ye=0;ye<ge;ye++)he[ye]=arguments[ye];var be=(0,Z.default)(this,me.call.apply(me,[this].concat(he)));return be._bindAll('_onStickerMouseLeave','_renderTooltipCanvas','_onCategoryChange','_onBeforeHistoryUndo'),be._events=(0,W.default)({},X.Constants.EVENTS.HISTORY_BEFORE_UNDO,be._onBeforeHistoryUndo),be._operation=be.getSharedState('operation'),be._sprites=be.getSharedState('sprites'),be._stickers=be.getSharedState('stickers'),be._initStickerManager(),be.state={category:be._stickerManager.getCategory('all')},be;}return(0,J.default)(fe,me),fe.prototype._onBeforeHistoryUndo=function(he){var ye=he.operation,be=he.options;if(ye===this.getSharedState('operation')){var Ee=be.sprites;-1===Ee.indexOf(this.getSharedState('selectedSprite'))&&(this.setSharedState({skipHistory:!0},!1),this.props.onSwitchControls('home'));}},fe.prototype._onCategoryChange=function(he){var ye=this;this.setState({category:he},function(){ye.refs.scrollbar.update();});},fe.prototype.componentDidMount=function(){me.prototype.componentDidMount.call(this),this.props.options.stickersJSONPath&&this._loadExternalStickers();var he=this.context.editor;he.zoom.set('auto',function(){he.features.disable('zoom','drag');});},fe.prototype._loadExternalStickers=function(){var he=this,ye=null,be=setTimeout(function(){ye=se.default.instance.displayLoading(he._t('loading.loading'));},100),Ee=function(){be&&(clearTimeout(be),be=null),ye&&ye.close();};this._stickerManager.loadExternal(this.props.options.stickersJSONPath).then(function(){Ee(),he.forceUpdate(function(){he.refs.scrollbar.update();});}).catch(function(Se){Ee(),console.error(Se);var ve=se.default.instance.displayError(he._t('errors.loadingStickersFailed.title'),Se.message);ve.on('close',function(){he.props.onBack();});});},fe.prototype._renderTooltipCanvas=function(){var he=this,ye=this.state.hoveredSticker,be=new window.Image();be.addEventListener('load',function(){if(he.state.tooltipVisible&&he.state.hoveredSticker===ye){var Se=he.refs.tooltipCanvas;Se.width=Se.offsetWidth,Se.height=Se.offsetHeight;var ve=Se.getContext('2d'),Me=Math.min(Se.width/be.width,Se.height/be.height),Ce=new X.Vector2(be.width,be.height).multiply(Me),Re=new X.Vector2(Se.width,Se.height).divide(2).subtract(Ce.clone().divide(2));ve.drawImage(be,0,0,be.width,be.height,Re.x,Re.y,Ce.x,Ce.y);}});var Ee=this._getAssetPath((ye.images.mediaMedium||ye.images.mediaBase).uri);be.crossOrigin='Anonymous',be.src=Ee;},fe.prototype._initStickerManager=function(){var he=X.SDKUtils.defaults(this.props.options,{allCategoryLabel:this._t('controls.sticker.categories.all')});this._stickerManager=new de.default(he);},fe.prototype._onBackClick=function(){this._backButtonClicked=!0,this.props.onSwitchControls('home');},fe.prototype._onStickerClick=function(he){var ye=this,be=this._getAssetPath(he.images.mediaBase.uri),Ee=new window.Image(),ve=setTimeout(function(){Se=se.default.instance.displayLoading(ye._t('loading.loading'));},100),Se;Ee.addEventListener('load',function(){Se&&Se.close(),ve&&(clearTimeout(ve),ve=null);var Me=ye.context.editor,Ce=ye._calculateInitialStickerScale(he,Ee),Re=ye._operation.createSticker({name:he.name,image:Ee,position:new X.Vector2(0.5,0.5),dimensions:new X.Vector2(Ee.width,Ee.height).multiply(Ce),rotation:0,smoothDownscaling:ye.props.options.smoothDownscaling});ye._operation.addSprite(Re),ye._stickers.push(Re),Me.render(function(){ye.setSharedState({selectedSprite:Re,sprites:ye._sprites,stickers:ye._stickers});});}),Ee.addEventListener('error',function(){Se&&Se.close(),ve&&(clearTimeout(ve),ve=null),se.default.instance.displayError(ye._t('errors.imageLoadFail.title'),ye._t('errors.imageLoadFail.text',{path:Ee.src}));}),Ee.crossOrigin='Anonymous',Ee.src=be;},fe.prototype._calculateInitialStickerScale=function(he,ye){var be=this.getSharedState('operation'),Ee=be.getInputDimensions().multiply(0.9),Se=new X.Vector2(ye.width,ye.height),ve=Se.clone().subtract(Ee);return 0>=ve.x&&0>=ve.y?1:ve.x>ve.y?Ee.x/Se.x:Ee.y/Se.y;},fe.prototype._onStickerMouseEnter=function(he,ye){var be=this;this.setState({tooltipVisible:!0,hoveredSticker:he,hoveredStickerElement:ye.currentTarget},function(){be._renderTooltipCanvas(),be._updateTooltipPosition();});},fe.prototype._updateTooltipPosition=function(){var he=this.state.hoveredStickerElement,ye=this.refs.root,be=he.getBoundingClientRect(),Ee=ye.getBoundingClientRect();this.setState({tooltipPosition:be.left-Ee.left});},fe.prototype._onStickerMouseLeave=function(){this.setState({tooltipVisible:!1,hoveredSticker:null});},fe.prototype._renderListItems=function(){var he=this,ye=this._stickerManager.getStickersForCategory(this.state.category.name);return ye.map(function(be){var Se=he.props.options,ve=Se.tooltips?{onMouseEnter:he._onStickerMouseEnter.bind(he,be),onMouseLeave:he._onStickerMouseLeave}:null;return X.ReactBEM.createElement(ce.default,(0,U.default)({sticker:be,onClick:he._onStickerClick.bind(he,be)},ve));});},fe.prototype._renderTooltip=function(){var he=this.props.options.tooltips&&this.state.tooltipVisible,ye={left:this.state.tooltipPosition};return he?X.ReactBEM.createElement('div',{bem:'e:cell m:empty'},X.ReactBEM.createElement('div',{bem:'$b:stickersControls $e:tooltip',style:ye},X.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'tooltipCanvas'}))):null;},fe.prototype._renderCategoryDropdown=function(){var he=this,ye=this._stickerManager.getCategories(),be=!this.props.options.hideCategories&&1<ye.length;if(!be)return null;var Ee=ye.map(function(ve){return{name:ve.name,label:ve.label,icon:he._getAssetPath('controls/stickers/categories/'+ve.name+'.png',!0)};}),Se={name:this.state.category.name,label:this.state.category.label,icon:this._getAssetPath('controls/stickers/categories/'+this.state.category.name+'.png',!0)};return X.ReactBEM.createElement('div',{bem:'e:cell m:categoryDropdown'},X.ReactBEM.createElement(ne.default,{items:Ee,selectedItem:Se,onChange:this._onCategoryChange}));},fe.prototype.renderControls=function(){var he=this._renderListItems(),ye=this._renderTooltip(),be=this._renderCategoryDropdown();return[ye,be,X.ReactBEM.createElement('div',{bem:'e:cell m:list'},X.ReactBEM.createElement(oe.default,{ref:'scrollbar'},X.ReactBEM.createElement('ul',{bem:'$e:list'},he)))];},fe;}(ee.default);R.default=ue,ue.contextTypes=ee.default.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype._onFlipClick=function(Q,ee){ee.preventDefault(),ee.stopPropagation(),this.props.onFlip&&this.props.onFlip(Q);},J.prototype._onTakeToFrontClick=function(Q){Q.preventDefault(),Q.stopPropagation(),this.props.onTakeToFront&&this.props.onTakeToFront();},J.prototype._onRemoveClick=function(Q){Q.preventDefault(),Q.stopPropagation(),this.props.onRemove&&this.props.onRemove();},J.prototype._renderItems=function(){return[G.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onFlipClick.bind(this,'h')},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/flip-h.png',!0)})),G.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onFlipClick.bind(this,'v')},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/flip-v.png',!0)})),G.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onTakeToFrontClick.bind(this)},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/take-to-front.png',!0)})),G.ReactBEM.createElement('div',{bem:'$e:separator'}),G.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onRemoveClick.bind(this)},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/remove.png',!0)}))];},J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',{bem:'$b:spritesControlsOverlay'},this._renderItems());},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){(0,U.default)(this,J);for(var X=arguments.length,Q=Array(X),ee=0;ee<X;ee++)Q[ee]=arguments[ee];var te=(0,W.default)(this,Y.call.apply(Y,[this].concat(Q)));return te.state={sticker:te.props.sticker},te;}return(0,H.default)(J,Y),J.prototype.componentDidMount=function(){this._renderSticker();},J.prototype.componentWillReceiveProps=function(Q){var ee=this;this.props.sticker!==Q.sticker&&this.setState({sticker:Q.sticker},function(){ee._renderSticker();});},J.prototype._renderSticker=function(){var Q=this.context.editor,ee=Q.getSDK(),te=this.props.sticker,oe=this._getAssetPath(te.images.mediaThumb.uri),re=this.refs['canvas-'+te.name],ne=ee.getPixelRatio();re.width=re.offsetWidth*ne,re.height=re.offsetHeight*ne,re.style.width=re.offsetWidth+'px',re.style.height=re.offsetHeight+'px';var ie=re.getContext('2d'),se=new window.Image();se.addEventListener('load',function(){var le=Math.min(re.width/se.width,re.height/se.height),de=new G.Vector2(se.width,se.height).multiply(le),pe=new G.Vector2(re.width,re.height).divide(2).subtract(de.clone().divide(2));ie.drawImage(se,0,0,se.width,se.height,pe.x,pe.y,de.x,de.y);}),se.crossOrigin='Anonymous',se.src=oe;},J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('li',{bem:'$b:stickersControls $e:item',key:this.props.sticker.name,onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},G.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas-'+this.props.sticker.name}));},J;}(G.BaseComponent);R.default=Z;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(5),Y=L(Z),J=I(65),X=L(J),Q=function(ee){function te(){return(0,U.default)(this,te),(0,W.default)(this,ee.apply(this,arguments));}return(0,H.default)(te,ee),te.prototype._onListItemClick=function(re){this.props.onChange&&this.props.onChange(re);},te.prototype._renderListItems=function(){var re=this,ne=this.props.fonts;return ne.map(function(ie,se){var le=re.props,de=le.fontFamily,pe=le.fontWeight,ce=le.fontStyle,ue=ie.optionsEqual({fontFamily:de,fontWeight:pe,fontStyle:ce}),me=ue?'is-active':null;return G.ReactBEM.createElement('li',{bem:'e:item',key:se,className:me,onClick:re._onListItemClick.bind(re,ie)},G.ReactBEM.createElement(X.default,{fontFamily:ie.getFontFamily(),fontWeight:ie.getFontWeight(),fontStyle:ie.getFontStyle()}),G.ReactBEM.createElement('div',{bem:'e:label'},ie.getFontFamily()));});},te.prototype.renderWithBEM=function(){var re=this._renderListItems();return G.ReactBEM.createElement('div',{bem:'$b:controls e:overlay m:dark m:large'},G.ReactBEM.createElement(Y.default,null,G.ReactBEM.createElement('ul',{bem:'$b:fontFamily e:list'},re)));},te;}(G.BaseComponent);R.default=Q,Q.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(ie){return ie&&ie.__esModule?ie:{default:ie};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(8),Y=L(Z),J=I(146),X=L(J),Q=I(147),ee=L(Q),te=I(189),oe=L(te),re=G.SDK.Operations.SpriteOperation.Text,ne=function(ie){function se(){return(0,U.default)(this,se),(0,W.default)(this,ie.apply(this,arguments));}return(0,H.default)(se,ie),se.onExit=function(){var de=this.context.editor,pe=this.getSharedState('operation');this.getSharedState('skipHistory')||de.history.add(pe,this.getSharedState('initialOptions'),this.getSharedState('operationExistedBefore')),pe.setEnabled(!0),de.zoom.restore(),de.features.enable('zoom','drag'),de.render();},se.onEnter=function(de,pe){var ce=this.context.editor,ue=ce.operations.exists('sprite'),me=ce.operations.getOrCreate('sprite'),fe=me.getSprites(),ge=me.serializeOptions(),he=new oe.default(pe),ye=he.getDefaultFont();this.setSharedState({operationExistedBefore:ue,operation:me,sprites:fe,initialOptions:ge,fontManager:he,defaultFont:ye,fonts:he.getFonts()}),ce.zoom.save(),me.setEnabled(!1),ce.render();},se.clickAtPosition=function(de,pe){if(!pe.operations.exists('sprite'))return!1;var ce=pe.operations.getOrCreate('sprite'),ue=ce.getSpritesAtPosition(de,pe.getOutputTextureDimensions()).filter(function(me){return me instanceof re;});return!!ue.length&&{selectedSprite:ue[0]};},se.isAvailable=function(de){return de.isToolEnabled('text');},se.getPreloadAssets=function(){return['controls/text/align_left.png','controls/text/align_right.png','controls/text/align_center.png','controls/text/minus.png','controls/text/plus.png'];},se;}(Y.default);ne.controlsComponent=ee.default,ne.canvasControlsComponent=X.default,ne.identifier='text',ne.iconPath='controls/overview/text.png',ne.languageKey='controls.overview.text',ne.defaultOptions={additionalFonts:[],replaceFonts:!1,selectableFonts:null,defaultText:null},R.default=ne;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(31),Y=L(Z),J=I(148),X=L(J),Q=function(ee){function te(){(0,U.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,W.default)(this,ee.call.apply(ee,[this].concat(re)));return ie._bindAll('_onTextEdit'),ie;}return(0,H.default)(te,ee),te.prototype._onItemBlur=function(){var re=this.getSharedState('selectedSprite');re&&''===re.getText()&&(re.setText(G.Constants.DEFAULTS.TEXT),re._edited=!1);},te.prototype._onSpriteRemove=function(){ee.prototype._onSpriteRemove.call(this),this.props.onSwitchControls('home');},te.prototype._onTextEdit=function(){var re=this.getSharedState('selectedSprite');this.refs['sprite-'+re.getId()].enterEditMode();},te.prototype._renderOverlayControls=function(){return this.getSharedState('selectedSprite')?G.ReactBEM.createElement(X.default,{onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove,onEdit:this._onTextEdit}):void 0;},te;}(Y.default);R.default=Q,Q.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(fe){return fe&&fe.__esModule?fe:{default:fe};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(7),X=L(J),Q=I(5),ee=L(Q),te=I(39),oe=L(te),re=I(12),ne=L(re),ie=I(65),se=L(ie),le=I(144),de=L(le),pe=I(6),ce=L(pe),ue=['left','center','right'],me=function(fe){function ge(){(0,W.default)(this,ge);for(var he=arguments.length,ye=Array(he),be=0;be<he;be++)ye[be]=arguments[be];var Ee=(0,H.default)(this,fe.call.apply(fe,[this].concat(ye)));Ee._bindAll('_onFontSizeChange','_onFontChange','_onAlignmentClick','_onTakeToFrontClick','_onForegroundColorChange','_onBackgroundColorChange','_onBeforeHistoryUndo'),Ee._events=(0,U.default)({},Y.Constants.EVENTS.HISTORY_BEFORE_UNDO,Ee._onBeforeHistoryUndo),Ee._operation=Ee.getSharedState('operation'),Ee._fontLoader=Ee.context.ui.getFontLoader(),Ee._fontLoader.setFonts(Ee.getSharedState('fonts')),Ee.state={mode:null,loading:!0};var Se=Ee.context.editor;return Se.render(),Ee._fonts=Ee.getSharedState('fonts'),Ee;}return(0,Z.default)(ge,fe),ge.prototype.componentDidMount=function(){var ye=this;fe.prototype.componentDidMount.call(this);var be=this.context.editor;be.zoom.set('auto',function(){be.features.disable('zoom','drag');});var Ee=function(){ye._createText(),ye.setState({loading:!1});};this._fontLoader.needsToLoad()?this._loadFonts().then(Ee.bind(this)):Ee();},ge.prototype._loadFonts=function(){var ye=this,be=ce.default.instance.displayLoading(this._t('loading.loading'));return this._fontLoader.load().then(function(){be.close();}).catch(function(){be.close(),ce.default.instance.displayWarning(ye._t('errors.loadingFontsFailed.title'),ye._t('errors.loadingFontsFailed.text'));});},ge.prototype._createText=function(){var ye=this.context.editor,be=this.getSharedState('selectedSprite'),Ee=this.getSharedState('operation'),Se=this.getSharedState('defaultFont'),ve=this.props.options,Me=ye.getOutputDimensions();if(!be){var Ce=ye.getSDK(),Re=Ce.getRenderer(),Be=Re.getMaxTextureSize(),xe=Ee.createText({text:ve.defaultText||Y.Constants.DEFAULTS.TEXT,position:new Y.Vector2(0.5,0.5),maxWidth:0.5,maxHeight:Be?Be/Me.y:3,fontSize:0.08,fontFamily:Se.getFontFamily(),fontWeight:Se.getFontWeight(),fontStyle:Se.getFontStyle(),alignment:'center'});Ee.addSprite(xe),this.setSharedState({selectedSprite:xe});}},ge.prototype._onBeforeHistoryUndo=function(ye){var be=ye.operation,Ee=ye.options;if(be===this.getSharedState('operation')){var Se=Ee.sprites;-1===Se.indexOf(this.getSharedState('selectedSprite'))&&(this.setSharedState({skipHistory:!0},!1),this.props.onSwitchControls('home'));}},ge.prototype._onBackClick=function(){var be=this.context.editor;be.render(),this._backButtonClicked=!0,this.props.onSwitchControls('home');},ge.prototype.sharedStateDidChange=function(ye){'selectedSprite'in ye&&this.forceUpdate();},ge.prototype._onFontSizeChange=function(ye){var be=this.context.editor.getOutputDimensions(),Ee=this.getSharedState('selectedSprite');Ee.setFontSize(ye/be.y),this.forceUpdate();},ge.prototype._onFontChange=function(ye){var be=this.getSharedState('selectedSprite');be.setFontFamily(ye.getFontFamily()),be.setFontWeight(ye.getFontWeight()),be.setFontStyle(ye.getFontStyle()),this.forceUpdate();},ge.prototype._onAlignmentClick=function(){var be=this.getSharedState('selectedSprite'),Ee=be.getAlignment(),Se=ue.indexOf(Ee),ve=(Se+1)%ue.length,Me=ue[ve];be.setAlignment(Me),this.forceSharedUpdate();},ge.prototype._onTakeToFrontClick=function(){var be=this.getSharedState('operation');be.takeSpriteToFront(this.getSharedState('selectedSprite')),this.forceSharedUpdate();},ge.prototype._onForegroundColorChange=function(ye){var be=this.getSharedState('selectedSprite');be.setColor(ye);},ge.prototype._onBackgroundColorChange=function(ye){var be=this.getSharedState('selectedSprite');be.setBackgroundColor(ye);},ge.prototype._switchToMode=function(ye){ye===this.state.mode&&(ye=null),this.setState({mode:ye});},ge.prototype.renderOverlayControls=function(){switch(this.state.mode){case'size':return this._renderFontSizeOverlayControl();case'font':return this._renderFontFamilyOverlayControl();default:return null;}},ge.prototype._renderFontSizeOverlayControl=function(){var ye=this.getSharedState('selectedSprite');if(ye){var be=this.context.editor,Ee=be.getOutputDimensions(),Se=Math.round(Ee.y),ve=Math.round(ye.getFontSize()*Ee.y);return Y.ReactBEM.createElement(ne.default,{value:ve,maxValue:Se,label:this._t('controls.text.size'),onChange:this._onFontSizeChange});}},ge.prototype._renderSizeItem=function(){var ye=this.getSharedState('selectedSprite');if(ye){var be=this.context.editor.getOutputDimensions(),Ee=ye.getFontSize(),Se='size'===this.state.mode?'is-active':null;return Y.ReactBEM.createElement('li',{bem:'e:item',key:'size'},Y.ReactBEM.createElement('bem',{specifier:'$b:controls'},Y.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:Se,"data-identifier":'fontSize',onClick:this._switchToMode.bind(this,'size')},Y.ReactBEM.createElement('div',{bem:'b:fontSize e:text'},Math.round(Ee*be.y)),Y.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.text.size')))));}},ge.prototype._renderFontFamilyOverlayControl=function(){var ye=this.getSharedState('selectedSprite');return ye?Y.ReactBEM.createElement(de.default,{fontFamily:ye.getFontFamily(),fontWeight:ye.getFontWeight(),fontStyle:ye.getFontStyle(),fonts:this._fonts,onChange:this._onFontChange}):void 0;},ge.prototype._renderFontItem=function(){var ye=this.getSharedState('selectedSprite');if(ye){var be='font'===this.state.mode?'is-active':null;return Y.ReactBEM.createElement('li',{bem:'e:item',key:'font'},Y.ReactBEM.createElement('bem',{specifier:'$b:controls'},Y.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:be,"data-identifier":'font',onClick:this._switchToMode.bind(this,'font')},Y.ReactBEM.createElement(se.default,{fontFamily:ye.getFontFamily(),fontWeight:ye.getFontWeight(),fontStyle:ye.getFontStyle()}),Y.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.text.font')))));}},ge.prototype._renderAlignmentItem=function(){var ye=this.getSharedState('selectedSprite');if(ye){var be=ye.getAlignment();return Y.ReactBEM.createElement('li',{bem:'e:item',key:'alignment'},Y.ReactBEM.createElement('bem',{specifier:'$b:controls'},Y.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',onClick:this._onAlignmentClick,"data-identifier":'alignment'},Y.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/text/align_'+be+'.png',!0)}),Y.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.text.alignment')))));}},ge.prototype._renderTakeToFrontItem=function(){return Y.ReactBEM.createElement('li',{bem:'e:item',key:'takeToFront'},Y.ReactBEM.createElement('bem',{specifier:'$b:controls'},Y.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',onClick:this._onTakeToFrontClick},Y.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/take_to_front.png',!0)}),Y.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.text.takeToFront')))));},ge.prototype.renderControls=function(){if(this.state.loading)return Y.ReactBEM.createElement('div',null);var ye=[this._renderSizeItem(),this._renderFontItem(),this._renderAlignmentItem()],be=this.getSharedState('selectedSprite'),Ee=be.getColor().clone(),Se=be.getBackgroundColor().clone();return[Y.ReactBEM.createElement('div',{bem:'e:cell m:list'},Y.ReactBEM.createElement(ee.default,{ref:'scrollbar'},Y.ReactBEM.createElement('ul',{bem:'$e:list'},ye))),Y.ReactBEM.createElement('div',{bem:'e:cell m:colorPicker'},Y.ReactBEM.createElement(oe.default,{initialValue:Ee,label:this._t('controls.text.foreground'),onChange:this._onForegroundColorChange})),Y.ReactBEM.createElement('div',{bem:'e:cell m:colorPicker'},Y.ReactBEM.createElement(oe.default,{initialValue:Se,label:this._t('controls.text.background'),onChange:this._onBackgroundColorChange}))];},ge;}(X.default);R.default=me,me.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype._onEditClick=function(Q){Q.preventDefault(),Q.stopPropagation(),this.props.onEdit&&this.props.onEdit();},J.prototype._onTakeToFrontClick=function(Q){Q.preventDefault(),Q.stopPropagation(),this.props.onTakeToFront&&this.props.onTakeToFront();},J.prototype._onRemoveClick=function(Q){Q.preventDefault(),Q.stopPropagation(),this.props.onRemove&&this.props.onRemove();},J.prototype._renderItems=function(){var Q=[G.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onTakeToFrontClick.bind(this)},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/take-to-front.png',!0)}))];return G.Utils.isTouchDevice()&&(Q=Q.concat([G.ReactBEM.createElement('div',{bem:'$e:separator'}),G.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onEditClick.bind(this)},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/edit.png',!0)}))])),Q=Q.concat([G.ReactBEM.createElement('div',{bem:'$e:separator'}),G.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onRemoveClick.bind(this)},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/remove.png',!0)}))]),Q;},J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',{bem:'$b:spritesControlsOverlay'},this._renderItems());},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('bem',{specifier:'$b:controls'},G.ReactBEM.createElement('div',{bem:'e:cell m:largeButton'},G.ReactBEM.createElement('div',{bem:'$e:largeButton',onClick:this.props.onClick},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/tick.png',!0)}))));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){(0,U.default)(this,J);for(var X=arguments.length,Q=Array(X),ee=0;ee<X;ee++)Q[ee]=arguments[ee];var te=(0,W.default)(this,Y.call.apply(Y,[this].concat(Q)));return te._bindAll('_onCloseClick'),te;}return(0,H.default)(J,Y),J.prototype._onCloseClick=function(){this.context.mediator.emit(G.Constants.EVENTS.CLOSE);},J.prototype.renderWithBEM=function(){var Q;return this.context.options.showCloseButton&&(Q=G.ReactBEM.createElement('div',{bem:'$e:close',onClick:this._onCloseClick},G.ReactBEM.createElement('img',{bem:'e:image',src:this._getAssetPath('close.png',!0)}))),G.ReactBEM.createElement('div',{bem:'$b:header'},G.ReactBEM.createElement('div',{bem:'e:label'},this.context.options.title),Q);},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(ne){return ne&&ne.__esModule?ne:{default:ne};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(153),Y=L(Z),J=I(155),X=L(J),Q=I(152),ee=L(Q),te=I(154),oe=L(te),re=function(ne){function ie(){(0,U.default)(this,ie);for(var se=arguments.length,le=Array(se),de=0;de<se;de++)le[de]=arguments[de];var pe=(0,W.default)(this,ne.call.apply(ne,[this].concat(le)));return pe._modalManager=pe.props.modalManager,pe._bindAll('_onModalManagerUpdate'),pe;}return(0,H.default)(ie,ne),ie.prototype.componentDidMount=function(){ne.prototype.componentDidMount.call(this),this._modalManager.on('update',this._onModalManagerUpdate);},ie.prototype.componentWillUnmount=function(){ne.prototype.componentWillUnmount.call(this),this._modalManager.off('update',this._onModalManagerUpdate);},ie.prototype._onModalManagerUpdate=function(){this.forceUpdate();},ie.prototype._onModalClosed=function(le){this._modalManager.removeModal(le);},ie.prototype._renderModals=function(){var le=this,de=this._modalManager.getModals();return de.map(function(pe){var ce;switch(pe.type){case'loading':ce=Y.default;break;case'warning':ce=X.default;break;case'error':ce=ee.default;break;case'progress':ce=oe.default;}return G.ReactBEM.createElement(ce,{modal:pe,onClose:le._onModalClosed.bind(le,pe)});});},ie.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',null,this._renderModals());},ie;}(G.BaseComponent);R.default=re,re.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){(0,U.default)(this,J);for(var X=arguments.length,Q=Array(X),ee=0;ee<X;ee++)Q[ee]=arguments[ee];var te=(0,W.default)(this,Y.call.apply(Y,[this].concat(Q)));return te._bindAll('_onClose'),te;}return(0,H.default)(J,Y),J.prototype._onClose=function(){this.props.modal.close();},J.prototype.renderWithBEM=function(){var Q=this.props.modal,ee=G.ReactBEM.createElement('div',{bem:'e:modal m:error'},G.ReactBEM.createElement('div',{bem:'e:title'},Q.title),G.ReactBEM.createElement('div',{bem:'e:text'},Q.text),G.ReactBEM.createElement('div',{bem:'e:button b:button m:inline',onClick:this._onClose},'OK')),te=Q.overlay?G.ReactBEM.createElement('div',{bem:'e:overlay'},ee):ee;return G.ReactBEM.createElement('bem',{specifier:'$b:modals'},te);},J;}(G.BaseComponent);R.default=Z,Z.propTypes={modal:G.React.PropTypes.object},Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.renderWithBEM=function(){var Q=this.props.modal;return G.ReactBEM.createElement('bem',{specifier:'$b:modals'},G.ReactBEM.createElement('div',{bem:'e:overlay'},G.ReactBEM.createElement('div',{bem:'e:modal m:loading'},G.ReactBEM.createElement('div',{bem:'e:text'},Q.text))));},J;}(G.BaseComponent);R.default=Z,Z.propTypes={modal:G.React.PropTypes.object},Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.renderWithBEM=function(){var Q=this.props.modal,ee=Q.data.progress,te={width:(100*(ee||0)).toFixed(2)+'%'};return G.ReactBEM.createElement('bem',{specifier:'$b:modals'},G.ReactBEM.createElement('div',{bem:'e:overlay'},G.ReactBEM.createElement('div',{bem:'e:modal m:loading'},G.ReactBEM.createElement('div',{bem:'e:text'},Q.text),G.ReactBEM.createElement('bem',{specifier:'b:loadingModal'},G.ReactBEM.createElement('div',{bem:'$e:progressBar'},G.ReactBEM.createElement('div',{bem:'e:progress',style:te}))))));},J;}(G.BaseComponent);R.default=Z,Z.propTypes={modal:G.React.PropTypes.object},Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.renderWithBEM=function(){var Q=this.props.modal;return G.ReactBEM.createElement('bem',{specifier:'$b:modals'},G.ReactBEM.createElement('div',{bem:'e:modal m:warning'},G.ReactBEM.createElement('div',{bem:'e:title'},Q.title),G.ReactBEM.createElement('div',{bem:'e:text'},Q.text),G.ReactBEM.createElement('div',{bem:'e:button b:button m:inline',onClick:this.props.onClose},'OK')));},J;}(G.BaseComponent);R.default=Z,Z.propTypes={modal:G.React.PropTypes.object},Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(4),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=function(X){function Q(){var ee;(0,W.default)(this,Q);for(var te=arguments.length,oe=Array(te),re=0;re<te;re++)oe[re]=arguments[re];var ne=(0,H.default)(this,X.call.apply(X,[this].concat(oe)));return ne._bindAll('_onDragStart','_onDragMove','_onDragEnd','_onWindowResize','_onFeaturesUpdated','_onZoomChange'),ne._events=(ee={},(0,U.default)(ee,Y.Constants.EVENTS.WINDOW_RESIZE,ne._onWindowResize),(0,U.default)(ee,Y.Constants.EVENTS.FEATURES_UPDATED,ne._onFeaturesUpdated),ee),ne._initialRenderDone=!1,ne.state={canvasPosition:new Y.Vector2(),canvasOffset:new Y.Vector2()},ne;}return(0,Z.default)(Q,X),Q.prototype._onWindowResize=function(){var te=this.context.editor,oe=te.getSDK();oe.resizeTo(this._getContainerDimensions()),te.zoom.set('auto');},Q.prototype._onFeaturesUpdated=function(te){-1!==te.indexOf('drag')&&this.forceUpdate();},Q.prototype.componentDidMount=function(){X.prototype.componentDidMount.call(this);var te=this.context.editor,oe=te.getRenderer(),re=this.refs,ne=re.canvasCell,ie=re.canvas,se=ne.offsetWidth,le=ne.offsetHeight;oe.setCanvas(ie),oe.resizeTo(new Y.Vector2(se,le),!0),te.zoom.on('set',this._onZoomChange);},Q.prototype.componentWillUnmount=function(){var te=this.context.editor;te.zoom.off('set',this._onZoomChange);},Q.prototype._onZoomChange=function(){this.forceUpdate();},Q.prototype._onDragStart=function(te){var oe=this.context.editor;oe.features.isEnabled('drag')&&(te.preventDefault(),this._dragStartPosition=Y.Utils.getEventPosition(te.nativeEvent),this._dragInitialOffset=oe.getOffset().clone(),document.addEventListener('mousemove',this._onDragMove),document.addEventListener('touchmove',this._onDragMove),document.addEventListener('mouseup',this._onDragEnd),document.addEventListener('touchend',this._onDragEnd));},Q.prototype._onDragMove=function(te){var oe=Y.Utils.getEventPosition(te),re=oe.clone().subtract(this._dragStartPosition),ne=this._dragInitialOffset.clone().add(re),ie=this.context.editor,se=ie.getOffset().clone();ie.setOffset(ne),ie.getOffset().equals(se)||ie.render();},Q.prototype._onDragEnd=function(){document.removeEventListener('mousemove',this._onDragMove),document.removeEventListener('touchmove',this._onDragMove),document.removeEventListener('mouseup',this._onDragEnd),document.removeEventListener('touchend',this._onDragEnd);},Q.prototype._getContainerDimensions=function(){var te=this.refs.canvasCell;return new Y.Vector2(te.offsetWidth,te.offsetHeight);},Q.prototype._getDraggableStyle=function(){return{top:this.state.canvasPosition.y+this.state.canvasOffset.y,left:this.state.canvasPosition.x+this.state.canvasOffset.x};},Q.prototype.renderWithBEM=function(){var te=null,oe=null;this.props.largeControls?oe=this.props.children:te=this.props.children;var re=this.context.editor,ne=re.isReady()&&re.zoom.get()>re.zoom.getDefault(),ie=re.features.isEnabled('drag')&&ne;return Y.ReactBEM.createElement('div',{bem:'$b:canvas e:container e:row'},Y.ReactBEM.createElement('div',{bem:'e:container e:cell',ref:'canvasCell'},Y.ReactBEM.createElement('div',{bem:'e:innerContainer',className:ie?'is-draggable':null,onTouchStart:this._onDragStart,onMouseDown:this._onDragStart,style:this._getDraggableStyle()},Y.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'}),te),oe));},Q;}(Y.BaseComponent);R.default=J,J.contextTypes=Y.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(pe){return pe&&pe.__esModule?pe:{default:pe};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(64),Y=L(Z),J=I(21),X=L(J),Q=I(156),ee=L(Q),te=I(6),oe=L(te),re=I(126),ne=L(re),ie=I(69),se=L(ie),de=function(pe){function ce(){(0,U.default)(this,ce);for(var ue=arguments.length,me=Array(ue),fe=0;fe<ue;fe++)me[fe]=arguments[fe];var ge=(0,W.default)(this,pe.call.apply(pe,[this].concat(me)));return ge._overviewControls=Y.default,ge._bindAll('switchToControls','_startEditor','_onWindowResize','_onWindowResizeDone','_onImageResize','_onNewImage','_onRenderError'),ge._previousControlsStack=[],ge.state={zoom:null,controls:ne.default,dragEnabled:!0,sharedState:new G.SharedState()},ge._editor=new se.default(ge.context.ui,ge.context.options,ge.context.mediator),ge._editor.on('new-image',ge._onNewImage),ge._editor.on('ready',ge._startEditor),ge._editor.on('resize',ge._onImageResize),ge._editor.on('render-error',ge._onRenderError),ge._forceControls=ge.context.options.editor.forceControls,ge._forceControlIndex=0,ge;}return(0,H.default)(ce,pe),ce.prototype.componentDidMount=function(){pe.prototype.componentDidMount.call(this);var me=this.context.options.editor.image;this.setImage(me),this._editor.render(),this._switchToNextForceControl();var fe=this.context.options;fe.responsive&&window.addEventListener('resize',this._onWindowResize);},ce.prototype.componentWillUnmount=function(){pe.prototype.componentWillUnmount.call(this),this._editor.dispose();var me=this.context.options;me.responsive&&window.removeEventListener('resize',this._onWindowResize);},ce.prototype._startEditor=function(){this._editor.start();},ce.prototype._switchToNextForceControl=function(){if(this._forceControlIndex<this._forceControls.length){var me=this._forceControls[this._forceControlIndex],fe=me.control,ge=me.options,he=this._editor.controls.getAvailable(),ye=he[fe],be=G.SDKUtils.defaults({forcedControl:!0},ge);if(!ye)throw new Error('Force controls: Could not find control with identifier `'+fe+'`');this.switchToControls(ye,{},null,be),this._forceControlIndex++;}},ce.prototype._onRenderError=function(me){oe.default.instance.displayError(this._t('errors.renderingError.title'),this._t('errors.renderingError.text'),!0),G.Log.error(this.constructor.name,'An error occurred while rendering: '+me.message),G.Log.printError(me);},ce.prototype._onNewImage=function(){this.switchToControls(ne.default);},ce.prototype._onImageResize=function(){var me=this,fe=oe.default.instance.displayLoading(this._t('loading.resizing'));this._editor.once('resized',function(ge){var he=ge.dimensions,ye=ge.reason;fe.close(),me.context.options.editor.displayResizeMessage&&oe.default.instance.displayWarning(me._t('warnings.imageResized_'+ye+'.title'),me._t('warnings.imageResized_'+ye+'.text',{maxMegaPixels:me._editor.getMaxMegapixels(),width:he.x,height:he.y}));});},ce.prototype._onWindowResize=function(){this._resizeTimeout&&(window.clearTimeout(this._resizeTimeout),this._resizeTimeout=null),this._resizeTimeout=window.setTimeout(this._onWindowResizeDone,500);},ce.prototype._onWindowResizeDone=function(){this._emitEvent(G.Constants.EVENTS.WINDOW_RESIZE);},ce.prototype.switchToControls=function(me){var fe=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},ge=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,he=arguments[3],ye=null;if('back'===me)ye=this._previousControlsStack.pop();else if('home'===me){if(this._forceControlIndex<this._forceControls.length)return this._switchToNextForceControl();ye=ne.default,this._previousControlsStack=[];}else ye=me,this._previousControlsStack.push(this.state.controls);var be=this.state.controls!==ye;this.state.controls.onExit&&this.state.controls.onExit.call(this.refs.controls),this.state.sharedState.clear(),this.state.sharedState.set(fe,!1);var Ee=G.SDKUtils.defaults(he||this.context.options.editor.controlsOptions[ye.identifier],ye.defaultOptions);return ye.onEnter&&ye.onEnter.call(this.refs.controls,this.state.sharedState,Ee),be?void this.setState({controls:ye,controlsOptions:Ee},ge):ge&&ge();},ce.prototype.getZoom=function(){return this.state.zoom;},ce.prototype.export=function(){for(var me=this,fe=arguments.length,ge=Array(fe),he=0;he<fe;he++)ge[he]=arguments[he];return new Promise(function(ye,be){me.switchToControls('home',{},function(){var Ee;(Ee=me._editor).export.apply(Ee,ge).then(ye).catch(be);});});},ce.prototype.getEditor=function(){return this._editor;},ce.prototype.serialize=function(){var me;return(me=this._editor).serialize.apply(me,arguments);},ce.prototype.deserialize=function(me){return this._editor.deserialize(me);},ce.prototype._showUndoButton=function(){return this._editor.history.isAvailable();},ce.prototype.getChildContext=function(){return{editor:this._editor,ui:this.context.ui,options:this.context.options,editorScreen:this,mediator:this.context.mediator};},ce.prototype.setImage=function(me,fe){this._editor.setImage(me,fe);},ce.prototype._renderScreen=function(){var me=this.state.controls.controlsComponent,fe=this.state.controls.canvasControlsComponent;fe||(fe=ne.default.canvasControlsComponent);var ge=this.state.controls.topBarControlsComponent;ge||(ge=ne.default.topBarControlsComponent);var he,ye,be;ge&&this.context.options.showTopBar&&(be=G.ReactBEM.createElement(ge,{sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,ref:'topBarControls'})),me&&(he=G.ReactBEM.createElement(me,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+'-controls',ref:'controls'})),fe&&(ye=G.ReactBEM.createElement(fe,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+'-canvasControls',ref:'canvasControls'}));var Ee='$b:editorScreen';return this.context.options.showHeader||(Ee+=' m:noHeader'),G.ReactBEM.createElement('div',{bem:Ee},be,G.ReactBEM.createElement(ee.default,{ref:'canvas',largeControls:this.state.controls.largeCanvasControls},ye),G.ReactBEM.createElement('div',{bem:'$b:controls $e:container e:row'},G.ReactBEM.createElement('div',{bem:'e:cell'},he)));},ce;}(X.default);R.default=de,de.childContextTypes={ui:G.React.PropTypes.object.isRequired,editor:G.React.PropTypes.object.isRequired,mediator:G.React.PropTypes.object.isRequired,options:G.React.PropTypes.object.isRequired,editorScreen:G.React.PropTypes.object.isRequired},de.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(ee){return ee&&ee.__esModule?ee:{default:ee};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(195),Y=L(Z),J=I(21),X=L(J),Q=function(ee){function te(){(0,U.default)(this,te);for(var oe=arguments.length,re=Array(oe),ne=0;ne<oe;ne++)re[ne]=arguments[ne];var ie=(0,W.default)(this,ee.call.apply(ee,[this].concat(re)));return ie.state={progress:0},ie._preloader=new Y.default(ie.context.ui,ie.context.options,ie.context.mediator),ie._preloader.on('progress',function(se){ie.state.progress=se;}),ie._preloader.on('done',function(){ie.props.app.switchToScreen('post-loading');}),ie;}return(0,H.default)(te,ee),te.prototype.componentDidMount=function(){var re=this;ee.prototype.componentDidMount.call(this);var ne=window,ie=ne.devicePixelRatio;this._canvas=this.refs.canvas,this._canvas.width=this._canvas.offsetWidth*ie,this._canvas.height=this._canvas.offsetHeight*ie,this._context=this._canvas.getContext('2d'),this._preloaderImage=new window.Image(),this._preloaderImage.addEventListener('load',function(){re._preloader.load(),(0,G.requestAnimationFrame)(re._tick);}),this._preloaderImage.crossOrigin='Anonymous',this._preloaderImage.src=this.context.ui.getAssetPath('preloader.png',!0),this._running=!0,this._tick=this._tick.bind(this);},te.prototype.componentWillUnmount=function(){ee.prototype.componentWillUnmount.call(this),this._running=!1;},te.prototype._tick=function(){this._renderLoadingIndicator(),this._running&&(0,G.requestAnimationFrame)(this._tick);},te.prototype._renderLoadingIndicator=function(){var re=this._canvas,ne=re.width,ie=re.height,se=this._context;se.clearRect(0,0,ne,ie),se.save(),se.beginPath(),se.moveTo(ne/2,ie/2),se.arc(ne/2,ie/2,ne/2,0.5*-Math.PI,2*Math.PI*this.state.progress-0.5*Math.PI,!1),se.lineTo(ne/2,ie/2),se.clip(),se.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,ne,ie),se.restore(),se.save(),se.globalAlpha=0.05,se.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,ne,ie),se.restore();},te.prototype._renderScreen=function(){return G.ReactBEM.createElement('div',{bem:'$b:loadingScreen'},G.ReactBEM.createElement('div',{bem:'e:container'},G.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'})));},te;}(X.default);R.default=Q,Q.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){(0,U.default)(this,J);for(var X=arguments.length,Q=Array(X),ee=0;ee<X;ee++)Q[ee]=arguments[ee];var te=(0,W.default)(this,Y.call.apply(Y,[this].concat(Q)));return te._bindAll('_onClick'),te;}return(0,H.default)(J,Y),J.prototype._onClick=function(){this.props.onClick&&this.props.onClick(this.props.library);},J.prototype.renderWithBEM=function(){var Q=this.props.library,ee={backgroundImage:'url('+Q.coverImage+')'};return G.ReactBEM.createElement('bem',{specifier:'b:photoRoll e:libraryList'},G.ReactBEM.createElement('li',{bem:'e:item',style:ee,onClick:this._onClick},G.ReactBEM.createElement('div',{bem:'e:overlay'}),G.ReactBEM.createElement('div',{bem:'e:name'},Q.name)));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.renderWithBEM=function(){var Q=this.props.photo;return G.ReactBEM.createElement('bem',{specifier:'b:photoRoll e:photoList'},G.ReactBEM.createElement('li',{bem:'$e:item',onClick:this.props.onClick},G.ReactBEM.createElement('div',{bem:'e:overlay'}),G.ReactBEM.createElement('div',{bem:'e:title'},Q.title),G.ReactBEM.createElement('img',{bem:'e:image',src:Q.urls.thumb})));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(66),Y=L(Z),J=function(X){function Q(){(0,U.default)(this,Q);for(var ee=arguments.length,te=Array(ee),oe=0;oe<ee;oe++)te[oe]=arguments[oe];var re=(0,W.default)(this,X.call.apply(X,[this].concat(te)));re._bindAll('_onSearchSuggestionClick');var ne=re.context.options.photoRoll.provider;return re._provider=new ne(),re.state={searchSuggestions:[]},re;}return(0,H.default)(Q,X),Q.prototype._onSearchSuggestionClick=function(te){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(te);},Q.prototype.componentDidMount=function(){var te=this;X.prototype.componentDidMount.call(this),this._provider.getSearchSuggestions().then(function(oe){te.setState({searchSuggestions:oe});});},Q.prototype._renderMessage=function(){return{__html:this._t('photoRoll.search.noSearchResults',{query:this.props.query})};},Q.prototype._renderSearchSuggestions=function(){var te=this;if(!this.state.searchSuggestions.length)return null;var oe=this.state.searchSuggestions.map(function(re){return G.ReactBEM.createElement(Y.default,{onClick:te._onSearchSuggestionClick,searchSuggestion:re});});return G.ReactBEM.createElement('div',null,G.ReactBEM.createElement('div',{bem:'e:headline'},'Search suggestions'),G.ReactBEM.createElement('ul',{bem:'$e:libraryList'},oe));},Q.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',{bem:'$b:photoRoll e:row m:fullHeight'},G.ReactBEM.createElement('div',{bem:'e:cell'},G.ReactBEM.createElement('div',{bem:'e:container'},G.ReactBEM.createElement('div',{bem:'e:innerContainer'},G.ReactBEM.createElement('div',{bem:'e:noSearchResults',dangerouslySetInnerHTML:this._renderMessage()}),this._renderSearchSuggestions()))));},Q;}(G.BaseComponent);R.default=J,J.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(ne){return ne&&ne.__esModule?ne:{default:ne};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(212),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(6),X=L(J),Q=I(159),ee=L(Q),te=I(66),oe=L(te),re=function(ne){function ie(){(0,W.default)(this,ie);for(var se=arguments.length,le=Array(se),de=0;de<se;de++)le[de]=arguments[de];var pe=(0,H.default)(this,ne.call.apply(ne,[this].concat(le)));pe._needsStyleFixes=!0,pe.state={loading:!0,libraries:[],searchSuggestions:[]},pe._bindAll('_onLibraryClick','_onSearchSuggestionClick');var ce=pe.context.options.photoRoll.provider;return pe._provider=new ce(),pe;}return(0,Z.default)(ie,ne),ie.prototype.fixStyles=function(){if(Y.Utils.Browser.isIElte(11)){var le=this.refs,de=le.cell,pe=le.container;if(!(de&&pe))return;var ce=de.offsetHeight;pe.style.height=ce+'px';}},ie.prototype.componentDidMount=function(){var le=this;ne.prototype.componentDidMount.call(this);var de=X.default.instance.displayLoading(this._t('loading.loading'));this._load().then(function(pe){var ce=(0,U.default)(pe,2),ue=ce[0],me=ce[1];de.close(),1===ue.length?le._onLibraryClick(ue[0],!0):le.setState({loading:!1,libraries:ue,searchSuggestions:me});});},ie.prototype._onLibraryClick=function(le){var de=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.props.onLibraryClicked&&this.props.onLibraryClicked(le,de);},ie.prototype._onSearchSuggestionClick=function(le){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(le);},ie.prototype._load=function(){var le=[this._provider.getLibraries(),this._provider.getSearchSuggestions()];return Y.Promise.all(le);},ie.prototype._renderLibraries=function(){var le=this,de=this.state.libraries.map(function(pe){return Y.ReactBEM.createElement(ee.default,{onClick:le._onLibraryClick,library:pe});});return Y.ReactBEM.createElement('li',{bem:'e:item'},Y.ReactBEM.createElement('bem',{specifier:'b:photoRoll'},Y.ReactBEM.createElement('div',{bem:'e:headline'},'Browse libraries'),Y.ReactBEM.createElement('ul',{bem:'$e:libraryList'},de)));},ie.prototype._renderSearchSuggestions=function(){var le=this;if(!this.state.searchSuggestions.length)return null;var de=this.state.searchSuggestions.map(function(pe){return Y.ReactBEM.createElement(oe.default,{onClick:le._onSearchSuggestionClick,searchSuggestion:pe});});return Y.ReactBEM.createElement('li',{bem:'e:item'},Y.ReactBEM.createElement('bem',{specifier:'b:photoRoll'},Y.ReactBEM.createElement('div',{bem:'e:headline'},'Search suggestions'),Y.ReactBEM.createElement('ul',{bem:'$e:libraryList'},de)));},ie.prototype._renderContent=function(){return Y.ReactBEM.createElement('div',{bem:'$b:photoRoll e:row m:fullHeight'},Y.ReactBEM.createElement('div',{bem:'e:cell',ref:'cell'},Y.ReactBEM.createElement('div',{bem:'e:container',ref:'container'},Y.ReactBEM.createElement('div',{bem:'e:innerContainer'},Y.ReactBEM.createElement('ul',{bem:'$e:groupList'},this._renderLibraries(),this._renderSearchSuggestions())))));},ie.prototype.renderWithBEM=function(){return this.state.loading?Y.ReactBEM.createElement('div',null):this._renderContent();},ie;}(Y.BaseComponent);R.default=re,re.contextTypes=Y.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(de){return de&&de.__esModule?de:{default:de};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(21),Y=L(Z),J=I(166),X=L(J),Q=I(162),ee=L(Q),te=I(67),oe=L(te),re=I(164),ne=L(re),ie=I(6),se=L(ie),le=function(de){function pe(){(0,U.default)(this,pe);for(var ce=arguments.length,ue=Array(ce),me=0;me<ce;me++)ue[me]=arguments[me];var fe=(0,W.default)(this,de.call.apply(de,[this].concat(ue)));return fe.state={section:'overview',sectionsHistory:[]},fe._bindAll('_onLibraryClicked','_onSearchSuggestionClicked','_onPhotoClicked','_onFileUpload','_onWebcamClick','_onBackClicked','_onSearch'),fe;}return(0,H.default)(pe,de),pe.prototype.hasPreviousSection=function(){return!!this.state.sectionsHistory.length;},pe.prototype.switchToSection=function(ue){var me=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,fe=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;if('back'===ue){if(!this.hasPreviousSection())return me?this.props.app.switchToScreen('back'):this.switchToSection('overview');ue=this.state.sectionsHistory.pop();}else this.state.section!==ue&&fe&&this.state.sectionsHistory.push(this.state.section);this.setState({section:ue});},pe.prototype._onLibraryClicked=function(ue){var me=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.state.library=ue,this.switchToSection('library',!0,!me);},pe.prototype._onSearchSuggestionClicked=function(ue){this.state.searchQuery=ue.query,this.switchToSection('search');},pe.prototype._onPhotoClicked=function(ue){var me=this,fe=se.default.instance.displayLoading(this._t('loading.loading')),ge=new window.Image();ge.addEventListener('load',function(){fe.close(),me.props.app.setImage(ge,!0);}),ge.addEventListener('error',function(){fe.close(),se.default.instance.displayError(me._t('errors.imageLoadFail.title'),me._t('errors.imageLoadFail.text',{path:ge.src}));}),ge.crossOrigin='Anonymous',ge.src=ue.urls.raw;},pe.prototype._onBackClicked=function(){this.switchToSection('back');},pe.prototype._onSearch=function(ue){return ue.trim().length?void(this.state.searchQuery=ue,this.switchToSection('search')):(this.state.searchQuery=null,this.switchToSection('back',!1));},pe.prototype._onWebcamClick=function(){this.props.app.switchToScreen('webcam');},pe.prototype._onFileUpload=function(ue){this.props.app.setImage(ue);},pe.prototype._isBackButtonVisible=function(){return 0!==this.state.sectionsHistory.length||this.props.app.hasPreviousScreen();},pe.prototype._renderContent=function(){switch(this.state.section){case'search':return G.ReactBEM.createElement(ne.default,{query:this.state.searchQuery,onPhotoClicked:this._onPhotoClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked});case'library':return G.ReactBEM.createElement(oe.default,{library:this.state.library,onPhotoClicked:this._onPhotoClicked});case'overview':return G.ReactBEM.createElement(ee.default,{onLibraryClicked:this._onLibraryClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked});}},pe.prototype._renderScreen=function(){var ue=this._renderContent();return G.ReactBEM.createElement('div',{bem:'$b:photoRollScreen'},G.ReactBEM.createElement(X.default,{onBackClicked:this._onBackClicked,onSearch:this._onSearch,searchQuery:this.state.searchQuery,onFileUpload:this._onFileUpload,onWebcamClick:this._onWebcamClick,backButton:this._isBackButtonVisible(),backButtonLabel:this._t('generic.back'),ref:'topBarControls'}),ue);},pe;}(Y.default);R.default=le,le.childContextTypes={ui:G.React.PropTypes.object.isRequired,editor:G.React.PropTypes.object.isRequired,mediator:G.React.PropTypes.object.isRequired,options:G.React.PropTypes.object.isRequired,editorScreen:G.React.PropTypes.object.isRequired},le.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(oe){return oe&&oe.__esModule?oe:{default:oe};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(67),Y=L(Z),J=I(161),X=L(J),Q=I(6),ee=L(Q),te=function(oe){function re(){return(0,U.default)(this,re),(0,W.default)(this,oe.apply(this,arguments));}return(0,H.default)(re,oe),re.prototype.componentWillReceiveProps=function(ie){ie.query!==this.props.query&&this._loadPhotos(ie.query);},re.prototype._getHeadline=function(){return this._t('photoRoll.search.results.headline',{query:this.props.query});},re.prototype._loadPhotos=function(){var ie=this,se=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.props.query;this._totalPhotosHeight=0;var le=ee.default.instance.displayProgress(this._t('loading.loading')),de=this.context.options.photoRoll.provider,pe=new de();pe.searchPhotos(se).then(function(ce){return ie._preloadPhotos(ce,le);}).then(function(ce){ie.setState({photos:ce,loading:!1}),le.close();});},re.prototype._renderNotFound=function(){return G.ReactBEM.createElement(X.default,{query:this.props.query,onSearchSuggestionClicked:this.props.onSearchSuggestionClicked});},re.prototype.renderWithBEM=function(){return this.state.loading?G.ReactBEM.createElement('div',null):0===this.state.photos.length?this._renderNotFound():this._renderPhotos();},re;}(Y.default);R.default=te,te.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('bem',{specifier:'$b:topBar'},G.ReactBEM.createElement('div',{bem:'$e:iconButton',onClick:this.props.onClick},G.ReactBEM.createElement('img',{bem:'e:icon',src:this.props.icon})));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(se){return se&&se.__esModule?se:{default:se};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(32),Y=L(Z),J=I(165),X=L(J),Q=I(42),ee=L(Q),te=I(167),oe=L(te),re=I(174),ne=L(re),ie=function(se){function le(){(0,U.default)(this,le);for(var de=arguments.length,pe=Array(de),ce=0;ce<de;ce++)pe[ce]=arguments[ce];var ue=(0,W.default)(this,se.call.apply(se,[this].concat(pe)));return ue._bindAll('_onUploadButtonClicked','_onWebcamButtonClicked','_onBackClicked','_onSearchValueChange','_onNewFile'),ue._onSearchValueChange=G.Utils.debounce(ue._onSearchValueChange,250),ue;}return(0,H.default)(le,se),le.prototype._onBackClicked=function(){this.props.onBackClicked&&this.props.onBackClicked();},le.prototype._onSearchValueChange=function(pe){this.props.onSearch&&this.props.onSearch(pe);},le.prototype._onUploadButtonClicked=function(){this.refs.upload.open();},le.prototype._onWebcamButtonClicked=function(){this.props.onWebcamClick&&this.props.onWebcamClick();},le.prototype._onNewFile=function(pe){this.props.onFileUpload&&this.props.onFileUpload(pe);},le.prototype._isWebcamAvailable=function(){return!G.Utils.isMobile()&&!1!==this.context.options.enableWebcam;},le.prototype._renderRightButtons=function(){var pe=this.context.options,ce=[];return pe.enableUpload&&ce.push(G.ReactBEM.createElement(X.default,{icon:this._getAssetPath('photo-roll/upload.png',!0),onClick:this._onUploadButtonClicked})),this._isWebcamAvailable()&&ce.push(G.ReactBEM.createElement(X.default,{icon:this._getAssetPath('photo-roll/webcam.png',!0),onClick:this._onWebcamButtonClicked})),ce;},le.prototype.renderWithBEM=function(){var pe;return this.props.backButton&&(pe=G.ReactBEM.createElement(ne.default,{label:this.props.backButtonLabel,onClick:this._onBackClicked})),G.ReactBEM.createElement('div',{bem:'$b:topBar e:row'},G.ReactBEM.createElement('div',{bem:'e:cell'},G.ReactBEM.createElement('div',{bem:'e:table'},G.ReactBEM.createElement('div',{bem:'e:cell m:left'},pe),G.ReactBEM.createElement('div',{bem:'e:cell m:fullWidth'},G.ReactBEM.createElement(oe.default,{searchQuery:this.props.searchQuery,onChange:this._onSearchValueChange}),G.ReactBEM.createElement(ee.default,{onNewFile:this._onNewFile,ref:'upload'})),G.ReactBEM.createElement('div',{bem:'e:cell m:right'},this._renderRightButtons()))));},le;}(Y.default);R.default=ie,ie.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){(0,U.default)(this,J);for(var X=arguments.length,Q=Array(X),ee=0;ee<X;ee++)Q[ee]=arguments[ee];var te=(0,W.default)(this,Y.call.apply(Y,[this].concat(Q)));return te._bindAll('_onFocus','_onBlur','_onChange','_onBarClick'),te.state={active:!1,placeholder:te._t('photoRoll.search.placeholder'),value:te.props.searchQuery||''},te;}return(0,H.default)(J,Y),J.prototype.componentWillReceiveProps=function(Q){this.state.active=Q.searchQuery||this.state.value,this.setState({value:Q.searchQuery||''});},J.prototype.componentDidUpdate=function(){this.refs.input.value=this.state.value;},J.prototype.componentDidMount=function(){var Q=this;Y.prototype.componentDidMount.call(this),this._hiddenInputDummy=document.createElement('div');var ee=G.Utils.getStyleObject(this.refs.input);['font','lineHeight','textAlign','textIndent','textTransform','textDecoration','textRendering','textShadow','textOverflow','wordSpacing','letterSpacing','whiteSpace'].forEach(function(oe){Q._hiddenInputDummy.style[oe]=ee[oe];}),this._hiddenInputDummy.style.position='absolute',this._hiddenInputDummy.style.top='-9999px',this._hiddenInputDummy.style.left='-9999px',this.refs.root.appendChild(this._hiddenInputDummy),this._updateInputWidth();},J.prototype._updateInputWidth=function(){var Q=this;this._hiddenInputDummy.innerHTML=this.state.value||this.state.placeholder,setTimeout(function(){Q.setState({inputWidth:Q._hiddenInputDummy.offsetWidth+5});},0);},J.prototype._onBarClick=function(){this.refs.input.focus();},J.prototype._onFocus=function(){this.setState({active:!0});},J.prototype._onBlur=function(){''!==this.state.value||this.props.searchQuery||this.setState({active:!1});},J.prototype._onChange=function(Q){this.state.value=Q.target.value,this.forceUpdate(),this.props.onChange&&this.props.onChange(this.state.value);},J.prototype.renderWithBEM=function(){var Q='$e:searchBar',ee='photo-roll/search-light.png';this.state.active&&(Q+=' m:active',ee='photo-roll/search-dark.png'),ee=this._getAssetPath(ee,!0);var te={width:this.state.inputWidth+'px'};return G.ReactBEM.createElement('bem',{specifier:'$b:photoRollScreen'},G.ReactBEM.createElement('div',{bem:Q,ref:'root',onClick:this._onBarClick},G.ReactBEM.createElement('div',{bem:'e:content'},G.ReactBEM.createElement('div',{bem:'$e:icon'},G.ReactBEM.createElement('img',{src:ee,bem:'e:image'})),G.ReactBEM.createElement('div',{bem:'e:inputContainer'},G.ReactBEM.createElement('input',{bem:'e:input',ref:'input',placeholder:this.state.placeholder,onBlur:this._onBlur,onFocus:this._onFocus,onChange:this._onChange,defaultValue:this.state.value,style:te})))));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(41),Y=L(Z),J=function(X){function Q(){(0,U.default)(this,Q);for(var ee=arguments.length,te=Array(ee),oe=0;oe<ee;oe++)te[oe]=arguments[oe];var re=(0,W.default)(this,X.call.apply(X,[this].concat(te)));return re._needsStyleFixes=!0,re._modifier='photoRoll',re;}return(0,H.default)(Q,X),Q.prototype.fixStyles=function(){if(G.Utils.Browser.isIElte(11)){var te=this.refs,oe=te.cell,re=te.overlay,ne=oe.offsetHeight;re.style.height=ne+'px';}},Q.prototype._renderContent=function(){var te={backgroundImage:'url('+this._getAssetPath('splash/photo-roll.png',!0,!0)+')'};return G.ReactBEM.createElement('div',{bem:'e:contentWrapper'},G.ReactBEM.createElement('div',{bem:'e:contentRow'},G.ReactBEM.createElement('div',{bem:'e:contentCell',onClick:this._onClick,style:te,ref:'cell'},G.ReactBEM.createElement('div',{bem:'e:overlay',ref:'overlay'}),G.ReactBEM.createElement('div',{bem:'e:headline'},this._t('splash.photoRoll.headline')),G.ReactBEM.createElement('div',{bem:'e:description'},this._t('splash.photoRoll.description')))));},Q;}(Y.default);R.default=J,J.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(ne){return ne&&ne.__esModule?ne:{default:ne};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(21),Y=L(Z),J=I(170),X=L(J),Q=I(171),ee=L(Q),te=I(168),oe=L(te),re=function(ne){function ie(){(0,U.default)(this,ie);var se=(0,W.default)(this,ne.call(this));return se._bindAll('_onWebcamClick','_onPhotoRollClick','_onImage'),se;}return(0,H.default)(ie,ne),ie.prototype._onPhotoRollClick=function(){this.props.app.switchToScreen('photoRoll');},ie.prototype._onWebcamClick=function(){this.props.app.switchToScreen('webcam');},ie.prototype._onImage=function(le){this.props.app.setImage(le);},ie.prototype._isWebcamAvailable=function(){return!G.Utils.isMobile()&&!1!==this.context.options.enableWebcam;},ie.prototype._isPhotoRollAvailable=function(){return!!this.context.options.photoRoll.provider;},ie.prototype._renderScreen=function(){var le=[],de=0,pe=this.context.options.enableUpload;pe&&de++;var ce=this._isWebcamAvailable();ce&&de++;var ue=this._isPhotoRollAvailable();return ue&&de++,pe&&le.push(G.ReactBEM.createElement(X.default,{onImage:this._onImage,totalRows:de})),ce&&le.push(G.ReactBEM.createElement(ee.default,{onClick:this._onWebcamClick,totalRows:de})),ue&&le.push(G.ReactBEM.createElement(oe.default,{onClick:this._onPhotoRollClick,totalRows:de})),G.ReactBEM.createElement('div',{bem:'$b:splashScreen'},G.ReactBEM.createElement('div',{bem:'e:container'},le));},ie;}(Y.default);R.default=re,re.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(ne){return ne&&ne.__esModule?ne:{default:ne};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(24),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(1),J=I(41),X=L(J),Q=I(99),ee=L(Q),te=I(42),oe=L(te),re=function(ne){function ie(){(0,W.default)(this,ie);var se=(0,H.default)(this,ne.call(this));return se._modifier='upload',se._bindAll('_onImage','_onDragEnter','_onDragOver','_onDragLeave','_onDrop'),se._dragCounter=0,se.state={dragAreaHovered:!1},se;}return(0,Z.default)(ie,ne),ie.prototype._onDragEnter=function(le){le.preventDefault(),this._dragCounter++,this.setState({dragAreaHovered:!0});},ie.prototype._onDragOver=function(le){le.preventDefault();},ie.prototype._onDragLeave=function(le){le.preventDefault(),this._dragCounter--,0===this._dragCounter&&this.setState({dragAreaHovered:!1});},ie.prototype._onDrop=function(le){var de=this;le.stopPropagation(),le.preventDefault(),le=le.nativeEvent,le.returnValue=!1,this.setState({dragAreaHovered:!1},function(){le.dataTransfer&&de._handleFile(le.dataTransfer.files[0]);});},ie.prototype._onClick=function(){this.refs.upload.open();},ie.prototype._handleFile=function(le){var de=this,pe=new window.FileReader();pe.onload=function(){return function(ce){var ue=ce.target.result,me=new window.Image();me.addEventListener('load',function(){de._onImage(me);}),me.src=ue;};}(le),pe.readAsDataURL(le);},ie.prototype._onImage=function(le){this.props.onImage&&this.props.onImage(le);},ie.prototype._renderContent=function(){var le={onDragEnter:this._onDragEnter,onDragOver:this._onDragOver,onDragLeave:this._onDragLeave,onDrop:this._onDrop};this.state.dragAreaHovered&&(le.className='is-hovered');var de='e:contentCell';return(!1!==this.context.options.enableWebcam||null!==this.context.options.photoRoll.provider)&&(de+=' m:withBorder'),Y.ReactBEM.createElement('div',{bem:'e:contentWrapper'},Y.ReactBEM.createElement('div',{bem:'e:contentRow'},Y.ReactBEM.createElement('div',(0,U.default)({bem:de,onClick:this._onClick},le),Y.ReactBEM.createElement(oe.default,{ref:'upload',onNewFile:this._onImage}),Y.ReactBEM.createElement(ee.default,{bem:'e:button',uppercase:!0},this._t('splash.upload.button')),Y.ReactBEM.createElement('div',{bem:'e:description'},this._t('splash.upload.description')))));},ie;}(X.default);R.default=re,re.propTypes={onImage:Y.React.PropTypes.func.isRequired},re.contextTypes=X.default.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(41),Y=L(Z),J=function(X){function Q(){(0,U.default)(this,Q);for(var ee=arguments.length,te=Array(ee),oe=0;oe<ee;oe++)te[oe]=arguments[oe];var re=(0,W.default)(this,X.call.apply(X,[this].concat(te)));return re._needsStyleFixes=!0,re._modifier='webcam',re;}return(0,H.default)(Q,X),Q.prototype.fixStyles=function(){if(G.Utils.Browser.isIElte(11)){var te=this.refs,oe=te.cell,re=te.overlay,ne=oe.offsetHeight;re.style.height=ne+'px';}},Q.prototype._renderContent=function(){var te={backgroundImage:'url('+this._getAssetPath('splash/webcam.png',!0,!0)+')'};return G.ReactBEM.createElement('div',{bem:'e:contentWrapper'},G.ReactBEM.createElement('div',{bem:'e:contentRow'},G.ReactBEM.createElement('div',{bem:'e:contentCell',onClick:this._onClick,style:te,ref:'cell'},G.ReactBEM.createElement('div',{bem:'e:overlay',ref:'overlay'}),G.ReactBEM.createElement('div',{bem:'e:headline'},this._t('splash.webcam.headline')),G.ReactBEM.createElement('div',{bem:'e:description'},this._t('splash.webcam.description')))));},Q;}(Y.default);R.default=J,J.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(6),Y=L(Z),J=function(X){function Q(){(0,U.default)(this,Q);var ee=(0,W.default)(this,X.call(this));return ee._bindAll('_onWebcamReady'),ee.state={webcamReady:!1},ee;}return(0,H.default)(Q,X),Q.prototype.shouldComponentUpdate=function(){return!1;},Q.prototype.componentWillUnmount=function(){X.prototype.componentWillUnmount.call(this);var te=this.refs.video;if(this._stream){var oe=this._stream.getTracks()[0];oe&&oe.stop(),this._stream.stop&&this._stream.stop();}te.pause();},Q.prototype.componentDidMount=function(){this._resizeVideo(),this._initVideoStream();},Q.prototype._onWebcamReady=function(){this.props.onReady&&this.props.onReady(),this.setState({webcamReady:!0});},Q.prototype.makePhoto=function(){if(!this.state.webcamReady)return G.Promise.reject(new Error('UserMedia stream not ready'));var te=this.refs.video;return new G.Promise(function(oe){var ne=document.createElement('canvas');ne.width=te.videoWidth,ne.height=te.videoHeight;var ie=ne.getContext('2d');ie.drawImage(te,0,0);var se=new window.Image();se.addEventListener('load',function(){oe(se);}),se.src=ne.toDataURL('image/png');});},Q.prototype._resizeVideo=function(){var te=this.refs,oe=te.video,re=te.container,ne=G.Utils.getInnerDimensionsForElement(re);oe.width=ne.x,oe.height=ne.y;},Q.prototype._initVideoStream=function(){var te=this,oe=this.refs.video,re=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;if(!re){var ne=Y.default.instance.displayError(this._t('errors.webcamNotSupported.title'),this._t('errors.webcamNotSupported.text'));return void ne.on('close',function(){return te.props.onBack();});}re.call(navigator,{video:!0},function(ie){te._stream=ie,oe.onloadedmetadata=te._onWebcamReady,oe.src=window.URL.createObjectURL(ie);},function(ie){console.error&&console.error(ie);var se=Y.default.instance.displayError(te._t('errors.webcamUnavailable.title'),te._t('errors.webcamUnavailable.text',{error:ie.name}),!0);se.on('close',function(){return te.props.onBack();});});},Q.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('div',{bem:'$b:webcam',ref:'container'},G.ReactBEM.createElement('video',{bem:'e:video',ref:'video',autoPlay:!0}));},Q;}(G.BaseComponent);R.default=J,J.propTypes={onReady:G.React.PropTypes.func},J.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";function L(oe){return oe&&oe.__esModule?oe:{default:oe};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(21),Y=L(Z),J=I(32),X=L(J),Q=I(172),ee=L(Q),te=function(oe){function re(){(0,U.default)(this,re);var ne=(0,W.default)(this,oe.call(this));return ne._bindAll('_onCancel','_onWebcamReady','_onShutterClicked'),ne.state={webcamReady:!1},ne;}return(0,H.default)(re,oe),re.prototype._onWebcamReady=function(){this.setState({webcamReady:!0});},re.prototype._onCancel=function(){this.props.app.switchToScreen('back');},re.prototype._onShutterClicked=function(){var ie=this,se=this.refs.webcam;se.makePhoto().then(function(le){ie.props.app.setImage(le);}).catch(function(le){console.error&&console.error(le);});},re.prototype._renderScreen=function(){return G.ReactBEM.createElement('div',{bem:'$b:webcamScreen'},G.ReactBEM.createElement(X.default,{label:this._t('webcam.headline')},G.ReactBEM.createElement('bem',{specifier:'$b:topBar'},G.ReactBEM.createElement('div',{bem:'e:cancelButton',onClick:this._onCancel},this._t('generic.cancel')),G.ReactBEM.createElement('div',{bem:'e:label'},this._t('webcam.headline')))),G.ReactBEM.createElement('div',{bem:'$b:canvas e:container e:row'},G.ReactBEM.createElement('div',{bem:'e:container e:cell'},G.ReactBEM.createElement(ee.default,{ref:'webcam',onReady:this._onWebcamReady,onBack:this._onCancel}))),G.ReactBEM.createElement('div',{bem:'$b:controls $e:container e:row'},G.ReactBEM.createElement('div',{bem:'e:cell'},G.ReactBEM.createElement('bem',{specifier:'b:webcamScreen'},G.ReactBEM.createElement('div',{bem:'$e:shutterButton',onClick:this._onShutterClicked,className:!!this.state.webcamReady&&'is-active'},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/webcam/shutter.png',!0)}))))));},re;}(Y.default);R.default=te,te.contextTypes=Y.default.contextTypes;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(){return(0,U.default)(this,J),(0,W.default)(this,Y.apply(this,arguments));}return(0,H.default)(J,Y),J.prototype.renderWithBEM=function(){return G.ReactBEM.createElement('bem',{specifier:'$b:topBar'},G.ReactBEM.createElement('div',{bem:'$e:backButton',onClick:this.props.onClick},G.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('top-bar/back.png',!0)}),G.ReactBEM.createElement('div',{bem:'e:label'},this.props.label)));},J;}(G.BaseComponent);R.default=Z,Z.contextTypes=G.BaseComponent.contextTypes;},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(29),U=function(N){return N&&N.__esModule?N:{default:N};}(V);R.default={EVENTS:{RENDER:'render',EXPORT:'export',CLOSE:'close',ZOOM_DONE:'zoom:done',OPERATION_CREATED:'operation:created',OPERATION_UPDATED:'operation:updated',OPERATION_REMOVED:'operation:removed',FEATURES_DISABLED:'editor:features:disabled',FEATURES_ENABLED:'editor:features:enabled',FEATURES_UPDATED:'editor:features:updated',COLORPICKER_OPEN:'colorpicker:open',HISTORY_UPDATED:'history:update',HISTORY_BEFORE_UNDO:'history:before_undo',HISTORY_UNDO:'history:undo',WINDOW_RESIZE:'window:resize',CONTROLS_SWITCHED:'controls:switched',CROP_REAPPLY_RATIO:'crop:reapply_ratio'},DEFAULTS:{TEXT:'Double-click to edit',CROP_RATIOS:[[{name:'custom',ratio:'*',selected:!0},{name:'square',ratio:1},{name:'4-3',ratio:1.33},{name:'16-9',ratio:1.77}],[{name:'social',dimensions:new U.default.Math.Vector2(800,800)},{name:'fb-ad',dimensions:new U.default.Math.Vector2(1200,627)},{name:'fb-post',dimensions:new U.default.Math.Vector2(940,788)},{name:'fb-cover',dimensions:new U.default.Math.Vector2(851,315)}]],FRAMES:[{name:'dia',label:'Dia',layoutMode:'vertical-inside',icon:'frames/dia/icon.png',imageGroups:{top:{mid:{image:'frames/dia/dia_top.png',mode:'repeat'}},left:{start:'frames/dia/dia_top_left.png',mid:'frames/dia/dia_left.png',end:'frames/dia/dia_bottom_left.png'},right:{start:'frames/dia/dia_top_right.png',mid:'frames/dia/dia_right.png',end:'frames/dia/dia_bottom_right.png'},bottom:{mid:{image:'frames/dia/dia_bottom.png',mode:'repeat'}}}},{name:'simple',label:'Simple',tintable:!0,layoutMode:'vertical-inside',icon:'frames/simple/icon.png',imageGroups:{top:{start:'frames/simple/simple_corner.png',mid:{image:'frames/simple/simple_horizontal.png',mode:'repeat'},end:'frames/simple/simple_corner.png'},left:{mid:{image:'frames/simple/simple_vertical.png',mode:'repeat'}},right:{mid:{image:'frames/simple/simple_vertical.png',mode:'repeat'}},bottom:{start:'frames/simple/simple_corner.png',mid:{image:'frames/simple/simple_horizontal.png',mode:'repeat'},end:'frames/simple/simple_corner.png'}}},{name:'white',label:'White',tintable:!0,layoutMode:'vertical-inside',icon:'frames/white/icon.png',imageGroups:{top:{start:'frames/white/white_top_left.png',mid:{image:'frames/white/white_top.png',mode:'repeat'},end:'frames/white/white_top_right.png'},left:{mid:{image:'frames/white/white_left.png',mode:'repeat'}},right:{mid:{image:'frames/white/white_right.png',mode:'repeat'}},bottom:{start:'frames/white/white_bottom_left.png',mid:{image:'frames/white/white_bottom.png',mode:'repeat'},end:'frames/white/white_bottom_right.png'}}}],FONTS:[{name:'helvetica',fontFamily:'Helvetica',fontWeight:'normal'},{name:'verdana',fontFamily:'Verdana',fontWeight:'normal'},{name:'timesnewroman',fontFamily:'Times New Roman',fontWeight:'normal'},{name:'impact',fontFamily:'Impact',fontWeight:'normal',default:!0}],STICKER_CATEGORIES:[{name:'glasses',label:'Glasses',stickers:[{name:'glasses-nerd',label:'Nerd glasses',images:{mediaThumb:{uri:'stickers/thumb/glasses-nerd.png',width:100,height:100},mediaBase:{uri:'stickers/base/glasses-nerd.png',width:221,height:91}}},{name:'glasses-normal',label:'Normal glasses',images:{mediaThumb:{uri:'stickers/thumb/glasses-normal.png',width:100,height:100},mediaBase:{uri:'stickers/base/glasses-normal.png',width:249,height:87}}},{name:'glasses-shutter-green',label:'Green shutter glasses',images:{mediaThumb:{uri:'stickers/thumb/glasses-shutter-green.png',width:100,height:100},mediaBase:{uri:'stickers/base/glasses-shutter-green.png',width:235,height:89}}},{name:'glasses-shutter-yellow',label:'Yellow shutter glasses',images:{mediaThumb:{uri:'stickers/thumb/glasses-shutter-yellow.png',width:100,height:100},mediaBase:{uri:'stickers/base/glasses-shutter-yellow.png',width:236,height:89}}},{name:'glasses-sun',label:'Sun glasses',images:{mediaThumb:{uri:'stickers/thumb/glasses-sun.png',width:100,height:100},mediaBase:{uri:'stickers/base/glasses-sun.png',width:250,height:87}}}]},{name:'hats',label:'Hats',stickers:[{name:'hat-cap',label:'Cap',images:{mediaThumb:{uri:'stickers/thumb/hat-cap.png',width:100,height:100},mediaBase:{uri:'stickers/base/hat-cap.png',width:237,height:189}}},{name:'hat-cylinder',label:'Cylinder',images:{mediaThumb:{uri:'stickers/thumb/hat-cylinder.png',width:100,height:100},mediaBase:{uri:'stickers/base/hat-cylinder.png',width:225,height:176}}},{name:'hat-party',label:'Party hat',images:{mediaThumb:{uri:'stickers/thumb/hat-party.png',width:100,height:100},mediaBase:{uri:'stickers/base/hat-party.png',width:140,height:226}}},{name:'hat-sheriff',label:'Sheriff hat',images:{mediaThumb:{uri:'stickers/thumb/hat-sheriff.png',width:100,height:100},mediaBase:{uri:'stickers/base/hat-sheriff.png',width:251,height:129}}}]},{name:'beards',label:'Beards',stickers:[{name:'mustache-long',label:'Long mustache',images:{mediaThumb:{uri:'stickers/thumb/mustache-long.png',width:100,height:100},mediaBase:{uri:'stickers/base/mustache-long.png',width:199,height:182}}},{name:'mustache1',label:'Brown mustache',images:{mediaThumb:{uri:'stickers/thumb/mustache1.png',width:100,height:100},mediaBase:{uri:'stickers/base/mustache1.png',width:238,height:106}}},{name:'mustache2',label:'Black mustache',images:{mediaThumb:{uri:'stickers/thumb/mustache2.png',width:100,height:100},mediaBase:{uri:'stickers/base/mustache2.png',width:250,height:82}}},{name:'mustache3',label:'Brown mustache',images:{mediaThumb:{uri:'stickers/thumb/mustache3.png',width:100,height:100},mediaBase:{uri:'stickers/base/mustache3.png',width:250,height:94}}}]},{name:'misc',label:'Misc',stickers:[{name:'heart',label:'Heart',images:{mediaThumb:{uri:'stickers/thumb/heart.png',width:100,height:100},mediaBase:{uri:'stickers/base/heart.png',width:185,height:174}}},{name:'pipe',label:'Pipe',images:{mediaThumb:{uri:'stickers/thumb/pipe.png',width:100,height:100},mediaBase:{uri:'stickers/base/pipe.png',width:240,height:112}}},{name:'snowflake',label:'Snow flake',images:{mediaThumb:{uri:'stickers/thumb/snowflake.png',width:100,height:100},mediaBase:{uri:'stickers/base/snowflake.png',width:204,height:171}}},{name:'star',label:'Star',images:{mediaThumb:{uri:'stickers/thumb/star.png',width:100,height:100},mediaBase:{uri:'stickers/base/star.png',width:201,height:191}}}]}]}};},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var U=I(0),N=function(Z){return Z&&Z.__esModule?Z:{default:Z};}(U),W=I(62),$=function(Z){if(Z&&Z.__esModule)return Z;var Y={};if(null!=Z)for(var J in Z)Object.prototype.hasOwnProperty.call(Z,J)&&(Y[J]=Z[J]);return Y.default=Z,Y;}(W),H=I(1),G=function(){function Z(Y,J,X){(0,N.default)(this,Z),this._editor=Y,this._sdk=J,this._mediator=X,this._options=this._editor.getOptions(),this._available=H.SDKUtils.extend({},$,this._options.extensions.controls);}return Z.prototype.isEnabled=function(J){var X=this.get(J);return X?X.isAvailable&&X.isAvailable(this._editor):(H.Log.info('EditorControls#isEnabled: Unknown control: '+J),!1);},Z.prototype.get=function(J){return this._available[J];},Z.prototype.getAvailable=function(){return this._available;},Z;}();R.default=G;},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function($){return $&&$.__esModule?$:{default:$};}(V),N=I(1),W=function(){function $(H,G,Z){(0,U.default)(this,$),this._editor=H,this._sdk=G,this._mediator=Z,this._options=this._editor.getOptions(),this._features={drag:this._options.editor.enableDrag,zoom:this._options.editor.enableZoom};}return $.prototype.isEnabled=function(G){var Z=G.charAt(0).toUpperCase()+G.slice(1),Y=this._options.editor['enable'+Z];return this._features[G]&&Y;},$.prototype.enable=function(){for(var G=this,Z=arguments.length,Y=Array(Z),J=0;J<Z;J++)Y[J]=arguments[J];Y.forEach(function(X){G._features[X]=!0;}),this._mediator.emit(N.Constants.EVENTS.FEATURES_ENABLED,Y),this._mediator.emit(N.Constants.EVENTS.FEATURES_UPDATED,Y);},$.prototype.disable=function(){for(var G=this,Z=arguments.length,Y=Array(Z),J=0;J<Z;J++)Y[J]=arguments[J];Y.forEach(function(X){G._features[X]=!1;}),this._mediator.emit(N.Constants.EVENTS.FEATURES_DISABLED,Y),this._mediator.emit(N.Constants.EVENTS.FEATURES_UPDATED,Y);},$;}();R.default=W;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(X,Q,ee){(0,U.default)(this,J);var te=(0,W.default)(this,Y.call(this));return te._editor=X,te._sdk=Q,te._mediator=ee,te._history=[],te;}return(0,H.default)(J,Y),J.prototype.isAvailable=function(){return 0!==this._history.length;},J.prototype.add=function(Q,ee,te){var oe=this,re=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,ne;if(Q instanceof Array){var ie=Q;this._history.push(ie),ie.forEach(function(se){oe._mediator.emit(G.Constants.EVENTS.HISTORY_UPDATED,se.operation);}),ne=ie;}else ne={operation:Q,options:ee,existent:te,undo:re},this._history.push(ne),this._mediator.emit(G.Constants.EVENTS.HISTORY_UPDATED,Q);return ne;},J.prototype.undo=function(){var Q=this,ee=this._editor.operations,te=this._history.pop();if(te){var oe=[].concat(te);oe.forEach(function(re){var ne=re.operation,ie=re.existent,se=re.options,le=re.undo;Q._mediator.emit(G.Constants.EVENTS.HISTORY_BEFORE_UNDO,re),ie?(ne=ee.getOrCreate(ne.constructor.identifier),ne.set(se),Q._mediator.emit(G.Constants.EVENTS.OPERATION_UPDATED,ne)):ee.remove(ne),'function'==typeof le&&le(ne,se),Q._mediator.emit(G.Constants.EVENTS.HISTORY_UPDATED,ne),Q._mediator.emit(G.Constants.EVENTS.HISTORY_UNDO,ne);}),this.emit('undo');}},J.prototype.reset=function(){this._history=[];},J;}(G.EventEmitter);R.default=Z;},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function($){return $&&$.__esModule?$:{default:$};}(V),N=I(1),W=function(){function $(H,G,Z){(0,U.default)(this,$),this._editor=H,this._sdk=G,this._mediator=Z,this._available=this._sdk.getOperations(),this._map={},this._stack=this._sdk.getOperationsStack(),this._preferredOrder=this._editor.getOptions().editor.operationsOrder,this._fixStack();}return $.prototype.exists=function(G){return!!this._map[G];},$.prototype.add=function(G){var Z=this,Y=G.constructor.identifier;G.on('updated',function(){Z._mediator.emit(N.Constants.EVENTS.OPERATION_UPDATED,G);});var J=this._preferredOrder.indexOf(Y);if(-1===J)throw new Error('EditorOperations#add: `'+Y+'` does not appear in `operationsOrder`');this._stack.set(J,G),this._map[Y]=G,this._mediator.emit(N.Constants.EVENTS.OPERATION_CREATED,G);},$.prototype.remove=function(G){var Z=G.constructor.identifier,Y=this._stack.getStack();delete this._map[Z];var J=Y.map(function(ee){return ee.constructor.identifier;}).indexOf(G.constructor.identifier);if(-1!==J){this._stack.removeAt(J);for(var X=J+1,Q;X<Y.length;X++)Q=Y[X],Q&&Q.setDirty(!0);this._mediator.emit(N.Constants.EVENTS.OPERATION_REMOVED,G);}},$.prototype.get=function(G){return this._map[G];},$.prototype.getOrCreate=function(G){var Z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(this._map[G]){var Y=this._map[G];return Y;}var J=this._available[G],X=new J(this._sdk,Z);return this.add(X),X;},$.prototype.getStack=function(){return this._stack;},$.prototype.reset=function(){this._map={};},$.prototype._fixStack=function(){var G=this,Z=this._stack.getStack().slice();this._stack.clear(),Z.forEach(function(Y){G.add(Y);});},$;}();R.default=W;},function(M,R,I){"use strict";function L(J){return J&&J.__esModule?J:{default:J};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=300,Y=function(J){function X(Q,ee,te){(0,U.default)(this,X);var oe=(0,W.default)(this,J.call(this));return oe._editor=Q,oe._sdk=ee,oe._mediator=te,oe._isDefaultZoom=!1,oe._zoom=oe._sdk.getZoom(),oe._options=oe._editor.getOptions(),oe._zoomLevels=[1,2,3,4,5,6.25,8.33,12.5,16.66,25,33.33,50,66.66,100,200,300,400,500,600,700,800,1200,1600,3200].map(function(re){return re/100;}),oe;}return(0,H.default)(X,J),X.prototype.zoomIn=function(){var ee=this._getClosestZoomLevel(this._zoom+1e-3,1);return ee?void this.set(ee):this._zoomLevels[this._zoomLevels.length-1];},X.prototype.zoomOut=function(){var ee=this._getClosestZoomLevel(this._zoom-1e-3,-1);return ee?void this.set(ee):this._zoomLevels[0];},X.prototype._getClosestZoomLevel=function(ee,te){return-1===te?this._zoomLevels.filter(function(oe){return oe<ee;}).pop():1===te?this._zoomLevels.filter(function(oe){return oe>ee;})[0]:void 0;},X.prototype.restore=function(){this._previousZoom&&(this.set(this._previousZoom),this._previousZoom=null);},X.prototype.save=function(){this._previousZoom=this._zoom;},X.prototype.set=function(ee,te){var oe=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;if(this._editor.isReady()){var re=ee,ne=this.getDefault();'auto'===ee||re===ne?(re=ne,ee='auto',this._isDefaultZoom=!0):this._isDefaultZoom=!1;var ie=Math.max(1,2*ne),se=oe?this.getMinimum():0;re=Math.max(se,Math.min(ie,re)),this._zoom=re,this._sdk.setZoom(this._zoom),this._sdk.setTextureQuality(Math.min(this._zoom,1)),this.emit('set',this._zoom,te);}},X.prototype.getDefault=function(){var ee=this._editor.getFinalDimensions(!1),te=this._editor.getCanvasDimensions(),oe=G.SDKUtils.resizeVectorToFit(ee,te);return oe.divide(ee).x;},X.prototype.getMinimum=function(){var ee=this._editor.getFinalDimensions(),te=G.SDKUtils.resizeVectorToFit(ee,new G.Vector2(Z,Z));return te.divide(ee).x;},X.prototype.isDefault=function(){return this._isDefaultZoom;},X.prototype.get=function(){return this._zoom;},X;}(G.EventEmitter);R.default=Y;},function(M,R,I){"use strict";function L(G){return G&&G.__esModule?G:{default:G};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(1),W=I(182),$=L(W),H=function(){function G(Z,Y,J){(0,U.default)(this,G),this._sdk=Z,this._options=Y,this._download=J;}return G.prototype.export=function(){var Y=this,J=this._getRenderType();return this._sdk.export(J,this._options.format,this._options.quality).then(function(X){return Y._download&&Y._downloadData(J,X),X;});},G.prototype._downloadData=function(Y,J){Y===N.RenderType.DATAURL?$.default.downloadDataURL(J,this._options.fileBasename):Y===N.RenderType.MSBLOB?$.default.downloadMSBlob(J,this._options.fileBasename):void 0;},G.prototype._getRenderType=function(){var Y=this._options;return Y.type===N.RenderType.IMAGE&&this._download?N.Utils.supportsMSBlob()?N.RenderType.MSBLOB:N.RenderType.DATAURL:Y.type;},G;}();R.default=H;},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function($){return $&&$.__esModule?$:{default:$};}(V),N=I(1),W=function(){function $(){(0,U.default)(this,$);}return $.downloadDataURL=function(G){var Z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'photoeditorsdk-export',Y=this.createBlobURLFromDataURL(G),J=this.getExtensionFromDataURL(G),X=document.createElement('a');X.download=Z+'.'+J,X.href=Y,document.body.appendChild(X),X.click(),document.body.removeChild(X);},$.downloadMSBlob=function(G){var Z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'photoeditorsdk-export';navigator.msSaveBlob(G,Z+'.png');},$.getExtensionFromDataURL=function(G){var Z=G.split(',')[0].split(':')[1].split(';')[0];return Z.split('/').pop();},$.createBlobURLFromDataURL=function(G){if(!window.Blob||!window.URL||!ArrayBuffer||!Uint8Array)return G;for(var Z=N.Base64.decode(G.split(',')[1]),Y=G.split(',')[0].split(':')[1].split(';')[0],J=new ArrayBuffer(Z.length),X=new Uint8Array(J),Q=0;Q<Z.length;Q++)X[Q]=Z[Q];var ee=new window.Blob([J],{type:Y});return window.URL.createObjectURL(ee);},$;}();R.default=W;},function(M,R,I){"use strict";function L(Y){return Y&&Y.__esModule?Y:{default:Y};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=function(Y){function J(X){(0,U.default)(this,J);var Q=(0,W.default)(this,Y.call(this));return Q._input=X,Q._onFileChange=Q._onFileChange.bind(Q),Q._input.addEventListener('change',Q._onFileChange),Q;}return(0,H.default)(J,Y),J.prototype.open=function(){this._input.value=null,this._input.click();},J.prototype._handleFile=function(Q){var ee=this,te=new window.FileReader();te.onload=function(){return function(oe){var re=oe.target.result,ne=new window.Image();ne.addEventListener('load',function(){ee.emit('file',ne);}),ne.src=re;};}(Q),te.readAsDataURL(Q);},J.prototype._onFileChange=function(){var Q=this._input.files;Q.length&&this._handleFile(Q[0]);},J.prototype.dispose=function(){this._input.removeEventListener('change',this._onFileChange);},J;}(G.EventEmitter);R.default=Z;},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function(W){return W&&W.__esModule?W:{default:W};}(V),N=function(){function W(){(0,U.default)(this,W),this._fonts=[];}return W.prototype.add=function(H){this._fonts.push(H);},W.prototype.load=function(){},W;}();R.default=N;},function(M,R,I){"use strict";function L(te){return te&&te.__esModule?te:{default:te};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(184),Z=L(G),Y=I(186),J=L(Y),X='undefined'!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):I(89),Q={italic:'i'},ee=function(te){function oe(){return(0,U.default)(this,oe),(0,W.default)(this,te.apply(this,arguments));}return(0,H.default)(oe,te),oe.prototype.load=function(){var ne=this;return 0===this._fonts.length?Promise.resolve():(this._defaultFontRuler=new J.default(),this._customFontRulers=[],this._addStylesheetTag(),this._fonts.forEach(function(ie){var se=new J.default();se.setFont(ie),ne._customFontRulers.push(se);}),this._waitForLoadPromise());},oe.prototype._waitForLoadPromise=function(){var ie=this;this._startedAt=X();var se=this._customFontRulers.map(function(le){return ie._waitForLoad(le).then(function(){le.dispose();});});return Promise.all(se).then(function(){ie.dispose();}).catch(function(le){throw ie.dispose(),le;});},oe.prototype._waitForLoad=function(ne){var ie=this;return new Promise(function(se,le){(function pe(){var ce=ie._checkWidthChanged(ne);return ce?se():5e3<=X()-ie._startedAt?le(new Error('Font loading timed out.')):void setTimeout(pe,50);})();});},oe.prototype._checkWidthChanged=function(ne){return this._defaultFontRuler.getWidth()!==ne.getWidth();},oe.prototype._addStylesheetTag=function(){var ne=this._getFamiliesString(),ie=document.createElement('link');ie.rel='stylesheet',ie.href='https://fonts.googleapis.com/css?family='+ne;var se=document.getElementsByTagName('head')[0];se.appendChild(ie);},oe.prototype._getFamiliesString=function(){var ne={};this._fonts.forEach(function(ce){var ue=ce.getFontFamily(),me=ce.getFontStyle(),fe=ce.getFontWeight();ne[ue]=ne[ue]||[],'undefined'==typeof fe?ne[ue].push(400):ne[ue].push(''+fe+(Q[me]||''));});var ie=[];for(var se in ne){var le=ne[se],de=le.length?':'+le.join(','):'',pe=se.replace(' ','+')+de;ie.push(pe);}return ie.join('|');},oe.prototype.dispose=function(){this._defaultFontRuler&&this._defaultFontRuler.dispose(),this._customFontRulers.forEach(function(ne){ne.dispose();});},oe;}(Z.default);R.default=ee;},function(M,R,I){"use strict";function L(Z){return Z&&Z.__esModule?Z:{default:Z};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(70),W=L(N),G=function(){function Z(){(0,U.default)(this,Z),this._font=new W.default({fontFamily:'Times New Roman',fontWeight:'normal',fontStyle:'normal'}),this._createRuler();}return Z.prototype._createRuler=function(){this._ruler=document.createElement('div'),this._ruler.innerText='abcdefghijklmnopqrstuvwxzy',document.body.appendChild(this._ruler),this._setRulerStyle();},Z.prototype._setRulerStyle=function(){this._ruler.style.cssText='\n      position: absolute;\n      top: -9999px;\n      left: -9999px;\n      display: inline-block;\n      font: '+this._font.getFontStyle()+' '+this._font.getFontWeight()+' '+30+'px '+this._font.getFontFamily()+';\n    ';},Z.prototype.setFont=function(J){this._font=J,this._setRulerStyle();},Z.prototype.getWidth=function(){return this._ruler.offsetWidth;},Z.prototype.dispose=function(){this._ruler&&(this._ruler.parentNode.removeChild(this._ruler),this._ruler=null);},Z;}();R.default=G;},function(M,R,I){"use strict";function L(J){return J&&J.__esModule?J:{default:J};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=G.SDK.OptionType,Y=function(J){function X(Q){var ee=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(0,U.default)(this,X);var te=(0,W.default)(this,J.call(this,ee));return te._loaded=!1,te._loading=!1,te._ui=Q,te._frame=G.SDK.Utils.deepDefaults(te._options,{}),te;}return(0,H.default)(X,J),X.prototype.load=function(){var ee=this;if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error('Called Frame#load while it\'s already loading'));this._loading=!0;var te=this._options.imageGroups,oe=[];return['top','left','right','bottom'].forEach(function(re){if(re in te){var ne=te[re];['start','mid','end'].forEach(function(ie){ie in ne&&oe.push(ee._loadPart(re,ie));});}}),Promise.all(oe).then(function(){ee._loaded=!0,ee._loading=!1;}).catch(function(){ee._loaded=!1,ee._loading=!1;});},X.prototype._loadPart=function(ee,te){var oe=this;return new Promise(function(re,ne){var ie=oe._options.imageGroups,se=ie[ee][te],le=se;'string'!=typeof se&&'image'in se&&(le=se.image);var de=new window.Image();de.addEventListener('load',function(){'string'==typeof se?oe._frame.imageGroups[ee][te]=de:oe._frame.imageGroups[ee][te].image=de,re(de);}),de.addEventListener('error',function(){ne(new Error('Failed to load image at '+le));}),de.crossOrigin='Anonymous',de.src=oe._ui.getAssetPath(le);});},X.prototype.getFrame=function(){return this._frame;},X;}(G.SDK.Configurable);R.default=Y,Y.prototype.availableOptions={name:{type:Z.STRING,required:!0},label:{type:Z.STRING},icon:{type:Z.STRING},tintable:{type:Z.BOOLEAN,default:!1},layoutMode:{type:Z.STRING,default:'horizontal-inside',available:['horizontal-inside','vertical-inside']},imageGroups:{type:Z.OBJECT,required:!0}};},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function($){return $&&$.__esModule?$:{default:$};}(V),N=I(1),W=function(){function $(H,G,Z){(0,U.default)(this,$),this._image=H,this._maxPixels=G,this._maxDimensions=Z;}return $.prototype.needsResize=function(){var G=new N.Vector2(this._image.width,this._image.height),Z=G.x*G.y,Y=Z>this._maxPixels,J=null!==this._maxDimensions&&(G.x>this._maxDimensions||G.y>this._maxDimensions);return Y||J;},$.prototype.resize=function(){var G=this,Z=null,Y=null,J=this._maxDimensions;return new N.Promise(function(X){window.setTimeout(function(){var ee=new N.Vector2(G._image.width,G._image.height),te=ee.clone();if(te.x*te.y>G._maxPixels&&(te.copy(G._getDimensionsByMaxPixels()),Z='maxMegaPixels'),null!==J&&(te.x>J||te.y>J)){var oe=Math.min(J/te.x,J/te.y);te.multiply(oe),Z='maxDimensions';}te.floor(),Y=G._createResizedImageCanvas(te),X({canvas:Y,dimensions:te,reason:Z});},1e3);});},$.prototype._createResizedImageCanvas=function(G){var Z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:G,Y=this._image,J=document.createElement('canvas');J.width=G.x,J.height=G.y;var X=G.clone().subtract(Z).divide(2),Q=J.getContext('2d');return Q.drawImage(Y,0,0,Y.width,Y.height,X.x,X.y,Z.x,Z.y),J;},$.prototype._getDimensionsByMaxPixels=function(){var G=this._image,Z=this._maxPixels,Y=G.width/G.height,J=G.height/G.width;return new N.Vector2(Math.sqrt(Z*Y),Math.sqrt(Z*J)).floor();},$;}();R.default=W;},function(M,R,I){"use strict";function L(G){return G&&G.__esModule?G:{default:G};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(1),W=I(70),$=L(W),H=function(){function G(Z){(0,U.default)(this,G),this._options=Z,this._fonts=[],this._initFonts();}return G.prototype._initFonts=function(){var Y=this._options,J=Y.additionalFonts,X=Y.replaceFonts,Q=Y.selectableFonts;J=J||[];var ee=N.Constants.DEFAULTS.FONTS;ee=X?J:ee.concat(J),Q&&Q.length&&(ee=N.Utils.select(ee,Q,function(oe){return oe.name;})),ee=ee.map(function(oe){return new $.default(oe);});var te=null;ee.forEach(function(oe){!te&&oe.default&&(te=oe);}),te||(te=ee[0]),this._defaultFont=te,this._fonts=ee;},G.prototype.getFonts=function(){return this._fonts;},G.prototype.getDefaultFont=function(){return this._defaultFont;},G;}();R.default=H;},function(M,R,I){"use strict";function L(G){return G&&G.__esModule?G:{default:G};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(1),W=I(187),$=L(W),H=function(){function G(Z,Y){(0,U.default)(this,G),this._ui=Z,this._options=Y,this._initFrames();}return G.prototype._initFrames=function(){var Y=this,J=this._options,X=J.additionalFrames,Q=J.replaceFrames,ee=J.selectableFrames;X=X||[];var te=N.Constants.DEFAULTS.FRAMES;te=Q?X:te.concat(X),ee&&ee.length&&(te=N.Utils.select(te,ee,function(re){return re.name;})),te=te.map(function(re){return new $.default(Y._ui,re);});var oe=null;te.forEach(function(re){!oe&&re.default&&(oe=re);}),oe||(oe=te[0]),this._defaultFrame=oe,this._frames=te;},G.prototype.getFrames=function(){return this._frames;},G.prototype.getDefaultFrame=function(){return this._defaultFrame;},G;}();R.default=H;},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function(W){return W&&W.__esModule?W:{default:W};}(V);R.default=function W($){(0,U.default)(this,W),this.name=$.name,this.coverImage=$.coverImage;};},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function(W){return W&&W.__esModule?W:{default:W};}(V);R.default=function W($,H){(0,U.default)(this,W),this.library=$,this.title=H.title,this.urls=H.urls;};},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function($){return $&&$.__esModule?$:{default:$};}(V),N=I(1),W=function(){function $(){(0,U.default)(this,$);}return $.prototype.getLibraries=function(){return N.Log.warn(this.constructor.name,'`getLibraries` is abstract and not implemented.'),N.Promise.resolve([]);},$.prototype.getSearchSuggestions=function(){return N.Log.warn(this.constructor.name,'`getSearchSuggestions` is abstract and not implemented.'),N.Promise.resolve([]);},$.prototype.getPhotosForLibrary=function(){return N.Log.warn(this.constructor.name,'`getPhotosForLibrary` is abstract and not implemented.'),N.Promise.resolve([]);},$.prototype.searchPhotos=function(){return N.Log.warn(this.constructor.name,'`searchPhotos` is abstract and not implemented.'),N.Promise.resolve([]);},$;}();R.default=W;},function(M,R,I){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=function(W){return W&&W.__esModule?W:{default:W};}(V);R.default=function W($){(0,U.default)(this,W),this.query=$.query,this.name=this.query,this.coverImage=$.coverImage;};},function(M,R,I){"use strict";function L(Q){return Q&&Q.__esModule?Q:{default:Q};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(69),Y=L(Z),X=function(Q){function ee(te,oe,re){(0,U.default)(this,ee);var ne=(0,W.default)(this,Q.call(this));return ne._ui=te,ne._options=oe,ne._mediator=re,ne._editor=new Y.default(te,oe,re,!0),ne._assets=['controls/back.png','controls/minus.png','controls/plus.png','controls/tick.png','controls/webcam/shutter.png','controls/knobs/remove.png','controls/knobs/resize-diagonal-down.png','controls/knobs/resize-diagonal-up.png','controls/knobs/rotate.png','editor/export.png','editor/new.png','editor/undo.png',['splash/photo-roll.png',!1],['splash/webcam.png',!1],'top-bar/back.png','close.png'],ne._appendControlsAssets(),ne;}return(0,H.default)(ee,Q),ee.prototype._appendControlsAssets=function(){var oe=this._editor.controls.getAvailable();for(var re in oe){var ne=oe[re];this._editor.controls.isEnabled(re)&&(this._assets=this._assets.concat(ne.getPreloadAssets(this._editor)),this._assets.push(ne.iconPath));}},ee.prototype.load=function(){var oe=this,re=this._assets.slice(),ne=re.length,ie=0,se=function(){ie++,oe.emit('progress',ie/ne),ie===ne&&oe.emit('done');},le=function(ce){var ue=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'timed out';G.Log.warn('Preloader',ce+' '+ue+'.'),se();},de=function(ce){return window.setTimeout(function(){le(ce);},5e3);};re.forEach(function(pe){var ce=!0;G.SDKUtils.isArray(pe)&&(ce=pe[1],pe=pe[0]);var ue=oe._ui.getAssetPath(pe,!0,!ce),me=new window.Image(),fe=de(ue);me.addEventListener('load',function(){window.clearTimeout(fe),se();}),me.addEventListener('error',function(){window.clearTimeout(fe),le(ue,'was not found');}),me.crossOrigin='Anonymous',me.src=ue;});},ee;}(G.EventEmitter);R.default=X;},function(M,R,I){"use strict";function L(Z){return Z&&Z.__esModule?Z:{default:Z};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(74),W=L(N),$=I(73),H=L($),G=function(){function Z(Y){(0,U.default)(this,Z),this._editor=Y;}return Z.prototype.serialize=function(){var J=new W.default(this._editor);return J.serialize.apply(J,arguments);},Z.prototype.deserialize=function(J){var X=new H.default(this._editor,J);return X.deserialize();},Z;}();R.default=G,G.version='1.0.0';},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(73),Y=L(Z),J=function(X){function Q(){return(0,U.default)(this,Q),(0,W.default)(this,X.apply(this,arguments));}return(0,H.default)(Q,X),Q.prototype._validateVersion=function(){return'1.0.1'===this._data.version?Promise.resolve():Promise.reject(new Error('Invalid version '+this._data.version+', expected 1.0.1'));},Q.prototype._deserializeOperations=function(){var te=this,oe=this._data.operations.map(function(re){switch(re.type){case'crop':return te._deserializeCropOperation(re);case'orientation':return te._deserializeOrientationOperation(re);case'filter':return te._deserializeFilterOperation(re);case'adjustments':return te._deserializeAdjustmentsOperation(re);case'sprite':return te._deserializeSpriteOperation(re);case'focus':return te._deserializeFocusOperation(re);case'selective-blur':return te._deserializeSelectiveBlurOperation(re);}});return Promise.all(oe);},Q.prototype._deserializeCropOperation=function(te){var oe=te.options,re=oe.scale,ne=oe.rotation,ie=G.Vector2.fromObject(oe.start),se=G.Vector2.fromObject(oe.end);return ne>Math.PI&&(ne-=2*Math.PI),this._editor.operations.getOrCreate('crop',{start:ie,end:se,scale:re,rotation:ne}),Promise.resolve();},Q;}(Y.default);R.default=J;},function(M,R,I){"use strict";function L(Z){return Z&&Z.__esModule?Z:{default:Z};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(199),W=L(N),$=I(197),H=L($),G=function(){function Z(Y){(0,U.default)(this,Z),this._editor=Y;}return Z.prototype.serialize=function(){var J=new W.default(this._editor);return J.serialize.apply(J,arguments);},Z.prototype.deserialize=function(J){var X=new H.default(this._editor,J);return X.deserialize();},Z;}();R.default=G,G.version='1.0.1';},function(M,R,I){"use strict";function L(Q){return Q&&Q.__esModule?Q:{default:Q};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(0),U=L(V),N=I(3),W=L(N),$=I(2),H=L($),G=I(1),Z=I(74),Y=L(Z),J=2*Math.PI,X=function(Q){function ee(){return(0,U.default)(this,ee),(0,W.default)(this,Q.apply(this,arguments));}return(0,H.default)(ee,Q),ee.prototype.serialize=function(){var oe=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._options=G.SDKUtils.defaults(oe,{image:!0});return this._serializeInputImage({version:'1.0.1'}).then(this._serializeOperations);},ee.prototype._serializeOperation=function(oe){switch(oe.constructor.identifier){case'crop':return this._serializeCropOperation(oe);case'orientation':return this._serializeOrientationOperation(oe);case'filter':return this._serializeFilterOperation(oe);case'adjustments':return this._serializeAdjustmentsOperation(oe);case'sprite':return this._serializeSpriteOperation(oe);case'radial-focus':return this._serializeRadialFocusOperation(oe);case'linear-focus':return this._serializeLinearFocusOperation(oe);case'selective-blur':return this._serializeSelectiveBlurOperation(oe);default:throw new Error('Unable to serialize operation of type '+oe.constructor.identifier);}},ee.prototype._serializeCropOperation=function(oe){var re=oe.serializeOptions(['start','end','rotation','scale','textureScale'],!0);return re.rotation=(re.rotation+J)%J,delete re.textureScale,{type:'crop',options:re};},ee;}(Y.default);R.default=X;},function(M,R,I){"use strict";function L(te){return te&&te.__esModule?te:{default:te};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(33),U=L(V),N=I(0),W=L(N),$=I(3),H=L($),G=I(2),Z=L(G),Y=I(29),J=L(Y),X=J.default.EventEmitter,Q=J.default.Utils,ee=function(te){function oe(){var re=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(0,W.default)(this,oe);var ne=(0,H.default)(this,te.call(this));return ne._state=re,ne;}return(0,Z.default)(oe,te),oe.prototype.set=function(){var ne=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},ie=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0;'object'!==('undefined'==typeof ne?'undefined':(0,U.default)(ne))&&console&&console.trace('SharedState#set expects an object as first parameter');var se=Q.extend({},this._state);this._state=Q.extend(this._state,ne),ie&&this.broadcastUpdate(se,this._state);},oe.prototype.get=function(ne){return this._state[ne];},oe.prototype.broadcastUpdate=function(ne){var ie=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.emit('update',ne,ie);},oe.prototype.clear=function(){this._state={};},oe;}(X);R.default=ee;},function(M,R,I){"use strict";function L(X){return X&&X.__esModule?X:{default:X};}Object.defineProperty(R,"__esModule",{value:!0});var V=I(29),U=L(V),N=I(75),W=L(N),$=I(202),H=L($),G=I(37),Z=L(G),Y=U.default.Math.Vector2,J={getInnerDimensionsForElement:function(Q){var ee=new Y(Q.offsetWidth,Q.offsetHeight),te=window.getComputedStyle(Q,null);return ee.x-=parseInt(te.getPropertyValue('padding-left'),10),ee.x-=parseInt(te.getPropertyValue('padding-right'),10),ee.y-=parseInt(te.getPropertyValue('padding-top'),10),ee.y-=parseInt(te.getPropertyValue('padding-bottom'),10),ee;},getEventPosition:function(Q){var ee=Q.clientX,te=Q.clientY;if(-1!==Q.type.indexOf('touch')){if(!Q.touches.length)return;ee=Q.touches[0].clientX,te=Q.touches[0].clientY;}return new Y(ee,te);},createTransparentPatternCanvas:function(){var Q=document.createElement('canvas'),ee=Q.getContext('2d');return Q.width=10,Q.height=10,ee.fillStyle='white',ee.fillRect(0,0,Q.width,Q.height),ee.fillStyle='#cccccc',ee.fillRect(0,0,Q.width/2,Q.height/2),ee.fillRect(Q.width/2,Q.height/2,Q.width,Q.height),Q;},supportsMSBlob:function(){var Q=document.createElement('canvas');return'undefined'!=typeof Q.msToBlob;},translate:function(Q,ee){var te=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},oe=this.fetch(Q,ee);if(!oe)return W.default.warn('Utils#translate','Unable to translate `'+ee+'`'),ee;for(var re in te)oe=oe.replace('${'+re+'}',te[re]);return oe;},fetch:function(Q,ee){ee=ee.replace(/\[(\w+)]/g,'.$1'),ee=ee.replace(/^\./,'');for(var oe=ee.split('.'),re=0,ne;re<oe.length&&(ne=oe[re],Q=Q[ne],!!Q);re++);return'undefined'!=typeof Q&&Q;},isMobile:function(){var Q=navigator.userAgent||navigator.vendor||window.opera;return /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(Q)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(Q.substr(0,4));},isTouchDevice:function(){return!!('ontouchstart'in window||window.DocumentTouch&&document instanceof window.DocumentTouch);},select:function(Q,ee){var te=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;te||(te=function(ne){return ne;});var oe=[];return ee.forEach(function(re){Q.forEach(function(ne){var ie=te(ne);ie===re&&oe.push(ne);});}),oe;},getJSONP:function(Q){var ee=new Z.default(Q);return ee.load();},mergeCategories:function(Q,ee,te){Q=Q.slice(0);var oe=null;return ee.forEach(function(re){Q.forEach(function(ne){re.name===ne.name&&(oe=ne);}),oe?oe[te]=oe[te].concat(re[te]):Q.push(re);}),Q;},getStyleObject:function(Q){var ee=window.getComputedStyle(Q),te={};for(var oe in ee){var re=ee.getPropertyValue(oe),ne=oe.replace(/-([a-z])/g,function(ie,se){return se.toUpperCase();});''!==re&&(te[ne]=re);}return te;},debounce:function(Q,ee,te){var oe;return function(){var re=this,ne=arguments,se=te&&!oe;clearTimeout(oe),oe=setTimeout(function(){oe=null,te||Q.apply(re,ne);},ee),se&&Q.apply(this,ne);};},getScrollbarWidth:function(){var Q=document.createElement('div');Q.style.visibility='hidden',Q.style.width='100px',Q.style.msOverflowStyle='scrollbar',document.body.appendChild(Q);var ee=Q.offsetWidth;Q.style.overflow='scroll';var te=document.createElement('div');te.style.width='100%',Q.appendChild(te);var oe=te.offsetWidth;return Q.parentNode.removeChild(Q),ee-oe;},Browser:H.default};R.default=J;},function(M,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default={getIEVersion:function(){var L=navigator,V=L.userAgent,U=L.appVersion;return-1===U.indexOf('MSIE')?-1!==V.indexOf('Trident')&&V.match(/rv:([0-9]+)/i)[1]:U.match(/MSIE\s+?([0-9]+)/i)[1];},isIE10:function(){var L=this.getIEVersion();return!1!==L&&10===L;},isIE11:function(){var L=this.getIEVersion();return!1!==L&&11===L;},isIElte:function(L){var V=this.getIEVersion();return!1!==V&&V<=L;}};},function(M,R,I){"use strict";(function(L){Object.defineProperty(R,"__esModule",{value:!0});/*
 * http://paulirish.com/2011/requestanimationframe-for-smart-animating/
 * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
 * requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel
 * MIT license
 * @license
 */for(var V='undefined'==typeof window?L:window,U=V.requestAnimationFrame,N=V.cancelAnimationFrame,W=0,$=['ms','moz','webkit','o'],H=0;H<$.length&&!U;++H)R.requestAnimationFrame=U=V[$[H]+'RequestAnimationFrame'],R.cancelAnimationFrame=N=V[$[H]+'CancelAnimationFrame']||V[$[H]+'CancelRequestAnimationFrame'];U||(R.requestAnimationFrame=U=function(Z){var J=new Date().getTime(),X=Math.max(0,16-(J-W)),Q=setTimeout(function(){Z(J+X);},X);return W=J+X,Q;}),N||(R.cancelAnimationFrame=N=function(Z){clearTimeout(Z);}),R.requestAnimationFrame=U,R.cancelAnimationFrame=N;}).call(R,I(91));},function(M,R,I){M.exports={default:I(214),__esModule:!0};},function(M,R,I){M.exports={default:I(215),__esModule:!0};},function(M,R,I){M.exports={default:I(216),__esModule:!0};},function(M,R,I){M.exports={default:I(217),__esModule:!0};},function(M,R,I){M.exports={default:I(218),__esModule:!0};},function(M,R,I){M.exports={default:I(220),__esModule:!0};},function(M,R,I){M.exports={default:I(221),__esModule:!0};},function(M,R,I){M.exports={default:I(222),__esModule:!0};},function(M,R,I){"use strict";function L($){return $&&$.__esModule?$:{default:$};}R.__esModule=!0;var V=I(206),U=L(V),N=I(205),W=L(N);R.default=function(){function $(H,G){var Z=[],Y=!0,J=!1,X;try{for(var Q=(0,W.default)(H),ee;!(Y=(ee=Q.next()).done)&&(Z.push(ee.value),!(G&&Z.length===G));Y=!0);}catch(te){J=!0,X=te;}finally{try{!Y&&Q["return"]&&Q["return"]();}finally{if(J)throw X;}}return Z;}return function(H,G){if(Array.isArray(H))return H;if((0,U.default)(Object(H)))return $(H,G);throw new TypeError("Invalid attempt to destructure non-iterable instance");};}();},function(M,R,I){"use strict";R.__esModule=!0;var V=I(204),U=function(N){return N&&N.__esModule?N:{default:N};}(V);R.default=function(N){if(Array.isArray(N)){for(var W=0,$=Array(N.length);W<N.length;W++)$[W]=N[W];return $;}return(0,U.default)(N);};},function(M,R,I){I(36),I(246),M.exports=I(9).Array.from;},function(M,R,I){I(60),I(36),M.exports=I(244);},function(M,R,I){I(60),I(36),M.exports=I(245);},function(M,R,I){I(248),M.exports=I(9).Object.assign;},function(M,R,I){I(249);var L=I(9).Object;M.exports=function(U,N){return L.create(U,N);};},function(M,R,I){I(250);var L=I(9).Object;M.exports=function(U,N,W){return L.defineProperty(U,N,W);};},function(M,R,I){I(251),M.exports=I(9).Object.setPrototypeOf;},function(M,R,I){I(253),I(252),I(254),I(255),M.exports=I(9).Symbol;},function(M,R,I){I(36),I(60),M.exports=I(59).f('iterator');},function(M){M.exports=function(I){if('function'!=typeof I)throw TypeError(I+' is not a function!');return I;};},function(M){M.exports=function(){};},function(M,R,I){var L=I(19),V=I(87),U=I(243);M.exports=function(N){return function(W,$,H){var G=L(W),Z=V(G.length),Y=U(H,Z),J;if(N&&$!=$){for(;Z>Y;)if(J=G[Y++],J!=J)return!0;}else for(;Z>Y;Y++)if((N||Y in G)&&G[Y]===$)return N||Y||0;return!N&&-1;};};},function(M,R,I){"use strict";var L=I(14),V=I(28);M.exports=function(U,N,W){N in U?L.f(U,N,V(0,W)):U[N]=W;};},function(M,R,I){var L=I(27),V=I(51),U=I(34);M.exports=function(N){var W=L(N),$=V.f;if($)for(var H=$(N),G=U.f,Z=0,Y;H.length>Z;)G.call(N,Y=H[Z++])&&W.push(Y);return W;};},function(M,R,I){var L=I(13).document;M.exports=L&&L.documentElement;},function(M,R,I){var L=I(23),V=I(10)('iterator'),U=Array.prototype;M.exports=function(N){return N!==void 0&&(L.Array===N||U[V]===N);};},function(M,R,I){var L=I(45);M.exports=Array.isArray||function(U){return'Array'==L(U);};},function(M,R,I){var L=I(15);M.exports=function(V,U,N,W){try{return W?U(L(N)[0],N[1]):U(N);}catch(H){var $=V['return'];throw void 0!==$&&L($.call(V)),H;}};},function(M,R,I){"use strict";var L=I(50),V=I(28),U=I(52),N={};I(22)(N,I(10)('iterator'),function(){return this;}),M.exports=function(W,$,H){W.prototype=L(N,{next:V(1,H)}),U(W,$+' Iterator');};},function(M,R,I){var L=I(10)('iterator'),V=!1;try{var U=[7][L]();U['return']=function(){V=!0;},Array.from(U,function(){throw 2;});}catch(N){}M.exports=function(N,W){if(!W&&!V)return!1;var $=!1;try{var H=[7],G=H[L]();G.next=function(){return{done:$=!0};},H[L]=function(){return G;},N(H);}catch(Z){}return $;};},function(M){M.exports=function(I,L){return{value:L,done:!!I};};},function(M,R,I){var L=I(27),V=I(19);M.exports=function(U,N){for(var W=V(U),$=L(W),H=$.length,G=0,Z;H>G;)if(W[Z=$[G++]]===N)return Z;};},function(M,R,I){var L=I(35)('meta'),V=I(26),U=I(18),N=I(14).f,W=0,$=Object.isExtensible||function(){return!0;},H=!I(25)(function(){return $(Object.preventExtensions({}));}),G=function(Q){N(Q,L,{value:{i:'O'+ ++W,w:{}}});},X=M.exports={KEY:L,NEED:!1,fastKey:function(Q,ee){if(!V(Q))return'symbol'==typeof Q?Q:('string'==typeof Q?'S':'P')+Q;if(!U(Q,L)){if(!$(Q))return'F';if(!ee)return'E';G(Q);}return Q[L].i;},getWeak:function(Q,ee){if(!U(Q,L)){if(!$(Q))return!0;if(!ee)return!1;G(Q);}return Q[L].w;},onFreeze:function(Q){return H&&X.NEED&&$(Q)&&!U(Q,L)&&G(Q),Q;}};},function(M,R,I){"use strict";var L=I(27),V=I(51),U=I(34),N=I(56),W=I(81),$=Object.assign;M.exports=!$||I(25)(function(){var H={},G={},Z=Symbol(),Y='abcdefghijklmnopqrst';return H[Z]=7,Y.split('').forEach(function(J){G[J]=J;}),7!=$({},H)[Z]||Object.keys($({},G)).join('')!=Y;})?function(G){for(var Y=N(G),J=arguments.length,X=1,Q=V.f,ee=U.f;J>X;)for(var te=W(arguments[X++]),oe=Q?L(te).concat(Q(te)):L(te),re=oe.length,ne=0,ie;re>ne;)ee.call(te,ie=oe[ne++])&&(Y[ie]=te[ie]);return Y;}:$;},function(M,R,I){var L=I(14),V=I(15),U=I(27);M.exports=I(16)?Object.defineProperties:function(W,$){V(W);for(var H=U($),G=H.length,Z=0,Y;G>Z;)L.f(W,Y=H[Z++],$[Y]);return W;};},function(M,R,I){var L=I(19),V=I(84).f,U={}.toString,N='object'==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],W=function($){try{return V($);}catch(H){return N.slice();}};M.exports.f=function(H){return N&&'[object Window]'==U.call(H)?W(H):V(L(H));};},function(M,R,I){var L=I(18),V=I(56),U=I(53)('IE_PROTO'),N=Object.prototype;M.exports=Object.getPrototypeOf||function(W){return W=V(W),L(W,U)?W[U]:'function'==typeof W.constructor&&W instanceof W.constructor?W.constructor.prototype:W instanceof Object?N:null;};},function(M,R,I){var L=I(26),V=I(15),U=function(N,W){if(V(N),!L(W)&&null!==W)throw TypeError(W+": can't set as prototype!");};M.exports={set:Object.setPrototypeOf||('__proto__'in{}?function(N,W,$){try{$=I(46)(Function.call,I(83).f(Object.prototype,'__proto__').set,2),$(N,[]),W=!(N instanceof Array);}catch(H){W=!0;}return function(G,Z){return U(G,Z),W?G.__proto__=Z:$(G,Z),G;};}({},!1):void 0),check:U};},function(M,R,I){var L=I(55),V=I(47);M.exports=function(U){return function(N,W){var $=V(N)+'',H=L(W),G=$.length,Z,Y;return 0>H||H>=G?U?'':void 0:(Z=$.charCodeAt(H),0xd800>Z||0xdbff<Z||H+1===G||0xdc00>(Y=$.charCodeAt(H+1))||0xdfff<Y?U?$.charAt(H):Z:U?$.slice(H,H+2):(Z-0xd800<<10)+(Y-0xdc00)+0x10000);};};},function(M,R,I){var L=I(55),V=Math.max,U=Math.min;M.exports=function(N,W){return N=L(N),0>N?V(N+W,0):U(N,W);};},function(M,R,I){var L=I(15),V=I(88);M.exports=I(9).getIterator=function(U){var N=V(U);if('function'!=typeof N)throw TypeError(U+' is not iterable!');return L(N.call(U));};},function(M,R,I){var L=I(78),V=I(10)('iterator'),U=I(23);M.exports=I(9).isIterable=function(N){var W=Object(N);return W[V]!==void 0||'@@iterator'in W||U.hasOwnProperty(L(W));};},function(M,R,I){"use strict";var L=I(46),V=I(17),U=I(56),N=I(231),W=I(229),$=I(87),H=I(226),G=I(88);V(V.S+V.F*!I(233)(function(Z){Array.from(Z);}),'Array',{from:function(Y){var J=U(Y),X='function'==typeof this?this:Array,Q=arguments.length,ee=1<Q?arguments[1]:void 0,te=void 0!==ee,oe=0,re=G(J),ne,ie,se,le;if(te&&(ee=L(ee,2<Q?arguments[2]:void 0,2)),void 0!=re&&!(X==Array&&W(re)))for(le=re.call(J),ie=new X();!(se=le.next()).done;oe++)H(ie,oe,te?N(le,ee,[se.value,oe],!0):se.value);else for(ne=$(J.length),ie=new X(ne);ne>oe;oe++)H(ie,oe,te?ee(J[oe],oe):J[oe]);return ie.length=oe,ie;}});},function(M,R,I){"use strict";var L=I(224),V=I(234),U=I(23),N=I(19);M.exports=I(82)(Array,'Array',function(W,$){this._t=N(W),this._i=0,this._k=$;},function(){var W=this._t,$=this._k,H=this._i++;return!W||H>=W.length?(this._t=void 0,V(1)):'keys'==$?V(0,H):'values'==$?V(0,W[H]):V(0,[H,W[H]]);},'values'),U.Arguments=U.Array,L('keys'),L('values'),L('entries');},function(M,R,I){var L=I(17);L(L.S+L.F,'Object',{assign:I(237)});},function(M,R,I){var L=I(17);L(L.S,'Object',{create:I(50)});},function(M,R,I){var L=I(17);L(L.S+L.F*!I(16),'Object',{defineProperty:I(14).f});},function(M,R,I){var L=I(17);L(L.S,'Object',{setPrototypeOf:I(241).set});},function(){},function(M,R,I){"use strict";var L=I(13),V=I(18),U=I(16),N=I(17),W=I(86),$=I(236).KEY,H=I(25),G=I(54),Z=I(52),Y=I(35),J=I(10),X=I(59),Q=I(58),ee=I(235),te=I(227),oe=I(230),re=I(15),ne=I(19),ie=I(57),se=I(28),le=I(50),de=I(239),pe=I(83),ce=I(14),ue=I(27),me=pe.f,fe=ce.f,ge=de.f,he=L.Symbol,ye=L.JSON,be=ye&&ye.stringify,Ee='prototype',Se=J('_hidden'),ve=J('toPrimitive'),Me={}.propertyIsEnumerable,Ce=G('symbol-registry'),Re=G('symbols'),Be=G('op-symbols'),xe=Object[Ee],ke='function'==typeof he,De=L.QObject,Pe=!De||!De[Ee]||!De[Ee].findChild,Te=U&&H(function(){return 7!=le(fe({},'a',{get:function(){return fe(this,'a',{value:7}).a;}})).a;})?function(He,je,qe){var Ge=me(xe,je);Ge&&delete xe[je],fe(He,je,qe),Ge&&He!==xe&&fe(xe,je,Ge);}:fe,Oe=function(He){var je=Re[He]=le(he[Ee]);return je._k=He,je;},we=ke&&'symbol'==typeof he.iterator?function(He){return'symbol'==typeof He;}:function(He){return He instanceof he;},Fe=function(je,qe,Ge){return je===xe&&Fe(Be,qe,Ge),re(je),qe=ie(qe,!0),re(Ge),V(Re,qe)?(Ge.enumerable?(V(je,Se)&&je[Se][qe]&&(je[Se][qe]=!1),Ge=le(Ge,{enumerable:se(0,!1)})):(!V(je,Se)&&fe(je,Se,se(1,{})),je[Se][qe]=!0),Te(je,qe,Ge)):fe(je,qe,Ge);},Ae=function(je,qe){re(je);for(var Ge=te(qe=ne(qe)),Ze=0,Ye=Ge.length,Je;Ye>Ze;)Fe(je,Je=Ge[Ze++],qe[Je]);return je;},ze=function(je){var qe=Me.call(this,je=ie(je,!0));return this===xe&&V(Re,je)&&!V(Be,je)?!1:qe||!V(this,je)||!V(Re,je)||V(this,Se)&&this[Se][je]?qe:!0;},Le=function(je,qe){if(je=ne(je),qe=ie(qe,!0),je!==xe||!V(Re,qe)||V(Be,qe)){var Ge=me(je,qe);return Ge&&V(Re,qe)&&!(V(je,Se)&&je[Se][qe])&&(Ge.enumerable=!0),Ge;}},Ve=function(je){for(var qe=ge(ne(je)),Ge=[],Ze=0,Ye;qe.length>Ze;)V(Re,Ye=qe[Ze++])||Ye==Se||Ye==$||Ge.push(Ye);return Ge;},Ue=function(je){for(var qe=je===xe,Ge=ge(qe?Be:ne(je)),Ze=[],Ye=0,Je;Ge.length>Ye;)V(Re,Je=Ge[Ye++])&&(!qe||V(xe,Je))&&Ze.push(Re[Je]);return Ze;};ke||(he=function(){if(this instanceof he)throw TypeError('Symbol is not a constructor!');var je=Y(0<arguments.length?arguments[0]:void 0),qe=function(Ge){this===xe&&qe.call(Be,Ge),V(this,Se)&&V(this[Se],je)&&(this[Se][je]=!1),Te(this,je,se(1,Ge));};return U&&Pe&&Te(xe,je,{configurable:!0,set:qe}),Oe(je);},W(he[Ee],'toString',function(){return this._k;}),pe.f=Le,ce.f=Fe,I(84).f=de.f=Ve,I(34).f=ze,I(51).f=Ue,U&&!I(49)&&W(xe,'propertyIsEnumerable',ze,!0),X.f=function(He){return Oe(J(He));}),N(N.G+N.W+N.F*!ke,{Symbol:he});for(var Ne='hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'.split(','),We=0;Ne.length>We;)J(Ne[We++]);for(var Ke=ue(J.store),$e=0;Ke.length>$e;)Q(Ke[$e++]);N(N.S+N.F*!ke,'Symbol',{for:function(He){return V(Ce,He+='')?Ce[He]:Ce[He]=he(He);},keyFor:function(je){if(we(je))return ee(Ce,je);throw TypeError(je+' is not a symbol!');},useSetter:function(){Pe=!0;},useSimple:function(){Pe=!1;}}),N(N.S+N.F*!ke,'Object',{create:function(je,qe){return qe===void 0?le(je):Ae(le(je),qe);},defineProperty:Fe,defineProperties:Ae,getOwnPropertyDescriptor:Le,getOwnPropertyNames:Ve,getOwnPropertySymbols:Ue}),ye&&N(N.S+N.F*(!ke||H(function(){var He=he();return'[null]'!=be([He])||'{}'!=be({a:He})||'{}'!=be(Object(He));})),'JSON',{stringify:function(je){if(!(void 0===je||we(je))){for(var qe=[je],Ge=1,Ze,Ye;arguments.length>Ge;)qe.push(arguments[Ge++]);return Ze=qe[1],'function'==typeof Ze&&(Ye=Ze),(Ye||!oe(Ze))&&(Ze=function(Je,Xe){if(Ye&&(Xe=Ye.call(this,Je,Xe)),!we(Xe))return Xe;}),qe[1]=Ze,be.apply(ye,qe);}}}),he[Ee][ve]||I(22)(he[Ee],ve,he[Ee].valueOf),Z(he,'Symbol'),Z(Math,'Math',!0),Z(L.JSON,'JSON',!0);},function(M,R,I){I(58)('asyncIterator');},function(M,R,I){I(58)('observable');},function(M,R,I){(function(L,V){var U;(function(N){function W(Be){throw new RangeError(Se[Be]);}function $(Be,xe){for(var ke=Be.length,De=[];ke--;)De[ke]=xe(Be[ke]);return De;}function H(Be,xe){var ke=Be.split('@'),De='';1<ke.length&&(De=ke[0]+'@',Be=ke[1]),Be=Be.replace(Ee,'\x2E');var Pe=Be.split('.'),Te=$(Pe,xe).join('.');return De+Te;}function G(Be){for(var xe=[],ke=0,De=Be.length,Pe,Te;ke<De;)Pe=Be.charCodeAt(ke++),0xD800<=Pe&&0xDBFF>=Pe&&ke<De?(Te=Be.charCodeAt(ke++),0xDC00==(0xFC00&Te)?xe.push(((0x3FF&Pe)<<10)+(0x3FF&Te)+0x10000):(xe.push(Pe),ke--)):xe.push(Pe);return xe;}function Z(Be){return $(Be,function(xe){var ke='';return 0xFFFF<xe&&(xe-=0x10000,ke+=Ce(0xD800|0x3FF&xe>>>10),xe=0xDC00|0x3FF&xe),ke+=Ce(xe),ke;}).join('');}function Y(Be){return 10>Be-48?Be-22:26>Be-65?Be-65:26>Be-97?Be-97:de;}function J(Be,xe){return Be+22+75*(26>Be)-((0!=xe)<<5);}function X(Be,xe,ke){var De=0;for(Be=ke?Me(Be/me):Be>>1,Be+=Me(Be/xe);Be>ve*ce>>1;De+=de)Be=Me(Be/ve);return Me(De+(ve+1)*Be/(Be+ue));}function Q(Be){var xe=[],ke=Be.length,Pe=0,Te=ge,Oe=fe,De,we,Fe,Ae,Ie,ze,Le,Ve,Ue,Ne;for(we=Be.lastIndexOf(he),0>we&&(we=0),Fe=0;Fe<we;++Fe)0x80<=Be.charCodeAt(Fe)&&W('not-basic'),xe.push(Be.charCodeAt(Fe));for(Ae=0<we?we+1:0;Ae<ke;){for(Ie=Pe,ze=1,Le=de;;Le+=de){if(Ae>=ke&&W('invalid-input'),Ve=Y(Be.charCodeAt(Ae++)),(Ve>=de||Ve>Me((le-Pe)/ze))&&W('overflow'),Pe+=Ve*ze,Ue=Le<=Oe?pe:Le>=Oe+ce?ce:Le-Oe,Ve<Ue)break;Ne=de-Ue,ze>Me(le/Ne)&&W('overflow'),ze*=Ne;}De=xe.length+1,Oe=X(Pe-Ie,De,0==Ie),Me(Pe/De)>le-Te&&W('overflow'),Te+=Me(Pe/De),Pe%=De,xe.splice(Pe++,0,Te);}return Z(xe);}function ee(Be){var Le=[],xe,ke,De,Pe,Te,Oe,we,Fe,Ae,Ie,ze,Ve,Ue,Ne,We;for(Be=G(Be),Ve=Be.length,xe=ge,ke=0,Te=fe,Oe=0;Oe<Ve;++Oe)ze=Be[Oe],0x80>ze&&Le.push(Ce(ze));for(De=Pe=Le.length,Pe&&Le.push(he);De<Ve;){for(we=le,Oe=0;Oe<Ve;++Oe)ze=Be[Oe],ze>=xe&&ze<we&&(we=ze);for(Ue=De+1,we-xe>Me((le-ke)/Ue)&&W('overflow'),ke+=(we-xe)*Ue,xe=we,Oe=0;Oe<Ve;++Oe)if(ze=Be[Oe],ze<xe&&++ke>le&&W('overflow'),ze==xe){for(Fe=ke,Ae=de;;Ae+=de){if(Ie=Ae<=Te?pe:Ae>=Te+ce?ce:Ae-Te,Fe<Ie)break;We=Fe-Ie,Ne=de-Ie,Le.push(Ce(J(Ie+We%Ne,0))),Fe=Me(We/Ne);}Le.push(Ce(J(Fe,0))),Te=X(ke,Ue,De==Pe),ke=0,++De;}++ke,++xe;}return Le.join('');}var re='object'==typeof R&&R&&!R.nodeType&&R,ne='object'==typeof L&&L&&!L.nodeType&&L,ie='object'==typeof V&&V;(ie.global===ie||ie.window===ie||ie.self===ie)&&(N=ie);var le=2147483647,de=36,pe=1,ce=26,ue=38,me=700,fe=72,ge=128,he='-',ye=/^xn--/,be=/[^\x20-\x7E]/,Ee=/[\x2E\u3002\uFF0E\uFF61]/g,Se={overflow:'Overflow: input needs wider integers to process',"not-basic":'Illegal input >= 0x80 (not a basic code point)',"invalid-input":'Invalid input'},ve=de-pe,Me=Math.floor,Ce=String.fromCharCode,se;se={version:'1.4.1',ucs2:{decode:G,encode:Z},decode:Q,encode:ee,toASCII:function(Be){return H(Be,function(xe){return be.test(xe)?'xn--'+ee(xe):xe;});},toUnicode:function(Be){return H(Be,function(xe){return ye.test(xe)?Q(xe.slice(4).toLowerCase()):xe;});}};U=function(){return se;}.call(R,I,R,L),!(void 0!==U&&(L.exports=U));})(this);}).call(R,I(262)(M),I(91));},function(M){"use strict";function I(V,U){return Object.prototype.hasOwnProperty.call(V,U);}M.exports=function(V,U,N,W){U=U||'&',N=N||'=';var $={};if('string'!=typeof V||0===V.length)return $;var H=/\+/g;V=V.split(U);var G=1e3;W&&'number'==typeof W.maxKeys&&(G=W.maxKeys);var Z=V.length;0<G&&Z>G&&(Z=G);for(var Y=0;Y<Z;++Y){var J=V[Y].replace(H,'%20'),X=J.indexOf(N),Q,ee,te,oe;0<=X?(Q=J.substr(0,X),ee=J.substr(X+1)):(Q=J,ee=''),te=decodeURIComponent(Q),oe=decodeURIComponent(ee),I($,te)?L($[te])?$[te].push(oe):$[te]=[$[te],oe]:$[te]=oe;}return $;};var L=Array.isArray||function(V){return'[object Array]'===Object.prototype.toString.call(V);};},function(M){"use strict";function I(N,W){if(N.map)return N.map(W);for(var $=[],H=0;H<N.length;H++)$.push(W(N[H],H));return $;}var L=function(N){switch(typeof N){case'string':return N;case'boolean':return N?'true':'false';case'number':return isFinite(N)?N:'';default:return'';}};M.exports=function(N,W,$,H){return W=W||'&',$=$||'=',null===N&&(N=void 0),'object'==typeof N?I(U(N),function(G){var Z=encodeURIComponent(L(G))+$;return V(N[G])?I(N[G],function(Y){return Z+encodeURIComponent(L(Y));}).join(W):Z+encodeURIComponent(L(N[G]));}).join(W):H?encodeURIComponent(L(H))+$+encodeURIComponent(L(N)):'';};var V=Array.isArray||function(N){return'[object Array]'===Object.prototype.toString.call(N);},U=Object.keys||function(N){var W=[];for(var $ in N)Object.prototype.hasOwnProperty.call(N,$)&&W.push($);return W;};},function(M,R,I){"use strict";R.decode=R.parse=I(257),R.encode=R.stringify=I(258);},function(M,R,I){"use strict";function L(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null;}function V(pe,ce,ue){if(pe&&H.isObject(pe)&&pe instanceof L)return pe;var me=new L();return me.parse(pe,ce,ue),me;}var $=I(256),H=I(261);R.parse=V,R.resolve=function(pe,ce){return V(pe,!1,!0).resolve(ce);},R.resolveObject=function(pe,ce){return pe?V(pe,!1,!0).resolveObject(ce):ce;},R.format=function(pe){return H.isString(pe)&&(pe=V(pe)),pe instanceof L?pe.format():L.prototype.format.call(pe);},R.Url=L;var G=/^([a-z0-9.+-]+:)/i,Z=/:[0-9]*$/,Y=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,X=['{','}','|','\\','^','`'].concat(['<','>','"','`',' ','\r','\n','\t']),Q=['\''].concat(X),ee=['%','/','?',';','#'].concat(Q),te=['/','?','#'],re=/^[+a-z0-9A-Z_-]{0,63}$/,ne=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ie={javascript:!0,"javascript:":!0},se={javascript:!0,"javascript:":!0},le={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},de=I(259);L.prototype.parse=function(pe,ce,ue){if(!H.isString(pe))throw new TypeError("Parameter 'url' must be a string, not "+typeof pe);var me=pe.indexOf('?'),fe=-1!==me&&me<pe.indexOf('#')?'?':'#',ge=pe.split(fe),he=/\\/g;ge[0]=ge[0].replace(he,'/'),pe=ge.join(fe);var ye=pe;if(ye=ye.trim(),!ue&&1===pe.split('#').length){var be=Y.exec(ye);if(be)return this.path=ye,this.href=ye,this.pathname=be[1],be[2]?(this.search=be[2],this.query=ce?de.parse(this.search.substr(1)):this.search.substr(1)):ce&&(this.search='',this.query={}),this;}var Ee=G.exec(ye);if(Ee){Ee=Ee[0];var Se=Ee.toLowerCase();this.protocol=Se,ye=ye.substr(Ee.length);}if(ue||Ee||ye.match(/^\/\/[^@\/]+@[^@\/]+/)){var ve='//'===ye.substr(0,2);ve&&!(Ee&&se[Ee])&&(ye=ye.substr(2),this.slashes=!0);}if(!se[Ee]&&(ve||Ee&&!le[Ee])){for(var Me=-1,Ce=0,Re;Ce<te.length;Ce++)Re=ye.indexOf(te[Ce]),-1!==Re&&(-1==Me||Re<Me)&&(Me=Re);var Be,xe;xe=-1===Me?ye.lastIndexOf('@'):ye.lastIndexOf('@',Me),-1!==xe&&(Be=ye.slice(0,xe),ye=ye.slice(xe+1),this.auth=decodeURIComponent(Be)),Me=-1;for(var Ce=0,Re;Ce<ee.length;Ce++)Re=ye.indexOf(ee[Ce]),-1!==Re&&(-1===Me||Re<Me)&&(Me=Re);-1===Me&&(Me=ye.length),this.host=ye.slice(0,Me),ye=ye.slice(Me),this.parseHost(),this.hostname=this.hostname||'';var ke='['===this.hostname[0]&&']'===this.hostname[this.hostname.length-1];if(!ke)for(var De=this.hostname.split(/\./),Ce=0,Pe=De.length,Te;Ce<Pe;Ce++)if(Te=De[Ce],Te&&!Te.match(re)){for(var Oe='',we=0,Fe=Te.length;we<Fe;we++)Oe+=127<Te.charCodeAt(we)?'x':Te[we];if(!Oe.match(re)){var Ae=De.slice(0,Ce),Ie=De.slice(Ce+1),ze=Te.match(ne);ze&&(Ae.push(ze[1]),Ie.unshift(ze[2])),Ie.length&&(ye='/'+Ie.join('.')+ye),this.hostname=Ae.join('.');break;}}this.hostname=this.hostname.length>255?'':this.hostname.toLowerCase(),ke||(this.hostname=$.toASCII(this.hostname));var Le=this.port?':'+this.port:'',Ve=this.hostname||'';this.host=Ve+Le,this.href+=this.host,ke&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),'/'!==ye[0]&&(ye='/'+ye));}if(!ie[Se])for(var Ce=0,Pe=Q.length,Ue;Ce<Pe;Ce++)if(Ue=Q[Ce],-1!==ye.indexOf(Ue)){var Ne=encodeURIComponent(Ue);Ne===Ue&&(Ne=escape(Ue)),ye=ye.split(Ue).join(Ne);}var We=ye.indexOf('#');-1!==We&&(this.hash=ye.substr(We),ye=ye.slice(0,We));var Ke=ye.indexOf('?');if(-1===Ke?ce&&(this.search='',this.query={}):(this.search=ye.substr(Ke),this.query=ye.substr(Ke+1),ce&&(this.query=de.parse(this.query)),ye=ye.slice(0,Ke)),ye&&(this.pathname=ye),le[Se]&&this.hostname&&!this.pathname&&(this.pathname='/'),this.pathname||this.search){var Le=this.pathname||'',$e=this.search||'';this.path=Le+$e;}return this.href=this.format(),this;},L.prototype.format=function(){var pe=this.auth||'';pe&&(pe=encodeURIComponent(pe),pe=pe.replace(/%3A/i,':'),pe+='@');var ce=this.protocol||'',ue=this.pathname||'',me=this.hash||'',fe=!1,ge='';this.host?fe=pe+this.host:this.hostname&&(fe=pe+(-1===this.hostname.indexOf(':')?this.hostname:'['+this.hostname+']'),this.port&&(fe+=':'+this.port)),this.query&&H.isObject(this.query)&&Object.keys(this.query).length&&(ge=de.stringify(this.query));var he=this.search||ge&&'?'+ge||'';return ce&&':'!==ce.substr(-1)&&(ce+=':'),this.slashes||(!ce||le[ce])&&!1!==fe?(fe='//'+(fe||''),ue&&'/'!==ue.charAt(0)&&(ue='/'+ue)):!fe&&(fe=''),me&&'#'!==me.charAt(0)&&(me='#'+me),he&&'?'!==he.charAt(0)&&(he='?'+he),ue=ue.replace(/[?#]/g,function(ye){return encodeURIComponent(ye);}),he=he.replace('#','%23'),ce+fe+ue+he+me;},L.prototype.resolve=function(pe){return this.resolveObject(V(pe,!1,!0)).format();},L.prototype.resolveObject=function(pe){if(H.isString(pe)){var ce=new L();ce.parse(pe,!1,!0),pe=ce;}for(var ue=new L(),me=Object.keys(this),fe=0,ge;fe<me.length;fe++)ge=me[fe],ue[ge]=this[ge];if(ue.hash=pe.hash,''===pe.href)return ue.href=ue.format(),ue;if(pe.slashes&&!pe.protocol){for(var he=Object.keys(pe),ye=0,be;ye<he.length;ye++)be=he[ye],'protocol'!==be&&(ue[be]=pe[be]);return le[ue.protocol]&&ue.hostname&&!ue.pathname&&(ue.path=ue.pathname='/'),ue.href=ue.format(),ue;}if(pe.protocol&&pe.protocol!==ue.protocol){if(!le[pe.protocol]){for(var Ee=Object.keys(pe),Se=0,ve;Se<Ee.length;Se++)ve=Ee[Se],ue[ve]=pe[ve];return ue.href=ue.format(),ue;}if(ue.protocol=pe.protocol,!pe.host&&!se[pe.protocol]){for(var Me=(pe.pathname||'').split('/');Me.length&&!(pe.host=Me.shift()););pe.host||(pe.host=''),pe.hostname||(pe.hostname=''),''!==Me[0]&&Me.unshift(''),2>Me.length&&Me.unshift(''),ue.pathname=Me.join('/');}else ue.pathname=pe.pathname;if(ue.search=pe.search,ue.query=pe.query,ue.host=pe.host||'',ue.auth=pe.auth,ue.hostname=pe.hostname||pe.host,ue.port=pe.port,ue.pathname||ue.search){var Ce=ue.pathname||'',Re=ue.search||'';ue.path=Ce+Re;}return ue.slashes=ue.slashes||pe.slashes,ue.href=ue.format(),ue;}var Be=ue.pathname&&'/'===ue.pathname.charAt(0),xe=pe.host||pe.pathname&&'/'===pe.pathname.charAt(0),ke=xe||Be||ue.host&&pe.pathname,De=ke,Pe=ue.pathname&&ue.pathname.split('/')||[],Me=pe.pathname&&pe.pathname.split('/')||[],Te=ue.protocol&&!le[ue.protocol];if(Te&&(ue.hostname='',ue.port=null,ue.host&&(''===Pe[0]?Pe[0]=ue.host:Pe.unshift(ue.host)),ue.host='',pe.protocol&&(pe.hostname=null,pe.port=null,pe.host&&(''===Me[0]?Me[0]=pe.host:Me.unshift(pe.host)),pe.host=null),ke=ke&&(''===Me[0]||''===Pe[0])),xe)ue.host=pe.host||''===pe.host?pe.host:ue.host,ue.hostname=pe.hostname||''===pe.hostname?pe.hostname:ue.hostname,ue.search=pe.search,ue.query=pe.query,Pe=Me;else if(Me.length)Pe||(Pe=[]),Pe.pop(),Pe=Pe.concat(Me),ue.search=pe.search,ue.query=pe.query;else if(!H.isNullOrUndefined(pe.search)){if(Te){ue.hostname=ue.host=Pe.shift();var Oe=ue.host&&0<ue.host.indexOf('@')&&ue.host.split('@');Oe&&(ue.auth=Oe.shift(),ue.host=ue.hostname=Oe.shift());}return ue.search=pe.search,ue.query=pe.query,H.isNull(ue.pathname)&&H.isNull(ue.search)||(ue.path=(ue.pathname?ue.pathname:'')+(ue.search?ue.search:'')),ue.href=ue.format(),ue;}if(!Pe.length)return ue.pathname=null,ue.path=ue.search?'/'+ue.search:null,ue.href=ue.format(),ue;for(var we=Pe.slice(-1)[0],Fe=(ue.host||pe.host||1<Pe.length)&&('.'===we||'..'===we)||''===we,Ae=0,Ie=Pe.length;0<=Ie;Ie--)we=Pe[Ie],'.'===we?Pe.splice(Ie,1):'..'===we?(Pe.splice(Ie,1),Ae++):Ae&&(Pe.splice(Ie,1),Ae--);if(!ke&&!De)for(;Ae--;Ae)Pe.unshift('..');ke&&''!==Pe[0]&&(!Pe[0]||'/'!==Pe[0].charAt(0))&&Pe.unshift(''),Fe&&'/'!==Pe.join('/').substr(-1)&&Pe.push('');var ze=''===Pe[0]||Pe[0]&&'/'===Pe[0].charAt(0);if(Te){ue.hostname=ue.host=ze?'':Pe.length?Pe.shift():'';var Oe=ue.host&&0<ue.host.indexOf('@')&&ue.host.split('@');Oe&&(ue.auth=Oe.shift(),ue.host=ue.hostname=Oe.shift());}return ke=ke||ue.host&&Pe.length,ke&&!ze&&Pe.unshift(''),Pe.length?ue.pathname=Pe.join('/'):(ue.pathname=null,ue.path=null),H.isNull(ue.pathname)&&H.isNull(ue.search)||(ue.path=(ue.pathname?ue.pathname:'')+(ue.search?ue.search:'')),ue.auth=pe.auth||ue.auth,ue.slashes=ue.slashes||pe.slashes,ue.href=ue.format(),ue;},L.prototype.parseHost=function(){var pe=this.host,ce=Z.exec(pe);ce&&(ce=ce[0],':'!==ce&&(this.port=ce.substr(1)),pe=pe.substr(0,pe.length-ce.length)),pe&&(this.hostname=pe);};},function(M){"use strict";M.exports={isString:function(I){return'string'==typeof I;},isObject:function(I){return'object'==typeof I&&null!==I;},isNull:function(I){return null===I;},isNullOrUndefined:function(I){return null==I;}};},function(M){M.exports=function(I){return I.webpackPolyfill||(I.deprecate=function(){},I.paths=[],!I.children&&(I.children=[]),Object.defineProperty(I,"loaded",{enumerable:!0,configurable:!1,get:function(){return I.l;}}),Object.defineProperty(I,"id",{enumerable:!0,configurable:!1,get:function(){return I.i;}}),I.webpackPolyfill=1),I;};},function(M){M.exports=_;},function(M,R,I){"use strict";function L(Re){if(Re&&Re.__esModule)return Re;var Be={};if(null!=Re)for(var xe in Re)Object.prototype.hasOwnProperty.call(Re,xe)&&(Be[xe]=Re[xe]);return Be.default=Re,Be;}function V(Re){return Re&&Re.__esModule?Re:{default:Re};}var U=I(38),N=V(U),W=I(0),$=V(W),H=I(3),G=V(H),Z=I(2),Y=V(Z),J=I(1),X=I(92),Q=V(X),ee=I(5),te=V(ee),oe=I(7),re=V(oe),ne=I(6),ie=V(ne),se=I(37),le=V(se),de=I(94),pe=L(de),ce=I(8),ue=V(ce),me=I(62),fe=L(me),ge=I(30),he=V(ge),ye=I(12),be=V(ye),Ee=I(93),Se=V(Ee),ve=function(Be){return J.SDKUtils.byteArrayToString(J.Base64.decode(Be));},Me=function(Re){function Be(){var xe=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(0,$.default)(this,Be);var ke=(0,G.default)(this,Re.call(this));return ke._mediator=new J.EventEmitter(),ke._fontLoader=new Se.default(),ke._options=xe,ke._initOptions(),ke._initLanguage(),ke._initEvents(),ke._disposed=!1,J.Log.setLevel(ke._options.logLevel),ke._v()&&ke.run(),ke;}return(0,Y.default)(Be,Re),Be.prototype.run=function(){this._registerWebFonts(),this._options.container.style.position='relative',this._render();},Be.prototype._render=function(){var ke=J.React.createElement(Q.default,{ui:this,mediator:this._mediator,options:this._options});return this._options.renderReturnsComponent?ke:void(this._component=J.ReactDOM.render(ke,this._options.container));},Be.prototype.export=function(){var ke;return(ke=this._component).export.apply(ke,arguments);},Be.prototype.serialize=function(){var ke;return(ke=this._component).serialize.apply(ke,arguments);},Be.prototype.deserialize=function(ke){return this._component.deserialize(ke);},Be.prototype.getEditor=function(){return this._component.getEditor();},Be.prototype._initOptions=function(){this._options=J.SDKUtils.defaults(this._options,{language:'en',title:'PhotoEditor SDK',logLevel:'warn',preloader:!0,editor:{},assets:{},photoRoll:{},enableUpload:!0,enableWebcam:!0,showCloseButton:!1,showHeader:!0,showTopBar:!0,responsive:!1}),this._options.editor=J.SDKUtils.defaults(this._options.editor||{},{pixelRatio:'undefined'!=typeof window&&window.devicePixelRatio||1,preferredRenderer:'webgl',enableZoom:!0,enableDrag:!0,smoothDownscaling:!1,smoothUpscaling:!1,displayResizeMessage:!0,maxMegaPixels:{},forceControls:[],watermarkImage:null,tools:['crop','filter','brightness','saturation','contrast','clarity','exposure','shadows','highlights','text','sticker','brush','radial-focus','linear-focus','frame'],controlsOrder:['crop',['filter','adjustments'],['text','sticker','brush'],['selectiveBlur','focus','frame']],operationsOrder:['exif-orientation','orientation','crop','filter','adjustments','radial-focus','linear-focus','selective-blur','sprite','frame','watermark'],controlsOptions:{}}),this._options.editor.maxMegaPixels=J.SDKUtils.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10}),this._options.editor.export=J.SDKUtils.defaults(this._options.editor.export||{},{showButton:!0,format:'image/png',type:J.RenderType.IMAGE,download:!0,fileBasename:'photoeditorsdk-export',quality:0.8}),this._options.photoRoll=J.SDKUtils.defaults(this._options.photoRoll||{},{provider:null}),this._options.extensions=J.SDKUtils.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]}),this._options.assets=J.SDKUtils.defaults(this._options.assets||{},{baseUrl:'assets',resolver:null});},Be.prototype._v=function(){return!!this[ve('X29wdGlvbnM=')][ve('YXBpS2V5')]||(J.Log.error(ve('YXBpS2V5'),ve('Tm8gYGFwaUtleWAgb3B0aW9uIGdpdmVuLg==')),J.Log.error(ve('YXBpS2V5'),ve('SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhbiBBUEkga2V5IHlldCwgcGxlYXNlIGNvbnRhY3Qgb3VyIHNhbGVzIHN0YWZmIGF0IHNhbGVzQHBob3RvZWRpdG9yc2RrLmNvbSB0byBvYnRhaW4gYSBsaWNlbnNlIG9yIGxvZyBpbiB0byB5b3VyIGN1c3RvbWVyIGRhc2hib2FyZC4=')),!1);},Be.prototype._registerWebFonts=function(){var ke=this.getAssetPath('fonts/montserrat-regular.woff',!0,!0),De=this.getAssetPath('fonts/montserrat-light.woff',!0,!0);this._webFontsStyle=document.createElement('style'),this._webFontsStyle.innerHTML='\n      // Injected by PhotoEditorSDK\n      @font-face {\n        font-family: "__pesdk_Montserrat";\n        src: url(\''+ke+'\') format(\'woff\');\n        font-weight: normal;\n        font-style: normal;\n      }\n\n      @font-face {\n        font-family: "__pesdk_Montserrat";\n        src: url(\''+De+'\') format(\'woff\');\n        font-weight: 100;\n        font-style: normal;\n      }\n    ';var Te=document.getElementsByTagName('head')[0];Te.appendChild(this._webFontsStyle);},Be.prototype._initEvents=function(){this._mediator.pipeEvents(this);},Be.prototype._disposeEvents=function(){this._mediator.unpipeEvents(this);},Be.prototype._initLanguage=function(){this._languages=J.SDKUtils.deepDefaults(this._options.extensions.languages,{de:I(95),en:I(96)}),this._language=this._languages[this._options.language],this._language||J.Log.error(this.constructor.name,'Language `'+this._options.language+'` not found!');},Be.prototype.translate=function(ke,De){return J.Utils.translate(this._language,ke,De);},Be.prototype.setImage=function(ke){this._component&&this._component.setImage(ke);},Be.prototype.getAssetPath=function(ke){var De=1<arguments.length&&void 0!==arguments[1]&&arguments[1],Pe=2<arguments.length&&void 0!==arguments[2]&&arguments[2],Te=this._options.assets,Oe=Te.baseUrl,we=Te.resolver,Fe=Oe+'/'+ke;if(ke.match(/(ftp|http|https):\/\//)&&(Fe=ke),De){if(!Pe){var Ae='undefined'!=typeof window&&window.devicePixelRatio||1;if(1<Ae){var Ie=/\.[\w?=]+$/;ke=ke.replace(Ie,function(ze){return'@2x'+ze;});}}Fe=Oe+'/ui/react/'+ke;}return'undefined'!=typeof we&&null!==we&&(Fe=we(Fe)),Fe;},Be.prototype.getFontLoader=function(){return this._fontLoader;},Be.prototype.dispose=function(){if(this._disposed)throw new Error('This instance of PhotoEditorSDK is already disposed.');this._disposed=!0,this._webFontsStyle.parentNode.removeChild(this._webFontsStyle),J.ReactDOM.unmountComponentAtNode(this._options.container),this._disposeEvents();},Be;}(J.EventEmitter);/*
    * This file is part of PhotoEditorSDK.
    *
    * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
    * All rights reserved.
    *
    * Redistribution and use in source and binary forms, without
    * modification, are permitted provided that the following license agreement
    * is approved and a legal/financial contract was signed by the user.
    * The license agreement can be found under following link:
    *
    * https://www.photoeditorsdk.com/LICENSE.txt
    * @license
    */Me.prototype.identifier='react',Me.BaseComponent=J.BaseComponent,Me.BaseControls=ue.default,Me.ControlsComponent=re.default,Me.React=J.React,Me.ReactBEM=J.ReactBEM,Me.SharedState=J.SharedState,Me.Constants=J.Constants,Me.Utils=J.Utils,Me.ScrollbarComponent=te.default,Me.ModalManager=ie.default,Me.JSONLoader=le.default,Me.PhotoRoll=pe,Me.Controls=fe,Me.SliderComponent=he.default,Me.SliderOverlayComponent=be.default;var Ce=function(Re){function Be(){return(0,$.default)(this,Be),(0,G.default)(this,Re.apply(this,arguments));}return(0,Y.default)(Be,Re),Be.prototype.componentDidMount=function(){this._ui=new Me(J.SDKUtils.extend({},this.props,{container:this.refs.container}));},Be.prototype.render=function(){var ke=J.SDKUtils.extend({},this.props.style||{});return J.React.createElement('div',{style:ke,ref:'container'});},(0,N.default)(Be,[{key:'ui',get:function(){return this._ui;}}]),Be;}(J.React.Component);Me.ReactComponent=Ce,J.SDK.UI=J.SDK.UI||{},J.SDK.UI.ReactUI=Me,M.exports=Me;}]);});