!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("photoeditorsdk/PhotoEditorSDK.UI.DesktopUI.Core"),require("photoeditorsdk")):"function"==typeof define&&define.amd?define([["PhotoEditorSDK","UI","DesktopUI"],"photoeditorsdk"],e):"object"==typeof exports?exports._unexposedPESDK=e(require("photoeditorsdk/PhotoEditorSDK.UI.DesktopUI.Core"),require("photoeditorsdk")):t._unexposedPESDK=e(t.PhotoEditorSDK.UI.DesktopUI,t.PhotoEditorSDK)}("undefined"!=typeof self?self:this,function(t,e){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=75)}({0:function(e,n){e.exports=t},1:function(t,n){t.exports=e},2:function(t,e,n){"use strict";(function(t){n.d(e,"b",function(){return r}),n.d(e,"a",function(){return a});for(var o="undefined"==typeof window?t:window,r=o.requestAnimationFrame,a=o.cancelAnimationFrame,i=0,s=["ms","moz","webkit","o"],l=0;l<s.length&&!r;++l)r=o[s[l]+"RequestAnimationFrame"],a=o[s[l]+"CancelAnimationFrame"]||o[s[l]+"CancelRequestAnimationFrame"];r&&(r=r.bind(o)),a&&(a=a.bind(o)),r||(r=function(t,e){var n=(new Date).getTime(),o=Math.max(0,16-(n-i)),r=setTimeout(function(){t(n+o)},o);return i=n+o,r}),a||(a=function(t){clearTimeout(t)})}).call(e,n(4))},4:function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},75:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),s=(n.n(i),n(0)),l=n.n(s),c=n(76),d=n(78),p=i.Math.Vector2,h=new p(50,50),u=function(t){function e(){return o(this,e),r(this,t.apply(this,arguments))}return a(e,t),e.prototype._onEnter=function(){var t=this.context.editor,e=t.operations.exists("transform"),n=t.operations.getOrCreate("transform");n.setEnabled(!1,!1);var o=t.operations.exists("orientation"),r=t.operations.getOrCreate("orientation"),a={end:new p(1,1),rotation:0,start:new p(0,0),textureScale:1},s=n.getInputDimensions(!1),l=n.getNewDimensions(s),c=a,d=c,h=d.start,u=d.end,f=d.textureScale,m=d.rotation;if(e){c=n.serializeOptions(),h=c.start,u=c.end,m=c.rotation,f=c.textureScale,delete c.enabled;var g=n.calculateScale(m),y=n.getInputDimensions(!1),S=Math.cos(m),v=Math.sin(m),_=u.clone().subtract(h).divide(2),b=h.clone().add(_).multiply(y),R=b.subtract(y.clone().multiply(.5)),E=new p(R.x*S-R.y*v,R.x*v+R.y*S).multiply(g),C=y.clone().multiply(.5).add(E),x=C.clone().divide(y),O=x.clone().subtract(_.clone().multiply(g)),w=x.clone().add(_.clone().multiply(g));h=O,u=w}t.broadcastTransform(n,a);var D=r.serializeOptions();t.setSpriteScale(n.calculateScale()),t.setRotation(m),n.set(a,e);var T=t.features.isEnabledByOptions("export");t.zoom.auto(!0,!1,function(){t.features.disable("zoom","drag","export")},!1),this.sharedState.set({transformOperation:n,initialTransformOptions:c,newTransformOptions:{start:h,end:u,rotation:m,textureScale:f},transformOperationExistedBeforeEntering:e,exportEnabled:T,orientationOperation:r,initialOrientationOptions:D,newOrientationOptions:i.Utils.cloneOptions(D),orientationOperationExistedBeforeEntering:o,start:p.fromObject(h),end:p.fromObject(u),rotation:m,orientationRotation:r.getRotation(),flipVertically:r.getFlipVertically(),flipHorizontally:r.getFlipHorizontally(),initialDimensions:l,initialRatio:n._ratio||null})},e.prototype._onBeforeLeave=function(){var t=this,e=this.context.ui.translate.bind(this.context.ui);return new Promise(function(n,o){var r=t.sharedState.get("changesDone"),a=t.sharedState.get("changesAccepted");if(r&&!a){return void s.ModalManager.instance.displayWarning(e("warnings.discardChanges.title"),e("warnings.discardChanges.text"),[e("warnings.discardChanges.buttons.cancel"),e("warnings.discardChanges.buttons.discard")]).on("button",function(t){return 0===t?n({leave:!1}):1===t?n({leave:!0,data:{discard:!0}}):void 0})}n({leave:!0})})},e.prototype._onLeave=function(t){var e=t.discard,n=this.context.editor,o=this.sharedState.get("transformOperation"),r=this.sharedState.get("orientationOperation");if(e){var a=this.sharedState.get("initialOrientationOptions");r.set(a);var i=this.sharedState.get("initialTransformOptions");n.broadcastTransform(o,i),o.set(i),o.setTextureScale(this._calculateTextureScale()),o.setEnabled(!0)}else{var s={rotation:0,flipVertically:!1,flipHorizontally:!1};r.optionsEqual(s)&&n.operations.remove(r,!1);var l=this.sharedState.get("newTransformOptions"),c=l.start,d=l.end,h=l.textureScale,u=l.rotation;h=this._calculateTextureScale(),c=c.clone(),d=d.clone();var f=o.calculateScale(u),m=o.getInputDimensions(!1),g=Math.cos(-u),y=Math.sin(-u),S=d.clone().subtract(c).divide(2),v=c.clone().add(S).multiply(m),_=v.subtract(m.clone().multiply(.5)),b=new p(_.x*g-_.y*y,_.x*y+_.y*g).divide(f),R=m.clone().multiply(.5).add(b),E=R.clone().divide(m),C=E.clone().subtract(S.clone().divide(f)),x=E.clone().add(S.clone().divide(f)),O={start:new p(0,0),end:new p(1,1),rotation:0,textureScale:1},w={start:C,end:x,textureScale:h,rotation:u};w.start.equals(O.start)&&w.end.equals(O.end)&&w.rotation===O.rotation&&w.textureScale===O.textureScale?n.operations.remove(o,!1):(n.broadcastTransform(o,w),o.set(w),o.setTextureScale(this._calculateTextureScale()),o.setEnabled(!0))}n.setRotation(0),n.setSpriteScale(1),n.features.enable("zoom","drag","export"),this.sharedState.get("exportEnabled")&&n.features.enable("export"),n.zoom.auto(!0)},e.prototype._getGlobalHistoryData=function(){return{ratio:this.sharedState.get("ratio")}},e.prototype._onOperationRemoved=function(t){},e.prototype._calculateTextureScale=function(){var t=this.sharedState.get("transformOperation"),e=this.sharedState.get("ratio");if(!e||!e.dimensions)return 1;var n=this.sharedState.get("start"),o=this.sharedState.get("end"),r=o.clone().subtract(n),a=t.getInputDimensions(!1).multiply(r);return e.dimensions.x/a.x},e.prototype.fixTransform=function(t,e,n,o){var r=this.context.editor,a=this.sharedState.get("transformOperation"),i=a.getInputDimensions(!1),l=this.sharedState.get("ratio"),c=l.ratio,d=l.dimensions;d&&!c&&(c=d.x/d.y);var u=void 0;"*"!==c&&(u=s.Utils.findIntegerFraction(c));var f=new p;f.x="left"===n?e.x:1-t.x,f.y="top"===o?e.y:1-t.y;var m=i.clone().multiply(f),g=e.clone().subtract(t),y=g.clone().multiply(i),S=h.clone().divide(r.zoom.targetLevel),v=new p(Math.min(S.x,.1*i.x),Math.min(S.y,.1*i.y));if("*"!==c&&v.divide(u).round().multiply(u),y.x=Math.min(Math.max(v.x,y.x),m.x),"*"!==c){var _=Math.floor(i.x/u.x);y.x=Math.max(1,Math.min(_,Math.round(y.x/u.x)))*u.x,y.y=y.x/c}y.y=Math.min(Math.max(v.y,y.y),m.y),"*"!==c&&(y.x=y.y*c);var b=y.divide(i);return"top"===o?t.y=e.y-b.y:e.y=t.y+b.y,"left"===n?t.x=e.x-b.x:e.x=t.x+b.x,"*"===c&&(t.multiply(i).round().divide(i),e.multiply(i).round().divide(i)),{start:t,end:e}},e.getPreloadAssets=function(t){var e=t.getOptions(),n=i.Utils.defaults(e.editor.controlsOptions.transform,this.defaultOptions),o=["editor/controls/transform/dimensions-cross.png","editor/controls/transform/degree-slider.png","editor/controls/transform/flip.png","editor/controls/transform/lock.png","editor/controls/transform/rotate.png"];return new s.TransformRatioManager(n).getCategories().forEach(function(t){t.ratios.forEach(function(t){var e=t.identifier;o.push("editor/controls/transform/ratios/"+e+"-default.png","editor/controls/transform/ratios/"+e+"-hover.png","editor/controls/transform/ratios/"+e+"-active.png")})}),o},e.isEnabled=function(t){return t.isToolAllowed("transform")&&t.isToolEnabled("transform")},e}(s.BaseControls);u.clickAtPosition=s.BaseControls.clickAtPosition,u.identifier="transform",u.controlsComponent=d.a,u.canvasControlsComponent=c.a,u.iconPath="editor/controls/transform/icon.png",u.activeIconPath="editor/controls/transform/icon-active.png",u.requiredOperations=["transform","orientation"],u.defaultOptions={categories:[],replaceCategories:!1,availableRatios:null,enableRotation:!0,enableStraighten:!0,enableFlip:!0},e.default=u,l.a.Controls.TransformControls=u},76:function(t,e,n){"use strict";function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(1),l=(n.n(s),n(0)),c=(n.n(l),n(2)),d=n(77),p=s.Math.Vector2,h=function(t){function e(){var n;r(this,e);for(var i=arguments.length,c=Array(i),d=0;d<i;d++)c[d]=arguments[d];var p=a(this,t.call.apply(t,[this].concat(c)));return p._bindAll("_onZoomDone","_onCornerDrag","_onCenterDragStart","_onCenterDrag","_onRotationChange","_onOperationUpdated","_onOperationRemoved","_onAcceptClick","_onAcceptMouseDown"),p._events=(n={},o(n,l.Constants.EVENTS.OPERATION_UPDATED,p._onOperationUpdated),o(n,l.Constants.EVENTS.OPERATION_REMOVED,p._onOperationRemoved),o(n,l.Constants.EVENTS.ZOOM_DONE,p._onZoomDone),n),p.state=s.Utils.extend(p.state,{visible:!1}),p}return i(e,t),e.prototype.shouldSharedComponentUpdate=function(t,e){return!t.start.equals(e.start)||!t.end.equals(e.end)||t.orientationRotation!==e.orientationRotation||t.ratio!==e.ratio||t.changesDone!==e.changesDone},e.prototype.sharedStateDidChange=function(t,e){(t.ratio&&t.ratio.ratio)!==(e.ratio&&e.ratio.ratio)&&this._calculateRatioFraction()},e.prototype.sharedComponentWillUpdate=function(t,e){t.orientationRotation!==e.orientationRotation&&this._updateTransformAreaStyles()},e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._updateTransformAreaStyles(),this._calculateRatioFraction(),this.forceUpdate()},e.prototype.componentWillUpdate=function(){this._updateTransformAreaStyles()},e.prototype.componentDidUpdate=function(){!this._transformContainerRect&&this.getSharedState("ratio")&&(this._updateTransformAreaStyles(),this.forceUpdate())},e.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),this._zoomAFRequest&&(Object(c.a)(this._zoomAFRequest),this._zoomAFRequest=null)},e.prototype._calculateRatioFraction=function(){var t=this.getSharedState("ratio");t&&"*"!==t.ratio&&(this._ratioFraction=l.Utils.findIntegerFraction(t.ratio))},e.prototype._onCenterDragStart=function(t){var e=this.getSharedState("transformOperation");this._dragOptions={initialStart:this.getSharedState("start").clone(),initialEnd:this.getSharedState("end").clone(),areaDimensions:this._transformContainerRect.getSize(),imageDimensions:e.getInputDimensions(!1)}},e.prototype._onCenterDrag=function(t){var e=this._dragOptions,n=e.initialStart,o=e.initialEnd,r=e.areaDimensions,a=e.imageDimensions,i=t.clone().divide(r),s=o.clone().subtract(n),l=new p(0,0),c=new p(1,1).subtract(s),d=n.clone().add(i).clamp(l,c),h=d.clone().add(s);d.multiply(a).floor().divide(a),h.multiply(a).floor().divide(a),this.props.controls.fixTransform(d,h,"right","bottom");var u=this.getSharedState("newTransformOptions");u.start=d,u.end=h,this.setSharedState({start:d,end:h,changesDone:this.getSharedState("changesDone")||!(n.equals(d)&&o.equals(h))})},e.prototype._onCornerDragStart=function(t,e,n){var o=this.getSharedState("transformOperation");this._dragOptions={initialStart:this.getSharedState("start").clone(),initialEnd:this.getSharedState("end").clone(),verticalSide:t,horizontalSide:e,areaDimensions:this._transformContainerRect.getSize(),imageDimensions:o.getInputDimensions(!1)},this._currentCorner={vertical:t,horizontal:e}},e.prototype._onCornerDrag=function(t){var e=this._dragOptions,n=e.initialStart,o=e.initialEnd,r=e.verticalSide,a=e.horizontalSide,i=e.areaDimensions,s=t.clone().divide(i),c=n.clone(),d=o.clone();("top"===r?c:d).y+=s.y,("left"===a?c:d).x+=s.x,this.props.controls.fixTransform(c,d,a,r);var p=this.getSharedState("newTransformOptions");p.start=c,p.end=d,this.setSharedState({start:c,end:d,changesDone:!0}),this._emitEvent(l.Constants.EVENTS.TRANSFORM_RESIZE)},e.prototype._onRotationChange=function(t){var e=this.getSharedState("transformOperation"),n=this.context.editor;n.setRotation(t),n.setSpriteScale(e.calculateScale(t)),this.getSharedState("newTransformOptions").rotation=t,n.render(),this.setSharedState({rotation:t,changesDone:!0})},e.prototype._onAcceptClick=function(t){t.preventDefault(),t.stopPropagation(),this.getSharedState("changesDone")&&(this.setSharedState({changesAccepted:!0}),this.context.screen.switchToControls("default"))},e.prototype._onAcceptMouseDown=function(t){t.stopPropagation()},e.prototype._onZoomDone=function(){var t=this;this._zoomAFRequest=Object(c.b)(function(){t._updateTransformAreaStyles(),t.state.visible=!0,t.forceUpdate(),t._zoomAFRequest=null})},e.prototype._onOperationUpdated=function(t){if(t===this.getSharedState("transformOperation")){var e=this.context.editor,n=e.getSDK();n.setRotation(t.getRotation()),n.setSpriteScale(t.calculateScale()),e.render(),this.setSharedState({rotation:t.getRotation()}),this.forceUpdate()}},e.prototype._onOperationRemoved=function(t){"transform"!==t.constructor.identifier&&"orientation"!==t.constructor.identifier||this.forceUpdate()},e.prototype._onFlipClick=function(t){var e=this.context.editor,n=this.getSharedState("orientationOperation"),r=t.charAt(0).toUpperCase()+t.slice(1)+"ly",a=!this.getSharedState("flip"+r);this.setSharedState(o({},"flip"+r,a)),n.flip(t);var i=this.getSharedState("newTransformOptions"),s=-1*this.getSharedState("rotation");e.setRotation(s);var l=this.getSharedState("start").clone(),c=this.getSharedState("end").clone(),d=l.clone();"horizontal"===t?(l.set(1-c.x,l.y),c.set(1-d.x,c.y)):"vertical"===t&&(l.set(l.x,1-c.y),c.set(c.x,1-d.y)),i.start=l,i.end=c,i.rotation=s,this.setSharedState({start:l,end:c,rotation:s,changesDone:!0,newTransformOptions:i}),this.forceUpdate(),e.broadcastFlip(t),e.render()},e.prototype._onRotateClick=function(t){var e=this,n="cw"===t?90:-90,o=this.context.editor,r=this.getSharedState("orientationOperation"),a=(r.getRotation()+n)%360;r.set({rotation:a});var i={orientationRotation:a},s=this.getSharedState("newTransformOptions"),c=this.getSharedState("ratio");if(c)if(c.dimensions||"*"!==c.ratio)this._emitEvent(l.Constants.EVENTS.TRANSFORM_REAPPLY_RATIO),this._emitEvent(l.Constants.EVENTS.TRANSFORM_RESIZE);else{var d=this.getSharedState("start").clone(),p=this.getSharedState("end").clone(),h=d.clone();"cw"===t?(d.set(1-p.y,h.x),p.set(1-h.y,p.x)):"ccw"===t&&(d.set(h.y,1-p.x),p.set(p.y,1-h.x)),i.start=d,i.end=p,s.start=d,s.end=p}this.setSharedState({changesDone:!0,newTransformOptions:s}),o.broadcastRotate(n),o.zoom.auto(!0,!0,function(){e.setSharedState(i)})},e.prototype._updateTransformAreaStyles=function(){this._transformContainerRect=this.getImageBoundingRect(),this._imageContainer&&l.Utils.styleElement(this._imageContainer,{left:this._transformContainerRect.x+"px",top:this._transformContainerRect.y+"px",width:this._transformContainerRect.width+"px",height:this._transformContainerRect.height+"px"})},e.prototype._getAreaStyles=function(){var t=void 0,e=void 0,n=void 0,o=void 0,r=void 0;this._transformContainer?(t=this._transformContainerRect.getSize(),r=this._transformContainerRect.getPosition(),e=this.getSharedState("start").clone().multiply(t),n=this.getSharedState("end").clone().multiply(t),o=n.clone().subtract(e)):(t=new p(0,0),e=new p(0,0),o=new p(0,0),r=new p(0,0));var a=this._getDimensionsStyles(o.x,o.y);return{topLeft:this._getDimensionsStyles(e.x+r.x,e.y+r.y),topCenter:this._getDimensionsStyles(o.x,e.y+r.y),centerLeft:this._getDimensionsStyles(e.x+r.x,o.y),center:{width:a.width},innerTransformContainer:a}},e.prototype._getDimensionsStyles=function(t,e){return{width:Math.max(1,t),height:Math.max(1,e)}},e.prototype._renderOnCanvasControls=function(){var t=this,e=this._getAreaStyles(),n=!this.getSharedState("ratio"),o={backgroundImage:"url('"+this._getAssetPath("editor/controls/transform/accept.png",!0)+"')"};return l.React.createElement(f,{innerRef:function(e){t._container=e}},l.React.createElement(S,{className:"js-imageContainer",innerRef:function(e){t._imageContainer=e}},l.React.createElement(I,{className:void 0,enabled:this.getSharedState("changesDone"),onClick:this._onAcceptClick,onMouseDown:this._onAcceptMouseDown,style:o})),l.React.createElement(v,{visible:this.state.visible,innerRef:function(e){t._transformContainer=e}},l.React.createElement(b,null,l.React.createElement(x,{style:e.topLeft}),l.React.createElement(x,{style:e.topCenter}),l.React.createElement(x,null)),l.React.createElement(b,null,l.React.createElement(x,{style:e.centerLeft}),l.React.createElement(l.DraggableComponent,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag,disabled:n},l.React.createElement(C,{style:e.center,className:void 0,undraggable:n},!n&&[l.React.createElement(l.DraggableComponent,{onStart:this._onCornerDragStart.bind(this,"top","left"),onDrag:this._onCornerDrag,key:"topLeft"},l.React.createElement(O,{top:!0,left:!0,className:void 0})),l.React.createElement(l.DraggableComponent,{onStart:this._onCornerDragStart.bind(this,"top","right"),onDrag:this._onCornerDrag,key:"topRight"},l.React.createElement(O,{top:!0,right:!0,className:void 0})),l.React.createElement(l.DraggableComponent,{onStart:this._onCornerDragStart.bind(this,"bottom","left"),onDrag:this._onCornerDrag,key:"bottomLeft"},l.React.createElement(O,{bottom:!0,left:!0,className:void 0})),l.React.createElement(l.DraggableComponent,{onStart:this._onCornerDragStart.bind(this,"bottom","right"),onDrag:this._onCornerDrag,key:"bottomRight"},l.React.createElement(O,{bottom:!0,right:!0,className:void 0})),l.React.createElement(_,{style:e.innerTransformContainer,className:void 0,key:"inner"},l.React.createElement(b,null,l.React.createElement(E,{right:!0,bottom:!0}),l.React.createElement(E,{right:!0,bottom:!0}),l.React.createElement(E,{bottom:!0})),l.React.createElement(b,null,l.React.createElement(E,{right:!0,bottom:!0}),l.React.createElement(E,{right:!0,bottom:!0}),l.React.createElement(E,{bottom:!0})),l.React.createElement(b,null,l.React.createElement(E,{right:!0}),l.React.createElement(E,{right:!0}),l.React.createElement(E,null)))])),l.React.createElement(x,null)),l.React.createElement(b,null,l.React.createElement(x,null),l.React.createElement(x,null),l.React.createElement(x,null))))},e.prototype._renderControls=function(){var t={backgroundImage:"url('"+this._getAssetPath("editor/controls/transform/flip.png",!0)+"')"},e={backgroundImage:"url('"+this._getAssetPath("editor/controls/transform/rotate.png",!0)+"')"},n=this.props.options,o=n.enableRotation,r=n.enableFlip,a=n.enableStraighten;return l.React.createElement(u,{className:void 0},this._renderOnCanvasControls(),l.React.createElement(m,null,l.React.createElement(g,{className:void 0},r&&[l.React.createElement(D,{style:t,key:"flip-h",onClick:this._onFlipClick.bind(this,"horizontal"),className:void 0}),l.React.createElement(D,{vertical:!0,style:t,key:"flip-v",onClick:this._onFlipClick.bind(this,"vertical"),className:void 0})],a&&l.React.createElement(d.a,{value:this.getSharedState("rotation"),onChange:this._onRotationChange}),o&&[l.React.createElement(T,{style:e,key:"rotate-ccw",onClick:this._onRotateClick.bind(this,"ccw"),className:void 0}),l.React.createElement(T,{clockwise:!0,style:e,key:"rotate-cw",onClick:this._onRotateClick.bind(this,"cw"),className:void 0})])))},e}(l.CanvasControlsComponent);h.contextTypes=l.CanvasControlsComponent.contextTypes,e.a=h;var u=l.adonis.div("120drhm","CanvasControls"),f=l.adonis.div("8gacw5",{draggable:"ovipzq"},"OnCanvasControls"),m=l.adonis.div("nmw377","BottomControlsContainer"),g=l.adonis.div("1gk061a","BottomControls"),y=l.adonis.div("1v9hd4r","TransformContainer"),S=l.adonis.div("15kzu1c","ImageContainer"),v=Object(l.adonis)(y)("1kjfwvf",{visible:"zgbg08"},"OuterTransformContainer"),_=Object(l.adonis)(y)("120drhm","InnerTransformContainer"),b=l.adonis.div("15u7gri","TransformRow"),R=l.adonis.div("1q481v0","TransformCell"),E=Object(l.adonis)(R)("1qh9j3j",{top:"1mup05p",right:"12l7t8k",bottom:"1ebuiz6",left:"txqhsl"},"BorderedTransformCell"),C=Object(l.adonis)(R)("52h18o",{undraggable:"16s6vgr"},"CenterTransformCell"),x=Object(l.adonis)(R)("17b4s67","DarkTransformCell"),O=l.adonis.div("1tai30v",{top:"1stnln8",right:"1wj5vxi",bottom:"17bojqc",left:"1a9ompl"},"Dragger"),w=l.adonis.button("127b6wl","Button"),D=Object(l.adonis)(w)("120drhm",{vertical:"12fqiy2"},"FlipButton"),T=Object(l.adonis)(w)("120drhm",{clockwise:"o7ss47"},"RotateButton"),I=l.adonis.div("sbdqjz",{enabled:"ro0g1e"},"AcceptButton")},77:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var i=n(0),s=(n.n(i),function(t){function e(){o(this,e);for(var n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=r(this,t.call.apply(t,[this].concat(a)));return s._bindAll("_onDragStart","_onDrag"),s._width=0,s.state={value:s.props.value||0},s}return a(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._degreesPerPixel=90/217},e.prototype.componentWillReceiveProps=function(t){this.state.value!==t.value&&this.setState({value:t.value})},e.prototype._onDragStart=function(){this._initialDegrees=180*this.state.value/Math.PI},e.prototype._onDrag=function(t){var e=this._initialDegrees+t.x*this._degreesPerPixel;e=Math.min(45,Math.max(e,-45));var n=e*Math.PI/180;this.setState({value:n}),this.props.onChange&&this.props.onChange(n)},e.prototype._getValue=function(){return Math.round(180*this.state.value/Math.PI)+"°"},e.prototype._getIndicatorPosition=function(){var t=45*Math.PI/180;return this._width/2+this.state.value/t*(this._width/2)},e.prototype._getIndicatorStyles=function(){var t=45*Math.PI/180;return{left:{left:108.5+this.state.value/t*108.5},right:{right:108.5-this.state.value/t*108.5}}},e.prototype.render=function(){var t=this._getIndicatorStyles(),e={backgroundImage:"url('"+this._getAssetPath("editor/controls/transform/degree-slider.png",!0)+"')",backgroundPosition:t.left.left-4},n={backgroundImage:"url('"+this._getAssetPath("editor/controls/transform/degree-slider.png",!0)+"')",backgroundPosition:t.left.left+35};return i.React.createElement(i.DraggableComponent,{onStart:this._onDragStart,onDrag:this._onDrag},i.React.createElement(l,{className:void 0},i.React.createElement(c,{style:e},i.React.createElement(d,{style:t.left})),i.React.createElement(p,{className:void 0},this._getValue()),i.React.createElement(c,{style:n},i.React.createElement(d,{style:t.right}))))},e}(i.BaseComponent));s.contextTypes=i.BaseComponent.contextTypes,e.a=s;var l=i.adonis.div("tix0xu","Wrapper"),c=i.adonis.div("6mdana","RotationSlider"),d=i.adonis.div("nxjpo","Indicator"),p=i.adonis.div("d97kws","Value")},78:function(t,e,n){"use strict";function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(1),l=(n.n(s),n(0)),c=(n.n(l),n(79)),d=n(80),p=l.GroupedControlsStyles.ControlGroupList,h=l.GroupedControlsStyles.ControlGroup,u=l.GroupedControlsStyles.ControlGroupTitle,f=s.Math.Vector2,m=function(t){function e(){var n;r(this,e);for(var i=arguments.length,s=Array(i),c=0;c<i;c++)s[c]=arguments[c];var d=a(this,t.call.apply(t,[this].concat(s)));return d._bindAll("_reapplyRatio","_onHistoryChange","_onResetDefaultClick","_onOperationRemoved","_onOperationUpdated"),d._events=(n={},o(n,l.Constants.EVENTS.TRANSFORM_REAPPLY_RATIO,d._reapplyRatio),o(n,l.Constants.EVENTS.OPERATION_REMOVED,d._onOperationRemoved),o(n,l.Constants.EVENTS.OPERATION_UPDATED,d._onOperationUpdated),o(n,l.Constants.EVENTS.HISTORY_UNDO,d._onHistoryChange),o(n,l.Constants.EVENTS.HISTORY_REDO,d._onHistoryChange),n),d._transformRatioManager=new l.TransformRatioManager(d.props.options),d.state.ratio=null,d._selectInitialRatio(!d.getSharedState("transformOperationExistedBeforeEntering")),d}return i(e,t),e.prototype.shouldSharedComponentUpdate=function(t,e){return t.ratio!==e.ratio},e.prototype._onHistoryChange=function(t){var e=this.context.editor,n={},o=e.operations.get("transform");if(o){var r=this.getSharedState("newTransformOptions");r.start=o.getStart(),r.end=o.getEnd(),r.rotation=o.getRotation(),r.textureScale=o.getTextureScale(),n.newTransformOptions=r,t.data&&t.data.ratio&&(n.ratio=t.data.ratio),this.setSharedState(n)}},e.prototype._onOperationUpdated=function(t){var e=this.getSharedState("transformOperation");e===t&&this.setSharedState({rotation:e.getRotation(),start:e.getStart().clone(),end:e.getEnd().clone()})},e.prototype._onOperationRemoved=function(t){var e=this.context.editor;if(this.getSharedState("transformOperation")===t){var n=e.operations.getOrCreate("transform",{enabled:!1}),o=e.getSDK();o.setRotation(0),o.setSpriteScale(1),this.setSharedState({transformOperation:n,rotation:0,initialTransformOptions:n.serializeOptions(),transformOperationExistedBeforeEntering:!1}),n._ratio=null,this._selectInitialRatio(!0,!0)}if(this.getSharedState("orientationOperation")===t){var r=e.operations.getOrCreate("orientation");this.setSharedState({orientationOperation:r,rotation:0,flipVertically:!1,flipHorizontally:!1})}},e.prototype._onResetDefaultClick=function(){var t=this.context.editor,e=this.getSharedState("orientationOperation"),n=e.getRotation();e.set({flipHorizontally:!1,flipVertically:!1,rotation:0}),t.broadcastRotate(-n);var o=this.getSharedState("newTransformOptions");o.start=new f(0,0),o.end=new f(1,1),o.rotation=0,this.setSharedState({ratio:null,start:new f(0,0),end:new f(1,1),orientationRotation:0,rotation:0,flipVertically:!1,flipHorizontally:!1,changesDone:!0}),this._emitEvent(l.Constants.EVENTS.TRANSFORM_RESIZE),t.setRotation(0),t.setSpriteScale(1),t.zoom.auto(!0,!0)},e.prototype._reapplyRatio=function(){var t=this.getSharedState("ratio");this._selectRatio(t)},e.prototype._selectRatio=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.getSharedState("transformOperation");e&&t&&this._setDefaultOptionsForRatio(t,n),o._ratio=t,this.setSharedState({ratio:t},n),n&&this.setSharedState({changesDone:!0}),this._emitEvent(l.Constants.EVENTS.TRANSFORM_RESIZE)},e.prototype._setDefaultOptionsForRatio=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t||{},o=n.ratio,r=n.dimensions,a=new f,i=new f;r&&!o&&(o=r.x/r.y);var s=o&&l.Utils.findIntegerFraction(o);if(o&&"*"!==o){var c=this.getSharedState("transformOperation"),d=c.getInputDimensions(!1),p=d.x/d.y,h=void 0,u=void 0;if(p<=o){var m=Math.floor(d.x/s.x)*s.y;u=Math.floor(Math.min(m,d.y)/s.y)*s.y,h=u*o,a.set((d.x-h)/2,(d.y-u)/2).floor()}else{var g=Math.floor(d.y/s.y)*s.x;h=Math.floor(Math.min(g,d.x)/s.x)*s.x,u=h/o,a.set((d.x-h)/2,(d.y-u)/2).floor()}i.copy(a).add(h,u),a.divide(d),i.divide(d)}else a=new f(0,0),i=new f(1,1);var y=this.getSharedState("newTransformOptions");y.start=a,y.end=i,this.setSharedState({start:a,end:i},e)},e.prototype._selectInitialRatio=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getSharedState("transformOperation"),o=null,r=this._transformRatioManager.getCategories(),a=r.map(function(t){return t.ratios}).reduce(function(t,e){return t.concat(e)}),i=n._ratio;if(i){o=a.filter(function(t){return t===i})[0]}if(!o){o=a.filter(function(t){return t.selected}).pop()}return o||(o=a[0]),this._selectRatio(o,t,e)},e.prototype._renderSections=function(){var t=this,e=function(e){return l.React.createElement(S,{key:e.identifier},l.React.createElement(v,null,t._t("editor.controls.transform.ratios."+e.identifier+".name")||e.defaultName),l.React.createElement(_,null,n(e)))},n=function(e){return t._transformRatioManager.getRatiosForCategory(e).map(function(n){var o=t.getSharedState("ratio")===n;return l.React.createElement(c.a,{key:n.identifier,defaultIconPath:"editor/controls/transform/ratios/"+n.identifier+"-default.png",hoverIconPath:"editor/controls/transform/ratios/"+n.identifier+"-hover.png",activeIconPath:"editor/controls/transform/ratios/"+n.identifier+"-active.png",onClick:t._selectRatio.bind(t,n),title:t._t("editor.controls.transform.ratios."+e.identifier+".ratios."+n.identifier)||n.defaultName,identifier:n.identifier,selected:o})})};return this._transformRatioManager.getCategories().map(function(t){return e(t)})},e.prototype._getRootProps=function(){return{className:void 0,withBorderTop:!0}},e.prototype._renderContent=function(){var t=this,e=this.getSharedState("ratio");return[l.React.createElement(l.ScrollableListComponent,{key:"list",direction:"vertical",innerRef:function(e){t._scrollbar=e}},l.React.createElement(y,null,l.React.createElement(g,null,l.React.createElement(l.ButtonComponent,{title:this._t("editor.controls.transform.reset"),className:void 0,onClick:this._onResetDefaultClick})),this._renderSections())),l.React.createElement(d.a,{key:"transformDimensions",controls:this.props.controls,disabled:!e||!!e.dimensions})]},e}(l.ControlsComponent);m.contextTypes=l.ControlsComponent.contextTypes,m.RootElement=l.ControlsComponent.RootElement,e.a=m;var g=l.adonis.li("7abnmv","SectionListHeader"),y=Object(l.adonis)(p).ul("x32ss4","SectionList"),S=Object(l.adonis)(h).li("ber9o0","Section"),v=Object(l.adonis)(u).div("15ebqhq","SectionTitle"),_=l.adonis.ul("1klgjyq","SectionGrid")},79:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var i=n(0),s=(n.n(i),i.ControlsStyles.PlainControlItem),l=function(t){function e(){o(this,e);for(var n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=r(this,t.call.apply(t,[this].concat(a)));return s.state={hovered:!1},s}return a(e,t),e.prototype.render=function(){var t=this,e={backgroundImage:"url('"+this._getAssetPath(this.props.defaultIconPath,!0)+"')"},n={backgroundImage:"url('"+this._getAssetPath(this.props.hoverIconPath,!0)+"')"},o={backgroundImage:"url('"+this._getAssetPath(this.props.activeIconPath,!0)+"')"},r=this.props,a=r.selected,s=r.onClick,l=r.identifier,h=r.title,u=this.state.hovered;return i.React.createElement(c,{selected:a,onClick:s,"data-identifier":l,"data-selected":a,onMouseEnter:function(){return t.setState({hovered:!0})},onMouseLeave:function(){return t.setState({hovered:!1})},className:void 0},i.React.createElement(i.Transition,{active:!a},i.React.createElement(d,{style:e})),i.React.createElement(i.Transition,{active:!a&&u},i.React.createElement(d,{style:n})),i.React.createElement(i.Transition,{active:a},i.React.createElement(d,{style:o})),i.React.createElement(p,{selected:a},h))},e}(i.BaseComponent);l.contextTypes=i.BaseComponent.contextTypes,e.a=l;var c=Object(i.adonis)(s).li("71xi0n","TransformListItem"),d=i.adonis.div("u0ryhr",{rendered:"2jlos",visible:"82svov"},"Icon"),p=i.adonis.div("jpjwq7",{selected:"zgbg08"},"Title")},80:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var i=n(1),s=(n.n(i),n(0)),l=(n.n(s),function(t){function e(){o(this,e);for(var n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=r(this,t.call.apply(t,[this].concat(a))),l=s._getTransformDimensions();return s.state={dimensions:l,x:l.x,y:l.y},s}return a(e,t),e.prototype.shouldSharedComponentUpdate=function(t,e){return!t.start.equals(e.start)||!t.end.equals(e.end)||t.ratio!==e.ratio},e.prototype.sharedComponentWillUpdate=function(t,e){if(e.transformOperation){var n=this._getTransformDimensions(),o=n.x,r=n.y;this.state.dimensions=n,this.state.x=o,this.state.y=r}},e.prototype._onInputLiveChange=function(t,e){var n=e.target.value;n.length&&!n.match(/\d+?/i)||(this.state[t]=n&&parseInt(n,10)||"",this.forceUpdate())},e.prototype._onInputChange=function(t,e){var n=this.state[t]||0,o=this.getSharedState("transformOperation"),r=o.getInputDimensions(!1),a=this.getSharedState("ratio"),l=a.ratio,c=this.getSharedState("start"),d=this.getSharedState("end"),p=d.clone().subtract(c),h=p.clone().multiply(r);if(h[t]=Math.min(r[t],n),"*"!==l){var u=s.Utils.findIntegerFraction(l);h[t]=Math.max(1,Math.round(h[t]/u[t]))*u[t],"x"===t?h.y=h.x/l:h.x=h.y*l}var f=h.clone();(h.x>r.x||h.y>r.y)&&(f=i.Utils.resizeVectorToFit(h,r));var m=this._getTransformDimensions(),g=m.x,y=m.y;this.state.dimensions=m,this.state.x=g,this.state.y=y,this._resizeTransformTo(f),this.forceUpdate()},e.prototype._getTransformDimensions=function(){var t=this.getSharedState("transformOperation"),e=this.getSharedState("ratio")||{ratio:"*"},n=void 0;if(e.dimensions)n=e.dimensions.clone();else{var o=t.getInputDimensions(!1),r=this.getSharedState("start");n=this.getSharedState("end").clone().subtract(r).multiply(o).round()}return n},e.prototype._resizeTransformTo=function(t){var e=this.getSharedState("transformOperation"),n=e.getInputDimensions(!1),o=this.getSharedState("start").clone(),r=this.getSharedState("end").clone(),a=t.divide(n);r.copy(o).add(a),r.x>1&&(o.x-=r.x-1,r.x=1),r.y>1&&(o.y-=r.y-1,r.y=1);var i=this.props.controls,l=i.fixTransform(o,r,"right","bottom"),c=l.start,d=l.end,p=this.getSharedState("newTransformOptions");p.start=c,p.end=d,this.setSharedState({start:c,end:d}),this._emitEvent(s.Constants.EVENTS.TRANSFORM_RESIZE)},e.prototype.render=function(){return s.React.createElement(p,{className:void 0},s.React.createElement(h,null,s.React.createElement(u,null,s.React.createElement(f,null,s.React.createElement(c,{suffix:this._t("editor.controls.transform.dimensions.width"),name:"width",disabled:this.props.disabled,value:this.state.x,onLiveChange:this._onInputLiveChange.bind(this,"x"),onChange:this._onInputChange.bind(this,"x")})),s.React.createElement(m,null,s.React.createElement(d,{src:this._getAssetPath("editor/controls/transform/dimensions-cross.png",!0)})),s.React.createElement(f,null,s.React.createElement(c,{suffix:this._t("editor.controls.transform.dimensions.height"),name:"height",disabled:this.props.disabled,value:this.state.y,onLiveChange:this._onInputLiveChange.bind(this,"y"),onChange:this._onInputChange.bind(this,"y")}))),s.React.createElement(s.Transition,{active:this.props.disabled,enterProp:"rendered",enterDuration:300,appearProp:"visible",appearDuration:300,leaveDuration:300},s.React.createElement(g,{className:void 0},s.React.createElement(y,{src:this._getAssetPath("editor/controls/transform/lock.png",!0)})))))},e}(s.SharedStateComponent));l.contextTypes=s.SharedStateComponent.contextTypes,e.a=l;var c=Object(s.adonis)(s.SuffixedTextInputComponent)("2jlos","DimensionInput"),d=s.adonis.img("1dew3s1","Cross"),p=s.adonis.div("1yz821h","TransformDimensions"),h=s.adonis.div("1dg9k0o","TransformDimensionsWrapper"),u=s.adonis.div("wlk9p6","Table"),f=s.adonis.div("1q481v0","Cell"),m=Object(s.adonis)(f)("13lk3i9","CrossCell"),g=s.adonis.div("943mx5",{rendered:"2jlos",visible:"rval4i"},"LockOverlay"),y=s.adonis.img("1hp46pm","Lock")}}).default});